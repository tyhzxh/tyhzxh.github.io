<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Posts on tyhzxhçš„ä¸ªäººåšå®¢</title>
    <link>https://tyhzxh.github.io/posts/</link>
    <description>Recent content in Posts on tyhzxhçš„ä¸ªäººåšå®¢</description>
    <generator>Hugo -- 0.148.2</generator>
    <language>zh-cn</language>
    <lastBuildDate>Wed, 06 Aug 2025 20:56:36 +0800</lastBuildDate>
    <atom:link href="https://tyhzxh.github.io/posts/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Hugoåšå®¢ç½‘ç«™æ—¥å¸¸ç»´æŠ¤æŒ‡å—</title>
      <link>https://tyhzxh.github.io/posts/hugo-blog-workflow/</link>
      <pubDate>Sun, 23 Feb 2025 02:39:29 +0800</pubDate>
      <guid>https://tyhzxh.github.io/posts/hugo-blog-workflow/</guid>
      <description>Hugoé™æ€åšå®¢ç½‘ç«™çš„æ—¥å¸¸ç»´æŠ¤å’Œå‘å¸ƒæµç¨‹ï¼ŒåŒ…æ‹¬åˆ›å»ºæ–‡ç« ã€ç”Ÿæˆé™æ€æ–‡ä»¶ã€éƒ¨ç½²åˆ°GitHub Pagesçš„å®Œæ•´å·¥ä½œæµç¨‹</description>
      <content:encoded><![CDATA[<h2 id="å‰è¨€">å‰è¨€</h2>
<p>æœ¬æ–‡ä»‹ç»ä½¿ç”¨Hugoé™æ€ç½‘ç«™ç”Ÿæˆå™¨æ­å»ºçš„åšå®¢ç½‘ç«™çš„æ—¥å¸¸ç»´æŠ¤æµç¨‹ã€‚Hugoæ˜¯ä¸€ä¸ªå¿«é€Ÿã€ç°ä»£çš„é™æ€ç½‘ç«™ç”Ÿæˆå™¨ï¼Œç»“åˆGitHub Pageså¯ä»¥è½»æ¾æ­å»ºä¸ªäººåšå®¢ç½‘ç«™ã€‚</p>
<h2 id="hugoåšå®¢å‘å¸ƒæµç¨‹">Hugoåšå®¢å‘å¸ƒæµç¨‹</h2>
<h3 id="å®Œæ•´å·¥ä½œæµç¨‹">å®Œæ•´å·¥ä½œæµç¨‹</h3>
<pre tabindex="0"><code class="language-mermaid" data-lang="mermaid">graph TD
    A[åˆ›å»ºMarkdownæ–‡æ¡£] --&gt; B[ç¼–å†™åšå®¢å†…å®¹]
    B --&gt; C[ç”Ÿæˆé™æ€ç½‘ç«™]
    C --&gt; D[æäº¤åˆ°GitHub]
    D --&gt; E[ç½‘ç«™è‡ªåŠ¨æ›´æ–°]
</code></pre><h2 id="è¯¦ç»†æ“ä½œæ­¥éª¤">è¯¦ç»†æ“ä½œæ­¥éª¤</h2>
<h3 id="1-åˆ›å»ºåšå®¢æ–‡ç« ">1. åˆ›å»ºåšå®¢æ–‡ç« </h3>
<p>åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹æ‰§è¡Œä»¥ä¸‹å‘½ä»¤åˆ›å»ºæ–°çš„åšå®¢æ–‡ç« ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">hugo new posts/article-name.md
</span></span></code></pre></div><p><strong>å‘½ä»¤è¯´æ˜</strong>ï¼š</p>
<ul>
<li><code>hugo new</code>ï¼šHugoçš„å†…å®¹åˆ›å»ºå‘½ä»¤</li>
<li><code>posts/</code>ï¼šæ–‡ç« å­˜æ”¾çš„ç›®å½•</li>
<li><code>article-name.md</code>ï¼šæ–‡ç« æ–‡ä»¶åï¼ˆå»ºè®®ä½¿ç”¨è‹±æ–‡å’Œè¿å­—ç¬¦ï¼‰</li>
</ul>
<p><strong>ç¤ºä¾‹</strong>ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># åˆ›å»ºæŠ€æœ¯æ–‡ç« </span>
</span></span><span class="line"><span class="cl">hugo new posts/react-hooks-guide.md
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åˆ›å»ºç”Ÿæ´»éšç¬”</span>
</span></span><span class="line"><span class="cl">hugo new posts/my-reading-notes.md
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åˆ›å»ºé¡¹ç›®ä»‹ç»</span>
</span></span><span class="line"><span class="cl">hugo new posts/project-showcase.md
</span></span></code></pre></div><h3 id="2-ç¼–å†™æ–‡ç« å†…å®¹">2. ç¼–å†™æ–‡ç« å†…å®¹</h3>
<p>åˆ›å»ºçš„Markdownæ–‡ä»¶ä¼šåŒ…å«åŸºæœ¬çš„å‰ç½®å…ƒæ•°æ®ï¼ˆFront Matterï¼‰ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nn">---</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;æ–‡ç« æ ‡é¢˜&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">date</span><span class="p">:</span><span class="w"> </span><span class="ld">2025-02-23T02:39:29</span><span class="m">+08</span><span class="p">:</span><span class="m">00</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">draft</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nn">---</span><span class="w">
</span></span></span></code></pre></div><p><strong>å®Œå–„æ–‡ç« å…ƒæ•°æ®</strong>ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nn">---</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;React Hookså®Œå…¨æŒ‡å—&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">date</span><span class="p">:</span><span class="w"> </span><span class="ld">2025-02-23T10:00:00</span><span class="m">+08</span><span class="p">:</span><span class="m">00</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">draft</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">tags</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;React&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;JavaScript&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;å‰ç«¯å¼€å‘&#34;</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">categories</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;æŠ€æœ¯æ•™ç¨‹&#34;</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;æ·±å…¥ç†è§£React Hooksçš„ä½¿ç”¨æ–¹æ³•å’Œæœ€ä½³å®è·µ&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">cover</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;/images/react-hooks.jpg&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">alt</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;React Hooks&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">caption</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;React Hooksè®©å‡½æ•°ç»„ä»¶æ›´å¼ºå¤§&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nn">---</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># æ–‡ç« å†…å®¹å¼€å§‹...</span><span class="w">
</span></span></span></code></pre></div><p><strong>é‡è¦å­—æ®µè¯´æ˜</strong>ï¼š</p>
<ul>
<li><code>title</code>ï¼šæ–‡ç« æ ‡é¢˜</li>
<li><code>date</code>ï¼šå‘å¸ƒæ—¥æœŸ</li>
<li><code>draft</code>ï¼šæ˜¯å¦ä¸ºè‰ç¨¿ï¼ˆtrue=è‰ç¨¿ï¼Œfalse=å‘å¸ƒï¼‰</li>
<li><code>tags</code>ï¼šæ–‡ç« æ ‡ç­¾</li>
<li><code>categories</code>ï¼šæ–‡ç« åˆ†ç±»</li>
<li><code>description</code>ï¼šæ–‡ç« æè¿°ï¼ˆç”¨äºSEOï¼‰</li>
<li><code>cover</code>ï¼šå°é¢å›¾ç‰‡é…ç½®</li>
</ul>
<h3 id="3-ç”Ÿæˆé™æ€ç½‘ç«™">3. ç”Ÿæˆé™æ€ç½‘ç«™</h3>
<p>åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰§è¡Œï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">hugo
</span></span></code></pre></div><p><strong>å‘½ä»¤åŠŸèƒ½</strong>ï¼š</p>
<ul>
<li>è¯»å–<code>content/</code>ç›®å½•ä¸‹çš„Markdownæ–‡ä»¶</li>
<li>åº”ç”¨ä¸»é¢˜æ¨¡æ¿</li>
<li>ç”Ÿæˆé™æ€HTMLã€CSSã€JSæ–‡ä»¶</li>
<li>è¾“å‡ºåˆ°<code>public/</code>ç›®å½•</li>
</ul>
<p><strong>å¯é€‰å‚æ•°</strong>ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># ç”Ÿæˆå¹¶å¯åŠ¨æœ¬åœ°æœåŠ¡å™¨é¢„è§ˆ</span>
</span></span><span class="line"><span class="cl">hugo server
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç”Ÿæˆè‰ç¨¿å†…å®¹</span>
</span></span><span class="line"><span class="cl">hugo -D
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŒ‡å®šé…ç½®æ–‡ä»¶</span>
</span></span><span class="line"><span class="cl">hugo --config config.yaml
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ¸…ç†å¹¶é‡æ–°ç”Ÿæˆ</span>
</span></span><span class="line"><span class="cl">hugo --cleanDestinationDir
</span></span></code></pre></div><h3 id="4-æäº¤åˆ°github">4. æäº¤åˆ°GitHub</h3>
<p>è¿›å…¥<code>public</code>ç›®å½•ï¼ˆç”Ÿæˆçš„é™æ€æ–‡ä»¶ç›®å½•ï¼‰ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> public
</span></span></code></pre></div><p>æ‰§è¡ŒGitæ“ä½œï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æ·»åŠ æ‰€æœ‰æ–‡ä»¶åˆ°æš‚å­˜åŒº</span>
</span></span><span class="line"><span class="cl">git add .
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æäº¤æ›´æ”¹</span>
</span></span><span class="line"><span class="cl">git commit -m <span class="s2">&#34;update blog content&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ¨é€åˆ°GitHub Pages</span>
</span></span><span class="line"><span class="cl">git push origin master
</span></span></code></pre></div><p><strong>æäº¤ä¿¡æ¯å»ºè®®</strong>ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æ–°å¢æ–‡ç« </span>
</span></span><span class="line"><span class="cl">git commit -m <span class="s2">&#34;add: new post about React Hooks&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ›´æ–°æ–‡ç« </span>
</span></span><span class="line"><span class="cl">git commit -m <span class="s2">&#34;update: fix typos in React Hooks post&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç½‘ç«™é…ç½®æ›´æ–°</span>
</span></span><span class="line"><span class="cl">git commit -m <span class="s2">&#34;config: update site theme and settings&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ä¿®å¤é—®é¢˜</span>
</span></span><span class="line"><span class="cl">git commit -m <span class="s2">&#34;fix: resolve image loading issue&#34;</span>
</span></span></code></pre></div><h2 id="é«˜çº§å·¥ä½œæµç¨‹">é«˜çº§å·¥ä½œæµç¨‹</h2>
<h3 id="1-æœ¬åœ°é¢„è§ˆå’Œè°ƒè¯•">1. æœ¬åœ°é¢„è§ˆå’Œè°ƒè¯•</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># å¯åŠ¨æœ¬åœ°å¼€å‘æœåŠ¡å™¨</span>
</span></span><span class="line"><span class="cl">hugo server -D
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŒ‡å®šç«¯å£</span>
</span></span><span class="line"><span class="cl">hugo server --port <span class="m">1314</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç»‘å®šåˆ°æ‰€æœ‰ç½‘ç»œæ¥å£</span>
</span></span><span class="line"><span class="cl">hugo server --bind 0.0.0.0
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å®æ—¶é‡è½½ï¼ˆé»˜è®¤å¼€å¯ï¼‰</span>
</span></span><span class="line"><span class="cl">hugo server --watch
</span></span></code></pre></div><p>è®¿é—® <code>http://localhost:1313</code> é¢„è§ˆç½‘ç«™ã€‚</p>
<h3 id="2-å†…å®¹ç®¡ç†ç­–ç•¥">2. å†…å®¹ç®¡ç†ç­–ç•¥</h3>
<h4 id="æ–‡ç« åˆ†ç±»ç»“æ„">æ–‡ç« åˆ†ç±»ç»“æ„</h4>
<pre tabindex="0"><code>content/
â”œâ”€â”€ posts/           # åšå®¢æ–‡ç« 
â”œâ”€â”€ about/           # å…³äºé¡µé¢
â”œâ”€â”€ projects/        # é¡¹ç›®å±•ç¤º
â””â”€â”€ notes/           # å­¦ä¹ ç¬”è®°
</code></pre><h4 id="æ–‡ä»¶å‘½åè§„èŒƒ">æ–‡ä»¶å‘½åè§„èŒƒ</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æ—¥æœŸå‰ç¼€å‘½å</span>
</span></span><span class="line"><span class="cl">2025-02-23-react-hooks-guide.md
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åˆ†ç±»å‰ç¼€å‘½å</span>
</span></span><span class="line"><span class="cl">tech-react-hooks-guide.md
</span></span><span class="line"><span class="cl">life-reading-notes-2025.md
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç®€æ´å‘½å</span>
</span></span><span class="line"><span class="cl">react-hooks-guide.md
</span></span></code></pre></div><h3 id="3-è‡ªåŠ¨åŒ–éƒ¨ç½²">3. è‡ªåŠ¨åŒ–éƒ¨ç½²</h3>
<h4 id="github-actionsé…ç½®">GitHub Actionsé…ç½®</h4>
<p>åˆ›å»º<code>.github/workflows/hugo.yml</code>ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Deploy Hugo site to Pages</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">on</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">push</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">branches</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;main&#34;</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">workflow_dispatch</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">permissions</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">contents</span><span class="p">:</span><span class="w"> </span><span class="l">read</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">pages</span><span class="p">:</span><span class="w"> </span><span class="l">write</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">id-token</span><span class="p">:</span><span class="w"> </span><span class="l">write</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">concurrency</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;pages&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">cancel-in-progress</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">defaults</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">run</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">shell</span><span class="p">:</span><span class="w"> </span><span class="l">bash</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">jobs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">build</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l">ubuntu-latest</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">steps</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Checkout</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l">actions/checkout@v4</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">with</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">submodules</span><span class="p">:</span><span class="w"> </span><span class="l">recursive</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Setup Hugo</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l">peaceiris/actions-hugo@v2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">with</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">hugo-version</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;latest&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">extended</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Build with Hugo</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l">hugo --minify</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Upload artifact</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l">actions/upload-pages-artifact@v2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">with</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">./public</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">deploy</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">environment</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">github-pages</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l">${{ steps.deployment.outputs.page_url }}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l">ubuntu-latest</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">needs</span><span class="p">:</span><span class="w"> </span><span class="l">build</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">steps</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Deploy to GitHub Pages</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l">deployment</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l">actions/deploy-pages@v2</span><span class="w">
</span></span></span></code></pre></div><h4 id="ç®€åŒ–çš„å‘å¸ƒè„šæœ¬">ç®€åŒ–çš„å‘å¸ƒè„šæœ¬</h4>
<p>åˆ›å»º<code>deploy.sh</code>è„šæœ¬ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;å¼€å§‹æ„å»ºHugoç½‘ç«™...&#34;</span>
</span></span><span class="line"><span class="cl">hugo
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;è¿›å…¥publicç›®å½•...&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> public
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;æ·»åŠ æ–‡ä»¶åˆ°Git...&#34;</span>
</span></span><span class="line"><span class="cl">git add .
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;è¯·è¾“å…¥æäº¤ä¿¡æ¯ï¼š&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">read</span> commit_message
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[</span> -z <span class="s2">&#34;</span><span class="nv">$commit_message</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">    <span class="nv">commit_message</span><span class="o">=</span><span class="s2">&#34;update blog </span><span class="k">$(</span>date <span class="s1">&#39;+%Y-%m-%d %H:%M:%S&#39;</span><span class="k">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;æäº¤æ›´æ”¹...&#34;</span>
</span></span><span class="line"><span class="cl">git commit -m <span class="s2">&#34;</span><span class="nv">$commit_message</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;æ¨é€åˆ°GitHub...&#34;</span>
</span></span><span class="line"><span class="cl">git push origin master
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;éƒ¨ç½²å®Œæˆï¼&#34;</span>
</span></span></code></pre></div><p>ä½¿ç”¨è„šæœ¬ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">chmod +x deploy.sh
</span></span><span class="line"><span class="cl">./deploy.sh
</span></span></code></pre></div><h2 id="å†…å®¹ä¼˜åŒ–å»ºè®®">å†…å®¹ä¼˜åŒ–å»ºè®®</h2>
<h3 id="1-seoä¼˜åŒ–">1. SEOä¼˜åŒ–</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nn">---</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;å…·ä½“è€Œæœ‰å¸å¼•åŠ›çš„æ ‡é¢˜&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;ç®€æ´æ˜äº†çš„æ–‡ç« æè¿°ï¼ŒåŒ…å«å…³é”®è¯&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">keywords</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;å…³é”®è¯1&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;å…³é”®è¯2&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;å…³é”®è¯3&#34;</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">author</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;ä½œè€…å&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">canonical</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;https://yourdomain.com/posts/article-name/&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nn">---</span><span class="w">
</span></span></span></code></pre></div><h3 id="2-å›¾ç‰‡ç®¡ç†">2. å›¾ç‰‡ç®¡ç†</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gh"># æœ¬åœ°å›¾ç‰‡
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>![<span class="nt">å›¾ç‰‡æè¿°</span>](<span class="na">/images/local-image.jpg</span>)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># å¤–éƒ¨å›¾ç‰‡
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>![<span class="nt">å›¾ç‰‡æè¿°</span>](<span class="na">https://example.com/image.jpg</span>)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># å¸¦é“¾æ¥çš„å›¾ç‰‡
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>[<span class="nt">![å›¾ç‰‡æè¿°</span>](<span class="na">/images/image.jpg</span>)](https://link-url.com)
</span></span></code></pre></div><p>å›¾ç‰‡å­˜æ”¾ç»“æ„ï¼š</p>
<pre tabindex="0"><code>static/
â””â”€â”€ images/
    â”œâ”€â”€ posts/
    â”‚   â”œâ”€â”€ 2025/
    â”‚   â””â”€â”€ categories/
    â”œâ”€â”€ covers/
    â””â”€â”€ icons/
</code></pre><h3 id="3-ä»£ç é«˜äº®é…ç½®">3. ä»£ç é«˜äº®é…ç½®</h3>
<p>åœ¨<code>config.yaml</code>ä¸­é…ç½®ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">markup</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">highlight</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">style</span><span class="p">:</span><span class="w"> </span><span class="l">github</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">lineNos</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">tabWidth</span><span class="p">:</span><span class="w"> </span><span class="m">2</span><span class="w">
</span></span></span></code></pre></div><p>ä½¿ç”¨ä»£ç å—ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="s">```javascript
</span></span></span><span class="line"><span class="cl"><span class="s"></span><span class="kd">function</span> <span class="nx">greet</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Hello, </span><span class="si">${</span><span class="nx">name</span><span class="si">}</span><span class="sb">!`</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="s">```</span>
</span></span></code></pre></div><h2 id="æ•…éšœæ’é™¤">æ•…éšœæ’é™¤</h2>
<h3 id="å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ">å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ</h3>
<h4 id="1-æ„å»ºå¤±è´¥">1. æ„å»ºå¤±è´¥</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æ£€æŸ¥Hugoç‰ˆæœ¬</span>
</span></span><span class="line"><span class="cl">hugo version
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ£€æŸ¥é…ç½®æ–‡ä»¶è¯­æ³•</span>
</span></span><span class="line"><span class="cl">hugo config
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¯¦ç»†é”™è¯¯ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">hugo -v
</span></span></code></pre></div><h4 id="2-æ ·å¼ä¸¢å¤±">2. æ ·å¼ä¸¢å¤±</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æ£€æŸ¥baseURLé…ç½®</span>
</span></span><span class="line"><span class="cl">grep baseURL config.yaml
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># é‡æ–°ç”Ÿæˆå¹¶æ¸…ç†</span>
</span></span><span class="line"><span class="cl">hugo --cleanDestinationDir
</span></span></code></pre></div><h4 id="3-å›¾ç‰‡ä¸æ˜¾ç¤º">3. å›¾ç‰‡ä¸æ˜¾ç¤º</h4>
<ul>
<li>æ£€æŸ¥å›¾ç‰‡è·¯å¾„æ˜¯å¦æ­£ç¡®</li>
<li>ç¡®è®¤å›¾ç‰‡æ–‡ä»¶å­˜åœ¨äº<code>static/</code>ç›®å½•</li>
<li>æ£€æŸ¥æ–‡ä»¶åå¤§å°å†™</li>
</ul>
<h4 id="4-æ–‡ç« ä¸æ˜¾ç¤º">4. æ–‡ç« ä¸æ˜¾ç¤º</h4>
<ul>
<li>ç¡®è®¤<code>draft: false</code></li>
<li>æ£€æŸ¥æ—¥æœŸæ ¼å¼</li>
<li>éªŒè¯Front Matterè¯­æ³•</li>
</ul>
<h2 id="æ€§èƒ½ä¼˜åŒ–">æ€§èƒ½ä¼˜åŒ–</h2>
<h3 id="1-æ„å»ºä¼˜åŒ–">1. æ„å»ºä¼˜åŒ–</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># å‹ç¼©è¾“å‡º</span>
</span></span><span class="line"><span class="cl">hugo --minify
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¹¶è¡Œå¤„ç†</span>
</span></span><span class="line"><span class="cl">hugo --parallel
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¼“å­˜ä¼˜åŒ–</span>
</span></span><span class="line"><span class="cl">hugo --gc
</span></span></code></pre></div><h3 id="2-å›¾ç‰‡ä¼˜åŒ–">2. å›¾ç‰‡ä¼˜åŒ–</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="c"># config.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">imaging</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">resampleFilter</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;lanczos&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">quality</span><span class="p">:</span><span class="w"> </span><span class="m">85</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">anchor</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;smart&#34;</span><span class="w">
</span></span></span></code></pre></div><h3 id="3-å†…å®¹ä¼˜åŒ–">3. å†…å®¹ä¼˜åŒ–</h3>
<ul>
<li>ä½¿ç”¨WebPæ ¼å¼å›¾ç‰‡</li>
<li>å‹ç¼©CSSå’ŒJavaScript</li>
<li>å¯ç”¨Gzipå‹ç¼©</li>
<li>ä½¿ç”¨CDNåŠ é€Ÿ</li>
</ul>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>Hugoåšå®¢çš„æ—¥å¸¸ç»´æŠ¤æµç¨‹ç®€å•é«˜æ•ˆï¼š</p>
<ol>
<li><strong>åˆ›å»ºå†…å®¹</strong>ï¼š<code>hugo new posts/article.md</code></li>
<li><strong>æœ¬åœ°é¢„è§ˆ</strong>ï¼š<code>hugo server</code></li>
<li><strong>ç”Ÿæˆç½‘ç«™</strong>ï¼š<code>hugo</code></li>
<li><strong>éƒ¨ç½²å‘å¸ƒ</strong>ï¼š<code>git add . &amp;&amp; git commit &amp;&amp; git push</code></li>
</ol>
<p>é€šè¿‡è‡ªåŠ¨åŒ–è„šæœ¬å’ŒGitHub Actionsï¼Œå¯ä»¥è¿›ä¸€æ­¥ç®€åŒ–å‘å¸ƒæµç¨‹ï¼Œä¸“æ³¨äºå†…å®¹åˆ›ä½œã€‚è®°ä½å®šæœŸå¤‡ä»½æºç ï¼Œä¿æŒè‰¯å¥½çš„æ–‡ä»¶ç»„ç»‡ç»“æ„ï¼Œå°±èƒ½è½»æ¾ç»´æŠ¤ä¸€ä¸ªé«˜è´¨é‡çš„ä¸ªäººåšå®¢ç½‘ç«™ï¼ ğŸ˜Š</p>
<h2 id="å‚è€ƒèµ„æº">å‚è€ƒèµ„æº</h2>
<ul>
<li><a href="https://gohugo.io/documentation/">Hugoå®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://docs.github.com/en/pages">GitHub Pagesæ–‡æ¡£</a></li>
<li><a href="https://www.markdownguide.org/">Markdownè¯­æ³•æŒ‡å—</a></li>
<li><a href="https://themes.gohugo.io/">Hugoä¸»é¢˜åº“</a></li>
</ul>
]]></content:encoded>
    </item>
    <item>
      <title>MySQLçº¦æŸå®Œå…¨æŒ‡å—ï¼šæ•°æ®å®Œæ•´æ€§çš„å®ˆæŠ¤è€…</title>
      <link>https://tyhzxh.github.io/posts/mysql-constraints-complete-guide/</link>
      <pubDate>Thu, 19 Dec 2024 15:30:00 +0800</pubDate>
      <guid>https://tyhzxh.github.io/posts/mysql-constraints-complete-guide/</guid>
      <description>æ·±å…¥è§£æMySQLçš„å„ç§çº¦æŸç±»å‹ï¼Œä»åŸºç¡€æ¦‚å¿µåˆ°å®é™…åº”ç”¨ï¼Œå…¨é¢æŒæ¡æ•°æ®åº“çº¦æŸçš„ä½¿ç”¨æ–¹æ³•</description>
      <content:encoded><![CDATA[<h2 id="å‰è¨€">å‰è¨€</h2>
<p>åœ¨æ•°æ®åº“è®¾è®¡ä¸­ï¼Œçº¦æŸæ˜¯ä¿è¯æ•°æ®å®Œæ•´æ€§å’Œä¸€è‡´æ€§çš„é‡è¦æœºåˆ¶ã€‚MySQLæä¾›äº†å¤šç§çº¦æŸç±»å‹ï¼Œå®ƒä»¬å°±åƒæ•°æ®åº“çš„&quot;å®ˆé—¨å‘˜&quot;ï¼Œç¡®ä¿åªæœ‰ç¬¦åˆè§„åˆ™çš„æ•°æ®æ‰èƒ½è¿›å…¥æ•°æ®åº“ã€‚æœ¬æ–‡å°†å½»åº•è§£æMySQLçº¦æŸçš„æ–¹æ–¹é¢é¢ã€‚</p>
<h2 id="ä»€ä¹ˆæ˜¯mysqlçº¦æŸ">ä»€ä¹ˆæ˜¯MySQLçº¦æŸï¼Ÿ</h2>
<p>MySQLçº¦æŸï¼ˆConstraintsï¼‰æ˜¯æ•°æ®åº“ä¸­ç”¨æ¥ä¿è¯æ•°æ®å®Œæ•´æ€§å’Œä¸€è‡´æ€§çš„è§„åˆ™ã€‚å®ƒä»¬åœ¨æ•°æ®æ’å…¥ã€æ›´æ–°æ—¶è‡ªåŠ¨æ‰§è¡Œæ£€æŸ¥ï¼Œç¡®ä¿æ•°æ®ç¬¦åˆé¢„å®šä¹‰çš„ä¸šåŠ¡è§„åˆ™ã€‚</p>
<h3 id="çº¦æŸçš„æ ¸å¿ƒä½œç”¨">çº¦æŸçš„æ ¸å¿ƒä½œç”¨</h3>
<ul>
<li><strong>æ•°æ®å®Œæ•´æ€§</strong>ï¼šç¡®ä¿æ•°æ®çš„å‡†ç¡®æ€§å’Œæœ‰æ•ˆæ€§</li>
<li><strong>ä¸šåŠ¡è§„åˆ™å¼ºåˆ¶</strong>ï¼šåœ¨æ•°æ®åº“å±‚é¢å®æ–½ä¸šåŠ¡é€»è¾‘</li>
<li><strong>é”™è¯¯é¢„é˜²</strong>ï¼šé˜²æ­¢æ— æ•ˆæ•°æ®è¿›å…¥ç³»ç»Ÿ</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šæŸäº›çº¦æŸä¼šè‡ªåŠ¨åˆ›å»ºç´¢å¼•</li>
</ul>
<h2 id="mysqlçº¦æŸç±»å‹è¯¦è§£">MySQLçº¦æŸç±»å‹è¯¦è§£</h2>
<h3 id="1-ä¸»é”®çº¦æŸ-primary-key">1. ä¸»é”®çº¦æŸ (PRIMARY KEY)</h3>
<p>ä¸»é”®çº¦æŸæ˜¯æœ€é‡è¦çš„çº¦æŸä¹‹ä¸€ï¼Œç”¨äºå”¯ä¸€æ ‡è¯†è¡¨ä¸­çš„æ¯ä¸€è¡Œè®°å½•ã€‚</p>
<p><strong>ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>å€¼å¿…é¡»å”¯ä¸€</li>
<li>ä¸èƒ½ä¸ºNULL</li>
<li>ä¸€ä¸ªè¡¨åªèƒ½æœ‰ä¸€ä¸ªä¸»é”®</li>
<li>è‡ªåŠ¨åˆ›å»ºå”¯ä¸€ç´¢å¼•</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- å•åˆ—ä¸»é”®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">username</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">email</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- å¤åˆä¸»é”®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">order_items</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">order_id</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">product_id</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">quantity</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">price</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">order_id</span><span class="p">,</span><span class="w"> </span><span class="n">product_id</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><h3 id="2-å¤–é”®çº¦æŸ-foreign-key">2. å¤–é”®çº¦æŸ (FOREIGN KEY)</h3>
<p>å¤–é”®çº¦æŸç»´æŠ¤è¡¨ä¸è¡¨ä¹‹é—´çš„å¼•ç”¨å®Œæ•´æ€§ï¼Œç¡®ä¿æ•°æ®çš„å…³è”æ€§ã€‚</p>
<p><strong>ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>å¼•ç”¨å¦ä¸€ä¸ªè¡¨çš„ä¸»é”®æˆ–å”¯ä¸€é”®</li>
<li>å¯ä»¥ä¸ºNULLï¼ˆé™¤éåŒæ—¶æœ‰NOT NULLçº¦æŸï¼‰</li>
<li>æ”¯æŒçº§è”æ“ä½œ</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- åˆ›å»ºéƒ¨é—¨è¡¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">departments</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">dept_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">dept_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- åˆ›å»ºå‘˜å·¥è¡¨withå¤–é”®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">employees</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">emp_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">emp_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">dept_id</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">salary</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dept_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">departments</span><span class="p">(</span><span class="n">dept_id</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="k">NULL</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">CASCADE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><p><strong>çº§è”æ“ä½œç±»å‹ï¼š</strong></p>
<ul>
<li><code>CASCADE</code>ï¼šçº§è”åˆ é™¤/æ›´æ–°</li>
<li><code>SET NULL</code>ï¼šè®¾ç½®ä¸ºNULL</li>
<li><code>RESTRICT</code>ï¼šæ‹’ç»æ“ä½œ</li>
<li><code>NO ACTION</code>ï¼šä¸æ‰§è¡Œä»»ä½•æ“ä½œ</li>
</ul>
<h3 id="3-å”¯ä¸€çº¦æŸ-unique">3. å”¯ä¸€çº¦æŸ (UNIQUE)</h3>
<p>å”¯ä¸€çº¦æŸç¡®ä¿åˆ—ä¸­çš„å€¼å”¯ä¸€ï¼Œä½†å…è®¸NULLå€¼ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">username</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w"> </span><span class="k">UNIQUE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">email</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="k">UNIQUE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">phone</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">UNIQUE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- å¤åˆå”¯ä¸€çº¦æŸ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">products</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">category_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">sku</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">UNIQUE</span><span class="w"> </span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">category_id</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">UNIQUE</span><span class="w"> </span><span class="p">(</span><span class="n">sku</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><h3 id="4-éç©ºçº¦æŸ-not-null">4. éç©ºçº¦æŸ (NOT NULL)</h3>
<p>æœ€ç®€å•ä½†æœ€é‡è¦çš„çº¦æŸï¼Œç¡®ä¿åˆ—ä¸èƒ½ä¸ºç©ºå€¼ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">articles</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">title</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">content</span><span class="w"> </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">author_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">created_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">updated_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><h3 id="5-æ£€æŸ¥çº¦æŸ-check---mysql-8016">5. æ£€æŸ¥çº¦æŸ (CHECK) - MySQL 8.0.16+</h3>
<p>æ£€æŸ¥çº¦æŸç¡®ä¿åˆ—å€¼æ»¡è¶³ç‰¹å®šæ¡ä»¶ï¼Œæ”¯æŒå¤æ‚çš„é€»è¾‘è¡¨è¾¾å¼ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">employees</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">age</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">age</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">18</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">65</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">salary</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">salary</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">email</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">email</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%@%.%&#39;</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">gender</span><span class="w"> </span><span class="n">ENUM</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Other&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- è·¨åˆ—æ£€æŸ¥çº¦æŸ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">order_date</span><span class="w"> </span><span class="nb">DATE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">ship_date</span><span class="w"> </span><span class="nb">DATE</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">total_amount</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">total_amount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">ship_date</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">ship_date</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">order_date</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><h3 id="6-é»˜è®¤å€¼çº¦æŸ-default">6. é»˜è®¤å€¼çº¦æŸ (DEFAULT)</h3>
<p>ä¸ºåˆ—æä¾›é»˜è®¤å€¼ï¼Œç®€åŒ–æ•°æ®æ’å…¥æ“ä½œã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">posts</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">title</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">content</span><span class="w"> </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">status</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="s1">&#39;draft&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">view_count</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">is_published</span><span class="w"> </span><span class="nb">BOOLEAN</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">FALSE</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">created_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">updated_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><h3 id="7-è‡ªå¢çº¦æŸ-auto_increment">7. è‡ªå¢çº¦æŸ (AUTO_INCREMENT)</h3>
<p>è‡ªåŠ¨ç”Ÿæˆé€’å¢çš„æ•°å€¼ï¼Œé€šå¸¸ç”¨äºä¸»é”®ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">logs</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">user_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">action</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">ip_address</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">45</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">created_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- è®¾ç½®è‡ªå¢èµ·å§‹å€¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">logs</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1000</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h2 id="çº¦æŸç®¡ç†æ“ä½œ">çº¦æŸç®¡ç†æ“ä½œ</h2>
<h3 id="æ·»åŠ çº¦æŸ">æ·»åŠ çº¦æŸ</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- æ·»åŠ ä¸»é”®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- æ·»åŠ å¤–é”®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">posts</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ADD</span><span class="w"> </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">fk_posts_user</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">users</span><span class="p">(</span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">CASCADE</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- æ·»åŠ å”¯ä¸€çº¦æŸ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">uk_users_email</span><span class="w"> </span><span class="k">UNIQUE</span><span class="w"> </span><span class="p">(</span><span class="n">email</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- æ·»åŠ æ£€æŸ¥çº¦æŸ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">products</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ADD</span><span class="w"> </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">chk_products_price</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">price</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- æ·»åŠ éç©ºçº¦æŸ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="k">MODIFY</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h3 id="åˆ é™¤çº¦æŸ">åˆ é™¤çº¦æŸ</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- åˆ é™¤ä¸»é”®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="k">DROP</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- åˆ é™¤å¤–é”®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">posts</span><span class="w"> </span><span class="k">DROP</span><span class="w"> </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="n">fk_posts_user</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- åˆ é™¤å”¯ä¸€çº¦æŸ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="k">DROP</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">uk_users_email</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- åˆ é™¤æ£€æŸ¥çº¦æŸ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">products</span><span class="w"> </span><span class="k">DROP</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="n">chk_products_price</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h3 id="æŸ¥çœ‹çº¦æŸä¿¡æ¯">æŸ¥çœ‹çº¦æŸä¿¡æ¯</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- æŸ¥çœ‹è¡¨ç»“æ„
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">DESCRIBE</span><span class="w"> </span><span class="k">table_name</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SHOW</span><span class="w"> </span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">table_name</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- æŸ¥çœ‹çº¦æŸä¿¡æ¯
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">CONSTRAINT_NAME</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">CONSTRAINT_TYPE</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">TABLE_NAME</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">COLUMN_NAME</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">INFORMATION_SCHEMA</span><span class="p">.</span><span class="n">TABLE_CONSTRAINTS</span><span class="w"> </span><span class="n">tc</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">JOIN</span><span class="w"> </span><span class="n">INFORMATION_SCHEMA</span><span class="p">.</span><span class="n">KEY_COLUMN_USAGE</span><span class="w"> </span><span class="n">kcu</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">ON</span><span class="w"> </span><span class="n">tc</span><span class="p">.</span><span class="k">CONSTRAINT_NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kcu</span><span class="p">.</span><span class="k">CONSTRAINT_NAME</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">tc</span><span class="p">.</span><span class="n">TABLE_SCHEMA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;your_database_name&#39;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- æŸ¥çœ‹å¤–é”®ä¿¡æ¯
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">CONSTRAINT_NAME</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">TABLE_NAME</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">COLUMN_NAME</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">REFERENCED_TABLE_NAME</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">REFERENCED_COLUMN_NAME</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">INFORMATION_SCHEMA</span><span class="p">.</span><span class="n">KEY_COLUMN_USAGE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">REFERENCED_TABLE_NAME</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">AND</span><span class="w"> </span><span class="n">TABLE_SCHEMA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;your_database_name&#39;</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h2 id="å®é™…åº”ç”¨æ¡ˆä¾‹">å®é™…åº”ç”¨æ¡ˆä¾‹</h2>
<p>è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå®Œæ•´çš„åšå®¢ç³»ç»Ÿæ¥æ¼”ç¤ºçº¦æŸçš„å®é™…åº”ç”¨ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- ç”¨æˆ·è¡¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">username</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w"> </span><span class="k">UNIQUE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">email</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="k">UNIQUE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">password_hash</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">avatar</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">bio</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">status</span><span class="w"> </span><span class="n">ENUM</span><span class="p">(</span><span class="s1">&#39;active&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;inactive&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;banned&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="s1">&#39;active&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">created_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">updated_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="k">CHAR_LENGTH</span><span class="p">(</span><span class="n">username</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">email</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%@%.%&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- åˆ†ç±»è¡¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">categories</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w"> </span><span class="k">UNIQUE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">slug</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w"> </span><span class="k">UNIQUE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">description</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">parent_id</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">sort_order</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">is_active</span><span class="w"> </span><span class="nb">BOOLEAN</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">TRUE</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">created_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">parent_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">categories</span><span class="p">(</span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">sort_order</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- æ–‡ç« è¡¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">posts</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">title</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">slug</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span><span class="w"> </span><span class="k">UNIQUE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">content</span><span class="w"> </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">excerpt</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">featured_image</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">user_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">category_id</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">status</span><span class="w"> </span><span class="n">ENUM</span><span class="p">(</span><span class="s1">&#39;draft&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;published&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;archived&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="s1">&#39;draft&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">view_count</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">view_count</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">like_count</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">like_count</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">comment_count</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">comment_count</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">is_featured</span><span class="w"> </span><span class="nb">BOOLEAN</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">FALSE</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">published_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">created_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">updated_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">users</span><span class="p">(</span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">CASCADE</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">category_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">categories</span><span class="p">(</span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="k">CHAR_LENGTH</span><span class="p">(</span><span class="n">title</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">5</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">published_at</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">published_at</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">created_at</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- è¯„è®ºè¡¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">comments</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">post_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">user_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">parent_id</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">content</span><span class="w"> </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">status</span><span class="w"> </span><span class="n">ENUM</span><span class="p">(</span><span class="s1">&#39;pending&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;approved&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;rejected&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="s1">&#39;pending&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">ip_address</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">45</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">user_agent</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">created_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">updated_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">post_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">posts</span><span class="p">(</span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">CASCADE</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">users</span><span class="p">(</span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">CASCADE</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">parent_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">comments</span><span class="p">(</span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">CASCADE</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="k">CHAR_LENGTH</span><span class="p">(</span><span class="n">content</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- æ ‡ç­¾è¡¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">tags</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w"> </span><span class="k">UNIQUE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">slug</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w"> </span><span class="k">UNIQUE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">description</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">color</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="s1">&#39;#007bff&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">created_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="n">REGEXP</span><span class="w"> </span><span class="s1">&#39;^#[0-9A-Fa-f]{6}$&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- æ–‡ç« æ ‡ç­¾å…³è”è¡¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">post_tags</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">post_id</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">tag_id</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">created_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">post_id</span><span class="p">,</span><span class="w"> </span><span class="n">tag_id</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">post_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">posts</span><span class="p">(</span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">CASCADE</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">tag_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">tags</span><span class="p">(</span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">CASCADE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><h2 id="çº¦æŸçš„æœ€ä½³å®è·µ">çº¦æŸçš„æœ€ä½³å®è·µ</h2>
<h3 id="1-è®¾è®¡åŸåˆ™">1. è®¾è®¡åŸåˆ™</h3>
<ul>
<li><strong>æœ€å°æƒé™åŸåˆ™</strong>ï¼šåªå…è®¸å¿…è¦çš„æ•°æ®æ“ä½œ</li>
<li><strong>æ•°æ®å®Œæ•´æ€§ä¼˜å…ˆ</strong>ï¼šåœ¨åº”ç”¨å±‚å’Œæ•°æ®åº“å±‚éƒ½è¦ä¿è¯æ•°æ®å®Œæ•´æ€§</li>
<li><strong>æ€§èƒ½è€ƒè™‘</strong>ï¼šåˆç†ä½¿ç”¨çº¦æŸï¼Œé¿å…è¿‡åº¦çº¦æŸå½±å“æ€§èƒ½</li>
</ul>
<h3 id="2-å‘½åè§„èŒƒ">2. å‘½åè§„èŒƒ</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- æ¨èçš„çº¦æŸå‘½åè§„èŒƒ
</span></span></span><span class="line"><span class="cl"><span class="c1">-- ä¸»é”®ï¼špk_tablename
</span></span></span><span class="line"><span class="cl"><span class="c1">-- å¤–é”®ï¼šfk_tablename_referencedtable
</span></span></span><span class="line"><span class="cl"><span class="c1">-- å”¯ä¸€çº¦æŸï¼šuk_tablename_columnname
</span></span></span><span class="line"><span class="cl"><span class="c1">-- æ£€æŸ¥çº¦æŸï¼šchk_tablename_columnname
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">posts</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ADD</span><span class="w"> </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">fk_posts_users</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">users</span><span class="p">(</span><span class="n">id</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">users</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ADD</span><span class="w"> </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">uk_users_email</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">UNIQUE</span><span class="w"> </span><span class="p">(</span><span class="n">email</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">products</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ADD</span><span class="w"> </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">chk_products_price</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">price</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><h3 id="3-é”™è¯¯å¤„ç†">3. é”™è¯¯å¤„ç†</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- ä½¿ç”¨äº‹åŠ¡å¤„ç†çº¦æŸè¿å
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">START</span><span class="w"> </span><span class="k">TRANSACTION</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="p">(</span><span class="n">username</span><span class="p">,</span><span class="w"> </span><span class="n">email</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;newuser&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;user@example.com&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- å¦‚æœè¿åçº¦æŸï¼Œäº‹åŠ¡ä¼šå›æ»š
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">COMMIT</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h2 id="æ€§èƒ½å½±å“ä¸ä¼˜åŒ–">æ€§èƒ½å½±å“ä¸ä¼˜åŒ–</h2>
<h3 id="çº¦æŸå¯¹æ€§èƒ½çš„å½±å“">çº¦æŸå¯¹æ€§èƒ½çš„å½±å“</h3>
<ol>
<li>
<p><strong>æ­£é¢å½±å“</strong>ï¼š</p>
<ul>
<li>ä¸»é”®å’Œå”¯ä¸€çº¦æŸè‡ªåŠ¨åˆ›å»ºç´¢å¼•ï¼Œæé«˜æŸ¥è¯¢æ€§èƒ½</li>
<li>å¤–é”®çº¦æŸæœ‰åŠ©äºæŸ¥è¯¢ä¼˜åŒ–å™¨é€‰æ‹©æ›´å¥½çš„æ‰§è¡Œè®¡åˆ’</li>
</ul>
</li>
<li>
<p><strong>è´Ÿé¢å½±å“</strong>ï¼š</p>
<ul>
<li>æ’å…¥å’Œæ›´æ–°æ—¶éœ€è¦æ£€æŸ¥çº¦æŸï¼Œå¢åŠ å¼€é”€</li>
<li>å¤–é”®çº¦æŸå¯èƒ½å¯¼è‡´é”ç­‰å¾…</li>
</ul>
</li>
</ol>
<h3 id="ä¼˜åŒ–å»ºè®®">ä¼˜åŒ–å»ºè®®</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- 1. åˆç†ä½¿ç”¨ç´¢å¼•
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_posts_user_status</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">posts</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_posts_category_published</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">posts</span><span class="p">(</span><span class="n">category_id</span><span class="p">,</span><span class="w"> </span><span class="n">published_at</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 2. æ‰¹é‡æ“ä½œæ—¶ä¸´æ—¶ç¦ç”¨çº¦æŸæ£€æŸ¥ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SET</span><span class="w"> </span><span class="n">FOREIGN_KEY_CHECKS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- æ‰§è¡Œæ‰¹é‡æ“ä½œ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SET</span><span class="w"> </span><span class="n">FOREIGN_KEY_CHECKS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 3. ä½¿ç”¨åˆé€‚çš„æ•°æ®ç±»å‹
</span></span></span><span class="line"><span class="cl"><span class="c1">-- é¿å…è¿‡å¤§çš„VARCHARï¼Œä½¿ç”¨ENUMä»£æ›¿å­—ç¬¦ä¸²çŠ¶æ€
</span></span></span></code></pre></div><h2 id="å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ">å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</h2>
<h3 id="1-å¤–é”®çº¦æŸé”™è¯¯">1. å¤–é”®çº¦æŸé”™è¯¯</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- é”™è¯¯ï¼šCannot add foreign key constraint
</span></span></span><span class="line"><span class="cl"><span class="c1">-- åŸå› ï¼šå¼•ç”¨çš„åˆ—ä¸å­˜åœ¨æˆ–ç±»å‹ä¸åŒ¹é…
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- è§£å†³æ–¹æ¡ˆï¼šç¡®ä¿å¼•ç”¨çš„è¡¨å’Œåˆ—å­˜åœ¨ï¼Œæ•°æ®ç±»å‹åŒ¹é…
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SHOW</span><span class="w"> </span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">referenced_table</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h3 id="2-å”¯ä¸€çº¦æŸå†²çª">2. å”¯ä¸€çº¦æŸå†²çª</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- é”™è¯¯ï¼šDuplicate entry for key &#39;unique_constraint&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1">-- è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨INSERT IGNOREæˆ–ON DUPLICATE KEY UPDATE
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">INSERT</span><span class="w"> </span><span class="k">IGNORE</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="p">(</span><span class="n">username</span><span class="p">,</span><span class="w"> </span><span class="n">email</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;existing_user&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;new@email.com&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="p">(</span><span class="n">username</span><span class="p">,</span><span class="w"> </span><span class="n">email</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;user&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;email@example.com&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ON</span><span class="w"> </span><span class="n">DUPLICATE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">VALUES</span><span class="p">(</span><span class="n">email</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">updated_at</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h3 id="3-æ£€æŸ¥çº¦æŸå¤±è´¥">3. æ£€æŸ¥çº¦æŸå¤±è´¥</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- é”™è¯¯ï¼šCheck constraint violation
</span></span></span><span class="line"><span class="cl"><span class="c1">-- è§£å†³æ–¹æ¡ˆï¼šç¡®ä¿æ•°æ®ç¬¦åˆçº¦æŸæ¡ä»¶
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- æŸ¥çœ‹çº¦æŸå®šä¹‰
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">CONSTRAINT_NAME</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">CHECK_CLAUSE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">INFORMATION_SCHEMA</span><span class="p">.</span><span class="n">CHECK_CONSTRAINTS</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="k">CONSTRAINT_SCHEMA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;your_database&#39;</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>MySQLçº¦æŸæ˜¯æ•°æ®åº“è®¾è®¡çš„åŸºçŸ³ï¼Œå®ƒä»¬ç¡®ä¿æ•°æ®çš„å®Œæ•´æ€§ã€ä¸€è‡´æ€§å’Œå¯é æ€§ã€‚æ­£ç¡®ä½¿ç”¨çº¦æŸå¯ä»¥ï¼š</p>
<ol>
<li><strong>æé«˜æ•°æ®è´¨é‡</strong>ï¼šé˜²æ­¢æ— æ•ˆæ•°æ®è¿›å…¥ç³»ç»Ÿ</li>
<li><strong>ç®€åŒ–åº”ç”¨é€»è¾‘</strong>ï¼šå°†ä¸šåŠ¡è§„åˆ™ä¸‹æ²‰åˆ°æ•°æ®åº“å±‚</li>
<li><strong>æå‡ç³»ç»Ÿæ€§èƒ½</strong>ï¼šé€šè¿‡ç´¢å¼•ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½</li>
<li><strong>å¢å¼ºç³»ç»Ÿç¨³å®šæ€§</strong>ï¼šå‡å°‘å› æ•°æ®é—®é¢˜å¯¼è‡´çš„ç³»ç»Ÿé”™è¯¯</li>
</ol>
<p>åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œåº”è¯¥æ ¹æ®ä¸šåŠ¡éœ€æ±‚åˆç†è®¾è®¡çº¦æŸï¼Œæ—¢è¦ä¿è¯æ•°æ®å®Œæ•´æ€§ï¼Œåˆè¦è€ƒè™‘æ€§èƒ½å½±å“ã€‚è®°ä½ï¼Œçº¦æŸä¸ä»…ä»…æ˜¯æŠ€æœ¯å®ç°ï¼Œæ›´æ˜¯ä¸šåŠ¡è§„åˆ™çš„ä½“ç°ã€‚</p>
<p>æŒæ¡MySQLçº¦æŸï¼Œå°±æ˜¯æŒæ¡äº†æ„å»ºå¯é æ•°æ®åº“ç³»ç»Ÿçš„æ ¸å¿ƒæŠ€èƒ½ã€‚åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨MySQLçš„ç´¢å¼•ä¼˜åŒ–ç­–ç•¥ï¼Œæ•¬è¯·æœŸå¾…ï¼</p>
<hr>
<p><em>å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç‚¹èµæ”¶è—ï¼Œå¹¶å…³æ³¨æˆ‘è·å–æ›´å¤šæ•°æ®åº“æŠ€æœ¯åˆ†äº«ï¼</em></p>
]]></content:encoded>
    </item>
    <item>
      <title>åŒæŒ‡é’ˆç®—æ³•è¯¦è§£</title>
      <link>https://tyhzxh.github.io/posts/two-pointers-algorithm/</link>
      <pubDate>Thu, 24 Oct 2024 19:52:26 +0800</pubDate>
      <guid>https://tyhzxh.github.io/posts/two-pointers-algorithm/</guid>
      <description>æ·±å…¥è§£æåŒæŒ‡é’ˆç®—æ³•çš„åŸç†ã€åº”ç”¨åœºæ™¯å’Œå®ç°æŠ€å·§ï¼ŒåŒ…æ‹¬å¯¹æ’æŒ‡é’ˆã€å¿«æ…¢æŒ‡é’ˆã€æ»‘åŠ¨çª—å£ç­‰ç»å…¸æ¨¡å¼</description>
      <content:encoded><![CDATA[<h2 id="ä»‹ç»">ä»‹ç»</h2>
<p>åŒæŒ‡é’ˆæ˜¯ä¸€ç§å¸¸ç”¨çš„ç®—æ³•æŠ€å·§ï¼Œé€šè¿‡ä½¿ç”¨ä¸¤ä¸ªæŒ‡é’ˆæ¥éå†æ•°æ®ç»“æ„ï¼Œå¯ä»¥æœ‰æ•ˆåœ°å‡å°‘æ—¶é—´å¤æ‚åº¦ï¼Œä»O(nÂ²)é™ä½åˆ°O(n)ã€‚åŒæŒ‡é’ˆçš„ç±»å‹ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p>
<h3 id="1-å¯¹æ’æŒ‡é’ˆtwo-pointers-from-two-sides">1. å¯¹æ’æŒ‡é’ˆï¼ˆTwo Pointers from Two Sidesï¼‰</h3>
<p>ä¸¤ä¸ªæŒ‡é’ˆåˆ†åˆ«ä»æ•°ç»„æˆ–é“¾è¡¨çš„ä¸¤ç«¯å¼€å§‹ï¼Œå‘ä¸­é—´ç§»åŠ¨ï¼Œç›´åˆ°ç›¸é‡æˆ–è€…æ»¡è¶³æŸä¸ªæ¡ä»¶ã€‚è¿™ç§æ–¹æ³•é€‚ç”¨äºæœ‰åºæ•°ç»„æˆ–é“¾è¡¨ï¼Œå¯ä»¥ç”¨äºæŸ¥æ‰¾å’Œé—®é¢˜ã€ä¹˜ç§¯å’Œé—®é¢˜ç­‰ã€‚</p>
<h3 id="2-å¿«æ…¢æŒ‡é’ˆfast-and-slow-pointers">2. å¿«æ…¢æŒ‡é’ˆï¼ˆFast and Slow Pointersï¼‰</h3>
<p>ä¸¤ä¸ªæŒ‡é’ˆä»åŒä¸€ä½ç½®å¼€å§‹ï¼Œä¸€ä¸ªæŒ‡é’ˆï¼ˆå¿«æŒ‡é’ˆï¼‰ç§»åŠ¨çš„é€Ÿåº¦æ˜¯å¦ä¸€ä¸ªæŒ‡é’ˆï¼ˆæ…¢æŒ‡é’ˆï¼‰çš„ä¸¤å€ã€‚è¿™ç§æ–¹æ³•å¸¸ç”¨äºé“¾è¡¨é—®é¢˜ï¼Œæ¯”å¦‚åˆ¤æ–­é“¾è¡¨æ˜¯å¦æœ‰ç¯ï¼Œæˆ–è€…æ‰¾åˆ°é“¾è¡¨çš„ä¸­é—´èŠ‚ç‚¹ã€‚</p>
<h3 id="3-å·¦å³æŒ‡é’ˆleft-and-right-pointers">3. å·¦å³æŒ‡é’ˆï¼ˆLeft and Right Pointersï¼‰</h3>
<p>ä¸¤ä¸ªæŒ‡é’ˆåˆ†åˆ«ä»æ•°ç»„çš„ä¸¤ç«¯å¼€å§‹ï¼Œå‘ä¸­é—´ç§»åŠ¨ã€‚è¿™ç§æ–¹æ³•é€‚ç”¨äºæœ‰åºæ•°ç»„ï¼Œå¯ä»¥ç”¨äºæŸ¥æ‰¾ç‰¹å®šå…ƒç´ æˆ–è€…è§£å†³ä¸‰æ•°ä¹‹å’Œé—®é¢˜ã€‚</p>
<h3 id="4-æ— åºæŒ‡é’ˆ">4. æ— åºæŒ‡é’ˆ</h3>
<p>å¦‚æœä¸¤ä¸ªæŒ‡é’ˆæ²¡æœ‰ä»»ä½•è¯­ä¹‰å’Œé€»è¾‘é¡ºåºï¼Œåªæ˜¯ç”¨äºæŒ‡å‘ä¸åŒçš„åœ°å€ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ç®€å•å‘½åã€‚ä¾‹å¦‚ï¼Œåœ¨åˆå¹¶ä¸¤ä¸ªæœ‰åºé“¾è¡¨çš„é—®é¢˜ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ä¸¤ä¸ªæ— åºæŒ‡é’ˆåˆ†åˆ«æŒ‡å‘é“¾è¡¨1å’Œé“¾è¡¨2ã€‚</p>
<h2 id="åº”ç”¨åœºæ™¯">åº”ç”¨åœºæ™¯</h2>
<p>åŒæŒ‡é’ˆç®—æ³•çš„å…³é”®åœ¨äºå¦‚ä½•ç§»åŠ¨è¿™ä¸¤ä¸ªæŒ‡é’ˆã€‚åŒæŒ‡é’ˆæŠ€å·§é€šå¸¸ç”¨äºè§£å†³æ¶‰åŠæ•°ç»„æˆ–é“¾è¡¨çš„é—®é¢˜ï¼Œå®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬ä»¥çº¿æ€§æ—¶é—´å¤æ‚åº¦è§£å†³é—®é¢˜ï¼Œè€Œä¸æ˜¯ä½¿ç”¨åµŒå¥—å¾ªç¯å¯¼è‡´çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(nÂ²)ã€‚</p>
<h3 id="å¸¸è§ä½¿ç”¨åœºæ™¯">å¸¸è§ä½¿ç”¨åœºæ™¯ï¼š</h3>
<ol>
<li>
<p><strong>æ»‘åŠ¨çª—å£é—®é¢˜</strong>ï¼šå½“éœ€è¦æ‰¾åˆ°ä¸€ä¸ªå­æ•°ç»„æˆ–å­ä¸²ï¼Œä½¿å¾—å®ƒæ»¡è¶³ç‰¹å®šæ¡ä»¶ï¼ˆå¦‚æœ€å¤§å’Œã€æœ€å°å’Œã€åŒ…å«ç‰¹å®šå…ƒç´ ç­‰ï¼‰æ—¶ï¼Œå¯ä»¥ä½¿ç”¨åŒæŒ‡é’ˆæ¥ç»´æŠ¤ä¸€ä¸ªæ»‘åŠ¨çª—å£ã€‚</p>
</li>
<li>
<p><strong>æœ‰åºæ•°ç»„ä¸­çš„æŸ¥æ‰¾é—®é¢˜</strong>ï¼šå¦‚æœæœ‰ä¸¤ä¸ªæœ‰åºæ•°ç»„ï¼Œéœ€è¦æ‰¾åˆ°ä¸¤ä¸ªæ•°ç»„çš„ç¬¬kå°çš„æ•°ï¼Œæˆ–è€…åˆ¤æ–­ä¸€ä¸ªæ•°ç»„æ˜¯å¦æ˜¯å¦ä¸€ä¸ªæ•°ç»„çš„å­é›†ï¼Œå¯ä»¥ä½¿ç”¨åŒæŒ‡é’ˆã€‚</p>
</li>
<li>
<p><strong>é“¾è¡¨é—®é¢˜</strong>ï¼šåœ¨é“¾è¡¨ä¸­æ‰¾åˆ°ä¸­é—´èŠ‚ç‚¹ã€åˆ é™¤é“¾è¡¨ä¸­çš„èŠ‚ç‚¹ã€åˆå¹¶ä¸¤ä¸ªæœ‰åºé“¾è¡¨ç­‰é—®é¢˜ï¼Œé€šå¸¸ä½¿ç”¨å¿«æ…¢æŒ‡é’ˆã€‚</p>
</li>
<li>
<p><strong>æ•°ç»„ä¸­çš„æˆå¯¹é—®é¢˜</strong>ï¼šéœ€è¦åœ¨æ•°ç»„ä¸­æ‰¾åˆ°ä¸¤ä¸ªæ•°ï¼Œå®ƒä»¬çš„å’Œä¸ºç‰¹å®šå€¼ï¼ˆå¦‚&quot;ä¸¤æ•°ä¹‹å’Œ&quot;é—®é¢˜ï¼‰ï¼Œæˆ–è€…éœ€è¦æ‰¾åˆ°ä¸¤ä¸ªæ•°ï¼Œå®ƒä»¬çš„ä¹˜ç§¯ä¸ºç‰¹å®šå€¼ã€‚</p>
</li>
<li>
<p><strong>å¾ªç¯æ•°ç»„é—®é¢˜</strong>ï¼šå½“æ•°ç»„æ˜¯å¾ªç¯çš„ï¼Œéœ€è¦æ‰¾åˆ°é‡å¤çš„å…ƒç´ æˆ–è€…æ»¡è¶³ç‰¹å®šæ¡ä»¶çš„å…ƒç´ å¯¹æ—¶ï¼Œå¯ä»¥ä½¿ç”¨åŒæŒ‡é’ˆã€‚</p>
</li>
<li>
<p><strong>æ•°ç»„ä¸­çš„è¿ç»­å­æ•°ç»„é—®é¢˜</strong>ï¼šéœ€è¦æ‰¾åˆ°è¿ç»­çš„å­æ•°ç»„ï¼Œä½¿å¾—å®ƒä»¬çš„å’Œæ»¡è¶³ç‰¹å®šæ¡ä»¶ï¼Œæˆ–è€…æ‰¾åˆ°æœ€é•¿çš„è¿ç»­å­æ•°ç»„ï¼Œä½¿å¾—å®ƒä»¬æ»¡è¶³ç‰¹å®šæ¡ä»¶ã€‚</p>
</li>
</ol>
<h2 id="ç®—æ³•ä¼˜åŠ¿">ç®—æ³•ä¼˜åŠ¿</h2>
<p>åŒæŒ‡é’ˆæŠ€å·§åœ¨è§£å†³ç‰¹å®šé—®é¢˜æ—¶å…·æœ‰æ˜¾è‘—çš„ä¼˜åŠ¿ï¼š</p>
<h3 id="1-æ—¶é—´å¤æ‚åº¦ä¼˜åŒ–">1. æ—¶é—´å¤æ‚åº¦ä¼˜åŒ–</h3>
<p>åŒæŒ‡é’ˆå¯ä»¥å‡å°‘ä¸å¿…è¦çš„é‡å¤è®¡ç®—ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†æœ‰åºæ•°ç»„æˆ–é“¾è¡¨æ—¶ï¼Œå¯ä»¥é¿å…ä½¿ç”¨åµŒå¥—å¾ªç¯å¯¼è‡´çš„äºŒæ¬¡æ–¹æ—¶é—´å¤æ‚åº¦ï¼Œé€šå¸¸å¯ä»¥å°†æ—¶é—´å¤æ‚åº¦é™ä½åˆ°çº¿æ€§æ—¶é—´å¤æ‚åº¦O(n)ã€‚</p>
<h3 id="2-ç©ºé—´å¤æ‚åº¦ä¼˜åŒ–">2. ç©ºé—´å¤æ‚åº¦ä¼˜åŒ–</h3>
<p>åŒæŒ‡é’ˆé€šå¸¸åªéœ€è¦å¸¸æ•°çº§åˆ«çš„é¢å¤–ç©ºé—´ï¼Œè¿™æ¯”ä½¿ç”¨é¢å¤–çš„æ•°æ®ç»“æ„ï¼ˆå¦‚å“ˆå¸Œè¡¨ï¼‰è¦èŠ‚çœç©ºé—´ã€‚</p>
<h3 id="3-ç®€åŒ–é—®é¢˜">3. ç®€åŒ–é—®é¢˜</h3>
<p>åŒæŒ‡é’ˆå¯ä»¥å°†å¤æ‚é—®é¢˜ç®€åŒ–ä¸ºæ›´ç®€å•çš„å½¢å¼ã€‚ä¾‹å¦‚ï¼Œåœ¨æ»‘åŠ¨çª—å£é—®é¢˜ä¸­ï¼ŒåŒæŒ‡é’ˆå¯ä»¥åŠ¨æ€åœ°ç»´æŠ¤ä¸€ä¸ªçª—å£ï¼Œè€Œä¸éœ€è¦æ¯æ¬¡éƒ½é‡æ–°è®¡ç®—çª—å£å†…çš„å…ƒç´ ã€‚</p>
<h3 id="4-çµæ´»æ€§å’Œé€‚åº”æ€§">4. çµæ´»æ€§å’Œé€‚åº”æ€§</h3>
<p>åŒæŒ‡é’ˆæŠ€å·§éå¸¸çµæ´»ï¼Œå¯ä»¥æ ¹æ®é—®é¢˜çš„ä¸åŒéœ€æ±‚è°ƒæ•´æŒ‡é’ˆçš„ç§»åŠ¨ç­–ç•¥ï¼Œå¦‚å¯ä»¥åŒæ—¶å‘ä¸­é—´ç§»åŠ¨ï¼Œä¹Ÿå¯ä»¥ä¸€ä¸ªå‘å‰ç§»åŠ¨è€Œå¦ä¸€ä¸ªå‘åç§»åŠ¨ã€‚</p>
<h2 id="æ»‘åŠ¨çª—å£">æ»‘åŠ¨çª—å£</h2>
<p>æ»‘åŠ¨çª—å£ï¼ˆSliding Windowï¼‰æ˜¯ä¸€ç§åœ¨æ•°ç»„æˆ–å­—ç¬¦ä¸²ä¸Šè¿›è¡Œæ“ä½œçš„ç®—æ³•ç­–ç•¥ï¼Œä¸»è¦ç”¨äºè§£å†³éœ€è¦åœ¨è¿ç»­å­æ•°ç»„æˆ–å­å­—ç¬¦ä¸²ä¸Šæ»¡è¶³ç‰¹å®šæ¡ä»¶çš„é—®é¢˜ã€‚</p>
<h3 id="ä¸ºä»€ä¹ˆå«æ»‘åŠ¨çª—å£">ä¸ºä»€ä¹ˆå«æ»‘åŠ¨çª—å£ï¼Ÿ</h3>
<p>&ldquo;æ»‘åŠ¨çª—å£&quot;è¿™ä¸ªåå­—çš„ç”±æ¥æ˜¯å› ä¸ºè¿™ç§ç®—æ³•çš„æ“ä½œæ–¹å¼ç±»ä¼¼äºä¸€ä¸ªå¯ä»¥æ²¿ç€æ•°ç»„æˆ–å­—ç¬¦ä¸²æ»‘åŠ¨çš„çª—å£ã€‚çª—å£å¯ä»¥æ‰©å¤§æˆ–ç¼©å°ï¼Œä»¥åŒ…å«ä¸åŒçš„å…ƒç´ ï¼Œç›´åˆ°æ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„å­æ•°ç»„æˆ–å­å­—ç¬¦ä¸²ã€‚</p>
<h3 id="æ»‘åŠ¨çª—å£çš„ç‰¹ç‚¹">æ»‘åŠ¨çª—å£çš„ç‰¹ç‚¹ï¼š</h3>
<ol>
<li><strong>è¿ç»­æ€§</strong>ï¼šçª—å£å†…çš„å…ƒç´ æ˜¯è¿ç»­çš„ï¼Œä¸éœ€è¦æ˜¯æ•´ä¸ªæ•°ç»„æˆ–å­—ç¬¦ä¸²çš„å­é›†ã€‚</li>
<li><strong>åŠ¨æ€æ€§</strong>ï¼šçª—å£çš„å¤§å°å¯ä»¥æ ¹æ®éœ€è¦åŠ¨æ€è°ƒæ•´ï¼Œçª—å£çš„è¾¹ç•Œå¯ä»¥å‘å‰æˆ–å‘åç§»åŠ¨ã€‚</li>
<li><strong>å®æ—¶æ€§</strong>ï¼šçª—å£å¯ä»¥å®æ—¶åœ°æ£€æŸ¥å½“å‰çª—å£å†…çš„æ•°æ®æ˜¯å¦æ»¡è¶³æ¡ä»¶ã€‚</li>
</ol>
<h3 id="æ»‘åŠ¨çª—å£çš„å®ç°">æ»‘åŠ¨çª—å£çš„å®ç°ï¼š</h3>
<p>æ»‘åŠ¨çª—å£é€šå¸¸ä½¿ç”¨åŒæŒ‡é’ˆï¼ˆæˆ–ç´¢å¼•ï¼‰æ¥å®ç°ï¼Œä¸€ä¸ªæŒ‡é’ˆè¡¨ç¤ºçª—å£çš„å¼€å§‹ï¼Œå¦ä¸€ä¸ªæŒ‡é’ˆè¡¨ç¤ºçª—å£çš„ç»“æŸã€‚é€šè¿‡ç§»åŠ¨è¿™ä¸¤ä¸ªæŒ‡é’ˆï¼Œå¯ä»¥åŠ¨æ€åœ°è°ƒæ•´çª—å£çš„å¤§å°å’Œä½ç½®ã€‚</p>
<ul>
<li><strong>æ‰©å±•çª—å£</strong>ï¼šé€šå¸¸é€šè¿‡ç§»åŠ¨ç»“æŸæŒ‡é’ˆï¼ˆå³æŒ‡é’ˆï¼‰å‘å³æ¥å®ç°ï¼Œè¿™æ ·å¯ä»¥åŒ…å«æ›´å¤šçš„å…ƒç´ ã€‚</li>
<li><strong>æ”¶ç¼©çª—å£</strong>ï¼šé€šå¸¸é€šè¿‡ç§»åŠ¨å¼€å§‹æŒ‡é’ˆï¼ˆå·¦æŒ‡é’ˆï¼‰å‘å³æ¥å®ç°ï¼Œè¿™æ ·å¯ä»¥æ’é™¤çª—å£ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚</li>
</ul>
<h2 id="ç»å…¸ç®—æ³•å®ç°">ç»å…¸ç®—æ³•å®ç°</h2>
<h3 id="1-å¯¹æ’æŒ‡é’ˆç¤ºä¾‹">1. å¯¹æ’æŒ‡é’ˆç¤ºä¾‹</h3>
<p><strong>é—®é¢˜æè¿°</strong>ï¼šæ‰¾å‡ºæ•°ç»„ä¸­ä¹˜ç§¯å°äºKçš„è¿ç»­å­æ•°ç»„çš„æœ€å¤§é•¿åº¦ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">maxProductSubarray</span><span class="p">(</span><span class="n">nums</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">max_length</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">product</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">right</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">product</span> <span class="o">*=</span> <span class="n">nums</span><span class="p">[</span><span class="n">right</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="n">left</span> <span class="o">&lt;=</span> <span class="n">right</span> <span class="ow">and</span> <span class="n">product</span> <span class="o">&gt;=</span> <span class="n">k</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">product</span> <span class="o">/=</span> <span class="n">nums</span><span class="p">[</span><span class="n">left</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">left</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">        <span class="n">max_length</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_length</span><span class="p">,</span> <span class="n">right</span> <span class="o">-</span> <span class="n">left</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">right</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">max_length</span>
</span></span></code></pre></div><h3 id="2-å¿«æ…¢æŒ‡é’ˆç¤ºä¾‹">2. å¿«æ…¢æŒ‡é’ˆç¤ºä¾‹</h3>
<p><strong>é—®é¢˜æè¿°</strong>ï¼šåˆ¤æ–­é“¾è¡¨æ˜¯å¦æœ‰ç¯ï¼Œå¹¶è¿”å›ç¯çš„å…¥å£èŠ‚ç‚¹ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">ListNode</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">val</span> <span class="o">=</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">next</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">detectCycle</span><span class="p">(</span><span class="n">head</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">slow</span> <span class="o">=</span> <span class="n">fast</span> <span class="o">=</span> <span class="n">head</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># ç¬¬ä¸€é˜¶æ®µï¼šæ£€æµ‹æ˜¯å¦æœ‰ç¯</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">fast</span> <span class="ow">and</span> <span class="n">fast</span><span class="o">.</span><span class="n">next</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">slow</span> <span class="o">=</span> <span class="n">slow</span><span class="o">.</span><span class="n">next</span>
</span></span><span class="line"><span class="cl">        <span class="n">fast</span> <span class="o">=</span> <span class="n">fast</span><span class="o">.</span><span class="n">next</span><span class="o">.</span><span class="n">next</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">slow</span> <span class="o">==</span> <span class="n">fast</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># ç¬¬äºŒé˜¶æ®µï¼šæ‰¾åˆ°ç¯çš„å…¥å£</span>
</span></span><span class="line"><span class="cl">    <span class="n">slow</span> <span class="o">=</span> <span class="n">head</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">slow</span> <span class="o">!=</span> <span class="n">fast</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">slow</span> <span class="o">=</span> <span class="n">slow</span><span class="o">.</span><span class="n">next</span>
</span></span><span class="line"><span class="cl">        <span class="n">fast</span> <span class="o">=</span> <span class="n">fast</span><span class="o">.</span><span class="n">next</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">slow</span>
</span></span></code></pre></div><h3 id="3-å·¦å³æŒ‡é’ˆç¤ºä¾‹">3. å·¦å³æŒ‡é’ˆç¤ºä¾‹</h3>
<p><strong>é—®é¢˜æè¿°</strong>ï¼šæ‰¾å‡ºæ•°ç»„ä¸­ä¸‰æ•°ä¹‹å’Œä¸º0çš„ä¸‰å…ƒç»„ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">threeSum</span><span class="p">(</span><span class="n">nums</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">nums</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">        <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="n">left</span> <span class="o">&lt;</span> <span class="n">right</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">current_sum</span> <span class="o">=</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">nums</span><span class="p">[</span><span class="n">left</span><span class="p">]</span> <span class="o">+</span> <span class="n">nums</span><span class="p">[</span><span class="n">right</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">current_sum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">nums</span><span class="p">[</span><span class="n">left</span><span class="p">],</span> <span class="n">nums</span><span class="p">[</span><span class="n">right</span><span class="p">]])</span>
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                <span class="c1"># è·³è¿‡é‡å¤å…ƒç´ </span>
</span></span><span class="line"><span class="cl">                <span class="k">while</span> <span class="n">left</span> <span class="o">&lt;</span> <span class="n">right</span> <span class="ow">and</span> <span class="n">nums</span><span class="p">[</span><span class="n">left</span><span class="p">]</span> <span class="o">==</span> <span class="n">nums</span><span class="p">[</span><span class="n">left</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">left</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">                <span class="k">while</span> <span class="n">left</span> <span class="o">&lt;</span> <span class="n">right</span> <span class="ow">and</span> <span class="n">nums</span><span class="p">[</span><span class="n">right</span><span class="p">]</span> <span class="o">==</span> <span class="n">nums</span><span class="p">[</span><span class="n">right</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">right</span> <span class="o">-=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">                    
</span></span><span class="line"><span class="cl">                <span class="n">left</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">                <span class="n">right</span> <span class="o">-=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">elif</span> <span class="n">current_sum</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">left</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">right</span> <span class="o">-=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">result</span>
</span></span></code></pre></div><h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>åŒæŒ‡é’ˆæŠ€å·§æ˜¯ä¸€ç§é«˜æ•ˆä¸”å¼ºå¤§çš„ç®—æ³•å·¥å…·ï¼Œé€‚ç”¨äºè§£å†³å¤šç§ç®—æ³•é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†æ•°ç»„å’Œé“¾è¡¨æ—¶ã€‚é€šè¿‡åˆç†ä½¿ç”¨åŒæŒ‡é’ˆï¼Œå¯ä»¥è®¾è®¡å‡ºæ—¢é«˜æ•ˆåˆç®€æ´çš„ç®—æ³•è§£å†³æ–¹æ¡ˆã€‚</p>
<p>æ»‘åŠ¨çª—å£ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦é€šå¸¸æ˜¯O(n)ï¼Œå…¶ä¸­næ˜¯æ•°ç»„æˆ–å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œè¿™ä½¿å¾—å®ƒåœ¨å¤„ç†å¤§æ•°æ®é›†æ—¶éå¸¸æœ‰æ•ˆã€‚æŒæ¡åŒæŒ‡é’ˆæŠ€å·§å¯¹äºæå‡ç®—æ³•èƒ½åŠ›å’Œè§£å†³å®é™…ç¼–ç¨‹é—®é¢˜éƒ½å…·æœ‰é‡è¦æ„ä¹‰ã€‚</p>
]]></content:encoded>
    </item>
    <item>
      <title>LevelDBæºç é˜…è¯»æŒ‡å—</title>
      <link>https://tyhzxh.github.io/posts/leveldb-source-code-guide/</link>
      <pubDate>Sat, 12 Oct 2024 10:00:00 +0800</pubDate>
      <guid>https://tyhzxh.github.io/posts/leveldb-source-code-guide/</guid>
      <description>æ·±å…¥è§£æLevelDBæºç ç»“æ„å’Œæ ¸å¿ƒæ¦‚å¿µï¼Œæä¾›ç³»ç»Ÿæ€§çš„æºç é˜…è¯»æŒ‡å—ï¼Œæ¶µç›–é¡¹ç›®ç»“æ„ã€æ ¸å¿ƒæ¨¡å—ã€åŸºæœ¬ä½¿ç”¨æ–¹æ³•ç­‰å†…å®¹</description>
      <content:encoded><![CDATA[<h2 id="å‰è¨€">å‰è¨€</h2>
<p>é˜…è¯»LevelDBæºç æ˜¯ä¸€é¡¹å¾ˆå¥½çš„å­¦ä¹ æœºä¼šï¼Œå› ä¸ºå®ƒçš„ä»£ç è´¨é‡é«˜ã€è®¾è®¡ç®€æ´è€Œé«˜æ•ˆã€‚LevelDBæ˜¯Googleå¼€å‘çš„ä¸€ä¸ªé«˜æ€§èƒ½é”®å€¼å­˜å‚¨æ•°æ®åº“ï¼Œé‡‡ç”¨LSM Treeæ•°æ®ç»“æ„ï¼Œå¹¿æ³›åº”ç”¨äºå„ç§å­˜å‚¨ç³»ç»Ÿä¸­ã€‚</p>
<h2 id="åŸºæœ¬æ¦‚å¿µ">åŸºæœ¬æ¦‚å¿µ</h2>
<p>åœ¨é˜…è¯»æºç ä¹‹å‰ï¼Œç¡®ä¿ä½ ç†Ÿæ‚‰LevelDBçš„åŸºæœ¬æ¦‚å¿µå’Œæœ¯è¯­ï¼š</p>
<h3 id="æ ¸å¿ƒæ¦‚å¿µ">æ ¸å¿ƒæ¦‚å¿µ</h3>
<ul>
<li><strong>SSTableï¼ˆSorted String Tableï¼‰</strong>ï¼šä¸å¯å˜çš„ã€æ’åºçš„é”®å€¼å­˜å‚¨æ–‡ä»¶ï¼Œæ˜¯LevelDBæŒä¹…åŒ–æ•°æ®çš„åŸºæœ¬å•ä½</li>
<li><strong>LSM Treeï¼ˆLog-Structured Merge Treeï¼‰</strong>ï¼šä¸€ç§æ•°æ®ç»“æ„ï¼ŒLevelDBä½¿ç”¨å®ƒæ¥ç®¡ç†å­˜å‚¨åœ¨ç£ç›˜ä¸Šçš„æ•°æ®</li>
<li><strong>MemTableå’ŒImmutable MemTable</strong>ï¼šå†…å­˜ä¸­å­˜å‚¨çš„æ•°æ®ç»“æ„ï¼Œæ•°æ®é¦–å…ˆå†™å…¥MemTableï¼Œç„¶ååœ¨å…¶è¾¾åˆ°ä¸€å®šå¤§å°æ—¶ï¼Œè½¬æ¢æˆImmutable MemTableå¹¶æŒä¹…åŒ–åˆ°ç£ç›˜ä¸­</li>
<li><strong>WALï¼ˆWrite-Ahead Logï¼‰</strong>ï¼šæ¯ä¸ªå†™å…¥æ“ä½œéƒ½ä¼šè¢«è®°å½•åˆ°WALä¸­ï¼Œç”¨äºæ¢å¤æœªæŒä¹…åŒ–çš„æ•°æ®</li>
</ul>
<p>äº†è§£è¿™äº›åŸºç¡€çŸ¥è¯†èƒ½å¸®åŠ©ä½ åœ¨ä»£ç ä¸­æ›´å®¹æ˜“è¯†åˆ«å’Œç†è§£è¿™äº›æ¦‚å¿µã€‚</p>
<h2 id="é¡¹ç›®ç»“æ„è¯¦è§£">é¡¹ç›®ç»“æ„è¯¦è§£</h2>
<p>LevelDBçš„æºç ç»“æ„æ¸…æ™°ï¼Œæ¨¡å—åŒ–ç¨‹åº¦é«˜ï¼š</p>
<h3 id="1-db---æ ¸å¿ƒæ•°æ®åº“æ“ä½œ">1. db/ - æ ¸å¿ƒæ•°æ®åº“æ“ä½œ</h3>
<p>åŒ…å«LevelDBæ•°æ®åº“çš„æ ¸å¿ƒå®ç°ï¼Œå¤„ç†æ•°æ®çš„å­˜å‚¨ã€è¯»å–ã€æ›´æ–°ã€åˆ é™¤ç­‰ä¸»è¦åŠŸèƒ½ã€‚</p>
<p><strong>é‡è¦æ–‡ä»¶</strong>ï¼š</p>
<ul>
<li><code>db_impl.cc</code>ï¼šä¸»è¦æ•°æ®åº“æ“ä½œçš„å®ç°ï¼ˆGetã€Putã€Deleteç­‰æ¥å£ï¼‰</li>
<li><code>version_set.cc</code>ï¼šç®¡ç†SSTableæ–‡ä»¶çš„ç‰ˆæœ¬æ§åˆ¶ä»¥åŠæ–‡ä»¶åˆå¹¶ï¼ˆCompactionï¼‰æ“ä½œ</li>
<li><code>write_batch.cc</code>ï¼šå¤„ç†æ‰¹é‡å†™æ“ä½œï¼ˆWriteBatchï¼‰çš„å®ç°</li>
<li><code>log_writer.cc</code> å’Œ <code>log_reader.cc</code>ï¼šå†™å‰æ—¥å¿—ï¼ˆWALï¼‰çš„è¯»å†™åŠŸèƒ½å®ç°</li>
</ul>
<p><strong>æ ¸å¿ƒåŠŸèƒ½</strong>ï¼š</p>
<ul>
<li>æ•°æ®è¯»å†™æ¥å£çš„å®ç°</li>
<li>æ—¥å¿—æ¢å¤å’Œæ•°æ®æ¢å¤</li>
<li>æ•°æ®çš„å­˜å‚¨ç»„ç»‡å½¢å¼ç®¡ç†</li>
</ul>
<h3 id="2-table---sstableå®ç°">2. table/ - SSTableå®ç°</h3>
<p>SSTableæ˜¯LevelDBæŒä¹…åŒ–å­˜å‚¨çš„åŸºæœ¬å•ä½ï¼Œè¿™ä¸ªç›®å½•åŒ…å«äº†SSTableçš„ç”Ÿæˆã€è¯»å–ä»¥åŠä¸å…¶ä»–æ•°æ®åº“ç»“æ„çš„äº¤äº’ã€‚</p>
<p><strong>é‡è¦æ–‡ä»¶</strong>ï¼š</p>
<ul>
<li><code>block_builder.cc</code>ï¼šæ„å»ºSSTableä¸­çš„Blockï¼ˆå°çš„å­˜å‚¨å•å…ƒï¼‰</li>
<li><code>table_builder.cc</code>ï¼šæ„å»ºSSTableæ–‡ä»¶çš„é€»è¾‘</li>
<li><code>block.cc</code> å’Œ <code>block_reader.cc</code>ï¼šä»SSTableä¸­è¯»å–Blockçš„é€»è¾‘</li>
<li><code>filter_block.cc</code>ï¼šå®ç°å¸ƒéš†è¿‡æ»¤å™¨ï¼Œç”¨äºå¿«é€ŸæŸ¥æ‰¾é”®æ˜¯å¦å­˜åœ¨</li>
</ul>
<p><strong>æ ¸å¿ƒåŠŸèƒ½</strong>ï¼š</p>
<ul>
<li>SSTableæ–‡ä»¶çš„ç”Ÿæˆä¸è¯»å–</li>
<li>æ•°æ®çš„ç»„ç»‡æ–¹å¼ï¼ˆåˆ†å—å­˜å‚¨ã€å¸ƒéš†è¿‡æ»¤å™¨ã€å‹ç¼©ç­‰ï¼‰</li>
<li>ä¿è¯SSTableä¸­çš„æ•°æ®æ˜¯æœ‰åºçš„</li>
</ul>
<h3 id="3-util---é€šç”¨å·¥å…·å’Œè¾…åŠ©ç±»">3. util/ - é€šç”¨å·¥å…·å’Œè¾…åŠ©ç±»</h3>
<p>åŒ…å«LevelDBä¸­çš„é€šç”¨å·¥å…·ï¼Œè¾…åŠ©å¤„ç†å¸¸è§çš„æ“ä½œã€‚</p>
<p><strong>é‡è¦æ–‡ä»¶</strong>ï¼š</p>
<ul>
<li><code>status.cc</code>ï¼šæä¾›çŠ¶æ€ç±»Statusï¼Œç”¨äºè¡¨ç¤ºæ“ä½œæˆåŠŸæˆ–å¤±è´¥çš„ç»“æœ</li>
<li><code>coding.cc</code>ï¼šæä¾›åŸºæœ¬çš„ç¼–ç ã€è§£ç åŠŸèƒ½</li>
<li><code>env.cc</code>ï¼šæä¾›æ–‡ä»¶ç³»ç»Ÿç›¸å…³çš„æŠ½è±¡</li>
<li><code>crc32c.cc</code>ï¼šå®ç°CRC32Cæ ¡éªŒï¼Œç”¨äºæ•°æ®å®Œæ•´æ€§æ ¡éªŒ</li>
<li><code>compression.cc</code>ï¼šå¤„ç†æ•°æ®å‹ç¼©ä¸è§£å‹ç¼©</li>
</ul>
<h3 id="4-port---è·¨å¹³å°æ”¯æŒ">4. port/ - è·¨å¹³å°æ”¯æŒ</h3>
<p>ç¡®ä¿LevelDBå¯ä»¥åœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿå’Œç¡¬ä»¶æ¶æ„ä¸‹è¿è¡Œã€‚</p>
<p><strong>é‡è¦æ–‡ä»¶</strong>ï¼š</p>
<ul>
<li><code>port_posix.cc</code>ï¼šä¸ºPOSIXç³»ç»Ÿå®ç°çš„çº¿ç¨‹ã€æ–‡ä»¶ã€é”ç­‰æ“ä½œ</li>
<li><code>port_win.cc</code>ï¼šä¸ºWindowsç³»ç»Ÿæä¾›ä¸POSIXç­‰æ•ˆçš„åŠŸèƒ½</li>
<li><code>port_stdcxx.cc</code>ï¼šä¸ºC++æ ‡å‡†åº“æä¾›è·¨å¹³å°æ”¯æŒ</li>
</ul>
<h3 id="5-include---å…¬å…±å¤´æ–‡ä»¶">5. include/ - å…¬å…±å¤´æ–‡ä»¶</h3>
<p>åŒ…å«LevelDBåº“å¯¹å¤–æš´éœ²çš„æ¥å£æ–‡ä»¶ã€‚</p>
<p><strong>é‡è¦æ–‡ä»¶</strong>ï¼š</p>
<ul>
<li><code>db.h</code>ï¼šå®šä¹‰ä¸»è¦æ•°æ®åº“æ¥å£</li>
<li><code>options.h</code>ï¼šå®šä¹‰æ•°æ®åº“æ“ä½œæ—¶çš„å¯é€‰é¡¹</li>
<li><code>write_batch.h</code>ï¼šå®šä¹‰æ‰¹é‡å†™å…¥æ¥å£</li>
</ul>
<h3 id="6-doc---æ–‡æ¡£å’Œè®¾è®¡è¯´æ˜">6. doc/ - æ–‡æ¡£å’Œè®¾è®¡è¯´æ˜</h3>
<p>åŒ…å«LevelDBçš„è®¾è®¡æ–‡æ¡£å’Œç›¸å…³è¯´æ˜æ–‡æ¡£ã€‚</p>
<h2 id="æºç é˜…è¯»ç­–ç•¥">æºç é˜…è¯»ç­–ç•¥</h2>
<h3 id="æ¨èé˜…è¯»é¡ºåº">æ¨èé˜…è¯»é¡ºåº</h3>
<ol>
<li><strong>å…¬å¼€æ¥å£</strong>ï¼šä»<code>include/</code>ç›®å½•å¼€å§‹ï¼Œäº†è§£å¯¹å¤–æä¾›çš„åŠŸèƒ½</li>
<li><strong>æ ¸å¿ƒå…¥å£</strong>ï¼šé˜…è¯»DBç±»ã€WriteBatchç±»ã€Iteratorç±»</li>
<li><strong>æ ¸å¿ƒæ¨¡å—</strong>ï¼šæ·±å…¥MemTableã€SSTableã€Compactionæœºåˆ¶ã€WAL</li>
<li><strong>å·¥å…·ç±»</strong>ï¼šäº†è§£<code>util/</code>ä¸­çš„è¾…åŠ©åŠŸèƒ½</li>
</ol>
<h3 id="å­¦ä¹ æ–¹æ³•">å­¦ä¹ æ–¹æ³•</h3>
<ol>
<li><strong>ç†è§£é¡¹ç›®ç»“æ„</strong>ï¼šå…ˆä»å…¬å…±æ¥å£å¼€å§‹é˜…è¯»</li>
<li><strong>ä»ä¸»è¦å…¥å£å¼€å§‹</strong>ï¼šä»ç”¨æˆ·æœ€å¸¸è°ƒç”¨çš„æ¥å£å¼€å§‹</li>
<li><strong>é‡ç‚¹é˜…è¯»æ ¸å¿ƒæ¨¡å—</strong>ï¼šæ·±å…¥åˆ°LevelDBçš„å†…éƒ¨å®ç°</li>
<li><strong>ä½¿ç”¨è°ƒè¯•å·¥å…·</strong>ï¼šé€šè¿‡gdbç­‰å·¥å…·è¿›è¡Œå•æ­¥è°ƒè¯•</li>
<li><strong>é˜…è¯»ä»£ç æ³¨é‡Šå’Œæ–‡æ¡£</strong>ï¼šLevelDBçš„ä»£ç æ³¨é‡Šæ¯”è¾ƒä¸°å¯Œ</li>
<li><strong>ç»“åˆå®é™…é¡¹ç›®å’Œæµ‹è¯•</strong>ï¼šé€šè¿‡æµ‹è¯•ä»£ç ç†è§£ç”¨æ³•å’Œè¡Œä¸º</li>
<li><strong>æŸ¥é˜…èµ„æ–™å’Œç¤¾åŒºè®¨è®º</strong>ï¼šé‡åˆ°å›°éš¾æ—¶æŸ¥é˜…ç›¸å…³èµ„æ–™</li>
<li><strong>å¾ªåºæ¸è¿›ï¼Œé€æ­¥æ·±å…¥</strong>ï¼šå…ˆæŠŠæ¡æ•´ä½“ç»“æ„ï¼Œå†æ·±å…¥ç»†èŠ‚</li>
</ol>
<h2 id="åŸºæœ¬ä½¿ç”¨">åŸºæœ¬ä½¿ç”¨</h2>
<p>LevelDBæä¾›äº†ç®€æ´çš„é”®å€¼å­˜å‚¨æ¥å£ï¼š</p>
<h3 id="æ ¸å¿ƒæ¥å£">æ ¸å¿ƒæ¥å£</h3>
<h4 id="1-dbæ¥å£">1. DBæ¥å£</h4>
<p>DBæ˜¯LevelDBçš„æ ¸å¿ƒæ¥å£ï¼Œä»£è¡¨ä¸€ä¸ªæ•°æ®åº“å®ä¾‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="c1">// æ‰“å¼€æ•°æ®åº“
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">leveldb</span><span class="o">::</span><span class="n">DB</span><span class="o">*</span> <span class="n">db</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">leveldb</span><span class="o">::</span><span class="n">Options</span> <span class="n">options</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">options</span><span class="p">.</span><span class="n">create_if_missing</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">leveldb</span><span class="o">::</span><span class="n">Status</span> <span class="n">status</span> <span class="o">=</span> <span class="n">leveldb</span><span class="o">::</span><span class="n">DB</span><span class="o">::</span><span class="n">Open</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="s">&#34;/tmp/testdb&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">db</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// å†™å…¥æ•°æ®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">status</span> <span class="o">=</span> <span class="n">db</span><span class="o">-&gt;</span><span class="n">Put</span><span class="p">(</span><span class="n">leveldb</span><span class="o">::</span><span class="n">WriteOptions</span><span class="p">(),</span> <span class="s">&#34;key1&#34;</span><span class="p">,</span> <span class="s">&#34;value1&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// è¯»å–æ•°æ®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">value</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">status</span> <span class="o">=</span> <span class="n">db</span><span class="o">-&gt;</span><span class="n">Get</span><span class="p">(</span><span class="n">leveldb</span><span class="o">::</span><span class="n">ReadOptions</span><span class="p">(),</span> <span class="s">&#34;key1&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">value</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// åˆ é™¤æ•°æ®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">status</span> <span class="o">=</span> <span class="n">db</span><span class="o">-&gt;</span><span class="n">Delete</span><span class="p">(</span><span class="n">leveldb</span><span class="o">::</span><span class="n">WriteOptions</span><span class="p">(),</span> <span class="s">&#34;key1&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// å…³é—­æ•°æ®åº“
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">delete</span> <span class="n">db</span><span class="p">;</span>
</span></span></code></pre></div><h4 id="2-iteratoræ¥å£">2. Iteratoræ¥å£</h4>
<p>ç”¨äºéå†æ•°æ®åº“ä¸­çš„é”®å€¼å¯¹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">leveldb</span><span class="o">::</span><span class="n">Iterator</span><span class="o">*</span> <span class="n">it</span> <span class="o">=</span> <span class="n">db</span><span class="o">-&gt;</span><span class="n">NewIterator</span><span class="p">(</span><span class="n">leveldb</span><span class="o">::</span><span class="n">ReadOptions</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// éå†æ‰€æœ‰é”®å€¼å¯¹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">for</span> <span class="p">(</span><span class="n">it</span><span class="o">-&gt;</span><span class="n">SeekToFirst</span><span class="p">();</span> <span class="n">it</span><span class="o">-&gt;</span><span class="n">Valid</span><span class="p">();</span> <span class="n">it</span><span class="o">-&gt;</span><span class="n">Next</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">it</span><span class="o">-&gt;</span><span class="n">key</span><span class="p">().</span><span class="n">ToString</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;: &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">it</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">().</span><span class="n">ToString</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// æŸ¥æ‰¾ç‰¹å®šé”®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">it</span><span class="o">-&gt;</span><span class="n">Seek</span><span class="p">(</span><span class="s">&#34;key1&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="n">it</span><span class="o">-&gt;</span><span class="n">Valid</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;Found: &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">it</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">().</span><span class="n">ToString</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">delete</span> <span class="n">it</span><span class="p">;</span>
</span></span></code></pre></div><h4 id="3-writebatchæ¥å£">3. WriteBatchæ¥å£</h4>
<p>ç”¨äºæ‰¹é‡å†™å…¥æ“ä½œï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">leveldb</span><span class="o">::</span><span class="n">WriteBatch</span> <span class="n">batch</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">batch</span><span class="p">.</span><span class="n">Delete</span><span class="p">(</span><span class="s">&#34;key1&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">batch</span><span class="p">.</span><span class="n">Put</span><span class="p">(</span><span class="s">&#34;key2&#34;</span><span class="p">,</span> <span class="s">&#34;value2&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">batch</span><span class="p">.</span><span class="n">Put</span><span class="p">(</span><span class="s">&#34;key3&#34;</span><span class="p">,</span> <span class="s">&#34;value3&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">status</span> <span class="o">=</span> <span class="n">db</span><span class="o">-&gt;</span><span class="n">Write</span><span class="p">(</span><span class="n">leveldb</span><span class="o">::</span><span class="n">WriteOptions</span><span class="p">(),</span> <span class="o">&amp;</span><span class="n">batch</span><span class="p">);</span>
</span></span></code></pre></div><h3 id="é…ç½®é€‰é¡¹">é…ç½®é€‰é¡¹</h3>
<h4 id="optionsé…ç½®">Optionsé…ç½®</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">leveldb</span><span class="o">::</span><span class="n">Options</span> <span class="n">options</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">options</span><span class="p">.</span><span class="n">create_if_missing</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>  <span class="c1">// å¦‚æœæ•°æ®åº“ä¸å­˜åœ¨åˆ™åˆ›å»º
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">options</span><span class="p">.</span><span class="n">write_buffer_size</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">;</span>  <span class="c1">// å†™ç¼“å†²åŒºå¤§å°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">options</span><span class="p">.</span><span class="n">max_open_files</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">;</span>  <span class="c1">// æœ€å¤§æ‰“å¼€æ–‡ä»¶æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">options</span><span class="p">.</span><span class="n">block_size</span> <span class="o">=</span> <span class="mi">4096</span><span class="p">;</span>  <span class="c1">// å—å¤§å°
</span></span></span></code></pre></div><h4 id="readoptionsé…ç½®">ReadOptionsé…ç½®</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">leveldb</span><span class="o">::</span><span class="n">ReadOptions</span> <span class="n">read_options</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">read_options</span><span class="p">.</span><span class="n">verify_checksums</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>  <span class="c1">// éªŒè¯æ ¡éªŒå’Œ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">read_options</span><span class="p">.</span><span class="n">fill_cache</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>  <span class="c1">// å¡«å……ç¼“å­˜
</span></span></span></code></pre></div><h4 id="writeoptionsé…ç½®">WriteOptionsé…ç½®</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">leveldb</span><span class="o">::</span><span class="n">WriteOptions</span> <span class="n">write_options</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">write_options</span><span class="p">.</span><span class="n">sync</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>  <span class="c1">// åŒæ­¥å†™å…¥
</span></span></span></code></pre></div><h2 id="æ€§èƒ½ä¼˜åŒ–å»ºè®®">æ€§èƒ½ä¼˜åŒ–å»ºè®®</h2>
<h3 id="1-æ‰¹é‡æ“ä½œ">1. æ‰¹é‡æ“ä½œ</h3>
<p>ä½¿ç”¨WriteBatchè¿›è¡Œæ‰¹é‡å†™å…¥å¯ä»¥æ˜¾è‘—æé«˜æ€§èƒ½ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">leveldb</span><span class="o">::</span><span class="n">WriteBatch</span> <span class="n">batch</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">batch</span><span class="p">.</span><span class="n">Put</span><span class="p">(</span><span class="s">&#34;key&#34;</span> <span class="o">+</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="s">&#34;value&#34;</span> <span class="o">+</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">i</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">db</span><span class="o">-&gt;</span><span class="n">Write</span><span class="p">(</span><span class="n">leveldb</span><span class="o">::</span><span class="n">WriteOptions</span><span class="p">(),</span> <span class="o">&amp;</span><span class="n">batch</span><span class="p">);</span>
</span></span></code></pre></div><h3 id="2-åˆç†é…ç½®ç¼“å­˜">2. åˆç†é…ç½®ç¼“å­˜</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;leveldb/cache.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="n">leveldb</span><span class="o">::</span><span class="n">Options</span> <span class="n">options</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">options</span><span class="p">.</span><span class="n">block_cache</span> <span class="o">=</span> <span class="n">leveldb</span><span class="o">::</span><span class="n">NewLRUCache</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="mi">1048576</span><span class="p">);</span>  <span class="c1">// 100MBç¼“å­˜
</span></span></span></code></pre></div><h3 id="3-å‹ç¼©é…ç½®">3. å‹ç¼©é…ç½®</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;leveldb/filter_policy.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="n">options</span><span class="p">.</span><span class="n">filter_policy</span> <span class="o">=</span> <span class="n">leveldb</span><span class="o">::</span><span class="n">NewBloomFilterPolicy</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">options</span><span class="p">.</span><span class="n">compression</span> <span class="o">=</span> <span class="n">leveldb</span><span class="o">::</span><span class="n">kSnappyCompression</span><span class="p">;</span>
</span></span></code></pre></div><h2 id="é”™è¯¯å¤„ç†">é”™è¯¯å¤„ç†</h2>
<p>LevelDBä½¿ç”¨Statusç±»è¿›è¡Œé”™è¯¯å¤„ç†ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">leveldb</span><span class="o">::</span><span class="n">Status</span> <span class="n">status</span> <span class="o">=</span> <span class="n">db</span><span class="o">-&gt;</span><span class="n">Put</span><span class="p">(</span><span class="n">leveldb</span><span class="o">::</span><span class="n">WriteOptions</span><span class="p">(),</span> <span class="s">&#34;key&#34;</span><span class="p">,</span> <span class="s">&#34;value&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">status</span><span class="p">.</span><span class="n">ok</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;Error: &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">status</span><span class="p">.</span><span class="n">ToString</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">status</span><span class="p">.</span><span class="n">IsNotFound</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// å¤„ç†æœªæ‰¾åˆ°é”™è¯¯
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span> <span class="k">else</span> <span class="nf">if</span> <span class="p">(</span><span class="n">status</span><span class="p">.</span><span class="n">IsCorruption</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// å¤„ç†æ•°æ®æŸåé”™è¯¯
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span> <span class="k">else</span> <span class="nf">if</span> <span class="p">(</span><span class="n">status</span><span class="p">.</span><span class="n">IsIOError</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// å¤„ç†IOé”™è¯¯
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>LevelDBé€šè¿‡æ¸…æ™°çš„æ¨¡å—åŒ–è®¾è®¡ï¼Œå°†æ ¸å¿ƒåŠŸèƒ½ã€å·¥å…·ç±»ã€è·¨å¹³å°æ”¯æŒä»¥åŠå¯¹å¤–æ¥å£åˆ†ç¦»å¼€æ¥ã€‚ç†è§£å…¶æ¶æ„å’ŒåŸºæœ¬ä½¿ç”¨æ–¹æ³•ï¼Œæœ‰åŠ©äºæ·±å…¥å­¦ä¹ ç°ä»£å­˜å‚¨ç³»ç»Ÿçš„è®¾è®¡åŸç†ã€‚é€šè¿‡ç³»ç»Ÿæ€§çš„æºç é˜…è¯»ï¼Œå¯ä»¥æŒæ¡LSM Treeã€WALã€Compactionç­‰å…³é”®æŠ€æœ¯çš„å®ç°ç»†èŠ‚ã€‚</p>
<h2 id="å‚è€ƒèµ„æº">å‚è€ƒèµ„æº</h2>
<ul>
<li><a href="https://github.com/google/leveldb">LevelDBå®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://github.com/google/leveldb/blob/main/doc/index.md">LevelDBè®¾è®¡æ–‡æ¡£</a></li>
<li><a href="https://www.cs.umb.edu/~poneil/lsmtree.pdf">LSM Treeè®ºæ–‡</a></li>
</ul>
]]></content:encoded>
    </item>
    <item>
      <title>CSAPPç¬¬äºŒç« ï¼šä¿¡æ¯çš„è¡¨ç¤ºä¸å¤„ç†</title>
      <link>https://tyhzxh.github.io/posts/csapp-chapter2-data-representation/</link>
      <pubDate>Sun, 07 Apr 2024 23:31:21 +0800</pubDate>
      <guid>https://tyhzxh.github.io/posts/csapp-chapter2-data-representation/</guid>
      <description>æ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿç¬¬äºŒç« å­¦ä¹ ç¬”è®°ï¼Œæ¶µç›–æ•´æ•°è¡¨ç¤ºã€è¡¥ç ã€å¤§å°ç«¯ã€æµ®ç‚¹æ•°ç­‰æ ¸å¿ƒæ¦‚å¿µï¼ŒåŒ…å«å®é™…ä»£ç ç¤ºä¾‹</description>
      <content:encoded><![CDATA[<blockquote>
<p>è‘—åçš„å¤§é»‘ä¹¦ CSAPPã€Šæ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‹ç¬¬äºŒç« å­¦ä¹ ç¬”è®°ã€‚ä»ç¬¬äºŒç« ï¼ˆä¿¡æ¯çš„è¡¨ç¤ºä¸å¤„ç†ï¼‰å¼€å§‹ï¼Œè¿™æ˜¯è®¡ç®—æœºåº•å±‚æ•°æ®è¡¨ç¤ºçš„æ ¸å¿ƒå†…å®¹ã€‚</p></blockquote>
<h2 id="å‰è¨€">å‰è¨€</h2>
<p>ä»è¿™ä¸€ç« å¼€å§‹ï¼ŒCSAPPå°†æˆ‘ä»¬å¼•å…¥äº†è®¡ç®—æœºæœ€åº•å±‚çš„æ•°æ®è¡¨ç¤ºé¢†åŸŸâ€”â€”<strong>æ¢¦å¼€å§‹çš„åœ°æ–¹</strong>ï¼</p>
<blockquote>
<p><strong>æ ¸å¿ƒè§‚ç‚¹</strong>ï¼šè®¡ç®—æœºä¸­çš„äºŒè¿›åˆ¶åºåˆ—æœ¬èº«æ˜¯æ²¡æœ‰å®é™…æ„ä¹‰çš„ï¼Œé‡è¦çš„æ˜¯çœ‹ä½ æ€ä¹ˆå»<strong>è§£é‡Š</strong>å®ƒã€‚</p></blockquote>
<p>è¿™å¥è¯è´¯ç©¿äº†æ•´ä¸ªè®¡ç®—æœºç³»ç»Ÿçš„è®¾è®¡å“²å­¦ã€‚</p>
<h2 id="ä¸€æ•´æ•°è¡¨ç¤º">ä¸€ã€æ•´æ•°è¡¨ç¤º</h2>
<h3 id="å†…å­˜æ¨¡å‹åŸºç¡€">å†…å­˜æ¨¡å‹åŸºç¡€</h3>
<p>ç¨‹åºå‘˜ç¼–ç¨‹æ—¶é¢å¯¹çš„æ˜¯ä¸€ä¸ª<strong>å†…å­˜ç©ºé—´</strong>ï¼ˆä¸€ç§æŠ½è±¡ï¼‰ï¼Œè¿™ä¸ªå†…å­˜ç©ºé—´æœ¬è´¨ä¸Šæ˜¯ï¼š</p>
<ul>
<li>ä¸€ä¸ªå¾ˆé•¿çš„<strong>å­—èŠ‚æ•°ç»„</strong>ï¼ˆå­—èŠ‚æ˜¯å†…å­˜çš„æœ€å°å•ä½ï¼‰</li>
<li>æ¯ä¸ªå­—èŠ‚ç”±8ä¸ªäºŒè¿›åˆ¶ä½ç»„æˆ</li>
<li>æœ¬è´¨ä¸Šå°±æ˜¯ä¸€å †äºŒè¿›åˆ¶åºåˆ—</li>
</ul>
<h3 id="è¿›åˆ¶è½¬æ¢åŸºç¡€">è¿›åˆ¶è½¬æ¢åŸºç¡€</h3>
<p>æ¯ä¸ªå­—èŠ‚é‡Œçš„8ä½äºŒè¿›åˆ¶æ•°ä¹ æƒ¯ç”¨16è¿›åˆ¶è¡¨ç¤ºï¼š</p>
<pre tabindex="0"><code>äºŒè¿›åˆ¶: 11111111
åå…­è¿›åˆ¶: FF
</code></pre><p><strong>è®°å¿†æŠ€å·§</strong>ï¼š</p>
<ul>
<li>16è¿›åˆ¶çš„ä¸¤ä½åˆ†åˆ«ç”±äºŒè¿›åˆ¶çš„4ä½ç»„æˆ</li>
<li>æ¯ä¸€ä½çš„æƒé‡ï¼š8ã€4ã€2ã€1ï¼ˆæ•°å­—ç”µè·¯åŸºç¡€ï¼‰</li>
</ul>
<h3 id="æœ‰ç¬¦å·æ•°è¡¥ç è¡¨ç¤º">æœ‰ç¬¦å·æ•°ï¼ˆè¡¥ç è¡¨ç¤ºï¼‰</h3>
<p>ä»¥<code>int</code>ç±»å‹ä¸ºä¾‹ï¼š</p>
<ul>
<li><strong>å¤§å°</strong>ï¼š4ä¸ªå­—èŠ‚ï¼Œå…±32ä½</li>
<li><strong>ç¬¦å·ä½</strong>ï¼šç¬¬ä¸€ä½ï¼Œ0è¡¨ç¤ºæ­£æ•°ï¼Œ1è¡¨ç¤ºè´Ÿæ•°</li>
<li><strong>å­˜å‚¨æ–¹å¼</strong>ï¼šè¡¥ç </li>
</ul>
<h4 id="è¡¥ç çš„ç²¾å¦™è®¾è®¡">è¡¥ç çš„ç²¾å¦™è®¾è®¡</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="c1">// æ­£æ•°ï¼šç›´æ¥è¡¨ç¤º
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>    <span class="c1">// 00000000 00000000 00000000 00000101
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// è´Ÿæ•°ï¼šè¡¥ç è¡¨ç¤º
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">b</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span><span class="p">;</span>   <span class="c1">// 11111111 11111111 11111111 11111011
</span></span></span></code></pre></div><p><strong>è¡¥ç è®¡ç®—è§„åˆ™</strong>ï¼š</p>
<ol>
<li>æ­£æ•°çš„è¡¥ç å°±æ˜¯å…¶äºŒè¿›åˆ¶è¡¨ç¤º</li>
<li>è´Ÿæ•°çš„è¡¥ç  = æŒ‰ä½å–å + 1</li>
<li>æ•°çš„ç›¸åæ•° = æŒ‰ä½å–å + 1</li>
</ol>
<h4 id="è¡¥ç çš„ä¼˜åŠ¿">è¡¥ç çš„ä¼˜åŠ¿</h4>
<ol>
<li><strong>ç»Ÿä¸€è¿ç®—</strong>ï¼šåŠ æ³•å’Œå‡æ³•å¯ä»¥ç”¨åŒä¸€å¥—ç”µè·¯å®ç°</li>
<li><strong>å”¯ä¸€é›¶å€¼</strong>ï¼šåªæœ‰ä¸€ä¸ªé›¶çš„è¡¨ç¤º</li>
<li><strong>èŒƒå›´å¯¹ç§°</strong>ï¼šèƒ½è¡¨ç¤ºçš„è´Ÿæ•°æ¯”æ­£æ•°å¤šä¸€ä¸ª</li>
</ol>
<h3 id="æ— ç¬¦å·æ•°">æ— ç¬¦å·æ•°</h3>
<p>æ— ç¬¦å·æ•°æœ€ç®€å•ï¼š32ä½äºŒè¿›åˆ¶ä»£ç ç›´æ¥å¯¹åº”çœŸå€¼ï¼Œæ²¡æœ‰ç¬¦å·ä½çš„æ¦‚å¿µã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">4294967295U</span><span class="p">;</span>  <span class="c1">// 2^32 - 1
</span></span></span></code></pre></div><h2 id="äºŒå®é™…ç¼–ç¨‹ç»ƒä¹ ">äºŒã€å®é™…ç¼–ç¨‹ç»ƒä¹ </h2>
<h3 id="1-å¤§å°ç«¯æ£€æµ‹ç¨‹åº">1. å¤§å°ç«¯æ£€æµ‹ç¨‹åº</h3>
<p><strong>èƒŒæ™¯</strong>ï¼šå¤§å°ç«¯ä¹‹äº‰æ˜¯è®¡ç®—æœºå†å²ä¸Šçš„ç»å…¸é—®é¢˜</p>
<ul>
<li><strong>å°ç«¯æœºå™¨</strong>ï¼šä½ä½å­—èŠ‚å­˜å‚¨åœ¨ä½åœ°å€ï¼ˆç°åœ¨PCå¤§å¤šæ˜¯å°ç«¯ï¼‰</li>
<li><strong>å¤§ç«¯æœºå™¨</strong>ï¼šé«˜ä½å­—èŠ‚å­˜å‚¨åœ¨ä½åœ°å€</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">char</span> <span class="nf">get_first_bytes</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">a</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">islittle_endian</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nf">get_first_bytes</span><span class="p">((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">a</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;is little_endian</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;is big_endian</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">islittle_endian</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p><strong>åŸç†è§£æ</strong>ï¼š</p>
<ul>
<li>æ•´æ•°1çš„äºŒè¿›åˆ¶ï¼š<code>00000000 00000000 00000000 00000001</code></li>
<li>å°ç«¯æœºå™¨ï¼šç¬¬ä¸€ä¸ªå­—èŠ‚å­˜å‚¨<code>01</code>ï¼ˆéé›¶ï¼‰</li>
<li>å¤§ç«¯æœºå™¨ï¼šç¬¬ä¸€ä¸ªå­—èŠ‚å­˜å‚¨<code>00</code>ï¼ˆé›¶ï¼‰</li>
</ul>
<h3 id="2-å­—èŠ‚åºåˆ—æ˜¾ç¤ºç¨‹åº">2. å­—èŠ‚åºåˆ—æ˜¾ç¤ºç¨‹åº</h3>
<p>è¿™ä¸ªç¨‹åºå¯ä»¥æ˜¾ç¤ºä»»æ„æ•°æ®ç±»å‹åœ¨å†…å­˜ä¸­çš„å­—èŠ‚è¡¨ç¤ºï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">byte_pointer</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">show_bytes</span><span class="p">(</span><span class="n">byte_pointer</span> <span class="n">start</span><span class="p">,</span> <span class="kt">int</span> <span class="n">len</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%.2x &#34;</span><span class="p">,</span> <span class="n">start</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span> 
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">show_int</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">show_bytes</span><span class="p">((</span><span class="n">byte_pointer</span><span class="p">)</span><span class="o">&amp;</span><span class="n">x</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">show_float</span><span class="p">(</span><span class="kt">float</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">show_bytes</span><span class="p">((</span><span class="n">byte_pointer</span><span class="p">)</span><span class="o">&amp;</span><span class="n">x</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">float</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">show_pointer</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">show_bytes</span><span class="p">((</span><span class="n">byte_pointer</span><span class="p">)</span><span class="o">&amp;</span><span class="n">x</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">show_short</span><span class="p">(</span><span class="kt">short</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">show_bytes</span><span class="p">((</span><span class="n">byte_pointer</span><span class="p">)</span><span class="o">&amp;</span><span class="n">x</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">short</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">show_long</span><span class="p">(</span><span class="kt">long</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">show_bytes</span><span class="p">((</span><span class="n">byte_pointer</span><span class="p">)</span><span class="o">&amp;</span><span class="n">x</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">long</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">show_double</span><span class="p">(</span><span class="kt">double</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">show_bytes</span><span class="p">((</span><span class="n">byte_pointer</span><span class="p">)</span><span class="o">&amp;</span><span class="n">x</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">double</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">test_show_bytes</span><span class="p">(</span><span class="kt">short</span> <span class="n">val</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">short</span> <span class="n">sval</span> <span class="o">=</span> <span class="n">val</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">long</span> <span class="n">lval</span> <span class="o">=</span> <span class="p">(</span><span class="kt">long</span><span class="p">)</span><span class="n">val</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">double</span> <span class="n">dval</span> <span class="o">=</span> <span class="p">(</span><span class="kt">double</span><span class="p">)</span><span class="n">val</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;short %d: &#34;</span><span class="p">,</span> <span class="n">sval</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">show_short</span><span class="p">(</span><span class="n">sval</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;long %ld: &#34;</span><span class="p">,</span> <span class="n">lval</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">show_long</span><span class="p">(</span><span class="n">lval</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;double %f: &#34;</span><span class="p">,</span> <span class="n">dval</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">show_double</span><span class="p">(</span><span class="n">dval</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">test_show_bytes</span><span class="p">(</span><span class="mi">12345</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="3-ä½è¿ç®—ç»ƒä¹ ">3. ä½è¿ç®—ç»ƒä¹ </h3>
<p>ä½è¿ç®—æ˜¯åº•å±‚ç¼–ç¨‹çš„åŸºç¡€ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// è®¾ç½®æ‰€æœ‰ä½ä¸º1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">f1</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">|</span> <span class="mh">0xffffffff</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// è®¾ç½®æ‰€æœ‰ä½ä¸º0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">f2</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">&amp;</span> <span class="mh">0x00000000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// è®¾ç½®æœ€é«˜å­—èŠ‚ä¸º1ï¼Œå…¶ä»–ä¸å˜
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">f3</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">|</span> <span class="mh">0xff000000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// æ¸…é™¤æœ€ä½å­—èŠ‚ï¼Œå…¶ä»–ä¸å˜
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">f4</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">&amp;</span> <span class="mh">0xffffff00</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">show_hex</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;0x%x</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mh">0x12345678</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Original: &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">show_hex</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;f1 (set all 1): &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">show_hex</span><span class="p">(</span><span class="nf">f1</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;f2 (set all 0): &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">show_hex</span><span class="p">(</span><span class="nf">f2</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;f3 (set high byte): &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">show_hex</span><span class="p">(</span><span class="nf">f3</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;f4 (clear low byte): &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">show_hex</span><span class="p">(</span><span class="nf">f4</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h2 id="ä¸‰æ•°æ®ç±»å‹æ€»ç»“">ä¸‰ã€æ•°æ®ç±»å‹æ€»ç»“</h2>
<h3 id="æ•´æ•°ç±»å‹">æ•´æ•°ç±»å‹</h3>
<table>
  <thead>
      <tr>
          <th>ç±»å‹</th>
          <th>å¤§å°</th>
          <th>èŒƒå›´</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>char</code></td>
          <td>1å­—èŠ‚</td>
          <td>-128 ~ 127</td>
      </tr>
      <tr>
          <td><code>unsigned char</code></td>
          <td>1å­—èŠ‚</td>
          <td>0 ~ 255</td>
      </tr>
      <tr>
          <td><code>short</code></td>
          <td>2å­—èŠ‚</td>
          <td>-32,768 ~ 32,767</td>
      </tr>
      <tr>
          <td><code>unsigned short</code></td>
          <td>2å­—èŠ‚</td>
          <td>0 ~ 65,535</td>
      </tr>
      <tr>
          <td><code>int</code></td>
          <td>4å­—èŠ‚</td>
          <td>-2^31 ~ 2^31-1</td>
      </tr>
      <tr>
          <td><code>unsigned int</code></td>
          <td>4å­—èŠ‚</td>
          <td>0 ~ 2^32-1</td>
      </tr>
  </tbody>
</table>
<p><strong>å‘½åè§„åˆ™</strong>ï¼šæ— ç¬¦å·ç±»å‹ = <code>unsigned</code> + æœ‰ç¬¦å·ç±»å‹å</p>
<blockquote>
<p><strong>æ³¨æ„</strong>ï¼š<code>unsigned</code> å•ç‹¬ä½¿ç”¨ç­‰ä»·äº <code>unsigned int</code></p></blockquote>
<h2 id="å››æµ®ç‚¹æ•°ieee-754æ ‡å‡†">å››ã€æµ®ç‚¹æ•°ï¼ˆIEEE 754æ ‡å‡†ï¼‰</h2>
<p>æµ®ç‚¹æ•°çš„è¡¨ç¤ºæ›´åŠ å¤æ‚ï¼Œä½†è®¾è®¡åŒæ ·ç²¾å¦™ï¼š</p>
<h3 id="æµ®ç‚¹æ•°ç»“æ„">æµ®ç‚¹æ•°ç»“æ„</h3>
<pre tabindex="0"><code>ç¬¦å·ä½(S) | é˜¶ç (Exp) | å°¾æ•°(Frac)
   1ä½   |   8ä½     |   23ä½    (å•ç²¾åº¦float)
   1ä½   |   11ä½    |   52ä½    (åŒç²¾åº¦double)
</code></pre><h3 id="æµ®ç‚¹æ•°åˆ†ç±»">æµ®ç‚¹æ•°åˆ†ç±»</h3>
<ol>
<li><strong>è§„æ ¼åŒ–æ•°</strong>ï¼šæ­£å¸¸çš„æµ®ç‚¹æ•°</li>
<li><strong>éè§„æ ¼åŒ–æ•°</strong>ï¼šæ¥è¿‘é›¶çš„å¾ˆå°æ•°</li>
<li><strong>æ— ç©·å¤§</strong>ï¼šæº¢å‡ºè¡¨ç¤º</li>
<li><strong>NaN</strong>ï¼šéæ•°å­—ï¼ˆå¦‚0/0çš„ç»“æœï¼‰</li>
</ol>
<h3 id="æµ®ç‚¹æ•°çš„ç²¾å¦™ä¹‹å¤„">æµ®ç‚¹æ•°çš„ç²¾å¦™ä¹‹å¤„</h3>
<blockquote>
<p>æµ®ç‚¹æ•°å’Œè¡¥ç ä¸€æ ·ç²¾å¦™ï¼Œè®¾è®¡å¾—å¯ä»¥åƒæ•´æ•°ä¸€æ ·è¿›è¡Œå¤§å°æ¯”è¾ƒæ’åºï¼</p></blockquote>
<p>å½“ä½ ç†è§£äº†IEEE 754çš„è®¾è®¡å“²å­¦æ—¶ï¼Œå°±ä¸ä¼šå†è§‰å¾—æµ®ç‚¹æ•°å¤æ‚äº†ã€‚</p>
<h2 id="äº”è¿ç®—ä¸æº¢å‡º">äº”ã€è¿ç®—ä¸æº¢å‡º</h2>
<h3 id="æ•´æ•°è¿ç®—ç‰¹ç‚¹">æ•´æ•°è¿ç®—ç‰¹ç‚¹</h3>
<ol>
<li><strong>æ¨¡è¿ç®—</strong>ï¼šæ•´æ•°è¿ç®—å®é™…ä¸Šæ˜¯æ¨¡2^wè¿ç®—ï¼ˆwæ˜¯ä½æ•°ï¼‰</li>
<li><strong>æº¢å‡ºå¤„ç†</strong>ï¼šæœ‰ç¬¦å·æ•°æº¢å‡ºå¯èƒ½äº§ç”Ÿæ„å¤–ç»“æœ</li>
<li><strong>ç±»å‹è½¬æ¢</strong>ï¼šæœ‰ç¬¦å·å’Œæ— ç¬¦å·ä¹‹é—´çš„è½¬æ¢éœ€è¦ç‰¹åˆ«æ³¨æ„</li>
</ol>
<h3 id="å®é™…åº”ç”¨ä¸­çš„é™·é˜±">å®é™…åº”ç”¨ä¸­çš„é™·é˜±</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="c1">// å±é™©çš„ä»£ç 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">b</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;a &gt; b</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>  <span class="c1">// è¿™è¡Œä¸ä¼šæ‰§è¡Œï¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;a &lt;= b</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span> <span class="c1">// è¿™è¡Œä¼šæ‰§è¡Œ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span></code></pre></div><p><strong>åŸå› </strong>ï¼šæ¯”è¾ƒæ—¶<code>b</code>è¢«è½¬æ¢ä¸ºæ— ç¬¦å·æ•°ï¼Œ-1å˜æˆäº†å¾ˆå¤§çš„æ­£æ•°ã€‚</p>
<h2 id="å…­å­¦ä¹ å¿ƒå¾—">å…­ã€å­¦ä¹ å¿ƒå¾—</h2>
<h3 id="ä¸ºä»€ä¹ˆè¦å­¦ä¹ åº•å±‚è¡¨ç¤º">ä¸ºä»€ä¹ˆè¦å­¦ä¹ åº•å±‚è¡¨ç¤ºï¼Ÿ</h3>
<ol>
<li><strong>ç†è§£ç¨‹åºè¡Œä¸º</strong>ï¼šå¾ˆå¤š&quot;å¥‡æ€ª&quot;çš„ç¨‹åºè¡Œä¸ºéƒ½èƒ½ä»åº•å±‚æ‰¾åˆ°åŸå› </li>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šäº†è§£æ•°æ®è¡¨ç¤ºæœ‰åŠ©äºå†™å‡ºæ›´é«˜æ•ˆçš„ä»£ç </li>
<li><strong>è°ƒè¯•èƒ½åŠ›</strong>ï¼šèƒ½å¤Ÿåˆ†æå†…å­˜dumpï¼Œç†è§£ç¨‹åºå´©æºƒåŸå› </li>
<li><strong>ç³»ç»Ÿç¼–ç¨‹</strong>ï¼šæ“ä½œç³»ç»Ÿã€ç¼–è¯‘å™¨ç­‰ç³»ç»Ÿè½¯ä»¶å¼€å‘çš„åŸºç¡€</li>
</ol>
<h3 id="å­¦ä¹ å»ºè®®">å­¦ä¹ å»ºè®®</h3>
<ol>
<li><strong>åŠ¨æ‰‹å®è·µ</strong>ï¼šä¸€å®šè¦äº²è‡ªç¼–å†™å’Œè¿è¡Œä»£ç </li>
<li><strong>å¯è§†åŒ–ç†è§£</strong>ï¼šç”»å‡ºå†…å­˜å¸ƒå±€å›¾</li>
<li><strong>å…³è”æ€è€ƒ</strong>ï¼šå°†æŠ½è±¡æ¦‚å¿µä¸å…·ä½“å®ç°è”ç³»èµ·æ¥</li>
<li><strong>å¾ªåºæ¸è¿›</strong>ï¼šä»ç®€å•ä¾‹å­å¼€å§‹ï¼Œé€æ­¥æ·±å…¥</li>
</ol>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>CSAPPç¬¬äºŒç« çœ‹ä¼¼ç®€å•ï¼Œå®åˆ™åŒ…å«äº†è®¡ç®—æœºç³»ç»Ÿæœ€æ ¸å¿ƒçš„è®¾è®¡æ€æƒ³ï¼š</p>
<ul>
<li><strong>è¡¥ç è®¾è®¡</strong>ï¼šç»Ÿä¸€äº†æ­£è´Ÿæ•°çš„è¿ç®—</li>
<li><strong>IEEE 754</strong>ï¼šç²¾å¦™çš„æµ®ç‚¹æ•°è¡¨ç¤ºæ ‡å‡†</li>
<li><strong>ä½è¿ç®—</strong>ï¼šé«˜æ•ˆçš„åº•å±‚æ“ä½œæ–¹å¼</li>
</ul>
<blockquote>
<p>è®¡ç®—æœºçš„åº•å±‚æ—¢ç®€å•åˆå¤æ‚ï¼šç®€å•åœ¨äºå…¶å®ç°æ˜¯å¦‚æ­¤ä¼˜ç¾å’Œå·§å¦™ï¼Œå¤æ‚åœ¨äºéœ€è¦å¤„ç†å„ç§è¾¹ç•Œæƒ…å†µå’Œç‰¹æ®Šåœºæ™¯ã€‚</p></blockquote>
<p>ç†è§£è¿™äº›åŸºç¡€æ¦‚å¿µï¼Œæ˜¯æ·±å…¥å­¦ä¹ è®¡ç®—æœºç³»ç»Ÿçš„ç¬¬ä¸€æ­¥ã€‚æ¥ä¸‹æ¥çš„ç« èŠ‚ä¼šåœ¨è¿™ä¸ªåŸºç¡€ä¸Šï¼Œæ¢è®¨æ›´å¤æ‚çš„ç³»ç»Ÿæ¦‚å¿µã€‚</p>
<hr>
<p><em>ä¸‹ä¸€ç¯‡å°†æ€»ç»“CSAPPçš„Data Labå®éªŒï¼Œé‚£é‡Œæœ‰æ›´å¤šæœ‰è¶£çš„ä½è¿ç®—æŒ‘æˆ˜ï¼</em></p>
]]></content:encoded>
    </item>
    <item>
      <title>è®¡ç®—æœºç½‘ç»œæ¦‚è¿°ï¼šä»OSIæ¨¡å‹åˆ°TCP/IPåè®®æ ˆ</title>
      <link>https://tyhzxh.github.io/posts/computer-network-overview/</link>
      <pubDate>Mon, 25 Mar 2024 22:24:11 +0800</pubDate>
      <guid>https://tyhzxh.github.io/posts/computer-network-overview/</guid>
      <description>æ·±å…¥è§£æè®¡ç®—æœºç½‘ç»œçš„æ ¸å¿ƒæ¦‚å¿µï¼ŒåŒ…æ‹¬OSIä¸ƒå±‚æ¨¡å‹å’ŒTCP/IPå››å±‚æ¨¡å‹çš„å¯¹æ¯”ï¼Œä»¥åŠHTTPã€TCPã€IPç­‰é‡è¦åè®®çš„å·¥ä½œåŸç†å’Œåº”ç”¨åœºæ™¯</description>
      <content:encoded><![CDATA[<h2 id="è®¡ç®—æœºç½‘ç»œåŸºç¡€æ¦‚è¿°">è®¡ç®—æœºç½‘ç»œåŸºç¡€æ¦‚è¿°</h2>
<p>è®¡ç®—æœºç½‘ç»œæ˜¯ç°ä»£ä¿¡æ¯æŠ€æœ¯çš„åŸºç¡€è®¾æ–½ï¼Œç†è§£ç½‘ç»œæ¨¡å‹å’Œåè®®å¯¹äºä»»ä½•ITä»ä¸šè€…éƒ½è‡³å…³é‡è¦ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨ç½‘ç»œåˆ†å±‚æ¨¡å‹ã€æ ¸å¿ƒåè®®åŠå…¶å®é™…åº”ç”¨ã€‚</p>
<h2 id="ç½‘ç»œåˆ†å±‚æ¨¡å‹å¯¹æ¯”">ç½‘ç»œåˆ†å±‚æ¨¡å‹å¯¹æ¯”</h2>
<h3 id="osiä¸ƒå±‚æ¨¡å‹">OSIä¸ƒå±‚æ¨¡å‹</h3>
<p><strong>OSIï¼ˆOpen Systems Interconnectionï¼‰æ¨¡å‹</strong>æ˜¯å›½é™…æ ‡å‡†åŒ–ç»„ç»‡åˆ¶å®šçš„ç½‘ç»œé€šä¿¡æ ‡å‡†æ¨¡å‹ï¼Œå°†ç½‘ç»œé€šä¿¡åˆ†ä¸ºä¸ƒä¸ªå±‚æ¬¡ï¼š</p>
<table>
  <thead>
      <tr>
          <th>å±‚æ¬¡</th>
          <th>åç§°</th>
          <th>åŠŸèƒ½æè¿°</th>
          <th>å…¸å‹åè®®/æŠ€æœ¯</th>
          <th>æ•°æ®å•ä½</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>ç¬¬7å±‚</strong></td>
          <td>åº”ç”¨å±‚</td>
          <td>ä¸ºåº”ç”¨ç¨‹åºæä¾›ç½‘ç»œæœåŠ¡</td>
          <td>HTTPã€HTTPSã€FTPã€SMTPã€DNS</td>
          <td>æ•°æ®</td>
      </tr>
      <tr>
          <td><strong>ç¬¬6å±‚</strong></td>
          <td>è¡¨ç¤ºå±‚</td>
          <td>æ•°æ®æ ¼å¼è½¬æ¢ã€åŠ å¯†è§£å¯†ã€å‹ç¼©</td>
          <td>SSL/TLSã€JPEGã€MPEG</td>
          <td>æ•°æ®</td>
      </tr>
      <tr>
          <td><strong>ç¬¬5å±‚</strong></td>
          <td>ä¼šè¯å±‚</td>
          <td>å»ºç«‹ã€ç®¡ç†ã€ç»ˆæ­¢ä¼šè¯è¿æ¥</td>
          <td>NetBIOSã€RPCã€SQL</td>
          <td>æ•°æ®</td>
      </tr>
      <tr>
          <td><strong>ç¬¬4å±‚</strong></td>
          <td>ä¼ è¾“å±‚</td>
          <td>ç«¯åˆ°ç«¯çš„å¯é æ•°æ®ä¼ è¾“</td>
          <td>TCPã€UDP</td>
          <td>æ®µï¼ˆSegmentï¼‰</td>
      </tr>
      <tr>
          <td><strong>ç¬¬3å±‚</strong></td>
          <td>ç½‘ç»œå±‚</td>
          <td>è·¯å¾„é€‰æ‹©å’Œé€»è¾‘åœ°å€</td>
          <td>IPã€ICMPã€OSPFã€BGP</td>
          <td>åŒ…ï¼ˆPacketï¼‰</td>
      </tr>
      <tr>
          <td><strong>ç¬¬2å±‚</strong></td>
          <td>æ•°æ®é“¾è·¯å±‚</td>
          <td>ç‰©ç†åœ°å€å’Œé”™è¯¯æ£€æµ‹</td>
          <td>Ethernetã€WiFiã€PPP</td>
          <td>å¸§ï¼ˆFrameï¼‰</td>
      </tr>
      <tr>
          <td><strong>ç¬¬1å±‚</strong></td>
          <td>ç‰©ç†å±‚</td>
          <td>ç”µæ°”ã€ç‰©ç†ã€åŠŸèƒ½å’Œè¿‡ç¨‹ç‰¹æ€§</td>
          <td>åŒç»çº¿ã€å…‰çº¤ã€æ— çº¿ç”µæ³¢</td>
          <td>æ¯”ç‰¹ï¼ˆBitï¼‰</td>
      </tr>
  </tbody>
</table>
<h3 id="tcpipå››å±‚æ¨¡å‹">TCP/IPå››å±‚æ¨¡å‹</h3>
<p><strong>TCP/IPæ¨¡å‹</strong>æ˜¯äº’è”ç½‘å®é™…ä½¿ç”¨çš„ç½‘ç»œæ¨¡å‹ï¼Œæ›´åŠ å®ç”¨å’Œç®€åŒ–ï¼š</p>
<table>
  <thead>
      <tr>
          <th>TCP/IPå±‚æ¬¡</th>
          <th>åŠŸèƒ½æè¿°</th>
          <th>å¯¹åº”OSIå±‚</th>
          <th>ä¸»è¦åè®®</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>åº”ç”¨å±‚</strong></td>
          <td>åº”ç”¨ç¨‹åºæ¥å£å’ŒæœåŠ¡</td>
          <td>åº”ç”¨å±‚+è¡¨ç¤ºå±‚+ä¼šè¯å±‚</td>
          <td>HTTPã€HTTPSã€FTPã€SMTPã€DNSã€SSH</td>
      </tr>
      <tr>
          <td><strong>ä¼ è¾“å±‚</strong></td>
          <td>ç«¯åˆ°ç«¯é€šä¿¡å’Œæ•°æ®å®Œæ•´æ€§</td>
          <td>ä¼ è¾“å±‚</td>
          <td>TCPã€UDP</td>
      </tr>
      <tr>
          <td><strong>ç½‘ç»œå±‚</strong></td>
          <td>è·¯ç”±å’Œå¯»å€</td>
          <td>ç½‘ç»œå±‚</td>
          <td>IPã€ICMPã€ARP</td>
      </tr>
      <tr>
          <td><strong>ç½‘ç»œæ¥å£å±‚</strong></td>
          <td>ç‰©ç†ç½‘ç»œè®¿é—®</td>
          <td>æ•°æ®é“¾è·¯å±‚+ç‰©ç†å±‚</td>
          <td>Ethernetã€WiFiã€PPP</td>
      </tr>
  </tbody>
</table>
<h3 id="ä¸¤ç§æ¨¡å‹çš„å¯¹æ¯”">ä¸¤ç§æ¨¡å‹çš„å¯¹æ¯”</h3>
<pre tabindex="0"><code>OSIä¸ƒå±‚æ¨¡å‹                    TCP/IPå››å±‚æ¨¡å‹
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   åº”ç”¨å±‚    â”‚               â”‚             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚   åº”ç”¨å±‚    â”‚
â”‚   è¡¨ç¤ºå±‚    â”‚               â”‚             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚             â”‚
â”‚   ä¼šè¯å±‚    â”‚               â”‚             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   ä¼ è¾“å±‚    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   ä¼ è¾“å±‚    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   ç½‘ç»œå±‚    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   ç½‘ç»œå±‚    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ•°æ®é“¾è·¯å±‚  â”‚               â”‚ ç½‘ç»œæ¥å£å±‚  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚             â”‚
â”‚   ç‰©ç†å±‚    â”‚               â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre><h2 id="æ ¸å¿ƒåè®®è¯¦è§£">æ ¸å¿ƒåè®®è¯¦è§£</h2>
<h3 id="httpåè®®è¶…æ–‡æœ¬ä¼ è¾“åè®®">HTTPåè®®ï¼ˆè¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼‰</h3>
<h4 id="httpåŸºæœ¬æ¦‚å¿µ">HTTPåŸºæœ¬æ¦‚å¿µ</h4>
<p>**HTTPï¼ˆHyperText Transfer Protocolï¼‰**æ˜¯åº”ç”¨å±‚åè®®ï¼Œç”¨äºåœ¨Webæµè§ˆå™¨å’ŒWebæœåŠ¡å™¨ä¹‹é—´ä¼ è¾“æ•°æ®ã€‚</p>
<h4 id="httpå·¥ä½œåŸç†">HTTPå·¥ä½œåŸç†</h4>
<pre tabindex="0"><code>å®¢æˆ·ç«¯                                    æœåŠ¡å™¨
   â”‚                                        â”‚
   â”‚ â”€â”€â”€â”€ HTTPè¯·æ±‚ï¼ˆRequestï¼‰ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚
   â”‚                                        â”‚
   â”‚ â†â”€â”€â”€â”€ HTTPå“åº”ï¼ˆResponseï¼‰ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
   â”‚                                        â”‚
</code></pre><h4 id="httpè¯·æ±‚ç»“æ„">HTTPè¯·æ±‚ç»“æ„</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="nf">GET</span> <span class="nn">/api/users/123</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</span></span><span class="line"><span class="cl"><span class="n">Host</span><span class="o">:</span> <span class="l">www.example.com</span>
</span></span><span class="line"><span class="cl"><span class="n">User-Agent</span><span class="o">:</span> <span class="l">Mozilla/5.0 (Windows NT 10.0; Win64; x64)</span>
</span></span><span class="line"><span class="cl"><span class="n">Accept</span><span class="o">:</span> <span class="l">application/json</span>
</span></span><span class="line"><span class="cl"><span class="n">Authorization</span><span class="o">:</span> <span class="l">Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...</span>
</span></span><span class="line"><span class="cl"><span class="n">Content-Type</span><span class="o">:</span> <span class="l">application/json</span>
</span></span><span class="line"><span class="cl"><span class="n">Content-Length</span><span class="o">:</span> <span class="l">85</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;å¼ ä¸‰&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;email&#34;</span><span class="p">:</span> <span class="s2">&#34;zhangsan@example.com&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h4 id="httpå“åº”ç»“æ„">HTTPå“åº”ç»“æ„</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
</span></span><span class="line"><span class="cl"><span class="n">Date</span><span class="o">:</span> <span class="l">Mon, 25 Mar 2024 10:30:00 GMT</span>
</span></span><span class="line"><span class="cl"><span class="n">Server</span><span class="o">:</span> <span class="l">nginx/1.18.0</span>
</span></span><span class="line"><span class="cl"><span class="n">Content-Type</span><span class="o">:</span> <span class="l">application/json; charset=utf-8</span>
</span></span><span class="line"><span class="cl"><span class="n">Content-Length</span><span class="o">:</span> <span class="l">156</span>
</span></span><span class="line"><span class="cl"><span class="n">Cache-Control</span><span class="o">:</span> <span class="l">no-cache</span>
</span></span><span class="line"><span class="cl"><span class="n">Set-Cookie</span><span class="o">:</span> <span class="l">sessionid=abc123; Path=/; HttpOnly</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;id&#34;</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;å¼ ä¸‰&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;email&#34;</span><span class="p">:</span> <span class="s2">&#34;zhangsan@example.com&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;created_at&#34;</span><span class="p">:</span> <span class="s2">&#34;2024-03-25T10:30:00Z&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h4 id="httpæ–¹æ³•è¯¦è§£">HTTPæ–¹æ³•è¯¦è§£</h4>
<table>
  <thead>
      <tr>
          <th>æ–¹æ³•</th>
          <th>ç”¨é€”</th>
          <th>å¹‚ç­‰æ€§</th>
          <th>å®‰å…¨æ€§</th>
          <th>ç¤ºä¾‹</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>GET</strong></td>
          <td>è·å–èµ„æº</td>
          <td>âœ“</td>
          <td>âœ“</td>
          <td><code>GET /api/users</code></td>
      </tr>
      <tr>
          <td><strong>POST</strong></td>
          <td>åˆ›å»ºèµ„æº</td>
          <td>âœ—</td>
          <td>âœ—</td>
          <td><code>POST /api/users</code></td>
      </tr>
      <tr>
          <td><strong>PUT</strong></td>
          <td>æ›´æ–°/åˆ›å»ºèµ„æº</td>
          <td>âœ“</td>
          <td>âœ—</td>
          <td><code>PUT /api/users/123</code></td>
      </tr>
      <tr>
          <td><strong>PATCH</strong></td>
          <td>éƒ¨åˆ†æ›´æ–°èµ„æº</td>
          <td>âœ—</td>
          <td>âœ—</td>
          <td><code>PATCH /api/users/123</code></td>
      </tr>
      <tr>
          <td><strong>DELETE</strong></td>
          <td>åˆ é™¤èµ„æº</td>
          <td>âœ“</td>
          <td>âœ—</td>
          <td><code>DELETE /api/users/123</code></td>
      </tr>
      <tr>
          <td><strong>HEAD</strong></td>
          <td>è·å–å“åº”å¤´</td>
          <td>âœ“</td>
          <td>âœ“</td>
          <td><code>HEAD /api/users/123</code></td>
      </tr>
      <tr>
          <td><strong>OPTIONS</strong></td>
          <td>è·å–æ”¯æŒçš„æ–¹æ³•</td>
          <td>âœ“</td>
          <td>âœ“</td>
          <td><code>OPTIONS /api/users</code></td>
      </tr>
  </tbody>
</table>
<h4 id="httpçŠ¶æ€ç ">HTTPçŠ¶æ€ç </h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// 1xx ä¿¡æ¯æ€§çŠ¶æ€ç 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">100</span> <span class="nx">Continue</span>              <span class="c1">// ç»§ç»­è¯·æ±‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">101</span> <span class="nx">Switching</span> <span class="nx">Protocols</span>   <span class="c1">// åˆ‡æ¢åè®®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// 2xx æˆåŠŸçŠ¶æ€ç 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">200</span> <span class="nx">OK</span>                    <span class="c1">// è¯·æ±‚æˆåŠŸ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">201</span> <span class="nx">Created</span>              <span class="c1">// èµ„æºåˆ›å»ºæˆåŠŸ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">204</span> <span class="nx">No</span> <span class="nx">Content</span>           <span class="c1">// æˆåŠŸä½†æ— å†…å®¹è¿”å›
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// 3xx é‡å®šå‘çŠ¶æ€ç 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">301</span> <span class="nx">Moved</span> <span class="nx">Permanently</span>    <span class="c1">// æ°¸ä¹…é‡å®šå‘
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">302</span> <span class="nx">Found</span>               <span class="c1">// ä¸´æ—¶é‡å®šå‘
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">304</span> <span class="nx">Not</span> <span class="nx">Modified</span>        <span class="c1">// èµ„æºæœªä¿®æ”¹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// 4xx å®¢æˆ·ç«¯é”™è¯¯
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">400</span> <span class="nx">Bad</span> <span class="nx">Request</span>         <span class="c1">// è¯·æ±‚è¯­æ³•é”™è¯¯
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">401</span> <span class="nx">Unauthorized</span>        <span class="c1">// æœªæˆæƒ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">403</span> <span class="nx">Forbidden</span>          <span class="c1">// ç¦æ­¢è®¿é—®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">404</span> <span class="nx">Not</span> <span class="nx">Found</span>          <span class="c1">// èµ„æºä¸å­˜åœ¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">429</span> <span class="nx">Too</span> <span class="nx">Many</span> <span class="nx">Requests</span>  <span class="c1">// è¯·æ±‚è¿‡å¤š
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// 5xx æœåŠ¡å™¨é”™è¯¯
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">500</span> <span class="nx">Internal</span> <span class="nx">Server</span> <span class="nb">Error</span>  <span class="c1">// æœåŠ¡å™¨å†…éƒ¨é”™è¯¯
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">502</span> <span class="nx">Bad</span> <span class="nx">Gateway</span>           <span class="c1">// ç½‘å…³é”™è¯¯
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">503</span> <span class="nx">Service</span> <span class="nx">Unavailable</span>   <span class="c1">// æœåŠ¡ä¸å¯ç”¨
</span></span></span></code></pre></div><h4 id="httpså®‰å…¨å¢å¼º">HTTPSå®‰å…¨å¢å¼º</h4>
<pre tabindex="0"><code>HTTP + SSL/TLS = HTTPS

å®¢æˆ·ç«¯                                    æœåŠ¡å™¨
   â”‚                                        â”‚
   â”‚ â”€â”€â”€â”€ SSLæ¡æ‰‹ï¼ˆå»ºç«‹å®‰å…¨è¿æ¥ï¼‰ â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚
   â”‚ â†â”€â”€â”€â”€ è¯ä¹¦éªŒè¯ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
   â”‚ â”€â”€â”€â”€ åŠ å¯†çš„HTTPè¯·æ±‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚
   â”‚ â†â”€â”€â”€â”€ åŠ å¯†çš„HTTPå“åº” â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
   â”‚                                        â”‚
</code></pre><h3 id="tcpåè®®ä¼ è¾“æ§åˆ¶åè®®">TCPåè®®ï¼ˆä¼ è¾“æ§åˆ¶åè®®ï¼‰</h3>
<h4 id="tcpåŸºæœ¬ç‰¹æ€§">TCPåŸºæœ¬ç‰¹æ€§</h4>
<p>**TCPï¼ˆTransmission Control Protocolï¼‰**æ˜¯é¢å‘è¿æ¥çš„ã€å¯é çš„ä¼ è¾“å±‚åè®®ã€‚</p>
<h4 id="tcpæ ¸å¿ƒç‰¹æ€§">TCPæ ¸å¿ƒç‰¹æ€§</h4>
<table>
  <thead>
      <tr>
          <th>ç‰¹æ€§</th>
          <th>æè¿°</th>
          <th>å®ç°æœºåˆ¶</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>é¢å‘è¿æ¥</strong></td>
          <td>é€šä¿¡å‰éœ€å»ºç«‹è¿æ¥</td>
          <td>ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹è¿æ¥</td>
      </tr>
      <tr>
          <td><strong>å¯é ä¼ è¾“</strong></td>
          <td>ä¿è¯æ•°æ®å®Œæ•´æ€§</td>
          <td>åºåˆ—å·ã€ç¡®è®¤åº”ç­”ã€é‡ä¼ </td>
      </tr>
      <tr>
          <td><strong>æµé‡æ§åˆ¶</strong></td>
          <td>é˜²æ­¢å‘é€æ–¹è¿‡å¿«</td>
          <td>æ»‘åŠ¨çª—å£æœºåˆ¶</td>
      </tr>
      <tr>
          <td><strong>æ‹¥å¡æ§åˆ¶</strong></td>
          <td>é˜²æ­¢ç½‘ç»œæ‹¥å¡</td>
          <td>æ…¢å¯åŠ¨ã€æ‹¥å¡é¿å…</td>
      </tr>
      <tr>
          <td><strong>å…¨åŒå·¥é€šä¿¡</strong></td>
          <td>åŒå‘æ•°æ®ä¼ è¾“</td>
          <td>ç‹¬ç«‹çš„å‘é€å’Œæ¥æ”¶ç¼“å†²åŒº</td>
      </tr>
  </tbody>
</table>
<h4 id="tcpä¸‰æ¬¡æ¡æ‰‹">TCPä¸‰æ¬¡æ¡æ‰‹</h4>
<pre tabindex="0"><code>å®¢æˆ·ç«¯                                    æœåŠ¡å™¨
   â”‚                                        â”‚
   â”‚ â”€â”€â”€â”€ SYNï¼ˆseq=xï¼‰ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚  ç¬¬ä¸€æ¬¡æ¡æ‰‹
   â”‚                                        â”‚
   â”‚ â†â”€â”€â”€â”€ SYN+ACKï¼ˆseq=y, ack=x+1ï¼‰ â”€â”€â”€â”€â”€ â”‚  ç¬¬äºŒæ¬¡æ¡æ‰‹
   â”‚                                        â”‚
   â”‚ â”€â”€â”€â”€ ACKï¼ˆseq=x+1, ack=y+1ï¼‰ â”€â”€â”€â”€â”€â”€â”€â†’ â”‚  ç¬¬ä¸‰æ¬¡æ¡æ‰‹
   â”‚                                        â”‚
   â”‚ â•â•â•â•â•â•â• è¿æ¥å»ºç«‹ï¼Œå¼€å§‹æ•°æ®ä¼ è¾“ â•â•â•â•â•â•â• â”‚
</code></pre><h4 id="tcpå››æ¬¡æŒ¥æ‰‹">TCPå››æ¬¡æŒ¥æ‰‹</h4>
<pre tabindex="0"><code>å®¢æˆ·ç«¯                                    æœåŠ¡å™¨
   â”‚                                        â”‚
   â”‚ â”€â”€â”€â”€ FINï¼ˆseq=uï¼‰ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚  ç¬¬ä¸€æ¬¡æŒ¥æ‰‹
   â”‚                                        â”‚
   â”‚ â†â”€â”€â”€â”€ ACKï¼ˆack=u+1ï¼‰ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  ç¬¬äºŒæ¬¡æŒ¥æ‰‹
   â”‚                                        â”‚
   â”‚ â†â”€â”€â”€â”€ FINï¼ˆseq=vï¼‰ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹
   â”‚                                        â”‚
   â”‚ â”€â”€â”€â”€ ACKï¼ˆack=v+1ï¼‰ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚  ç¬¬å››æ¬¡æŒ¥æ‰‹
   â”‚                                        â”‚
   â”‚ â•â•â•â•â•â•â• è¿æ¥å…³é—­ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚
</code></pre><h4 id="tcp-vs-udpå¯¹æ¯”">TCP vs UDPå¯¹æ¯”</h4>
<table>
  <thead>
      <tr>
          <th>ç‰¹æ€§</th>
          <th>TCP</th>
          <th>UDP</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>è¿æ¥æ€§</strong></td>
          <td>é¢å‘è¿æ¥</td>
          <td>æ— è¿æ¥</td>
      </tr>
      <tr>
          <td><strong>å¯é æ€§</strong></td>
          <td>å¯é ä¼ è¾“</td>
          <td>ä¸å¯é ä¼ è¾“</td>
      </tr>
      <tr>
          <td><strong>é€Ÿåº¦</strong></td>
          <td>è¾ƒæ…¢ï¼ˆå¼€é”€å¤§ï¼‰</td>
          <td>è¾ƒå¿«ï¼ˆå¼€é”€å°ï¼‰</td>
      </tr>
      <tr>
          <td><strong>æ•°æ®è¾¹ç•Œ</strong></td>
          <td>å­—èŠ‚æµ</td>
          <td>æ•°æ®æŠ¥</td>
      </tr>
      <tr>
          <td><strong>åº”ç”¨åœºæ™¯</strong></td>
          <td>HTTPã€FTPã€é‚®ä»¶</td>
          <td>DNSã€è§†é¢‘æµã€æ¸¸æˆ</td>
      </tr>
  </tbody>
</table>
<h3 id="ipåè®®ç½‘é™…åè®®">IPåè®®ï¼ˆç½‘é™…åè®®ï¼‰</h3>
<h4 id="ipåè®®æ¦‚è¿°">IPåè®®æ¦‚è¿°</h4>
<p>**IPï¼ˆInternet Protocolï¼‰**æ˜¯ç½‘ç»œå±‚åè®®ï¼Œè´Ÿè´£åœ¨ç½‘ç»œä¸­è·¯ç”±æ•°æ®åŒ…ã€‚</p>
<h4 id="ipv4åœ°å€ç»“æ„">IPv4åœ°å€ç»“æ„</h4>
<pre tabindex="0"><code>IPv4åœ°å€ï¼š32ä½ï¼Œåˆ†ä¸º4ä¸ª8ä½å­—èŠ‚
ç¤ºä¾‹ï¼š192.168.1.100

äºŒè¿›åˆ¶è¡¨ç¤ºï¼š
11000000.10101000.00000001.01100100

åœ°å€åˆ†ç±»ï¼š
Aç±»ï¼š1.0.0.0    - 126.255.255.255  ï¼ˆ/8ï¼‰
Bç±»ï¼š128.0.0.0  - 191.255.255.255  ï¼ˆ/16ï¼‰
Cç±»ï¼š192.0.0.0  - 223.255.255.255  ï¼ˆ/24ï¼‰
</code></pre><h4 id="ç§æœ‰ipåœ°å€èŒƒå›´">ç§æœ‰IPåœ°å€èŒƒå›´</h4>
<table>
  <thead>
      <tr>
          <th>ç±»åˆ«</th>
          <th>åœ°å€èŒƒå›´</th>
          <th>å­ç½‘æ©ç </th>
          <th>ç”¨é€”</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Aç±»ç§æœ‰</td>
          <td>10.0.0.0 - 10.255.255.255</td>
          <td>255.0.0.0</td>
          <td>å¤§å‹ä¼ä¸šç½‘ç»œ</td>
      </tr>
      <tr>
          <td>Bç±»ç§æœ‰</td>
          <td>172.16.0.0 - 172.31.255.255</td>
          <td>255.240.0.0</td>
          <td>ä¸­å‹ä¼ä¸šç½‘ç»œ</td>
      </tr>
      <tr>
          <td>Cç±»ç§æœ‰</td>
          <td>192.168.0.0 - 192.168.255.255</td>
          <td>255.255.0.0</td>
          <td>å®¶åº­/å°å‹ç½‘ç»œ</td>
      </tr>
  </tbody>
</table>
<h4 id="ipv6åœ°å€ç»“æ„">IPv6åœ°å€ç»“æ„</h4>
<pre tabindex="0"><code>IPv6åœ°å€ï¼š128ä½ï¼Œåˆ†ä¸º8ç»„ï¼Œæ¯ç»„4ä¸ªåå…­è¿›åˆ¶æ•°å­—
ç¤ºä¾‹ï¼š2001:0db8:85a3:0000:0000:8a2e:0370:7334

ç®€åŒ–è¡¨ç¤ºï¼š
2001:db8:85a3::8a2e:370:7334

åœ°å€ç±»å‹ï¼š
å•æ’­åœ°å€ï¼šä¸€å¯¹ä¸€é€šä¿¡
ç»„æ’­åœ°å€ï¼šä¸€å¯¹å¤šé€šä¿¡
ä»»æ’­åœ°å€ï¼šä¸€å¯¹æœ€è¿‘ä¸€ä¸ªé€šä¿¡
</code></pre><h2 id="ç½‘ç»œé€šä¿¡å®ä¾‹">ç½‘ç»œé€šä¿¡å®ä¾‹</h2>
<h3 id="å®Œæ•´çš„httpè¯·æ±‚è¿‡ç¨‹">å®Œæ•´çš„HTTPè¯·æ±‚è¿‡ç¨‹</h3>
<pre tabindex="0"><code>1. DNSè§£æ
   www.example.com â†’ 93.184.216.34

2. TCPè¿æ¥å»ºç«‹ï¼ˆä¸‰æ¬¡æ¡æ‰‹ï¼‰
   å®¢æˆ·ç«¯:1234 â†â†’ æœåŠ¡å™¨:80

3. HTTPè¯·æ±‚å‘é€
   GET / HTTP/1.1
   Host: www.example.com

4. HTTPå“åº”æ¥æ”¶
   HTTP/1.1 200 OK
   Content-Type: text/html

5. TCPè¿æ¥å…³é—­ï¼ˆå››æ¬¡æŒ¥æ‰‹ï¼‰
</code></pre><h3 id="æ•°æ®åŒ…å°è£…è¿‡ç¨‹">æ•°æ®åŒ…å°è£…è¿‡ç¨‹</h3>
<pre tabindex="0"><code>åº”ç”¨å±‚ï¼šHTTPæ•°æ®
    â†“
ä¼ è¾“å±‚ï¼šTCPå¤´éƒ¨ + HTTPæ•°æ®
    â†“
ç½‘ç»œå±‚ï¼šIPå¤´éƒ¨ + TCPå¤´éƒ¨ + HTTPæ•°æ®
    â†“
æ•°æ®é“¾è·¯å±‚ï¼šä»¥å¤ªç½‘å¤´éƒ¨ + IPå¤´éƒ¨ + TCPå¤´éƒ¨ + HTTPæ•°æ® + ä»¥å¤ªç½‘å°¾éƒ¨
    â†“
ç‰©ç†å±‚ï¼šç”µä¿¡å·/å…‰ä¿¡å·
</code></pre><h2 id="ç½‘ç»œå®‰å…¨åŸºç¡€">ç½‘ç»œå®‰å…¨åŸºç¡€</h2>
<h3 id="å¸¸è§ç½‘ç»œæ”»å‡»">å¸¸è§ç½‘ç»œæ”»å‡»</h3>
<table>
  <thead>
      <tr>
          <th>æ”»å‡»ç±»å‹</th>
          <th>æè¿°</th>
          <th>é˜²æŠ¤æªæ–½</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>DDoSæ”»å‡»</strong></td>
          <td>åˆ†å¸ƒå¼æ‹’ç»æœåŠ¡</td>
          <td>æµé‡æ¸…æ´—ã€CDN</td>
      </tr>
      <tr>
          <td><strong>ä¸­é—´äººæ”»å‡»</strong></td>
          <td>æˆªè·é€šä¿¡å†…å®¹</td>
          <td>HTTPSã€è¯ä¹¦éªŒè¯</td>
      </tr>
      <tr>
          <td><strong>SQLæ³¨å…¥</strong></td>
          <td>æ¶æ„SQLä»£ç </td>
          <td>å‚æ•°åŒ–æŸ¥è¯¢ã€è¾“å…¥éªŒè¯</td>
      </tr>
      <tr>
          <td><strong>XSSæ”»å‡»</strong></td>
          <td>è·¨ç«™è„šæœ¬æ”»å‡»</td>
          <td>è¾“å…¥è¿‡æ»¤ã€CSPç­–ç•¥</td>
      </tr>
  </tbody>
</table>
<h3 id="ç½‘ç»œå®‰å…¨åè®®">ç½‘ç»œå®‰å…¨åè®®</h3>
<pre tabindex="0"><code>SSL/TLSï¼šä¼ è¾“å±‚å®‰å…¨
IPSecï¼šç½‘ç»œå±‚å®‰å…¨
WPA/WPA2ï¼šæ— çº¿ç½‘ç»œå®‰å…¨
SSHï¼šå®‰å…¨è¿œç¨‹è®¿é—®
</code></pre><h2 id="ç½‘ç»œæ€§èƒ½ä¼˜åŒ–">ç½‘ç»œæ€§èƒ½ä¼˜åŒ–</h2>
<h3 id="å¸¸è§ä¼˜åŒ–æŠ€æœ¯">å¸¸è§ä¼˜åŒ–æŠ€æœ¯</h3>
<ol>
<li>
<p><strong>CDNï¼ˆå†…å®¹åˆ†å‘ç½‘ç»œï¼‰</strong></p>
<ul>
<li>å°±è¿‘è®¿é—®ï¼Œå‡å°‘å»¶è¿Ÿ</li>
<li>åˆ†æ‹…æºæœåŠ¡å™¨å‹åŠ›</li>
</ul>
</li>
<li>
<p><strong>è´Ÿè½½å‡è¡¡</strong></p>
<ul>
<li>åˆ†æ•£è¯·æ±‚åˆ°å¤šå°æœåŠ¡å™¨</li>
<li>æé«˜ç³»ç»Ÿå¯ç”¨æ€§</li>
</ul>
</li>
<li>
<p><strong>ç¼“å­˜ç­–ç•¥</strong></p>
<ul>
<li>æµè§ˆå™¨ç¼“å­˜</li>
<li>ä»£ç†æœåŠ¡å™¨ç¼“å­˜</li>
<li>åº”ç”¨å±‚ç¼“å­˜</li>
</ul>
</li>
<li>
<p><strong>å‹ç¼©æŠ€æœ¯</strong></p>
<ul>
<li>Gzipå‹ç¼©</li>
<li>Brotliå‹ç¼©</li>
<li>å›¾ç‰‡å‹ç¼©</li>
</ul>
</li>
</ol>
<h3 id="ç½‘ç»œç›‘æ§æŒ‡æ ‡">ç½‘ç»œç›‘æ§æŒ‡æ ‡</h3>
<table>
  <thead>
      <tr>
          <th>æŒ‡æ ‡</th>
          <th>æè¿°</th>
          <th>æ­£å¸¸èŒƒå›´</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>å»¶è¿Ÿï¼ˆLatencyï¼‰</strong></td>
          <td>æ•°æ®ä¼ è¾“æ—¶é—´</td>
          <td>&lt; 100ms</td>
      </tr>
      <tr>
          <td><strong>å¸¦å®½ï¼ˆBandwidthï¼‰</strong></td>
          <td>æ•°æ®ä¼ è¾“é€Ÿç‡</td>
          <td>æ ¹æ®éœ€æ±‚</td>
      </tr>
      <tr>
          <td><strong>ä¸¢åŒ…ç‡ï¼ˆPacket Lossï¼‰</strong></td>
          <td>æ•°æ®åŒ…ä¸¢å¤±æ¯”ä¾‹</td>
          <td>&lt; 1%</td>
      </tr>
      <tr>
          <td><strong>ååé‡ï¼ˆThroughputï¼‰</strong></td>
          <td>å®é™…æ•°æ®ä¼ è¾“é‡</td>
          <td>æ¥è¿‘å¸¦å®½</td>
      </tr>
  </tbody>
</table>
<h2 id="å®é™…åº”ç”¨åœºæ™¯">å®é™…åº”ç”¨åœºæ™¯</h2>
<h3 id="webåº”ç”¨æ¶æ„">Webåº”ç”¨æ¶æ„</h3>
<pre tabindex="0"><code>ç”¨æˆ·æµè§ˆå™¨
    â†“ HTTP/HTTPS
è´Ÿè½½å‡è¡¡å™¨
    â†“ HTTP
WebæœåŠ¡å™¨ï¼ˆNginx/Apacheï¼‰
    â†“ HTTP/FastCGI
åº”ç”¨æœåŠ¡å™¨ï¼ˆNode.js/Java/Pythonï¼‰
    â†“ TCP/IP
æ•°æ®åº“æœåŠ¡å™¨ï¼ˆMySQL/PostgreSQLï¼‰
</code></pre><h3 id="å¾®æœåŠ¡é€šä¿¡">å¾®æœåŠ¡é€šä¿¡</h3>
<pre tabindex="0"><code>æœåŠ¡A â†â”€ HTTP/REST â”€â†’ æœåŠ¡B
  â”‚                      â”‚
  â””â”€ gRPC/TCP â”€â†’ æœåŠ¡C â†â”€â”˜
  â”‚                      â”‚
  â””â”€ Message Queue â”€â†’ æœåŠ¡D
</code></pre><h2 id="å­¦ä¹ å»ºè®®">å­¦ä¹ å»ºè®®</h2>
<h3 id="ç†è®ºå­¦ä¹ è·¯å¾„">ç†è®ºå­¦ä¹ è·¯å¾„</h3>
<ol>
<li><strong>åŸºç¡€æ¦‚å¿µ</strong>ï¼šç†è§£ç½‘ç»œåˆ†å±‚æ¨¡å‹</li>
<li><strong>åè®®åŸç†</strong>ï¼šæ·±å…¥å­¦ä¹ TCP/IPã€HTTP</li>
<li><strong>ç½‘ç»œç¼–ç¨‹</strong>ï¼šSocketç¼–ç¨‹å®è·µ</li>
<li><strong>å®‰å…¨çŸ¥è¯†</strong>ï¼šç½‘ç»œå®‰å…¨åŸºç¡€</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šç½‘ç»œè°ƒä¼˜æŠ€æœ¯</li>
</ol>
<h3 id="å®è·µé¡¹ç›®å»ºè®®">å®è·µé¡¹ç›®å»ºè®®</h3>
<ol>
<li><strong>æ­å»ºç®€å•WebæœåŠ¡å™¨</strong></li>
<li><strong>å®ç°HTTPå®¢æˆ·ç«¯</strong></li>
<li><strong>ç½‘ç»œæŠ“åŒ…åˆ†æ</strong></li>
<li><strong>é…ç½®è´Ÿè½½å‡è¡¡</strong></li>
<li><strong>éƒ¨ç½²HTTPSè¯ä¹¦</strong></li>
</ol>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>è®¡ç®—æœºç½‘ç»œæ˜¯ç°ä»£ä¿¡æ¯æŠ€æœ¯çš„åŸºç¡€ï¼Œç†è§£ç½‘ç»œæ¨¡å‹å’Œåè®®å¯¹äºï¼š</p>
<ul>
<li><strong>å¼€å‘äººå‘˜</strong>ï¼šç¼–å†™ç½‘ç»œåº”ç”¨ç¨‹åº</li>
<li><strong>è¿ç»´äººå‘˜</strong>ï¼šç½‘ç»œæ•…éšœæ’æŸ¥å’Œä¼˜åŒ–</li>
<li><strong>æ¶æ„å¸ˆ</strong>ï¼šè®¾è®¡åˆ†å¸ƒå¼ç³»ç»Ÿ</li>
<li><strong>å®‰å…¨å·¥ç¨‹å¸ˆ</strong>ï¼šç½‘ç»œå®‰å…¨é˜²æŠ¤</li>
</ul>
<p>æŒæ¡è¿™äº›åŸºç¡€çŸ¥è¯†å°†ä¸ºæ·±å…¥å­¦ä¹ æ›´é«˜çº§çš„ç½‘ç»œæŠ€æœ¯æ‰“ä¸‹åšå®åŸºç¡€ã€‚å»ºè®®ç»“åˆç†è®ºå­¦ä¹ å’Œå®é™…æ“ä½œï¼Œé€šè¿‡æŠ“åŒ…åˆ†æã€ç½‘ç»œç¼–ç¨‹ç­‰æ–¹å¼åŠ æ·±ç†è§£ã€‚</p>
]]></content:encoded>
    </item>
    <item>
      <title>Javaç¼“å†²æµè¯¦è§£ï¼šæå‡IOæ€§èƒ½çš„å…³é”®æŠ€æœ¯</title>
      <link>https://tyhzxh.github.io/posts/java-buffered-streams/</link>
      <pubDate>Wed, 20 Mar 2024 16:45:00 +0800</pubDate>
      <guid>https://tyhzxh.github.io/posts/java-buffered-streams/</guid>
      <description>æ·±å…¥è§£æJavaç¼“å†²æµçš„å·¥ä½œåŸç†ã€ä½¿ç”¨æ–¹æ³•å’Œæ€§èƒ½ä¼˜åŒ–æŠ€å·§ï¼ŒåŒ…æ‹¬BufferedInputStreamã€BufferedOutputStreamã€BufferedReaderå’ŒBufferedWriterçš„è¯¦ç»†ç”¨æ³•</description>
      <content:encoded><![CDATA[<h2 id="ç¼“å†²æµæ¦‚è¿°">ç¼“å†²æµæ¦‚è¿°</h2>
<p><strong>ç¼“å†²æµï¼ˆBuffered Streamï¼‰</strong> æ˜¯Java IOä¸­ä¸€ç§<strong>å¤„ç†æµï¼ˆProcessing Streamï¼‰</strong>ï¼Œå®ƒåœ¨åº•å±‚èŠ‚ç‚¹æµï¼ˆå¦‚æ–‡ä»¶æµã€ç½‘ç»œæµï¼‰çš„åŸºç¡€ä¸Šï¼Œå¢åŠ <strong>å†…å­˜ç¼“å†²åŒº</strong>ï¼Œé€šè¿‡<strong>æ‰¹é‡è¯»å†™æ•°æ®</strong>æ˜¾è‘—æå‡IOæ•ˆç‡ã€‚</p>
<h2 id="ç¼“å†²æµçš„æ ¸å¿ƒä½œç”¨">ç¼“å†²æµçš„æ ¸å¿ƒä½œç”¨</h2>
<h3 id="1-å‡å°‘ç‰©ç†ioæ¬¡æ•°">1. å‡å°‘ç‰©ç†IOæ¬¡æ•°</h3>
<p>è¿™æ˜¯ç¼“å†²æµæœ€é‡è¦çš„ä½œç”¨ã€‚è®©æˆ‘ä»¬é€šè¿‡å¯¹æ¯”æ¥ç†è§£ï¼š</p>
<h4 id="æ— ç¼“å†²æµçš„é—®é¢˜">æ— ç¼“å†²æµçš„é—®é¢˜</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// æ¯æ¬¡è¯»å–1å­—èŠ‚ï¼ˆæ€§èƒ½æå·®ï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="n">FileInputStream</span><span class="w"> </span><span class="n">fis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FileInputStream</span><span class="p">(</span><span class="s">&#34;largefile.bin&#34;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">data</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">((</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fis</span><span class="p">.</span><span class="na">read</span><span class="p">())</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">-</span><span class="n">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// æ¯è¯»1å­—èŠ‚è§¦å‘ä¸€æ¬¡ç£ç›˜IOæ“ä½œ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// è¯»å–1GBæ–‡ä»¶éœ€è¦çº¦10äº¿æ¬¡ç£ç›˜è®¿é—®</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="ä½¿ç”¨ç¼“å†²æµçš„ä¼˜åŠ¿">ä½¿ç”¨ç¼“å†²æµçš„ä¼˜åŠ¿</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// é»˜è®¤ç¼“å†²åŒº8KBï¼ˆä¸€æ¬¡æ€§è¯»å–8KBåˆ°å†…å­˜ï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="n">BufferedInputStream</span><span class="w"> </span><span class="n">bis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BufferedInputStream</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">FileInputStream</span><span class="p">(</span><span class="s">&#34;largefile.bin&#34;</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">data</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">((</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bis</span><span class="p">.</span><span class="na">read</span><span class="p">())</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">-</span><span class="n">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// ä»å†…å­˜ç¼“å†²åŒºè¯»å–ï¼Œç¼“å†²åŒºç©ºäº†æ‰ä¼šè§¦å‘ç£ç›˜IO</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// è¯»å–1GBæ–‡ä»¶åªéœ€è¦çº¦128,000æ¬¡ç£ç›˜è®¿é—®</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="2-æ€§èƒ½å¯¹æ¯”æ•°æ®">2. æ€§èƒ½å¯¹æ¯”æ•°æ®</h3>
<table>
  <thead>
      <tr>
          <th>åœºæ™¯</th>
          <th>ç‰©ç†IOæ¬¡æ•°</th>
          <th>è€—æ—¶</th>
          <th>æ€§èƒ½æå‡</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>è¯»å–1GBæ–‡ä»¶ï¼ˆæ— ç¼“å†²ï¼‰</td>
          <td>çº¦10äº¿æ¬¡æ“ä½œ</td>
          <td>&gt;60ç§’</td>
          <td>-</td>
      </tr>
      <tr>
          <td>è¯»å–1GBæ–‡ä»¶ï¼ˆ8KBç¼“å†²ï¼‰</td>
          <td>çº¦128,000æ¬¡æ“ä½œ</td>
          <td>&lt;1ç§’</td>
          <td><strong>60å€ä»¥ä¸Š</strong></td>
      </tr>
      <tr>
          <td>è¯»å–1GBæ–‡ä»¶ï¼ˆ64KBç¼“å†²ï¼‰</td>
          <td>çº¦16,000æ¬¡æ“ä½œ</td>
          <td>&lt;0.5ç§’</td>
          <td><strong>120å€ä»¥ä¸Š</strong></td>
      </tr>
  </tbody>
</table>
<h2 id="javaä¸­çš„ç¼“å†²æµç±»å‹">Javaä¸­çš„ç¼“å†²æµç±»å‹</h2>
<h3 id="ç¼“å†²æµå®¶æ—">ç¼“å†²æµå®¶æ—</h3>
<table>
  <thead>
      <tr>
          <th>ç±»å‹</th>
          <th>å¯¹åº”èŠ‚ç‚¹æµ</th>
          <th>åŠŸèƒ½è¯´æ˜</th>
          <th>é»˜è®¤ç¼“å†²åŒºå¤§å°</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>BufferedInputStream</code></td>
          <td><code>FileInputStream</code></td>
          <td>å­—èŠ‚è¾“å…¥ç¼“å†²æµ</td>
          <td>8KB</td>
      </tr>
      <tr>
          <td><code>BufferedOutputStream</code></td>
          <td><code>FileOutputStream</code></td>
          <td>å­—èŠ‚è¾“å‡ºç¼“å†²æµ</td>
          <td>8KB</td>
      </tr>
      <tr>
          <td><code>BufferedReader</code></td>
          <td><code>FileReader</code></td>
          <td>å­—ç¬¦è¾“å…¥ç¼“å†²æµï¼ˆæ”¯æŒæŒ‰è¡Œè¯»ï¼‰</td>
          <td>8KB</td>
      </tr>
      <tr>
          <td><code>BufferedWriter</code></td>
          <td><code>FileWriter</code></td>
          <td>å­—ç¬¦è¾“å‡ºç¼“å†²æµ</td>
          <td>8KB</td>
      </tr>
  </tbody>
</table>
<h2 id="ç¼“å†²æµçš„åº•å±‚åŸç†">ç¼“å†²æµçš„åº•å±‚åŸç†</h2>
<h3 id="1-è¯»å–ç¼“å†²æœºåˆ¶">1. è¯»å–ç¼“å†²æœºåˆ¶</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">BufferedInputStreamDemo</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">demonstrateBuffering</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="n">BufferedInputStream</span><span class="w"> </span><span class="n">bis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BufferedInputStream</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">new</span><span class="w"> </span><span class="n">FileInputStream</span><span class="p">(</span><span class="s">&#34;data.txt&#34;</span><span class="p">),</span><span class="w"> </span><span class="n">1024</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// 1KBç¼“å†²åŒº</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// å·¥ä½œæµç¨‹ï¼š</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// 1. åˆå§‹åŒ–ï¼šåˆ›å»º1KBç¼“å†²åŒº</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// 2. é¦–æ¬¡è¯»å–ï¼šä¸€æ¬¡æ€§ä»ç£ç›˜è¯»å–1KBæ•°æ®åˆ°ç¼“å†²åŒº</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// 3. åç»­è¯»å–ï¼šç›´æ¥ä»ç¼“å†²åŒºè¿”å›æ•°æ®ï¼ˆä¸è§¦å‘ç£ç›˜IOï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// 4. ç¼“å†²åŒºè€—å°½ï¼šå†æ¬¡è‡ªåŠ¨è¯»å–ä¸‹ä¸€æ‰¹1KBæ•°æ®</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">data</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="p">((</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bis</span><span class="p">.</span><span class="na">read</span><span class="p">())</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">-</span><span class="n">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="c1">// è¿™é‡Œçš„read()å¤§éƒ¨åˆ†æ—¶å€™æ˜¯ä»å†…å­˜ç¼“å†²åŒºè¯»å–</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">((</span><span class="kt">char</span><span class="p">)</span><span class="w"> </span><span class="n">data</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="2-å†™å…¥ç¼“å†²æœºåˆ¶">2. å†™å…¥ç¼“å†²æœºåˆ¶</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">BufferedOutputStreamDemo</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">demonstrateBuffering</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="n">BufferedOutputStream</span><span class="w"> </span><span class="n">bos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BufferedOutputStream</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">new</span><span class="w"> </span><span class="n">FileOutputStream</span><span class="p">(</span><span class="s">&#34;output.txt&#34;</span><span class="p">),</span><span class="w"> </span><span class="n">1024</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// 1KBç¼“å†²åŒº</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// å·¥ä½œæµç¨‹ï¼š</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;Hello, Buffered Stream!&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">data</span><span class="p">.</span><span class="na">toCharArray</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">bos</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">c</span><span class="p">);</span><span class="w"> </span><span class="c1">// æ•°æ®å…ˆå†™å…¥ç¼“å†²åŒºï¼ˆä¸ç«‹å³å†™å…¥ç£ç›˜ï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// ç¼“å†²åŒºæ»¡æ—¶ï¼šè‡ªåŠ¨å°†ç¼“å†²åŒºå†…å®¹å†™å…¥ç£ç›˜</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// æ‰‹åŠ¨åˆ·æ–°ï¼šé€šè¿‡flush()å¼ºåˆ¶ç«‹å³å†™å…¥</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">bos</span><span class="p">.</span><span class="na">flush</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// å…³é—­æµæ—¶ï¼šè‡ªåŠ¨åˆ·æ–°ç¼“å†²åŒº</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h2 id="ç¼“å†²æµçš„ä½¿ç”¨æ–¹æ³•">ç¼“å†²æµçš„ä½¿ç”¨æ–¹æ³•</h2>
<h3 id="1-å­—èŠ‚ç¼“å†²æµåŸºç¡€ç”¨æ³•">1. å­—èŠ‚ç¼“å†²æµåŸºç¡€ç”¨æ³•</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ByteBufferedStreamExample</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * ä½¿ç”¨ç¼“å†²æµå¤åˆ¶æ–‡ä»¶
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">copyFileWithBuffer</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">sourcePath</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">targetPath</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// åˆ›å»ºè¾“å…¥ç¼“å†²æµ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">FileInputStream</span><span class="w"> </span><span class="n">fis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FileInputStream</span><span class="p">(</span><span class="n">sourcePath</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">BufferedInputStream</span><span class="w"> </span><span class="n">bis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BufferedInputStream</span><span class="p">(</span><span class="n">fis</span><span class="p">,</span><span class="w"> </span><span class="n">16384</span><span class="p">);</span><span class="w"> </span><span class="c1">// 16KBç¼“å†²åŒº</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// åˆ›å»ºè¾“å‡ºç¼“å†²æµ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">FileOutputStream</span><span class="w"> </span><span class="n">fos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FileOutputStream</span><span class="p">(</span><span class="n">targetPath</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">BufferedOutputStream</span><span class="w"> </span><span class="n">bos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BufferedOutputStream</span><span class="p">(</span><span class="n">fos</span><span class="p">,</span><span class="w"> </span><span class="n">16384</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">buffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="n">1024</span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="c1">// é¢å¤–çš„è¯»å–ç¼“å†²åŒº</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">bytesRead</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="p">((</span><span class="n">bytesRead</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bis</span><span class="p">.</span><span class="na">read</span><span class="p">(</span><span class="n">buffer</span><span class="p">))</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">-</span><span class="n">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">bos</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="n">0</span><span class="p">,</span><span class="w"> </span><span class="n">bytesRead</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// ç¡®ä¿æ‰€æœ‰æ•°æ®éƒ½å†™å…¥ç£ç›˜</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">bos</span><span class="p">.</span><span class="na">flush</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">err</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;æ–‡ä»¶å¤åˆ¶å¤±è´¥: &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * æ€§èƒ½æµ‹è¯•ï¼šå¯¹æ¯”æœ‰æ— ç¼“å†²æµçš„æ€§èƒ½å·®å¼‚
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">performanceTest</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">filePath</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// æµ‹è¯•æ— ç¼“å†²æµ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kt">long</span><span class="w"> </span><span class="n">startTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="na">currentTimeMillis</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="n">FileInputStream</span><span class="w"> </span><span class="n">fis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FileInputStream</span><span class="p">(</span><span class="n">filePath</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">fis</span><span class="p">.</span><span class="na">read</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">-</span><span class="n">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="c1">// é€å­—èŠ‚è¯»å–</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kt">long</span><span class="w"> </span><span class="n">unbufferedTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="na">currentTimeMillis</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">startTime</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// æµ‹è¯•ç¼“å†²æµ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">startTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="na">currentTimeMillis</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="n">BufferedInputStream</span><span class="w"> </span><span class="n">bis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BufferedInputStream</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">new</span><span class="w"> </span><span class="n">FileInputStream</span><span class="p">(</span><span class="n">filePath</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">bis</span><span class="p">.</span><span class="na">read</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">-</span><span class="n">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="c1">// é€å­—èŠ‚è¯»å–ï¼ˆä½†æœ‰ç¼“å†²ï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kt">long</span><span class="w"> </span><span class="n">bufferedTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="na">currentTimeMillis</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">startTime</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;æ— ç¼“å†²æµè€—æ—¶: &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">unbufferedTime</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;ms&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;ç¼“å†²æµè€—æ—¶: &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">bufferedTime</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;ms&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;æ€§èƒ½æå‡: &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">unbufferedTime</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="kt">double</span><span class="p">)</span><span class="w"> </span><span class="n">bufferedTime</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;å€&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="2-å­—ç¬¦ç¼“å†²æµé«˜çº§åŠŸèƒ½">2. å­—ç¬¦ç¼“å†²æµé«˜çº§åŠŸèƒ½</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CharBufferedStreamExample</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * ä½¿ç”¨BufferedReaderæŒ‰è¡Œè¯»å–æ–‡æœ¬æ–‡ä»¶
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">readFileByLines</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">filePath</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">FileReader</span><span class="w"> </span><span class="n">fr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FileReader</span><span class="p">(</span><span class="n">filePath</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">BufferedReader</span><span class="w"> </span><span class="n">br</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BufferedReader</span><span class="p">(</span><span class="n">fr</span><span class="p">,</span><span class="w"> </span><span class="n">8192</span><span class="p">)</span><span class="w"> </span><span class="c1">// 8KBç¼“å†²åŒº</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">line</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">lineNumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// æŒ‰è¡Œè¯»å–ï¼Œè¿™æ˜¯BufferedReaderçš„ç‰¹è‰²åŠŸèƒ½</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="p">((</span><span class="n">line</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">br</span><span class="p">.</span><span class="na">readLine</span><span class="p">())</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">lineNumber</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;: &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">line</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">lineNumber</span><span class="o">++</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">err</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;è¯»å–æ–‡ä»¶å¤±è´¥: &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * ä½¿ç”¨BufferedWriterå†™å…¥æ–‡æœ¬æ–‡ä»¶
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">writeFileWithBuffer</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">filePath</span><span class="p">,</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">lines</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">FileWriter</span><span class="w"> </span><span class="n">fw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FileWriter</span><span class="p">(</span><span class="n">filePath</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">BufferedWriter</span><span class="w"> </span><span class="n">bw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BufferedWriter</span><span class="p">(</span><span class="n">fw</span><span class="p">,</span><span class="w"> </span><span class="n">8192</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">lines</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">bw</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">line</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">bw</span><span class="p">.</span><span class="na">newLine</span><span class="p">();</span><span class="w"> </span><span class="c1">// å†™å…¥ç³»ç»Ÿç›¸å…³çš„è¡Œåˆ†éš”ç¬¦</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// æ‰‹åŠ¨åˆ·æ–°ç¡®ä¿æ•°æ®å†™å…¥</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">bw</span><span class="p">.</span><span class="na">flush</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">err</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;å†™å…¥æ–‡ä»¶å¤±è´¥: &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * å¤„ç†å¤§æ–‡ä»¶çš„æµå¼è¯»å–
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">processLargeFile</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">filePath</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">FileReader</span><span class="w"> </span><span class="n">fr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FileReader</span><span class="p">(</span><span class="n">filePath</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">BufferedReader</span><span class="w"> </span><span class="n">br</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BufferedReader</span><span class="p">(</span><span class="n">fr</span><span class="p">,</span><span class="w"> </span><span class="n">65536</span><span class="p">)</span><span class="w"> </span><span class="c1">// 64KBç¼“å†²åŒº</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">line</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kt">long</span><span class="w"> </span><span class="n">lineCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kt">long</span><span class="w"> </span><span class="n">totalChars</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="p">((</span><span class="n">line</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">br</span><span class="p">.</span><span class="na">readLine</span><span class="p">())</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">lineCount</span><span class="o">++</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">totalChars</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">line</span><span class="p">.</span><span class="na">length</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="c1">// æ¯å¤„ç†10000è¡Œè¾“å‡ºä¸€æ¬¡è¿›åº¦</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lineCount</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">10000</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;å·²å¤„ç† &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lineCount</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34; è¡Œ&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="c1">// è¿™é‡Œå¯ä»¥æ·»åŠ å…·ä½“çš„ä¸šåŠ¡é€»è¾‘</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">processLine</span><span class="p">(</span><span class="n">line</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;æ–‡ä»¶å¤„ç†å®Œæˆ:&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;æ€»è¡Œæ•°: &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lineCount</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;æ€»å­—ç¬¦æ•°: &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">totalChars</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">err</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;å¤„ç†æ–‡ä»¶å¤±è´¥: &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">processLine</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">line</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// å…·ä½“çš„è¡Œå¤„ç†é€»è¾‘</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// ä¾‹å¦‚ï¼šæ•°æ®æ¸…æ´—ã€æ ¼å¼è½¬æ¢ã€ç»Ÿè®¡åˆ†æç­‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="3-è‡ªå®šä¹‰ç¼“å†²åŒºå¤§å°">3. è‡ªå®šä¹‰ç¼“å†²åŒºå¤§å°</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CustomBufferSizeExample</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * æ ¹æ®æ–‡ä»¶å¤§å°åŠ¨æ€è°ƒæ•´ç¼“å†²åŒºå¤§å°
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">copyWithOptimalBuffer</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">sourcePath</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">targetPath</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">File</span><span class="w"> </span><span class="n">sourceFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">File</span><span class="p">(</span><span class="n">sourcePath</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kt">long</span><span class="w"> </span><span class="n">fileSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sourceFile</span><span class="p">.</span><span class="na">length</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// æ ¹æ®æ–‡ä»¶å¤§å°é€‰æ‹©åˆé€‚çš„ç¼“å†²åŒºå¤§å°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">bufferSize</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fileSize</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">1024</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">1024</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">          </span><span class="c1">// å°äº1MB</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">bufferSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">4096</span><span class="p">;</span><span class="w">                  </span><span class="c1">// 4KBç¼“å†²åŒº</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fileSize</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">100</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">1024</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">1024</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// å°äº100MB</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">bufferSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">65536</span><span class="p">;</span><span class="w">                 </span><span class="c1">// 64KBç¼“å†²åŒº</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">                               </span><span class="c1">// å¤§äº100MB</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">bufferSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">1024</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">1024</span><span class="p">;</span><span class="w">          </span><span class="c1">// 1MBç¼“å†²åŒº</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">BufferedInputStream</span><span class="w"> </span><span class="n">bis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BufferedInputStream</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">new</span><span class="w"> </span><span class="n">FileInputStream</span><span class="p">(</span><span class="n">sourcePath</span><span class="p">),</span><span class="w"> </span><span class="n">bufferSize</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">BufferedOutputStream</span><span class="w"> </span><span class="n">bos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BufferedOutputStream</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">new</span><span class="w"> </span><span class="n">FileOutputStream</span><span class="p">(</span><span class="n">targetPath</span><span class="p">),</span><span class="w"> </span><span class="n">bufferSize</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">buffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="n">bufferSize</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">4</span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="c1">// è¯»å–ç¼“å†²åŒºä¸ºç¼“å†²æµçš„1/4</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">bytesRead</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="p">((</span><span class="n">bytesRead</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bis</span><span class="p">.</span><span class="na">read</span><span class="p">(</span><span class="n">buffer</span><span class="p">))</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">-</span><span class="n">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">bos</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="n">0</span><span class="p">,</span><span class="w"> </span><span class="n">bytesRead</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">err</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;æ–‡ä»¶å¤åˆ¶å¤±è´¥: &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h2 id="ç¼“å†²æµçš„æ³¨æ„äº‹é¡¹å’Œæœ€ä½³å®è·µ">ç¼“å†²æµçš„æ³¨æ„äº‹é¡¹å’Œæœ€ä½³å®è·µ</h2>
<h3 id="1-ç¼“å†²åŒºå¤§å°é€‰æ‹©">1. ç¼“å†²åŒºå¤§å°é€‰æ‹©</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">BufferSizeOptimization</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * æµ‹è¯•ä¸åŒç¼“å†²åŒºå¤§å°çš„æ€§èƒ½
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">testBufferSizes</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">filePath</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kt">int</span><span class="o">[]</span><span class="w"> </span><span class="n">bufferSizes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">1024</span><span class="p">,</span><span class="w"> </span><span class="n">4096</span><span class="p">,</span><span class="w"> </span><span class="n">8192</span><span class="p">,</span><span class="w"> </span><span class="n">16384</span><span class="p">,</span><span class="w"> </span><span class="n">32768</span><span class="p">,</span><span class="w"> </span><span class="n">65536</span><span class="p">};</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">bufferSize</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">bufferSizes</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kt">long</span><span class="w"> </span><span class="n">startTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="na">currentTimeMillis</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="n">BufferedInputStream</span><span class="w"> </span><span class="n">bis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BufferedInputStream</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="k">new</span><span class="w"> </span><span class="n">FileInputStream</span><span class="p">(</span><span class="n">filePath</span><span class="p">),</span><span class="w"> </span><span class="n">bufferSize</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">buffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="n">1024</span><span class="o">]</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">bis</span><span class="p">.</span><span class="na">read</span><span class="p">(</span><span class="n">buffer</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">-</span><span class="n">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="c1">// è¯»å–æ•°æ®</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kt">long</span><span class="w"> </span><span class="n">endTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="na">currentTimeMillis</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;ç¼“å†²åŒºå¤§å° &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">bufferSize</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34; å­—èŠ‚ï¼Œè€—æ—¶: &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">                             </span><span class="p">(</span><span class="n">endTime</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">startTime</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;ms&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="2-æ­£ç¡®çš„èµ„æºç®¡ç†">2. æ­£ç¡®çš„èµ„æºç®¡ç†</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ResourceManagementExample</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * æ­£ç¡®çš„èµ„æºç®¡ç†æ–¹å¼
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">correctResourceManagement</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">inputPath</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">outputPath</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// ä½¿ç”¨try-with-resourcesç¡®ä¿èµ„æºæ­£ç¡®å…³é—­</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// åªéœ€è¦å…³é—­æœ€å¤–å±‚çš„ç¼“å†²æµï¼Œå†…éƒ¨çš„èŠ‚ç‚¹æµä¼šè‡ªåŠ¨å…³é—­</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">BufferedReader</span><span class="w"> </span><span class="n">reader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BufferedReader</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">new</span><span class="w"> </span><span class="n">FileReader</span><span class="p">(</span><span class="n">inputPath</span><span class="p">),</span><span class="w"> </span><span class="n">16384</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">BufferedWriter</span><span class="w"> </span><span class="n">writer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BufferedWriter</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">new</span><span class="w"> </span><span class="n">FileWriter</span><span class="p">(</span><span class="n">outputPath</span><span class="p">),</span><span class="w"> </span><span class="n">16384</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">line</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="p">((</span><span class="n">line</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reader</span><span class="p">.</span><span class="na">readLine</span><span class="p">())</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">writer</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">line</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">writer</span><span class="p">.</span><span class="na">newLine</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// å†™å…¥æµéœ€è¦æ‰‹åŠ¨flushç¡®ä¿æ•°æ®å®Œå…¨å†™å…¥</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">writer</span><span class="p">.</span><span class="na">flush</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">err</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;æ–‡ä»¶æ“ä½œå¤±è´¥: &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// èµ„æºä¼šåœ¨è¿™é‡Œè‡ªåŠ¨å…³é—­</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * é”™è¯¯çš„èµ„æºç®¡ç†æ–¹å¼ï¼ˆä»…ä½œç¤ºä¾‹ï¼Œä¸è¦è¿™æ ·åšï¼‰
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">incorrectResourceManagement</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">inputPath</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">outputPath</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">BufferedReader</span><span class="w"> </span><span class="n">reader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">BufferedWriter</span><span class="w"> </span><span class="n">writer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">reader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BufferedReader</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">FileReader</span><span class="p">(</span><span class="n">inputPath</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">writer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BufferedWriter</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">FileWriter</span><span class="p">(</span><span class="n">outputPath</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">line</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="p">((</span><span class="n">line</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reader</span><span class="p">.</span><span class="na">readLine</span><span class="p">())</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">writer</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">line</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">writer</span><span class="p">.</span><span class="na">newLine</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// æ‰‹åŠ¨å…³é—­èµ„æºï¼Œå®¹æ˜“å‡ºé”™</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">reader</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="n">reader</span><span class="p">.</span><span class="na">close</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">writer</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="n">writer</span><span class="p">.</span><span class="na">close</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="3-å¼ºåˆ¶åˆ·æ–°ç¼“å†²åŒº">3. å¼ºåˆ¶åˆ·æ–°ç¼“å†²åŒº</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">FlushExample</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * æ¼”ç¤ºä½•æ—¶éœ€è¦æ‰‹åŠ¨åˆ·æ–°ç¼“å†²åŒº
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">demonstrateFlush</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">logPath</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="n">BufferedWriter</span><span class="w"> </span><span class="n">logWriter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BufferedWriter</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">new</span><span class="w"> </span><span class="n">FileWriter</span><span class="p">(</span><span class="n">logPath</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// è¿½åŠ æ¨¡å¼</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// å†™å…¥æ—¥å¿—</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">logWriter</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="s">&#34;[&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Date</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;] åº”ç”¨å¯åŠ¨&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">logWriter</span><span class="p">.</span><span class="na">newLine</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// é‡è¦ï¼šç«‹å³åˆ·æ–°ç¡®ä¿æ—¥å¿—å†™å…¥ç£ç›˜</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// å¦‚æœç¨‹åºå´©æºƒï¼Œæ²¡æœ‰flushçš„æ•°æ®å¯èƒ½ä¸¢å¤±</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">logWriter</span><span class="p">.</span><span class="na">flush</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// æ¨¡æ‹Ÿä¸€äº›æ“ä½œ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="n">1000</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">logWriter</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="s">&#34;[&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Date</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;] å¤„ç†ç”¨æˆ·è¯·æ±‚&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">logWriter</span><span class="p">.</span><span class="na">newLine</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">logWriter</span><span class="p">.</span><span class="na">flush</span><span class="p">();</span><span class="w"> </span><span class="c1">// å†æ¬¡åˆ·æ–°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">InterruptedException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * æ‰¹é‡å†™å…¥æ—¶çš„åˆ·æ–°ç­–ç•¥
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">batchWriteWithFlush</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">outputPath</span><span class="p">,</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="n">BufferedWriter</span><span class="w"> </span><span class="n">writer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BufferedWriter</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">new</span><span class="w"> </span><span class="n">FileWriter</span><span class="p">(</span><span class="n">outputPath</span><span class="p">),</span><span class="w"> </span><span class="n">32768</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// 32KBç¼“å†²åŒº</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">writer</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">item</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">writer</span><span class="p">.</span><span class="na">newLine</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">count</span><span class="o">++</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="c1">// æ¯å†™å…¥1000æ¡è®°å½•å°±åˆ·æ–°ä¸€æ¬¡</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">count</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">1000</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">writer</span><span class="p">.</span><span class="na">flush</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;å·²å†™å…¥ &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34; æ¡è®°å½•&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// æœ€åç¡®ä¿æ‰€æœ‰æ•°æ®éƒ½å†™å…¥</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">writer</span><span class="p">.</span><span class="na">flush</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h2 id="å®é™…åº”ç”¨åœºæ™¯">å®é™…åº”ç”¨åœºæ™¯</h2>
<h3 id="1-æ—¥å¿—æ–‡ä»¶å¤„ç†">1. æ—¥å¿—æ–‡ä»¶å¤„ç†</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">LogFileProcessor</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * åˆ†æå¤§å‹æ—¥å¿—æ–‡ä»¶
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">analyzeLogFile</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">logPath</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Integer</span><span class="o">&gt;</span><span class="w"> </span><span class="n">errorCounts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HashMap</span><span class="o">&lt;&gt;</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="n">BufferedReader</span><span class="w"> </span><span class="n">reader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BufferedReader</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">new</span><span class="w"> </span><span class="n">FileReader</span><span class="p">(</span><span class="n">logPath</span><span class="p">),</span><span class="w"> </span><span class="n">65536</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// 64KBç¼“å†²åŒº</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">line</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="p">((</span><span class="n">line</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reader</span><span class="p">.</span><span class="na">readLine</span><span class="p">())</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">line</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="s">&#34;ERROR&#34;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="c1">// æå–é”™è¯¯ç±»å‹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">String</span><span class="w"> </span><span class="n">errorType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">extractErrorType</span><span class="p">(</span><span class="n">line</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">errorCounts</span><span class="p">.</span><span class="na">merge</span><span class="p">(</span><span class="n">errorType</span><span class="p">,</span><span class="w"> </span><span class="n">1</span><span class="p">,</span><span class="w"> </span><span class="n">Integer</span><span class="p">::</span><span class="n">sum</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// è¾“å‡ºç»Ÿè®¡ç»“æœ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">errorCounts</span><span class="p">.</span><span class="na">forEach</span><span class="p">((</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="n">count</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">error</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;: &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34; æ¬¡&#34;</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">extractErrorType</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">logLine</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// ç®€å•çš„é”™è¯¯ç±»å‹æå–é€»è¾‘</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">logLine</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="s">&#34;NullPointerException&#34;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="s">&#34;NullPointerException&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">logLine</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="s">&#34;SQLException&#34;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="s">&#34;SQLException&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="s">&#34;Other&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="2-æ•°æ®æ–‡ä»¶è½¬æ¢">2. æ•°æ®æ–‡ä»¶è½¬æ¢</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">DataFileConverter</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * CSVæ–‡ä»¶æ ¼å¼è½¬æ¢
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">convertCsvFormat</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">inputPath</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">outputPath</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">BufferedReader</span><span class="w"> </span><span class="n">reader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BufferedReader</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">new</span><span class="w"> </span><span class="n">FileReader</span><span class="p">(</span><span class="n">inputPath</span><span class="p">),</span><span class="w"> </span><span class="n">32768</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">BufferedWriter</span><span class="w"> </span><span class="n">writer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BufferedWriter</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">new</span><span class="w"> </span><span class="n">FileWriter</span><span class="p">(</span><span class="n">outputPath</span><span class="p">),</span><span class="w"> </span><span class="n">32768</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">line</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kt">boolean</span><span class="w"> </span><span class="n">isFirstLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="p">((</span><span class="n">line</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reader</span><span class="p">.</span><span class="na">readLine</span><span class="p">())</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isFirstLine</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="c1">// å¤„ç†è¡¨å¤´</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">writer</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">convertHeader</span><span class="p">(</span><span class="n">line</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">isFirstLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="c1">// å¤„ç†æ•°æ®è¡Œ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">writer</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">convertDataLine</span><span class="p">(</span><span class="n">line</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">writer</span><span class="p">.</span><span class="na">newLine</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">convertHeader</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">header</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// è¡¨å¤´è½¬æ¢é€»è¾‘</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">header</span><span class="p">.</span><span class="na">replace</span><span class="p">(</span><span class="s">&#34;,&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;\t&#34;</span><span class="p">);</span><span class="w"> </span><span class="c1">// CSVè½¬TSV</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">convertDataLine</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">dataLine</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// æ•°æ®è¡Œè½¬æ¢é€»è¾‘</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">dataLine</span><span class="p">.</span><span class="na">replace</span><span class="p">(</span><span class="s">&#34;,&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;\t&#34;</span><span class="p">);</span><span class="w"> </span><span class="c1">// CSVè½¬TSV</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h2 id="æ€§èƒ½ä¼˜åŒ–å»ºè®®">æ€§èƒ½ä¼˜åŒ–å»ºè®®</h2>
<h3 id="1-ç¼“å†²åŒºå¤§å°ä¼˜åŒ–æŒ‡å—">1. ç¼“å†²åŒºå¤§å°ä¼˜åŒ–æŒ‡å—</h3>
<table>
  <thead>
      <tr>
          <th>æ–‡ä»¶å¤§å°</th>
          <th>æ¨èç¼“å†²åŒºå¤§å°</th>
          <th>è¯´æ˜</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>&lt; 1MB</td>
          <td>4KB - 8KB</td>
          <td>å°æ–‡ä»¶ä¸éœ€è¦å¤ªå¤§ç¼“å†²åŒº</td>
      </tr>
      <tr>
          <td>1MB - 100MB</td>
          <td>16KB - 64KB</td>
          <td>å¹³è¡¡å†…å­˜ä½¿ç”¨å’Œæ€§èƒ½</td>
      </tr>
      <tr>
          <td>&gt; 100MB</td>
          <td>64KB - 1MB</td>
          <td>å¤§æ–‡ä»¶å¯ä»¥ä½¿ç”¨æ›´å¤§ç¼“å†²åŒº</td>
      </tr>
      <tr>
          <td>ç½‘ç»œæµ</td>
          <td>8KB - 32KB</td>
          <td>è€ƒè™‘ç½‘ç»œå»¶è¿Ÿå’Œå¸¦å®½</td>
      </tr>
  </tbody>
</table>
<h3 id="2-é€‰æ‹©åˆé€‚çš„ç¼“å†²æµç±»å‹">2. é€‰æ‹©åˆé€‚çš„ç¼“å†²æµç±»å‹</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">StreamTypeSelection</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * æ ¹æ®ä½¿ç”¨åœºæ™¯é€‰æ‹©åˆé€‚çš„æµç±»å‹
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">chooseAppropriateStream</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// åœºæ™¯1ï¼šå¤„ç†äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆå›¾ç‰‡ã€è§†é¢‘ã€å‹ç¼©åŒ…ç­‰ï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// ä½¿ç”¨å­—èŠ‚ç¼“å†²æµ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="n">BufferedInputStream</span><span class="w"> </span><span class="n">bis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BufferedInputStream</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">new</span><span class="w"> </span><span class="n">FileInputStream</span><span class="p">(</span><span class="s">&#34;image.jpg&#34;</span><span class="p">),</span><span class="w"> </span><span class="n">32768</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// å¤„ç†äºŒè¿›åˆ¶æ•°æ®</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// åœºæ™¯2ï¼šå¤„ç†æ–‡æœ¬æ–‡ä»¶ï¼Œéœ€è¦æŒ‰è¡Œè¯»å–</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// ä½¿ç”¨å­—ç¬¦ç¼“å†²æµ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="n">BufferedReader</span><span class="w"> </span><span class="n">reader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BufferedReader</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">new</span><span class="w"> </span><span class="n">FileReader</span><span class="p">(</span><span class="s">&#34;data.txt&#34;</span><span class="p">),</span><span class="w"> </span><span class="n">16384</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">line</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="p">((</span><span class="n">line</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reader</span><span class="p">.</span><span class="na">readLine</span><span class="p">())</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="c1">// æŒ‰è¡Œå¤„ç†æ–‡æœ¬</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// åœºæ™¯3ï¼šç½‘ç»œæ•°æ®ä¼ è¾“</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// ä½¿ç”¨è¾ƒå°çš„ç¼“å†²åŒºï¼ŒåŠæ—¶å“åº”</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="n">BufferedOutputStream</span><span class="w"> </span><span class="n">bos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BufferedOutputStream</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">socket</span><span class="p">.</span><span class="na">getOutputStream</span><span class="p">(),</span><span class="w"> </span><span class="n">8192</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// ç½‘ç»œæ•°æ®ä¼ è¾“</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h2 id="æ€»ç»“">æ€»ç»“</h2>
<h3 id="ç¼“å†²æµçš„æ ¸å¿ƒä»·å€¼">ç¼“å†²æµçš„æ ¸å¿ƒä»·å€¼</h3>
<ul>
<li><strong>æ€§èƒ½æå‡</strong>ï¼šé€šè¿‡å†…å­˜ç¼“å†²åŒºå‡å°‘ç‰©ç†IOæ¬¡æ•°ï¼Œæ˜¾è‘—æå‡è¯»å†™æ€§èƒ½</li>
<li><strong>ä½¿ç”¨ç®€å•</strong>ï¼šåªéœ€è¦åŒ…è£…ç°æœ‰çš„èŠ‚ç‚¹æµï¼ŒAPIä½¿ç”¨æ–¹å¼åŸºæœ¬ä¸å˜</li>
<li><strong>é€‚ç”¨å¹¿æ³›</strong>ï¼šæ–‡ä»¶æ“ä½œã€ç½‘ç»œä¼ è¾“ã€æ—¥å¿—å¤„ç†ç­‰IOå¯†é›†å‹åœºæ™¯</li>
</ul>
<h3 id="æœ€ä½³å®è·µè¦ç‚¹">æœ€ä½³å®è·µè¦ç‚¹</h3>
<ol>
<li><strong>å§‹ç»ˆä¼˜å…ˆä½¿ç”¨ç¼“å†²æµ</strong>ï¼šé™¤éæœ‰ç‰¹æ®Šéœ€æ±‚ï¼Œå¦åˆ™æ€»æ˜¯ç”¨ç¼“å†²æµåŒ…è£…èŠ‚ç‚¹æµ</li>
<li><strong>åˆç†è®¾ç½®ç¼“å†²åŒºå¤§å°</strong>ï¼šæ ¹æ®æ–‡ä»¶å¤§å°å’Œä½¿ç”¨åœºæ™¯é€‰æ‹©åˆé€‚çš„ç¼“å†²åŒºå¤§å°</li>
<li><strong>æ­£ç¡®ç®¡ç†èµ„æº</strong>ï¼šä½¿ç”¨try-with-resourcesç¡®ä¿æµæ­£ç¡®å…³é—­</li>
<li><strong>åŠæ—¶åˆ·æ–°ç¼“å†²åŒº</strong>ï¼šå¯¹äºé‡è¦æ•°æ®ï¼ŒåŠæ—¶è°ƒç”¨flush()ç¡®ä¿æ•°æ®å†™å…¥</li>
<li><strong>é€‰æ‹©åˆé€‚çš„æµç±»å‹</strong>ï¼šæ ¹æ®æ•°æ®ç±»å‹é€‰æ‹©å­—èŠ‚æµæˆ–å­—ç¬¦æµ</li>
</ol>
<h3 id="æ€§èƒ½ä¼˜åŒ–å»ºè®®-1">æ€§èƒ½ä¼˜åŒ–å»ºè®®</h3>
<ul>
<li>å¯¹äºå¤§æ–‡ä»¶æ“ä½œï¼Œç¼“å†²æµèƒ½å¸¦æ¥æ•°åå€ç”šè‡³ä¸Šç™¾å€çš„æ€§èƒ½æå‡</li>
<li>åˆç†çš„ç¼“å†²åŒºå¤§å°é€šå¸¸åœ¨8KBåˆ°64KBä¹‹é—´</li>
<li>ç»“åˆå…·ä½“çš„ç¡¬ä»¶ç¯å¢ƒï¼ˆSSD vs HDDï¼‰å’Œç½‘ç»œæ¡ä»¶è¿›è¡Œè°ƒä¼˜</li>
</ul>
<p>æŒæ¡ç¼“å†²æµçš„ä½¿ç”¨æ˜¯Java IOç¼–ç¨‹çš„åŸºç¡€æŠ€èƒ½ï¼Œå®ƒä¸ä»…èƒ½æ˜¾è‘—æå‡ç¨‹åºæ€§èƒ½ï¼Œè¿˜èƒ½è®©ä»£ç æ›´åŠ ç®€æ´å’Œå¯ç»´æŠ¤ã€‚</p>
]]></content:encoded>
    </item>
    <item>
      <title>Javaç±»è®¾è®¡è¯¦è§£ï¼šEntityç±»ä¸JavaBeanè§„èŒƒ</title>
      <link>https://tyhzxh.github.io/posts/java-classes-and-beans/</link>
      <pubDate>Fri, 15 Mar 2024 14:30:00 +0800</pubDate>
      <guid>https://tyhzxh.github.io/posts/java-classes-and-beans/</guid>
      <description>æ·±å…¥è®²è§£Javaä¸­Entityç±»å’ŒJavaBeançš„è®¾è®¡è§„èŒƒï¼ŒåŒ…æ‹¬å®ä½“ç±»çš„ä½œç”¨ã€JavaBeanè§„èŒƒä»¥åŠæœ€ä½³å®è·µ</description>
      <content:encoded><![CDATA[<h2 id="javaç±»è®¾è®¡æ¦‚è¿°">Javaç±»è®¾è®¡æ¦‚è¿°</h2>
<p>åœ¨Javaå¼€å‘ä¸­ï¼Œè‰¯å¥½çš„ç±»è®¾è®¡æ˜¯æ„å»ºå¯ç»´æŠ¤ã€å¯æ‰©å±•åº”ç”¨ç¨‹åºçš„åŸºç¡€ã€‚æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»ä¸¤ç§é‡è¦çš„ç±»è®¾è®¡æ¨¡å¼ï¼šEntityç±»ï¼ˆå®ä½“ç±»ï¼‰å’ŒJavaBeanï¼Œä»¥åŠå®ƒä»¬åœ¨å®é™…å¼€å‘ä¸­çš„åº”ç”¨ã€‚</p>
<h2 id="entity-classå®ä½“ç±»">Entity Classï¼ˆå®ä½“ç±»ï¼‰</h2>
<h3 id="ä»€ä¹ˆæ˜¯å®ä½“ç±»">ä»€ä¹ˆæ˜¯å®ä½“ç±»ï¼Ÿ</h3>
<p><strong>å®ä½“ç±»ï¼ˆEntity Classï¼‰</strong> æ˜¯ä¸€ç§ç‰¹æ®Šçš„ç±»ï¼Œä¸»è¦ç”¨äºè¡¨ç¤º<strong>ä¸šåŠ¡é¢†åŸŸä¸­çš„å…·ä½“å¯¹è±¡</strong>ï¼ˆå¦‚ç”¨æˆ·ã€è®¢å•ã€å•†å“ç­‰ï¼‰ï¼Œå¹¶æ‰¿è½½ä¸è¿™äº›å¯¹è±¡ç›¸å…³çš„æ•°æ®ã€‚å®ƒçš„æ ¸å¿ƒç‰¹å¾æ˜¯ï¼š<strong>ç”¨å±æ€§æè¿°å¯¹è±¡ç‰¹å¾ï¼Œç”¨æ–¹æ³•å®šä¹‰ç®€å•è¡Œä¸º</strong>ã€‚</p>
<h3 id="å®ä½“ç±»ç¤ºä¾‹">å®ä½“ç±»ç¤ºä¾‹</h3>
<p>ä»¥RPCç¤ºä¾‹ä¸­çš„<code>User</code>ç±»ä¸ºä¾‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Data</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.Serializable</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Data</span><span class="w"> </span><span class="c1">// Lombokæ³¨è§£ï¼Œè‡ªåŠ¨ç”Ÿæˆgetter/setter/toStringç­‰æ–¹æ³•</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">User</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Serializable</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">serialVersionUID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">1L</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">;</span><span class="w">        </span><span class="c1">// ç”¨æˆ·ID</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span><span class="w">   </span><span class="c1">// ç”¨æˆ·å</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">email</span><span class="p">;</span><span class="w">  </span><span class="c1">// é‚®ç®±</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">age</span><span class="p">;</span><span class="w">       </span><span class="c1">// å¹´é¾„</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// æ— å‚æ„é€ å™¨ï¼ˆåºåˆ—åŒ–/ååºåˆ—åŒ–æ—¶éœ€è¦ï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">User</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// å…¨å‚æ„é€ å™¨ï¼ˆæ–¹ä¾¿åˆ›å»ºå¯¹è±¡ï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">User</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">email</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">age</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">id</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">email</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">age</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// éƒ¨åˆ†å‚æ•°æ„é€ å™¨</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">User</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">id</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="ä¸ºä»€ä¹ˆéœ€è¦å®ä½“ç±»">ä¸ºä»€ä¹ˆéœ€è¦å®ä½“ç±»ï¼Ÿ</h3>
<h4 id="1-æ•°æ®å°è£…">1. æ•°æ®å°è£…</h4>
<ul>
<li>å°†ç›¸å…³å±æ€§ï¼ˆå¦‚<code>id</code>ã€<code>name</code>ã€<code>email</code>ï¼‰èšåˆåœ¨ä¸€èµ·ï¼Œå½¢æˆæœ‰ä¸šåŠ¡æ„ä¹‰çš„å¯¹è±¡</li>
<li>æä¾›ç»Ÿä¸€çš„æ•°æ®è®¿é—®æ¥å£</li>
<li>éšè—å†…éƒ¨å®ç°ç»†èŠ‚</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// å¥½çš„è®¾è®¡ï¼šä½¿ç”¨å®ä½“ç±»</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">User</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">User</span><span class="p">(</span><span class="n">1</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;å¼ ä¸‰&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;zhangsan@example.com&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">25</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">userService</span><span class="p">.</span><span class="na">saveUser</span><span class="p">(</span><span class="n">user</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// ä¸å¥½çš„è®¾è®¡ï¼šåˆ†æ•£çš„å‚æ•°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">userService</span><span class="p">.</span><span class="na">saveUser</span><span class="p">(</span><span class="n">1</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;å¼ ä¸‰&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;zhangsan@example.com&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">25</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><h4 id="2-è·¨å±‚ä¼ è¾“">2. è·¨å±‚ä¼ è¾“</h4>
<ul>
<li>åœ¨RPCè°ƒç”¨ä¸­ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éœ€è¦é€šè¿‡ç½‘ç»œä¼ è¾“å¯¹è±¡</li>
<li>å®ä½“ç±»ä¼šè¢«<strong>åºåˆ—åŒ–</strong>ä¸ºå­—èŠ‚æµä¼ è¾“ï¼Œæ¥æ”¶æ–¹å†<strong>ååºåˆ—åŒ–</strong>è¿˜åŸå¯¹è±¡</li>
<li>æä¾›ç»Ÿä¸€çš„æ•°æ®ä¼ è¾“æ ¼å¼</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// RPCæœåŠ¡æ¥å£</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">UserService</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">User</span><span class="w"> </span><span class="nf">getUserById</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">);</span><span class="w">           </span><span class="c1">// è¿”å›å®ä½“ç±»</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">getAllUsers</span><span class="p">();</span><span class="w">           </span><span class="c1">// è¿”å›å®ä½“ç±»åˆ—è¡¨</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">saveUser</span><span class="p">(</span><span class="n">User</span><span class="w"> </span><span class="n">user</span><span class="p">);</span><span class="w">        </span><span class="c1">// æ¥æ”¶å®ä½“ç±»å‚æ•°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="3-æ¥å£å¥‘çº¦">3. æ¥å£å¥‘çº¦</h4>
<ul>
<li>å®šä¹‰æ˜ç¡®çš„å‚æ•°å’Œè¿”å›å€¼ç±»å‹</li>
<li>æä¾›ç±»å‹å®‰å…¨ä¿éšœ</li>
<li>ä¾¿äºAPIæ–‡æ¡£ç”Ÿæˆå’Œç»´æŠ¤</li>
</ul>
<h3 id="å®ä½“ç±»çš„è®¾è®¡è§„èŒƒ">å®ä½“ç±»çš„è®¾è®¡è§„èŒƒ</h3>
<table>
  <thead>
      <tr>
          <th>ç‰¹æ€§</th>
          <th>è¯´æ˜</th>
          <th>ç¤ºä¾‹</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>å®ç°<code>Serializable</code></td>
          <td>å¿…é¡»å®ç°åºåˆ—åŒ–æ¥å£ï¼Œå¦åˆ™æ— æ³•è·¨ç½‘ç»œä¼ è¾“</td>
          <td><code>implements Serializable</code></td>
      </tr>
      <tr>
          <td>æ— å‚æ„é€ å™¨</td>
          <td>åå°„å’Œååºåˆ—åŒ–æ—¶éœ€è¦é»˜è®¤æ„é€ å™¨</td>
          <td><code>public User() {}</code></td>
      </tr>
      <tr>
          <td>å±æ€§ç§æœ‰åŒ–</td>
          <td>é€šè¿‡getter/setterè®¿é—®å±æ€§ï¼Œä¿è¯å°è£…æ€§</td>
          <td><code>private String name;</code></td>
      </tr>
      <tr>
          <td>é¿å…ä¸šåŠ¡é€»è¾‘</td>
          <td>å®ä½“ç±»åº”åªåŒ…å«æ•°æ®ï¼Œä¸åŒ…å«å¤æ‚ä¸šåŠ¡æ–¹æ³•</td>
          <td>åªæœ‰ç®€å•çš„getter/setter</td>
      </tr>
      <tr>
          <td>ä½¿ç”¨Lombok</td>
          <td>æ¨èç”¨<code>@Data</code>è‡ªåŠ¨ç”Ÿæˆgetter/setterï¼Œå‡å°‘æ ·æ¿ä»£ç </td>
          <td><code>@Data</code></td>
      </tr>
      <tr>
          <td>åºåˆ—åŒ–ç‰ˆæœ¬å·</td>
          <td>æ·»åŠ <code>serialVersionUID</code>ç¡®ä¿åºåˆ—åŒ–å…¼å®¹æ€§</td>
          <td><code>private static final long serialVersionUID = 1L;</code></td>
      </tr>
  </tbody>
</table>
<h2 id="javabeanè§„èŒƒ">JavaBeanè§„èŒƒ</h2>
<h3 id="ä»€ä¹ˆæ˜¯javabean">ä»€ä¹ˆæ˜¯JavaBeanï¼Ÿ</h3>
<p>JavaBeanæ˜¯ç¬¦åˆç‰¹å®šè§„èŒƒçš„Javaç±»ï¼Œç”¨äº<strong>å°è£…æ•°æ®</strong>å’Œ<strong>å®šä¹‰å¯é‡ç”¨ç»„ä»¶</strong>ã€‚å®ƒæ˜¯Javaå¼€å‘ä¸­çš„ä¸€ç§è®¾è®¡æ ‡å‡†ï¼Œå¹¿æ³›åº”ç”¨äºå„ç§æ¡†æ¶å’Œå·¥å…·ä¸­ã€‚</p>
<h3 id="javabeanæ ¸å¿ƒè§„èŒƒ">JavaBeanæ ¸å¿ƒè§„èŒƒ</h3>
<table>
  <thead>
      <tr>
          <th>è§„èŒƒ</th>
          <th>è¯´æ˜</th>
          <th>ç¤ºä¾‹</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>æ— å‚æ„é€ å™¨</strong></td>
          <td>å¿…é¡»æä¾›é»˜è®¤æ„é€ å™¨ï¼ˆåå°„å®ä¾‹åŒ–æ—¶éœ€è¦ï¼‰</td>
          <td><code>public User() {}</code></td>
      </tr>
      <tr>
          <td><strong>å±æ€§ç§æœ‰åŒ–</strong></td>
          <td>å­—æ®µç”¨<code>private</code>ä¿®é¥°</td>
          <td><code>private String name;</code></td>
      </tr>
      <tr>
          <td><strong>å…¬å…±getter/setter</strong></td>
          <td>é€šè¿‡æ–¹æ³•è®¿é—®å±æ€§</td>
          <td><code>getName()</code>/<code>setName()</code></td>
      </tr>
      <tr>
          <td><strong>å®ç°<code>Serializable</code></strong></td>
          <td>å¯é€‰ï¼Œä½†é€šå¸¸å»ºè®®å®ç°ä»¥ä¾¿åºåˆ—åŒ–</td>
          <td><code>implements Serializable</code></td>
      </tr>
  </tbody>
</table>
<h3 id="æ ‡å‡†javabeanç¤ºä¾‹">æ ‡å‡†JavaBeanç¤ºä¾‹</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.Serializable</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">User</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Serializable</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">serialVersionUID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">1L</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// å±æ€§ç§æœ‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">email</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">active</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// æ— å‚æ„é€ å™¨</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">User</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// getter/setteræ–¹æ³•</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">getId</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">id</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setId</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">id</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getName</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">name</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setName</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getEmail</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">email</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setEmail</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">email</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">email</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isActive</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="c1">// booleanç±»å‹çš„getterä½¿ç”¨iså‰ç¼€</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">active</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setActive</span><span class="p">(</span><span class="kt">boolean</span><span class="w"> </span><span class="n">active</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">active</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">active</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// å¯é€‰ï¼šé‡å†™toStringã€equalsã€hashCode</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">toString</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&#34;User{&#34;</span><span class="w"> </span><span class="o">+</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="s">&#34;id=&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">+</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="s">&#34;, name=&#39;&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="sc">&#39;\&#39;&#39;</span><span class="w"> </span><span class="o">+</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="s">&#34;, email=&#39;&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">email</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="sc">&#39;\&#39;&#39;</span><span class="w"> </span><span class="o">+</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="s">&#34;, active=&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="o">+</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="sc">&#39;}&#39;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="javabeançš„ä¸»è¦ç”¨é€”">JavaBeançš„ä¸»è¦ç”¨é€”</h3>
<h4 id="1-guiç»„ä»¶">1. GUIç»„ä»¶</h4>
<p>åœ¨Swingç­‰GUIæ¡†æ¶ä¸­ï¼ŒJavaBeanç”¨äºåˆ›å»ºå¯é‡ç”¨çš„ç»„ä»¶ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// Swingä¸­çš„JavaBeanç»„ä»¶</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">JButton</span><span class="w"> </span><span class="n">button</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JButton</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">button</span><span class="p">.</span><span class="na">setText</span><span class="p">(</span><span class="s">&#34;ç‚¹å‡»æˆ‘&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">button</span><span class="p">.</span><span class="na">setEnabled</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">button</span><span class="p">.</span><span class="na">setVisible</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><h4 id="2-æ•°æ®å°è£…">2. æ•°æ®å°è£…</h4>
<p>åœ¨ORMæ¡†æ¶ï¼ˆå¦‚Hibernateã€MyBatisï¼‰ä¸­æ˜ å°„æ•°æ®åº“è¡¨ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Entity</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Table</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;users&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">User</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Serializable</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@GeneratedValue</span><span class="p">(</span><span class="n">strategy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GenerationType</span><span class="p">.</span><span class="na">IDENTITY</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Column</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;username&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// getter/setter...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="3-æ¡†æ¶é›†æˆ">3. æ¡†æ¶é›†æˆ</h4>
<p>Springç­‰æ¡†æ¶é€šè¿‡åå°„æ“ä½œJavaBeanï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Component</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">UserService</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Autowired</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">UserRepository</span><span class="w"> </span><span class="n">userRepository</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="nf">createUser</span><span class="p">(</span><span class="n">User</span><span class="w"> </span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// Springä¼šè‡ªåŠ¨æ³¨å…¥ä¾èµ–ï¼Œé€šè¿‡åå°„è°ƒç”¨setteræ–¹æ³•</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">userRepository</span><span class="p">.</span><span class="na">save</span><span class="p">(</span><span class="n">user</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h2 id="ä½¿ç”¨lombokç®€åŒ–å¼€å‘">ä½¿ç”¨Lombokç®€åŒ–å¼€å‘</h2>
<h3 id="lombokå¸¸ç”¨æ³¨è§£">Lombokå¸¸ç”¨æ³¨è§£</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">import</span><span class="w"> </span><span class="nn">lombok.*</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Data</span><span class="w">                    </span><span class="c1">// ç”Ÿæˆgetter/setter/toString/equals/hashCode</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@NoArgsConstructor</span><span class="w">      </span><span class="c1">// ç”Ÿæˆæ— å‚æ„é€ å™¨</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@AllArgsConstructor</span><span class="w">     </span><span class="c1">// ç”Ÿæˆå…¨å‚æ„é€ å™¨</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Builder</span><span class="w">                </span><span class="c1">// ç”Ÿæˆå»ºé€ è€…æ¨¡å¼</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">User</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Serializable</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">serialVersionUID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">1L</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">email</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">age</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Boolean</span><span class="w"> </span><span class="n">active</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="ä½¿ç”¨å»ºé€ è€…æ¨¡å¼åˆ›å»ºå¯¹è±¡">ä½¿ç”¨å»ºé€ è€…æ¨¡å¼åˆ›å»ºå¯¹è±¡</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// ä½¿ç”¨@Builderæ³¨è§£åï¼Œå¯ä»¥è¿™æ ·åˆ›å»ºå¯¹è±¡</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">User</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">User</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">.</span><span class="na">id</span><span class="p">(</span><span class="n">1L</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">.</span><span class="na">name</span><span class="p">(</span><span class="s">&#34;å¼ ä¸‰&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">.</span><span class="na">email</span><span class="p">(</span><span class="s">&#34;zhangsan@example.com&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">.</span><span class="na">age</span><span class="p">(</span><span class="n">25</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">.</span><span class="na">active</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">.</span><span class="na">build</span><span class="p">();</span><span class="w">
</span></span></span></code></pre></div><h2 id="æœ€ä½³å®è·µ">æœ€ä½³å®è·µ</h2>
<h3 id="1-å®ä½“ç±»è®¾è®¡åŸåˆ™">1. å®ä½“ç±»è®¾è®¡åŸåˆ™</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Data</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@NoArgsConstructor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@AllArgsConstructor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Builder</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Product</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Serializable</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">serialVersionUID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">1L</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// ä½¿ç”¨åŒ…è£…ç±»å‹ï¼Œé¿å…åŸºæœ¬ç±»å‹çš„é»˜è®¤å€¼é—®é¢˜</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">price</span><span class="p">;</span><span class="w">        </span><span class="c1">// é‡‘é¢ä½¿ç”¨BigDecimal</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">stock</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDateTime</span><span class="w"> </span><span class="n">createTime</span><span class="p">;</span><span class="w"> </span><span class="c1">// æ—¶é—´ä½¿ç”¨LocalDateTime</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Boolean</span><span class="w"> </span><span class="n">deleted</span><span class="p">;</span><span class="w">         </span><span class="c1">// é€»è¾‘åˆ é™¤æ ‡è®°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// å¯ä»¥æ·»åŠ ä¸€äº›ç®€å•çš„ä¸šåŠ¡æ–¹æ³•</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isInStock</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">stock</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">stock</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isDeleted</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Boolean</span><span class="p">.</span><span class="na">TRUE</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">deleted</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="2-éªŒè¯æ³¨è§£çš„ä½¿ç”¨">2. éªŒè¯æ³¨è§£çš„ä½¿ç”¨</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">import</span><span class="w"> </span><span class="nn">javax.validation.constraints.*</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Data</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@NoArgsConstructor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@AllArgsConstructor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">UserCreateRequest</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Serializable</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@NotBlank</span><span class="p">(</span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;ç”¨æˆ·åä¸èƒ½ä¸ºç©º&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Size</span><span class="p">(</span><span class="n">min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">2</span><span class="p">,</span><span class="w"> </span><span class="n">max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">20</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;ç”¨æˆ·åé•¿åº¦å¿…é¡»åœ¨2-20ä¹‹é—´&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@NotBlank</span><span class="p">(</span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;é‚®ç®±ä¸èƒ½ä¸ºç©º&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Email</span><span class="p">(</span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;é‚®ç®±æ ¼å¼ä¸æ­£ç¡®&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">email</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@NotNull</span><span class="p">(</span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;å¹´é¾„ä¸èƒ½ä¸ºç©º&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Min</span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">1</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;å¹´é¾„å¿…é¡»å¤§äº0&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Max</span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">150</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;å¹´é¾„ä¸èƒ½è¶…è¿‡150&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">age</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="3-åˆ†å±‚è®¾è®¡">3. åˆ†å±‚è®¾è®¡</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// DO (Data Object) - æ•°æ®åº“å®ä½“</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Entity</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Table</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;users&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">UserDO</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// æ•°æ®åº“å­—æ®µæ˜ å°„</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// DTO (Data Transfer Object) - æ•°æ®ä¼ è¾“å¯¹è±¡</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">UserDTO</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// ç”¨äºæœåŠ¡é—´ä¼ è¾“</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// VO (Value Object) - è§†å›¾å¯¹è±¡</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">UserVO</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// ç”¨äºå‰ç«¯å±•ç¤º</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// BO (Business Object) - ä¸šåŠ¡å¯¹è±¡</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">UserBO</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// ä¸šåŠ¡é€»è¾‘å¤„ç†</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h2 id="æ€»ç»“">æ€»ç»“</h2>
<h3 id="entityç±»çš„å…³é”®ç‚¹">Entityç±»çš„å…³é”®ç‚¹</h3>
<ul>
<li><strong>æ•°æ®å°è£…</strong>ï¼šå°†ç›¸å…³å±æ€§èšåˆæˆæœ‰æ„ä¹‰çš„ä¸šåŠ¡å¯¹è±¡</li>
<li><strong>è·¨å±‚ä¼ è¾“</strong>ï¼šæ”¯æŒåºåˆ—åŒ–ï¼Œä¾¿äºç½‘ç»œä¼ è¾“å’ŒæŒä¹…åŒ–</li>
<li><strong>æ¥å£å¥‘çº¦</strong>ï¼šæä¾›æ˜ç¡®çš„ç±»å‹å®šä¹‰å’ŒAPIå¥‘çº¦</li>
</ul>
<h3 id="javabeanè§„èŒƒçš„ä»·å€¼">JavaBeanè§„èŒƒçš„ä»·å€¼</h3>
<ul>
<li><strong>æ ‡å‡†åŒ–</strong>ï¼šæä¾›ç»Ÿä¸€çš„ç»„ä»¶è®¾è®¡è§„èŒƒ</li>
<li><strong>æ¡†æ¶å…¼å®¹</strong>ï¼šä¸å„ç§Javaæ¡†æ¶æ— ç¼é›†æˆ</li>
<li><strong>å·¥å…·æ”¯æŒ</strong>ï¼šIDEå’Œå¼€å‘å·¥å…·èƒ½å¤Ÿæ›´å¥½åœ°æ”¯æŒ</li>
</ul>
<h3 id="å¼€å‘å»ºè®®">å¼€å‘å»ºè®®</h3>
<ol>
<li><strong>ä¼˜å…ˆä½¿ç”¨Lombok</strong>ï¼šå‡å°‘æ ·æ¿ä»£ç ï¼Œæé«˜å¼€å‘æ•ˆç‡</li>
<li><strong>åˆç†åˆ†å±‚</strong>ï¼šæ ¹æ®ä¸åŒåœºæ™¯ä½¿ç”¨ä¸åŒçš„å¯¹è±¡ç±»å‹</li>
<li><strong>æ·»åŠ éªŒè¯</strong>ï¼šä½¿ç”¨Bean Validationè¿›è¡Œæ•°æ®æ ¡éªŒ</li>
<li><strong>æ³¨æ„åºåˆ—åŒ–</strong>ï¼šç¡®ä¿å®ä½“ç±»èƒ½å¤Ÿæ­£ç¡®åºåˆ—åŒ–å’Œååºåˆ—åŒ–</li>
<li><strong>éµå¾ªå‘½åè§„èŒƒ</strong>ï¼šä½¿ç”¨æ¸…æ™°ã€æœ‰æ„ä¹‰çš„ç±»åå’Œå±æ€§å</li>
</ol>
<p>é€šè¿‡éµå¾ªè¿™äº›è®¾è®¡åŸåˆ™å’Œæœ€ä½³å®è·µï¼Œå¯ä»¥åˆ›å»ºå‡ºç»“æ„æ¸…æ™°ã€æ˜“äºç»´æŠ¤çš„Javaç±»ï¼Œä¸ºæ•´ä¸ªåº”ç”¨ç¨‹åºçš„æ¶æ„å¥ å®šåšå®çš„åŸºç¡€ã€‚</p>
]]></content:encoded>
    </item>
    <item>
      <title>æ•°æ®åº“åŸºç¡€å…¥é—¨ï¼šä»æ¦‚å¿µåˆ°å®è·µ</title>
      <link>https://tyhzxh.github.io/posts/database-fundamentals/</link>
      <pubDate>Mon, 11 Mar 2024 12:32:05 +0800</pubDate>
      <guid>https://tyhzxh.github.io/posts/database-fundamentals/</guid>
      <description>æ•°æ®åº“åŸºç¡€çŸ¥è¯†å…¥é—¨æŒ‡å—ï¼ŒåŒ…æ‹¬åŸºæœ¬æ¦‚å¿µã€MySQLç¯å¢ƒæ­å»ºã€SQLè¯­æ³•è§„èŒƒã€æ•°æ®åº“åˆ›å»ºå’ŒåŸºæœ¬æ“ä½œï¼Œé€‚åˆåˆå­¦è€…ç³»ç»Ÿå­¦ä¹ æ•°æ®åº“æŠ€æœ¯</description>
      <content:encoded><![CDATA[<h2 id="æ•°æ®åº“å­¦ä¹ æ¦‚è¿°">æ•°æ®åº“å­¦ä¹ æ¦‚è¿°</h2>
<p>æ•°æ®åº“æ˜¯ç°ä»£è½¯ä»¶å¼€å‘çš„æ ¸å¿ƒæŠ€æœ¯ä¹‹ä¸€ï¼ŒæŒæ¡æ•°æ®åº“çŸ¥è¯†å¯¹äºä»»ä½•å¼€å‘è€…éƒ½è‡³å…³é‡è¦ã€‚æœ¬æ–‡å°†ä»åŸºç¡€æ¦‚å¿µå¼€å§‹ï¼Œé€æ­¥æ·±å…¥æ•°æ®åº“çš„æ ¸å¿ƒæŠ€æœ¯ã€‚</p>
<h2 id="å¼€å‘ç¯å¢ƒæ­å»º">å¼€å‘ç¯å¢ƒæ­å»º</h2>
<h3 id="æ¨èå·¥å…·ç»„åˆ">æ¨èå·¥å…·ç»„åˆ</h3>
<ol>
<li>
<p><strong>MySQL 8.3 Command Line Clientï¼ˆå‘½ä»¤è¡Œå·¥å…·ï¼‰</strong></p>
<ul>
<li>å®˜æ–¹å‘½ä»¤è¡Œå®¢æˆ·ç«¯</li>
<li>é€‚åˆå­¦ä¹ SQLè¯­æ³•å’Œæ‰§è¡Œè„šæœ¬</li>
<li>è½»é‡çº§ï¼Œå¯åŠ¨å¿«é€Ÿ</li>
</ul>
</li>
<li>
<p><strong>Navicat for MySQLï¼ˆå›¾å½¢åŒ–å·¥å…·ï¼‰</strong></p>
<ul>
<li>ç›´è§‚çš„å›¾å½¢ç•Œé¢</li>
<li>å†…ç½®å‘½ä»¤è¡ŒåŠŸèƒ½</li>
<li>æ”¯æŒæ•°æ®åº“è®¾è®¡å’Œç®¡ç†</li>
<li>é€‚åˆæ—¥å¸¸å¼€å‘å’Œç»´æŠ¤</li>
</ul>
</li>
</ol>
<h3 id="ç¯å¢ƒé…ç½®å»ºè®®">ç¯å¢ƒé…ç½®å»ºè®®</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># MySQLæœåŠ¡å¯åŠ¨</span>
</span></span><span class="line"><span class="cl">net start mysql
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¿æ¥åˆ°MySQLæœåŠ¡å™¨</span>
</span></span><span class="line"><span class="cl">mysql -u root -p
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹å½“å‰ç‰ˆæœ¬</span>
</span></span><span class="line"><span class="cl">SELECT VERSION<span class="o">()</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹å½“å‰ç”¨æˆ·</span>
</span></span><span class="line"><span class="cl">SELECT USER<span class="o">()</span><span class="p">;</span>
</span></span></code></pre></div><h2 id="æ•°æ®åº“åŸºæœ¬æ¦‚å¿µ">æ•°æ®åº“åŸºæœ¬æ¦‚å¿µ</h2>
<h3 id="æ ¸å¿ƒç»„ä»¶">æ ¸å¿ƒç»„ä»¶</h3>
<p>æ•°æ®åº“ç³»ç»ŸåŒ…å«ä»¥ä¸‹ä¸»è¦ç»„ä»¶ï¼š</p>
<table>
  <thead>
      <tr>
          <th>ç»„ä»¶</th>
          <th>åŠŸèƒ½è¯´æ˜</th>
          <th>åº”ç”¨åœºæ™¯</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>è¡¨ï¼ˆTableï¼‰</strong></td>
          <td>å­˜å‚¨æ•°æ®çš„åŸºæœ¬å•ä½</td>
          <td>ç”¨æˆ·ä¿¡æ¯ã€è®¢å•è®°å½•ç­‰</td>
      </tr>
      <tr>
          <td><strong>è§†å›¾ï¼ˆViewï¼‰</strong></td>
          <td>è™šæ‹Ÿè¡¨ï¼ŒåŸºäºæŸ¥è¯¢ç»“æœ</td>
          <td>æ•°æ®å±•ç¤ºã€æƒé™æ§åˆ¶</td>
      </tr>
      <tr>
          <td><strong>å­˜å‚¨è¿‡ç¨‹ï¼ˆProcedureï¼‰</strong></td>
          <td>é¢„ç¼–è¯‘çš„SQLä»£ç å—</td>
          <td>å¤æ‚ä¸šåŠ¡é€»è¾‘å¤„ç†</td>
      </tr>
      <tr>
          <td><strong>å‡½æ•°ï¼ˆFunctionï¼‰</strong></td>
          <td>è¿”å›å•ä¸€å€¼çš„ä»£ç å—</td>
          <td>æ•°æ®è®¡ç®—å’Œè½¬æ¢</td>
      </tr>
      <tr>
          <td><strong>è§¦å‘å™¨ï¼ˆTriggerï¼‰</strong></td>
          <td>è‡ªåŠ¨æ‰§è¡Œçš„ç‰¹æ®Šç¨‹åº</td>
          <td>æ•°æ®å®Œæ•´æ€§ç»´æŠ¤</td>
      </tr>
      <tr>
          <td><strong>äº‹ä»¶ï¼ˆEventï¼‰</strong></td>
          <td>å®šæ—¶æ‰§è¡Œçš„ä»»åŠ¡</td>
          <td>æ•°æ®æ¸…ç†ã€å¤‡ä»½ç­‰</td>
      </tr>
  </tbody>
</table>
<h3 id="åŸºæœ¬æ“ä½œç±»å‹crud">åŸºæœ¬æ“ä½œç±»å‹ï¼ˆCRUDï¼‰</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- Createï¼ˆåˆ›å»ºï¼‰
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">email</span><span class="p">)</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;å¼ ä¸‰&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;zhangsan@example.com&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- Readï¼ˆè¯»å–ï¼‰
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">18</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- Updateï¼ˆæ›´æ–°ï¼‰
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">UPDATE</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;newemail@example.com&#39;</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- Deleteï¼ˆåˆ é™¤ï¼‰
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h2 id="sqlè¯­æ³•è§„èŒƒ">SQLè¯­æ³•è§„èŒƒ</h2>
<h3 id="1-å¤§å°å†™è§„èŒƒ">1. å¤§å°å†™è§„èŒƒ</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- æ¨èå†™æ³•ï¼šå…³é”®å­—å¤§å†™ï¼Œè¡¨ååˆ—åå°å†™
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">email</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">users</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">18</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">name</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- ä¸æ¨èä½†å¯è¡Œçš„å†™æ³•
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="n">NAME</span><span class="p">,</span><span class="w"> </span><span class="n">EMAIL</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">USERS</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">AGE</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">18</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">NAME</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h3 id="2-è¯­å¥ç»“æŸç¬¦">2. è¯­å¥ç»“æŸç¬¦</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- æ¯æ¡SQLè¯­å¥å»ºè®®ç”¨åˆ†å·ç»“å°¾
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="n">testdb</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">USE</span><span class="w"> </span><span class="n">testdb</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><h3 id="3-æ ¼å¼åŒ–å’Œç¼©è¿›">3. æ ¼å¼åŒ–å’Œç¼©è¿›</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- è‰¯å¥½çš„æ ¼å¼åŒ–ç¤ºä¾‹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">u</span><span class="p">.</span><span class="n">id</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">u</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">u</span><span class="p">.</span><span class="n">email</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">p</span><span class="p">.</span><span class="n">title</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">position_title</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">users</span><span class="w"> </span><span class="n">u</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">positions</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">u</span><span class="p">.</span><span class="n">position_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">u</span><span class="p">.</span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;active&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">AND</span><span class="w"> </span><span class="n">u</span><span class="p">.</span><span class="n">created_date</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="s1">&#39;2024-01-01&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">u</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">ASC</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">u</span><span class="p">.</span><span class="n">created_date</span><span class="w"> </span><span class="k">DESC</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h3 id="4-æ³¨é‡Šè§„èŒƒ">4. æ³¨é‡Šè§„èŒƒ</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- å•è¡Œæ³¨é‡Šï¼šä½¿ç”¨ # å·
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">#</span><span class="w"> </span><span class="err">è¿™æ˜¯ä¸€ä¸ªå•è¡Œæ³¨é‡Š</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- å•è¡Œæ³¨é‡Šï¼šä½¿ç”¨åŒæ¨ªçº¿
</span></span></span><span class="line"><span class="cl"><span class="c1">-- è¿™ä¹Ÿæ˜¯ä¸€ä¸ªå•è¡Œæ³¨é‡Š
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cm">/* 
</span></span></span><span class="line"><span class="cl"><span class="cm">å¤šè¡Œæ³¨é‡Šï¼šä½¿ç”¨æ–œæ æ˜Ÿå·
</span></span></span><span class="line"><span class="cl"><span class="cm">å¯ä»¥è·¨è¶Šå¤šè¡Œ
</span></span></span><span class="line"><span class="cl"><span class="cm">é€‚åˆè¯¦ç»†è¯´æ˜
</span></span></span><span class="line"><span class="cl"><span class="cm">*/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- å®é™…åº”ç”¨ç¤ºä¾‹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span><span class="w">  </span><span class="c1">-- ç”¨æˆ·IDï¼Œè‡ªå¢ä¸»é”®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">          </span><span class="c1">-- ç”¨æˆ·å§“åï¼Œä¸èƒ½ä¸ºç©º
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="n">email</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="k">UNIQUE</span><span class="p">,</span><span class="w">          </span><span class="c1">-- é‚®ç®±åœ°å€ï¼Œå”¯ä¸€çº¦æŸ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="n">created_date</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w">  </span><span class="c1">-- åˆ›å»ºæ—¶é—´ï¼Œé»˜è®¤å½“å‰æ—¶é—´
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><h2 id="æ•°æ®åº“åˆ›å»ºå’Œç®¡ç†">æ•°æ®åº“åˆ›å»ºå’Œç®¡ç†</h2>
<h3 id="1-åˆ›å»ºæ•°æ®åº“">1. åˆ›å»ºæ•°æ®åº“</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- åŸºæœ¬åˆ›å»ºè¯­æ³•
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="n">studentinfo</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- å®Œæ•´çš„åˆ›å»ºè¯­æ³•ï¼ˆæ¨èï¼‰
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="n">studentinfo</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">DEFAULT</span><span class="w"> </span><span class="nb">CHARACTER</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">utf8mb4</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">COLLATE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">utf8mb4_unicode_ci</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- æŸ¥çœ‹åˆ›å»ºçš„æ•°æ®åº“
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SHOW</span><span class="w"> </span><span class="n">DATABASES</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- æŸ¥çœ‹æ•°æ®åº“è¯¦ç»†ä¿¡æ¯
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SHOW</span><span class="w"> </span><span class="k">CREATE</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="n">studentinfo</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h3 id="2-å­—ç¬¦é›†å’Œæ ¡å¯¹è§„åˆ™">2. å­—ç¬¦é›†å’Œæ ¡å¯¹è§„åˆ™</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- UTF-8å­—ç¬¦é›†ï¼ˆæ¨èï¼Œæ”¯æŒå…¨çƒå­—ç¬¦ï¼‰
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="n">modern_app</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">DEFAULT</span><span class="w"> </span><span class="nb">CHARACTER</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">utf8mb4</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">COLLATE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">utf8mb4_unicode_ci</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- ç®€ä½“ä¸­æ–‡å­—ç¬¦é›†
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="n">chinese_app</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">DEFAULT</span><span class="w"> </span><span class="nb">CHARACTER</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gb2312</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">COLLATE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gb2312_chinese_ci</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- æŸ¥çœ‹æ”¯æŒçš„å­—ç¬¦é›†
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SHOW</span><span class="w"> </span><span class="nb">CHARACTER</span><span class="w"> </span><span class="k">SET</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- æŸ¥çœ‹æ”¯æŒçš„æ ¡å¯¹è§„åˆ™
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SHOW</span><span class="w"> </span><span class="k">COLLATION</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h3 id="3-æ•°æ®åº“æ“ä½œ">3. æ•°æ®åº“æ“ä½œ</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- ä½¿ç”¨æ•°æ®åº“
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">USE</span><span class="w"> </span><span class="n">studentinfo</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- æŸ¥çœ‹å½“å‰ä½¿ç”¨çš„æ•°æ®åº“
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> </span><span class="k">DATABASE</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- åˆ é™¤æ•°æ®åº“ï¼ˆè°¨æ…æ“ä½œï¼‰
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">DROP</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="n">old_database</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- ä¿®æ”¹æ•°æ®åº“å­—ç¬¦é›†
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">ALTER</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="n">studentinfo</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nb">CHARACTER</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">utf8mb4</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">COLLATE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">utf8mb4_unicode_ci</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h2 id="è¡¨çš„åˆ›å»ºå’Œç®¡ç†">è¡¨çš„åˆ›å»ºå’Œç®¡ç†</h2>
<h3 id="1-åŸºæœ¬è¡¨ç»“æ„">1. åŸºæœ¬è¡¨ç»“æ„</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- å­¦ç”Ÿä¿¡æ¯è¡¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">students</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">student_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">student_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">student_email</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="k">UNIQUE</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">student_age</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">student_age</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">student_age</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">150</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">enrollment_date</span><span class="w"> </span><span class="nb">DATE</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="p">(</span><span class="k">CURRENT_DATE</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">status</span><span class="w"> </span><span class="n">ENUM</span><span class="p">(</span><span class="s1">&#39;active&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;inactive&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;graduated&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="s1">&#39;active&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">created_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">updated_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- è¯¾ç¨‹ä¿¡æ¯è¡¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">courses</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">course_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">course_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">course_code</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">UNIQUE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">credits</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">description</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">created_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- é€‰è¯¾å…³ç³»è¡¨ï¼ˆå¤šå¯¹å¤šå…³ç³»ï¼‰
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">enrollments</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">enrollment_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">student_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">course_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">enrollment_date</span><span class="w"> </span><span class="nb">DATE</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="p">(</span><span class="k">CURRENT_DATE</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">grade</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">grade</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">grade</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">100</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">status</span><span class="w"> </span><span class="n">ENUM</span><span class="p">(</span><span class="s1">&#39;enrolled&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;completed&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;dropped&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="s1">&#39;enrolled&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">student_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">students</span><span class="p">(</span><span class="n">student_id</span><span class="p">)</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">CASCADE</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">course_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">courses</span><span class="p">(</span><span class="n">course_id</span><span class="p">)</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">CASCADE</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">UNIQUE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="n">unique_enrollment</span><span class="w"> </span><span class="p">(</span><span class="n">student_id</span><span class="p">,</span><span class="w"> </span><span class="n">course_id</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><h3 id="2-æ•°æ®ç±»å‹é€‰æ‹©æŒ‡å—">2. æ•°æ®ç±»å‹é€‰æ‹©æŒ‡å—</h3>
<table>
  <thead>
      <tr>
          <th>æ•°æ®ç±»å‹</th>
          <th>é€‚ç”¨åœºæ™¯</th>
          <th>ç¤ºä¾‹</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>INT</code></td>
          <td>æ•´æ•°IDã€å¹´é¾„ã€æ•°é‡</td>
          <td><code>student_id INT AUTO_INCREMENT</code></td>
      </tr>
      <tr>
          <td><code>VARCHAR(n)</code></td>
          <td>å˜é•¿å­—ç¬¦ä¸²</td>
          <td><code>name VARCHAR(50)</code></td>
      </tr>
      <tr>
          <td><code>TEXT</code></td>
          <td>é•¿æ–‡æœ¬å†…å®¹</td>
          <td><code>description TEXT</code></td>
      </tr>
      <tr>
          <td><code>DECIMAL(m,d)</code></td>
          <td>ç²¾ç¡®å°æ•°</td>
          <td><code>price DECIMAL(10,2)</code></td>
      </tr>
      <tr>
          <td><code>DATE</code></td>
          <td>æ—¥æœŸ</td>
          <td><code>birth_date DATE</code></td>
      </tr>
      <tr>
          <td><code>TIMESTAMP</code></td>
          <td>æ—¶é—´æˆ³</td>
          <td><code>created_at TIMESTAMP</code></td>
      </tr>
      <tr>
          <td><code>ENUM</code></td>
          <td>æšä¸¾å€¼</td>
          <td><code>status ENUM('active', 'inactive')</code></td>
      </tr>
      <tr>
          <td><code>BOOLEAN</code></td>
          <td>å¸ƒå°”å€¼</td>
          <td><code>is_active BOOLEAN DEFAULT TRUE</code></td>
      </tr>
  </tbody>
</table>
<h3 id="3-çº¦æŸå’Œç´¢å¼•">3. çº¦æŸå’Œç´¢å¼•</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- æ·»åŠ çº¦æŸ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">students</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ADD</span><span class="w"> </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">chk_age</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">student_age</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">student_age</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">80</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- æ·»åŠ ç´¢å¼•
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_student_name</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">students</span><span class="p">(</span><span class="n">student_name</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_enrollment_date</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">students</span><span class="p">(</span><span class="n">enrollment_date</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- å¤åˆç´¢å¼•
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_student_status_date</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">students</span><span class="p">(</span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="n">enrollment_date</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- æŸ¥çœ‹è¡¨ç»“æ„
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">DESCRIBE</span><span class="w"> </span><span class="n">students</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SHOW</span><span class="w"> </span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">students</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- æŸ¥çœ‹ç´¢å¼•
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SHOW</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">students</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h2 id="åŸºæœ¬æŸ¥è¯¢æ“ä½œ">åŸºæœ¬æŸ¥è¯¢æ“ä½œ</h2>
<h3 id="1-ç®€å•æŸ¥è¯¢">1. ç®€å•æŸ¥è¯¢</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- æŸ¥è¯¢æ‰€æœ‰å­¦ç”Ÿ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">students</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- æŸ¥è¯¢ç‰¹å®šå­—æ®µ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">student_name</span><span class="p">,</span><span class="w"> </span><span class="n">student_email</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">students</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- æ¡ä»¶æŸ¥è¯¢
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">students</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">student_age</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- æ¨¡ç³ŠæŸ¥è¯¢
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">students</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">student_name</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;å¼ %&#39;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- èŒƒå›´æŸ¥è¯¢
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">students</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">student_age</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="mi">18</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="mi">25</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- å¤šæ¡ä»¶æŸ¥è¯¢
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">students</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;active&#39;</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">AND</span><span class="w"> </span><span class="n">student_age</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">18</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">AND</span><span class="w"> </span><span class="n">enrollment_date</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="s1">&#39;2024-01-01&#39;</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h3 id="2-æ’åºå’Œåˆ†é¡µ">2. æ’åºå’Œåˆ†é¡µ</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- æ’åº
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">students</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">student_age</span><span class="w"> </span><span class="k">DESC</span><span class="p">,</span><span class="w"> </span><span class="n">student_name</span><span class="w"> </span><span class="k">ASC</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- åˆ†é¡µæŸ¥è¯¢
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">students</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">student_id</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="k">OFFSET</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span><span class="w">  </span><span class="c1">-- è·³è¿‡å‰20æ¡ï¼Œå–10æ¡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- MySQLç‰¹æœ‰çš„åˆ†é¡µè¯­æ³•
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">students</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">student_id</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w">  </span><span class="c1">-- ä»ç¬¬21æ¡å¼€å§‹ï¼Œå–10æ¡
</span></span></span></code></pre></div><h3 id="3-èšåˆå‡½æ•°">3. èšåˆå‡½æ•°</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- ç»Ÿè®¡å‡½æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">total_students</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">status</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">status_types</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">AVG</span><span class="p">(</span><span class="n">student_age</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">average_age</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">MIN</span><span class="p">(</span><span class="n">student_age</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">youngest</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">MAX</span><span class="p">(</span><span class="n">student_age</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">oldest</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">SUM</span><span class="p">(</span><span class="k">CASE</span><span class="w"> </span><span class="k">WHEN</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;active&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">ELSE</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">END</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">active_count</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">students</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- åˆ†ç»„ç»Ÿè®¡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">status</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="k">count</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">AVG</span><span class="p">(</span><span class="n">student_age</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">avg_age</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">students</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">status</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">HAVING</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h2 id="æ•°æ®æ“ä½œå®è·µ">æ•°æ®æ“ä½œå®è·µ</h2>
<h3 id="1-æ’å…¥æ•°æ®">1. æ’å…¥æ•°æ®</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- å•æ¡æ’å…¥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">students</span><span class="w"> </span><span class="p">(</span><span class="n">student_name</span><span class="p">,</span><span class="w"> </span><span class="n">student_email</span><span class="p">,</span><span class="w"> </span><span class="n">student_age</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;å¼ ä¸‰&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;zhangsan@example.com&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- æ‰¹é‡æ’å…¥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">students</span><span class="w"> </span><span class="p">(</span><span class="n">student_name</span><span class="p">,</span><span class="w"> </span><span class="n">student_email</span><span class="p">,</span><span class="w"> </span><span class="n">student_age</span><span class="p">)</span><span class="w"> </span><span class="k">VALUES</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="s1">&#39;æå››&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;lisi@example.com&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">21</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="s1">&#39;ç‹äº”&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;wangwu@example.com&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">19</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="s1">&#39;èµµå…­&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;zhaoliu@example.com&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">22</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- ä»å…¶ä»–è¡¨æ’å…¥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">backup_students</span><span class="w"> </span><span class="p">(</span><span class="n">student_name</span><span class="p">,</span><span class="w"> </span><span class="n">student_email</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">student_name</span><span class="p">,</span><span class="w"> </span><span class="n">student_email</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">students</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;graduated&#39;</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h3 id="2-æ›´æ–°æ•°æ®">2. æ›´æ–°æ•°æ®</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- å•æ¡æ›´æ–°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">UPDATE</span><span class="w"> </span><span class="n">students</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SET</span><span class="w"> </span><span class="n">student_email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;new_email@example.com&#39;</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">student_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- æ‰¹é‡æ›´æ–°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">UPDATE</span><span class="w"> </span><span class="n">students</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SET</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;inactive&#39;</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">enrollment_date</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="s1">&#39;2020-01-01&#39;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- æ¡ä»¶æ›´æ–°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">UPDATE</span><span class="w"> </span><span class="n">students</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SET</span><span class="w"> </span><span class="n">student_age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">student_age</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="k">MONTH</span><span class="p">(</span><span class="n">enrollment_date</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">MONTH</span><span class="p">(</span><span class="k">CURRENT_DATE</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><h3 id="3-åˆ é™¤æ•°æ®">3. åˆ é™¤æ•°æ®</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- æ¡ä»¶åˆ é™¤
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">students</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;inactive&#39;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- æ¸…ç©ºè¡¨ï¼ˆä¿ç•™ç»“æ„ï¼‰
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">temp_students</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- åˆ é™¤è¡¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="n">old_table</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h2 id="æ•°æ®åº“è®¾è®¡æœ€ä½³å®è·µ">æ•°æ®åº“è®¾è®¡æœ€ä½³å®è·µ</h2>
<h3 id="1-å‘½åè§„èŒƒ">1. å‘½åè§„èŒƒ</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- è¡¨åï¼šä½¿ç”¨å¤æ•°å½¢å¼ï¼Œå°å†™å­—æ¯ï¼Œä¸‹åˆ’çº¿åˆ†éš”
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">user_profiles</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">order_items</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- å­—æ®µåï¼šå°å†™å­—æ¯ï¼Œä¸‹åˆ’çº¿åˆ†éš”ï¼Œæœ‰æ„ä¹‰çš„åç§°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">user_id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">first_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">last_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">email_address</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">phone_number</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">created_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">updated_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><h3 id="2-æ•°æ®å®Œæ•´æ€§">2. æ•°æ®å®Œæ•´æ€§</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- ä¸»é”®çº¦æŸ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">students</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">student_id</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- å¤–é”®çº¦æŸ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">enrollments</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ADD</span><span class="w"> </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">fk_student</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">student_id</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">students</span><span class="p">(</span><span class="n">student_id</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- å”¯ä¸€çº¦æŸ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">students</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">UNIQUE</span><span class="w"> </span><span class="p">(</span><span class="n">student_email</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- æ£€æŸ¥çº¦æŸ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">students</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ADD</span><span class="w"> </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">chk_age</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">student_age</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">student_age</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">150</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- éç©ºçº¦æŸ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">students</span><span class="w"> </span><span class="k">MODIFY</span><span class="w"> </span><span class="n">student_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h3 id="3-æ€§èƒ½ä¼˜åŒ–">3. æ€§èƒ½ä¼˜åŒ–</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- ä¸ºç»å¸¸æŸ¥è¯¢çš„å­—æ®µåˆ›å»ºç´¢å¼•
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_student_email</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">students</span><span class="p">(</span><span class="n">student_email</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_enrollment_date</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">students</span><span class="p">(</span><span class="n">enrollment_date</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- å¤åˆç´¢å¼•ç”¨äºå¤šå­—æ®µæŸ¥è¯¢
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_status_age</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">students</span><span class="p">(</span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="n">student_age</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- æŸ¥çœ‹æŸ¥è¯¢æ‰§è¡Œè®¡åˆ’
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">EXPLAIN</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">students</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">student_email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;test@example.com&#39;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- åˆ†æè¡¨ç»Ÿè®¡ä¿¡æ¯
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">ANALYZE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">students</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><h2 id="å­¦ä¹ è·¯å¾„å»ºè®®">å­¦ä¹ è·¯å¾„å»ºè®®</h2>
<h3 id="åˆçº§é˜¶æ®µ">åˆçº§é˜¶æ®µ</h3>
<ol>
<li><strong>åŸºç¡€æ¦‚å¿µ</strong>ï¼šç†è§£æ•°æ®åº“ã€è¡¨ã€å­—æ®µçš„æ¦‚å¿µ</li>
<li><strong>SQLè¯­æ³•</strong>ï¼šæŒæ¡SELECTã€INSERTã€UPDATEã€DELETE</li>
<li><strong>æ•°æ®ç±»å‹</strong>ï¼šäº†è§£å¸¸ç”¨æ•°æ®ç±»å‹çš„é€‰æ‹©</li>
<li><strong>ç®€å•æŸ¥è¯¢</strong>ï¼šæ¡ä»¶æŸ¥è¯¢ã€æ’åºã€åˆ†é¡µ</li>
</ol>
<h3 id="ä¸­çº§é˜¶æ®µ">ä¸­çº§é˜¶æ®µ</h3>
<ol>
<li><strong>è¡¨è®¾è®¡</strong>ï¼šä¸»é”®ã€å¤–é”®ã€çº¦æŸçš„ä½¿ç”¨</li>
<li><strong>å¤šè¡¨æŸ¥è¯¢</strong>ï¼šJOINæ“ä½œã€å­æŸ¥è¯¢</li>
<li><strong>å‡½æ•°åº”ç”¨</strong>ï¼šèšåˆå‡½æ•°ã€å­—ç¬¦ä¸²å‡½æ•°ã€æ—¥æœŸå‡½æ•°</li>
<li><strong>ç´¢å¼•ä¼˜åŒ–</strong>ï¼šç†è§£ç´¢å¼•åŸç†ï¼Œåˆ›å»ºåˆé€‚çš„ç´¢å¼•</li>
</ol>
<h3 id="é«˜çº§é˜¶æ®µ">é«˜çº§é˜¶æ®µ</h3>
<ol>
<li><strong>å­˜å‚¨è¿‡ç¨‹</strong>ï¼šç¼–å†™å¤æ‚çš„ä¸šåŠ¡é€»è¾‘</li>
<li><strong>è§¦å‘å™¨</strong>ï¼šè‡ªåŠ¨åŒ–æ•°æ®å¤„ç†</li>
<li><strong>è§†å›¾åº”ç”¨</strong>ï¼šç®€åŒ–å¤æ‚æŸ¥è¯¢</li>
<li><strong>æ€§èƒ½è°ƒä¼˜</strong>ï¼šæŸ¥è¯¢ä¼˜åŒ–ã€ç´¢å¼•ä¼˜åŒ–</li>
</ol>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>æ•°æ®åº“æŠ€æœ¯æ˜¯è½¯ä»¶å¼€å‘çš„åŸºçŸ³ï¼ŒæŒæ¡å¥½æ•°æ®åº“åŸºç¡€çŸ¥è¯†å¯¹äºä»»ä½•å¼€å‘è€…éƒ½è‡³å…³é‡è¦ã€‚é€šè¿‡ç³»ç»Ÿå­¦ä¹ å’Œå®è·µï¼Œä½ å°†èƒ½å¤Ÿï¼š</p>
<ul>
<li>è®¾è®¡åˆç†çš„æ•°æ®åº“ç»“æ„</li>
<li>ç¼–å†™é«˜æ•ˆçš„SQLæŸ¥è¯¢</li>
<li>ä¼˜åŒ–æ•°æ®åº“æ€§èƒ½</li>
<li>ç¡®ä¿æ•°æ®çš„å®Œæ•´æ€§å’Œå®‰å…¨æ€§</li>
</ul>
<p>å»ºè®®åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­å¤šåŠ¨æ‰‹å®è·µï¼Œé€šè¿‡å®é™…é¡¹ç›®æ¥å·©å›ºç†è®ºçŸ¥è¯†ï¼Œé€æ­¥æå‡æ•°æ®åº“åº”ç”¨èƒ½åŠ›ã€‚</p>
]]></content:encoded>
    </item>
    <item>
      <title>Javaæ¥å£è¯¦è§£ï¼šä»åŸºç¡€æ¦‚å¿µåˆ°é«˜çº§åº”ç”¨</title>
      <link>https://tyhzxh.github.io/posts/java-interfaces-guide/</link>
      <pubDate>Wed, 28 Feb 2024 15:00:00 +0800</pubDate>
      <guid>https://tyhzxh.github.io/posts/java-interfaces-guide/</guid>
      <description>æ·±å…¥è§£æJavaæ¥å£çš„æ¦‚å¿µã€ç‰¹æ€§ã€åº”ç”¨åœºæ™¯å’Œæœ€ä½³å®è·µï¼ŒåŒ…æ‹¬æ ‡è®°æ¥å£ã€å‡½æ•°å¼æ¥å£ã€é»˜è®¤æ–¹æ³•ç­‰é«˜çº§ç‰¹æ€§</description>
      <content:encoded><![CDATA[<h2 id="javaæ¥å£æ¦‚è¿°">Javaæ¥å£æ¦‚è¿°</h2>
<p>**æ¥å£ï¼ˆInterfaceï¼‰**æ˜¯Javaä¸­å®ç°å¤šé‡ç»§æ‰¿å’Œå®šä¹‰å¥‘çº¦çš„é‡è¦æœºåˆ¶ã€‚æ¥å£å®šä¹‰äº†ç±»å¿…é¡»å®ç°çš„æ–¹æ³•ç­¾åï¼Œä½†ä¸æä¾›å…·ä½“å®ç°ï¼ˆé™¤äº†é»˜è®¤æ–¹æ³•å’Œé™æ€æ–¹æ³•ï¼‰ã€‚æ¥å£æ˜¯Javaé¢å‘å¯¹è±¡ç¼–ç¨‹çš„æ ¸å¿ƒæ¦‚å¿µä¹‹ä¸€ã€‚</p>
<h3 id="æ¥å£çš„åŸºæœ¬ç‰¹æ€§">æ¥å£çš„åŸºæœ¬ç‰¹æ€§</h3>
<table>
  <thead>
      <tr>
          <th>ç‰¹æ€§</th>
          <th>æè¿°</th>
          <th>ç¤ºä¾‹</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>æŠ½è±¡æ€§</strong></td>
          <td>æ¥å£ä¸­çš„æ–¹æ³•é»˜è®¤æ˜¯æŠ½è±¡çš„</td>
          <td><code>void method();</code></td>
      </tr>
      <tr>
          <td><strong>å¤šé‡å®ç°</strong></td>
          <td>ä¸€ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£</td>
          <td><code>class A implements B, C</code></td>
      </tr>
      <tr>
          <td><strong>å¸¸é‡å®šä¹‰</strong></td>
          <td>æ¥å£ä¸­çš„å˜é‡é»˜è®¤æ˜¯å¸¸é‡</td>
          <td><code>int CONSTANT = 10;</code></td>
      </tr>
      <tr>
          <td><strong>ç»§æ‰¿å…³ç³»</strong></td>
          <td>æ¥å£å¯ä»¥ç»§æ‰¿å…¶ä»–æ¥å£</td>
          <td><code>interface A extends B</code></td>
      </tr>
      <tr>
          <td><strong>å¤šæ€æ”¯æŒ</strong></td>
          <td>æ¥å£å¼•ç”¨å¯ä»¥æŒ‡å‘å®ç°ç±»å¯¹è±¡</td>
          <td><code>Interface obj = new Implementation();</code></td>
      </tr>
  </tbody>
</table>
<h2 id="æ¥å£çš„åŸºæœ¬è¯­æ³•">æ¥å£çš„åŸºæœ¬è¯­æ³•</h2>
<h3 id="æ¥å£å®šä¹‰å’Œå®ç°">æ¥å£å®šä¹‰å’Œå®ç°</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// åŸºæœ¬æ¥å£å®šä¹‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">Drawable</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// å¸¸é‡ï¼ˆé»˜è®¤ public static finalï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">DEFAULT_COLOR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;BLACK&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">MAX_SIZE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">1000</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// æŠ½è±¡æ–¹æ³•ï¼ˆé»˜è®¤ public abstractï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">draw</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setColor</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">color</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">resize</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">width</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">height</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// é»˜è®¤æ–¹æ³•ï¼ˆJava 8+ï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">default</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">reset</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">setColor</span><span class="p">(</span><span class="n">DEFAULT_COLOR</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;å›¾å½¢å·²é‡ç½®ä¸ºé»˜è®¤çŠ¶æ€&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// é™æ€æ–¹æ³•ï¼ˆJava 8+ï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">printInfo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;è¿™æ˜¯ä¸€ä¸ªå¯ç»˜åˆ¶æ¥å£&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// ç§æœ‰æ–¹æ³•ï¼ˆJava 9+ï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">validateColor</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">color</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">color</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalArgumentException</span><span class="p">(</span><span class="s">&#34;é¢œè‰²ä¸èƒ½ä¸ºç©º&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// æ¥å£å®ç°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Circle</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Drawable</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">color</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">radius</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Circle</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">radius</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">radius</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">radius</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULT_COLOR</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">draw</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;ç»˜åˆ¶ä¸€ä¸ª&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;çš„åœ†å½¢ï¼ŒåŠå¾„ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">radius</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setColor</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">color</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">color</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">resize</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">width</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">height</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// å¯¹äºåœ†å½¢ï¼Œä½¿ç”¨è¾ƒå°çš„å€¼ä½œä¸ºåŠå¾„</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">radius</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Math</span><span class="p">.</span><span class="na">min</span><span class="p">(</span><span class="n">width</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">2</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// å¯ä»¥é‡å†™é»˜è®¤æ–¹æ³•</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">reset</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">radius</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">10</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Drawable</span><span class="p">.</span><span class="na">super</span><span class="p">.</span><span class="na">reset</span><span class="p">();</span><span class="w"> </span><span class="c1">// è°ƒç”¨æ¥å£çš„é»˜è®¤å®ç°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// å¤šæ¥å£å®ç°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">Movable</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">move</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">stop</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">Rotatable</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">rotate</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">angle</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Shape</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Drawable</span><span class="p">,</span><span class="w"> </span><span class="n">Movable</span><span class="p">,</span><span class="w"> </span><span class="n">Rotatable</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Drawable</span><span class="p">.</span><span class="na">DEFAULT_COLOR</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">rotation</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">draw</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;ç»˜åˆ¶å½¢çŠ¶åœ¨ä½ç½® (&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;, &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;)ï¼Œæ—‹è½¬è§’åº¦ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rotation</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setColor</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">color</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">color</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">resize</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">width</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">height</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;è°ƒæ•´å¤§å°ä¸ºï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">width</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;x&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">height</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">move</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;ç§»åŠ¨åˆ°ä½ç½®ï¼š(&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;, &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;)&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">stop</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;åœæ­¢ç§»åŠ¨&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">rotate</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">angle</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">rotation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">angle</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;æ—‹è½¬è§’åº¦ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">angle</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;åº¦&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// ä½¿ç”¨ç¤ºä¾‹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">InterfaceExample</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// å¤šæ€ä½¿ç”¨</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Drawable</span><span class="w"> </span><span class="n">drawable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Circle</span><span class="p">(</span><span class="n">5</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">drawable</span><span class="p">.</span><span class="na">draw</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">drawable</span><span class="p">.</span><span class="na">setColor</span><span class="p">(</span><span class="s">&#34;RED&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">drawable</span><span class="p">.</span><span class="na">draw</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">drawable</span><span class="p">.</span><span class="na">reset</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// é™æ€æ–¹æ³•è°ƒç”¨</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Drawable</span><span class="p">.</span><span class="na">printInfo</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// å¤šæ¥å£å®ç°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Shape</span><span class="w"> </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Shape</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">shape</span><span class="p">.</span><span class="na">draw</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">shape</span><span class="p">.</span><span class="na">move</span><span class="p">(</span><span class="n">10</span><span class="p">,</span><span class="w"> </span><span class="n">20</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">shape</span><span class="p">.</span><span class="na">rotate</span><span class="p">(</span><span class="n">45</span><span class="p">.</span><span class="na">0</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// æ¥å£å¼•ç”¨</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Movable</span><span class="w"> </span><span class="n">movable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">shape</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">movable</span><span class="p">.</span><span class="na">move</span><span class="p">(</span><span class="n">30</span><span class="p">,</span><span class="w"> </span><span class="n">40</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Rotatable</span><span class="w"> </span><span class="n">rotatable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">shape</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">rotatable</span><span class="p">.</span><span class="na">rotate</span><span class="p">(</span><span class="n">90</span><span class="p">.</span><span class="na">0</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h2 id="æ ‡è®°æ¥å£è¯¦è§£">æ ‡è®°æ¥å£è¯¦è§£</h2>
<h3 id="serializableæ¥å£">Serializableæ¥å£</h3>
<p><strong>Serializable</strong>æ˜¯Javaä¸­æœ€é‡è¦çš„æ ‡è®°æ¥å£ä¹‹ä¸€ï¼Œç”¨äºæ ‡è¯†ç±»çš„å¯¹è±¡å¯ä»¥è¢«åºåˆ—åŒ–ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.*</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.*</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// å®ç°Serializableæ¥å£</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Person</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Serializable</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// åºåˆ—åŒ–ç‰ˆæœ¬å·</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">serialVersionUID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">1L</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">age</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">transient</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">password</span><span class="p">;</span><span class="w"> </span><span class="c1">// transientå­—æ®µä¸ä¼šè¢«åºåˆ—åŒ–</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">company</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;TechCorp&#34;</span><span class="p">;</span><span class="w"> </span><span class="c1">// staticå­—æ®µä¸ä¼šè¢«åºåˆ—åŒ–</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Person</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">password</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">age</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">password</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// è‡ªå®šä¹‰åºåˆ—åŒ–æ–¹æ³•</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">writeObject</span><span class="p">(</span><span class="n">ObjectOutputStream</span><span class="w"> </span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">out</span><span class="p">.</span><span class="na">defaultWriteObject</span><span class="p">();</span><span class="w"> </span><span class="c1">// æ‰§è¡Œé»˜è®¤åºåˆ—åŒ–</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// å¯ä»¥æ·»åŠ è‡ªå®šä¹‰åºåˆ—åŒ–é€»è¾‘</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">out</span><span class="p">.</span><span class="na">writeObject</span><span class="p">(</span><span class="n">encrypt</span><span class="p">(</span><span class="n">password</span><span class="p">));</span><span class="w"> </span><span class="c1">// åŠ å¯†å¯†ç ååºåˆ—åŒ–</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// è‡ªå®šä¹‰ååºåˆ—åŒ–æ–¹æ³•</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">readObject</span><span class="p">(</span><span class="n">ObjectInputStream</span><span class="w"> </span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="p">,</span><span class="w"> </span><span class="n">ClassNotFoundException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">in</span><span class="p">.</span><span class="na">defaultReadObject</span><span class="p">();</span><span class="w"> </span><span class="c1">// æ‰§è¡Œé»˜è®¤ååºåˆ—åŒ–</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// å¯ä»¥æ·»åŠ è‡ªå®šä¹‰ååºåˆ—åŒ–é€»è¾‘</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">encryptedPassword</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="p">)</span><span class="w"> </span><span class="n">in</span><span class="p">.</span><span class="na">readObject</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">decrypt</span><span class="p">(</span><span class="n">encryptedPassword</span><span class="p">);</span><span class="w"> </span><span class="c1">// è§£å¯†å¯†ç </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">encrypt</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">text</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// ç®€å•çš„åŠ å¯†ç¤ºä¾‹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Base64</span><span class="p">.</span><span class="na">getEncoder</span><span class="p">().</span><span class="na">encodeToString</span><span class="p">(</span><span class="n">text</span><span class="p">.</span><span class="na">getBytes</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">decrypt</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">encryptedText</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// ç®€å•çš„è§£å¯†ç¤ºä¾‹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">String</span><span class="p">(</span><span class="n">Base64</span><span class="p">.</span><span class="na">getDecoder</span><span class="p">().</span><span class="na">decode</span><span class="p">(</span><span class="n">encryptedText</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">toString</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&#34;Person{name=&#39;&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;&#39;, age=&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="o">+</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">               </span><span class="s">&#34;, password=&#39;&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;&#39;, company=&#39;&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">company</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;&#39;}&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// Getters and setters</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getName</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">name</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setName</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">getAge</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">age</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setAge</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">age</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">age</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getPassword</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">password</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setPassword</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">password</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">password</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// åºåˆ—åŒ–å·¥å…·ç±»</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SerializationUtil</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="n">Object</span><span class="w"> </span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">filename</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="n">FileOutputStream</span><span class="w"> </span><span class="n">fos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FileOutputStream</span><span class="p">(</span><span class="n">filename</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">             </span><span class="n">ObjectOutputStream</span><span class="w"> </span><span class="n">oos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ObjectOutputStream</span><span class="p">(</span><span class="n">fos</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">oos</span><span class="p">.</span><span class="na">writeObject</span><span class="p">(</span><span class="n">obj</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;å¯¹è±¡å·²åºåˆ—åŒ–åˆ°æ–‡ä»¶ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">filename</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="nf">deserialize</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">filename</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="p">,</span><span class="w"> </span><span class="n">ClassNotFoundException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="n">FileInputStream</span><span class="w"> </span><span class="n">fis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FileInputStream</span><span class="p">(</span><span class="n">filename</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">             </span><span class="n">ObjectInputStream</span><span class="w"> </span><span class="n">ois</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ObjectInputStream</span><span class="p">(</span><span class="n">fis</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">Object</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ois</span><span class="p">.</span><span class="na">readObject</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;å¯¹è±¡å·²ä»æ–‡ä»¶ååºåˆ—åŒ–ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">filename</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">obj</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="nf">serializeToBytes</span><span class="p">(</span><span class="n">Object</span><span class="w"> </span><span class="n">obj</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="n">ByteArrayOutputStream</span><span class="w"> </span><span class="n">baos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ByteArrayOutputStream</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">             </span><span class="n">ObjectOutputStream</span><span class="w"> </span><span class="n">oos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ObjectOutputStream</span><span class="p">(</span><span class="n">baos</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">oos</span><span class="p">.</span><span class="na">writeObject</span><span class="p">(</span><span class="n">obj</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">baos</span><span class="p">.</span><span class="na">toByteArray</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="nf">deserializeFromBytes</span><span class="p">(</span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="p">,</span><span class="w"> </span><span class="n">ClassNotFoundException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="n">ByteArrayInputStream</span><span class="w"> </span><span class="n">bais</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ByteArrayInputStream</span><span class="p">(</span><span class="n">data</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">             </span><span class="n">ObjectInputStream</span><span class="w"> </span><span class="n">ois</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ObjectInputStream</span><span class="p">(</span><span class="n">bais</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">ois</span><span class="p">.</span><span class="na">readObject</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// åºåˆ—åŒ–ç¤ºä¾‹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SerializationExample</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// åˆ›å»ºå¯¹è±¡</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">Person</span><span class="w"> </span><span class="n">person</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Person</span><span class="p">(</span><span class="s">&#34;å¼ ä¸‰&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">25</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;secret123&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;åŸå§‹å¯¹è±¡ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">person</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// åºåˆ—åŒ–åˆ°æ–‡ä»¶</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">SerializationUtil</span><span class="p">.</span><span class="na">serialize</span><span class="p">(</span><span class="n">person</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;person.ser&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// ä»æ–‡ä»¶ååºåˆ—åŒ–</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">Person</span><span class="w"> </span><span class="n">deserializedPerson</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Person</span><span class="p">)</span><span class="w"> </span><span class="n">SerializationUtil</span><span class="p">.</span><span class="na">deserialize</span><span class="p">(</span><span class="s">&#34;person.ser&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;ååºåˆ—åŒ–å¯¹è±¡ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">deserializedPerson</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// åºåˆ—åŒ–åˆ°å­—èŠ‚æ•°ç»„</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SerializationUtil</span><span class="p">.</span><span class="na">serializeToBytes</span><span class="p">(</span><span class="n">person</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;åºåˆ—åŒ–æ•°æ®å¤§å°ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">data</span><span class="p">.</span><span class="na">length</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34; å­—èŠ‚&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// ä»å­—èŠ‚æ•°ç»„ååºåˆ—åŒ–</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">Person</span><span class="w"> </span><span class="n">fromBytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Person</span><span class="p">)</span><span class="w"> </span><span class="n">SerializationUtil</span><span class="p">.</span><span class="na">deserializeFromBytes</span><span class="p">(</span><span class="n">data</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;ä»å­—èŠ‚æ•°ç»„ååºåˆ—åŒ–ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">fromBytes</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="å…¶ä»–é‡è¦çš„æ ‡è®°æ¥å£">å…¶ä»–é‡è¦çš„æ ‡è®°æ¥å£</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// Cloneableæ¥å£ç¤ºä¾‹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Student</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Cloneable</span><span class="p">,</span><span class="w"> </span><span class="n">Serializable</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">age</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">courses</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Student</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">age</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">age</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">courses</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// æµ…å…‹éš†</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Student</span><span class="w"> </span><span class="nf">clone</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">CloneNotSupportedException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">Student</span><span class="p">)</span><span class="w"> </span><span class="kd">super</span><span class="p">.</span><span class="na">clone</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// æ·±å…‹éš†</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Student</span><span class="w"> </span><span class="nf">deepClone</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">CloneNotSupportedException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Student</span><span class="w"> </span><span class="n">cloned</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Student</span><span class="p">)</span><span class="w"> </span><span class="kd">super</span><span class="p">.</span><span class="na">clone</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">cloned</span><span class="p">.</span><span class="na">courses</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">courses</span><span class="p">);</span><span class="w"> </span><span class="c1">// æ·±æ‹·è´é›†åˆ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">cloned</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">addCourse</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">course</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">courses</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">course</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">toString</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&#34;Student{name=&#39;&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;&#39;, age=&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;, courses=&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">courses</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;}&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// Getters and setters</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getName</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">name</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setName</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">getAge</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">age</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setAge</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">age</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">age</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">getCourses</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">courses</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// RandomAccessæ¥å£ç¤ºä¾‹ï¼ˆæ ‡è®°æ¥å£ï¼Œè¡¨ç¤ºæ”¯æŒå¿«é€Ÿéšæœºè®¿é—®ï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CustomList</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">AbstractList</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">RandomAccess</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Object</span><span class="o">[]</span><span class="w"> </span><span class="n">elements</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">size</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">CustomList</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">capacity</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">elements</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Object</span><span class="o">[</span><span class="n">capacity</span><span class="o">]</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">index</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">size</span><span class="p">)</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IndexOutOfBoundsException</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="w"> </span><span class="n">elements</span><span class="o">[</span><span class="n">index</span><span class="o">]</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">size</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">size</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="n">element</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">elements</span><span class="p">.</span><span class="na">length</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalStateException</span><span class="p">(</span><span class="s">&#34;List is full&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">elements</span><span class="o">[</span><span class="n">size</span><span class="o">++]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// æ ‡è®°æ¥å£ä½¿ç”¨ç¤ºä¾‹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MarkerInterfaceExample</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">CloneNotSupportedException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// Cloneableç¤ºä¾‹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Student</span><span class="w"> </span><span class="n">student1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Student</span><span class="p">(</span><span class="s">&#34;æå››&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">20</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">student1</span><span class="p">.</span><span class="na">addCourse</span><span class="p">(</span><span class="s">&#34;Java&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">student1</span><span class="p">.</span><span class="na">addCourse</span><span class="p">(</span><span class="s">&#34;Python&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// æµ…å…‹éš†</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Student</span><span class="w"> </span><span class="n">student2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">student1</span><span class="p">.</span><span class="na">clone</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">student2</span><span class="p">.</span><span class="na">setName</span><span class="p">(</span><span class="s">&#34;ç‹äº”&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// æ·±å…‹éš†</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Student</span><span class="w"> </span><span class="n">student3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">student1</span><span class="p">.</span><span class="na">deepClone</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">student3</span><span class="p">.</span><span class="na">addCourse</span><span class="p">(</span><span class="s">&#34;C++&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;åŸå§‹å­¦ç”Ÿï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">student1</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;æµ…å…‹éš†å­¦ç”Ÿï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">student2</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;æ·±å…‹éš†å­¦ç”Ÿï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">student3</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// RandomAccessç¤ºä¾‹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">CustomList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">customList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">CustomList</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">10</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">customList</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&#34;A&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">customList</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&#34;B&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">customList</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&#34;C&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// æ£€æŸ¥æ˜¯å¦æ”¯æŒéšæœºè®¿é—®</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">customList</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">RandomAccess</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;æ”¯æŒå¿«é€Ÿéšæœºè®¿é—®&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">customList</span><span class="p">.</span><span class="na">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;å…ƒç´ [&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;]: &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">customList</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">i</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h2 id="å‡½æ•°å¼æ¥å£">å‡½æ•°å¼æ¥å£</h2>
<h3 id="åŸºæœ¬å‡½æ•°å¼æ¥å£">åŸºæœ¬å‡½æ•°å¼æ¥å£</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.function.*</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.*</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.stream.Collectors</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// è‡ªå®šä¹‰å‡½æ•°å¼æ¥å£</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@FunctionalInterface</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">Calculator</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="nf">calculate</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">b</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// é»˜è®¤æ–¹æ³•ä¸å½±å“å‡½æ•°å¼æ¥å£çš„æ€§è´¨</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">default</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">printResult</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;è®¡ç®—ç»“æœï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">calculate</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// é™æ€æ–¹æ³•</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="n">Calculator</span><span class="w"> </span><span class="nf">add</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="n">Calculator</span><span class="w"> </span><span class="nf">multiply</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// å‡½æ•°å¼æ¥å£åº”ç”¨ç¤ºä¾‹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">FunctionalInterfaceExample</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 1. è‡ªå®šä¹‰å‡½æ•°å¼æ¥å£</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">demonstrateCustomFunctionalInterface</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 2. å†…ç½®å‡½æ•°å¼æ¥å£</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">demonstrateBuiltInFunctionalInterfaces</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 3. æ–¹æ³•å¼•ç”¨</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">demonstrateMethodReferences</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 4. å®é™…åº”ç”¨åœºæ™¯</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">demonstratePracticalUsage</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">demonstrateCustomFunctionalInterface</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;=== è‡ªå®šä¹‰å‡½æ•°å¼æ¥å£ç¤ºä¾‹ ===&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// Lambdaè¡¨è¾¾å¼å®ç°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Calculator</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Calculator</span><span class="w"> </span><span class="n">subtract</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Calculator</span><span class="w"> </span><span class="n">multiply</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Calculator</span><span class="w"> </span><span class="n">divide</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">0</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">10</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">5</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;åŠ æ³•ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">add</span><span class="p">.</span><span class="na">calculate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;å‡æ³•ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">subtract</span><span class="p">.</span><span class="na">calculate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;ä¹˜æ³•ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">multiply</span><span class="p">.</span><span class="na">calculate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;é™¤æ³•ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">divide</span><span class="p">.</span><span class="na">calculate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// ä½¿ç”¨é™æ€æ–¹æ³•</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Calculator</span><span class="w"> </span><span class="n">staticAdd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Calculator</span><span class="p">.</span><span class="na">add</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">staticAdd</span><span class="p">.</span><span class="na">printResult</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">demonstrateBuiltInFunctionalInterfaces</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;\n=== å†…ç½®å‡½æ•°å¼æ¥å£ç¤ºä¾‹ ===&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// Predicate&lt;T&gt; - æ–­è¨€å‹æ¥å£</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Predicate</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span><span class="w"> </span><span class="n">isEven</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Predicate</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span><span class="w"> </span><span class="n">isPositive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Predicate</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span><span class="w"> </span><span class="n">isEvenAndPositive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isEven</span><span class="p">.</span><span class="na">and</span><span class="p">(</span><span class="n">isPositive</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span><span class="w"> </span><span class="n">numbers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span><span class="o">-</span><span class="n">2</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">1</span><span class="p">,</span><span class="w"> </span><span class="n">0</span><span class="p">,</span><span class="w"> </span><span class="n">1</span><span class="p">,</span><span class="w"> </span><span class="n">2</span><span class="p">,</span><span class="w"> </span><span class="n">3</span><span class="p">,</span><span class="w"> </span><span class="n">4</span><span class="p">,</span><span class="w"> </span><span class="n">5</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span><span class="w"> </span><span class="n">evenPositive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">numbers</span><span class="p">.</span><span class="na">stream</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">.</span><span class="na">filter</span><span class="p">(</span><span class="n">isEvenAndPositive</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">.</span><span class="na">collect</span><span class="p">(</span><span class="n">Collectors</span><span class="p">.</span><span class="na">toList</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;å¶æ•°ä¸”ä¸ºæ­£æ•°ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">evenPositive</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// Function&lt;T, R&gt; - å‡½æ•°å‹æ¥å£</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Function</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Integer</span><span class="o">&gt;</span><span class="w"> </span><span class="n">stringLength</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">String</span><span class="p">::</span><span class="n">length</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Function</span><span class="o">&lt;</span><span class="n">Integer</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">intToString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Object</span><span class="p">::</span><span class="n">toString</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Function</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">stringToUpper</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">String</span><span class="p">::</span><span class="n">toUpperCase</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// å‡½æ•°ç»„åˆ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Function</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">lengthToString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stringLength</span><span class="p">.</span><span class="na">andThen</span><span class="p">(</span><span class="n">intToString</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;å­—ç¬¦ä¸²é•¿åº¦ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lengthToString</span><span class="p">.</span><span class="na">apply</span><span class="p">(</span><span class="s">&#34;Hello World&#34;</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// Consumer&lt;T&gt; - æ¶ˆè´¹å‹æ¥å£</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Consumer</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">printer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">::</span><span class="n">println</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Consumer</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">upperPrinter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="na">toUpperCase</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Consumer</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">combinedPrinter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">printer</span><span class="p">.</span><span class="na">andThen</span><span class="p">(</span><span class="n">upperPrinter</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">combinedPrinter</span><span class="p">.</span><span class="na">accept</span><span class="p">(</span><span class="s">&#34;hello world&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// Supplier&lt;T&gt; - ä¾›ç»™å‹æ¥å£</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Supplier</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">randomString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">&#34;Random-&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Math</span><span class="p">.</span><span class="na">random</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Supplier</span><span class="o">&lt;</span><span class="n">Date</span><span class="o">&gt;</span><span class="w"> </span><span class="n">currentDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Date</span><span class="p">::</span><span class="k">new</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;éšæœºå­—ç¬¦ä¸²ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">randomString</span><span class="p">.</span><span class="na">get</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;å½“å‰æ—¶é—´ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">currentDate</span><span class="p">.</span><span class="na">get</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// BiFunction&lt;T, U, R&gt; - åŒå‚æ•°å‡½æ•°å‹æ¥å£</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">BiFunction</span><span class="o">&lt;</span><span class="n">Integer</span><span class="p">,</span><span class="w"> </span><span class="n">Integer</span><span class="p">,</span><span class="w"> </span><span class="n">Integer</span><span class="o">&gt;</span><span class="w"> </span><span class="n">max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Integer</span><span class="p">::</span><span class="n">max</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">BiFunction</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">concat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">s1</span><span class="p">,</span><span class="w"> </span><span class="n">s2</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">s1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34; &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">s2</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;æœ€å¤§å€¼ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">max</span><span class="p">.</span><span class="na">apply</span><span class="p">(</span><span class="n">10</span><span class="p">,</span><span class="w"> </span><span class="n">20</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;è¿æ¥å­—ç¬¦ä¸²ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">concat</span><span class="p">.</span><span class="na">apply</span><span class="p">(</span><span class="s">&#34;Hello&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;World&#34;</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">demonstrateMethodReferences</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;\n=== æ–¹æ³•å¼•ç”¨ç¤ºä¾‹ ===&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span><span class="s">&#34;Alice&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;Bob&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;Charlie&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;David&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// é™æ€æ–¹æ³•å¼•ç”¨</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">names</span><span class="p">.</span><span class="na">stream</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">String</span><span class="p">::</span><span class="n">toUpperCase</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">.</span><span class="na">forEach</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">::</span><span class="n">println</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// å®ä¾‹æ–¹æ³•å¼•ç”¨</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">prefix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;Mr. &#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Function</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">addPrefix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prefix</span><span class="p">::</span><span class="n">concat</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">names</span><span class="p">.</span><span class="na">stream</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">addPrefix</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">.</span><span class="na">forEach</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">::</span><span class="n">println</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// æ„é€ å™¨å¼•ç”¨</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Supplier</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">listSupplier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ArrayList</span><span class="p">::</span><span class="k">new</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Function</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">StringBuilder</span><span class="o">&gt;</span><span class="w"> </span><span class="n">sbCreator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">StringBuilder</span><span class="p">::</span><span class="k">new</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">newList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">listSupplier</span><span class="p">.</span><span class="na">get</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">StringBuilder</span><span class="w"> </span><span class="n">sb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sbCreator</span><span class="p">.</span><span class="na">apply</span><span class="p">(</span><span class="s">&#34;Initial content&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;æ–°åˆ—è¡¨ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">newList</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;StringBuilderï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sb</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">demonstratePracticalUsage</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;\n=== å®é™…åº”ç”¨åœºæ™¯ ===&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// ç­–ç•¥æ¨¡å¼çš„å‡½æ•°å¼å®ç°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Function</span><span class="o">&lt;</span><span class="n">Double</span><span class="p">,</span><span class="w"> </span><span class="n">Double</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">taxCalculators</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HashMap</span><span class="o">&lt;&gt;</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">taxCalculators</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&#34;STANDARD&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">0</span><span class="p">.</span><span class="na">1</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">taxCalculators</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&#34;PREMIUM&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">0</span><span class="p">.</span><span class="na">15</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">taxCalculators</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&#34;VIP&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">0</span><span class="p">.</span><span class="na">05</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">1000</span><span class="p">.</span><span class="na">0</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">customerType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;PREMIUM&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">tax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taxCalculators</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">customerType</span><span class="p">).</span><span class="na">apply</span><span class="p">(</span><span class="n">amount</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;å®¢æˆ·ç±»å‹ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">customerType</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;ï¼Œç¨é¢ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">tax</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// äº‹ä»¶å¤„ç†çš„å‡½æ•°å¼å®ç°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">EventProcessor</span><span class="w"> </span><span class="n">processor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">EventProcessor</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">processor</span><span class="p">.</span><span class="na">addHandler</span><span class="p">(</span><span class="s">&#34;LOGIN&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;ç”¨æˆ·ç™»å½•ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">user</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">processor</span><span class="p">.</span><span class="na">addHandler</span><span class="p">(</span><span class="s">&#34;LOGOUT&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;ç”¨æˆ·ç™»å‡ºï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">user</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">processor</span><span class="p">.</span><span class="na">addHandler</span><span class="p">(</span><span class="s">&#34;PURCHASE&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;ç”¨æˆ·è´­ä¹°ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">user</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">processor</span><span class="p">.</span><span class="na">processEvent</span><span class="p">(</span><span class="s">&#34;LOGIN&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;Alice&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">processor</span><span class="p">.</span><span class="na">processEvent</span><span class="p">(</span><span class="s">&#34;PURCHASE&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;Bob&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// æ•°æ®éªŒè¯çš„å‡½æ•°å¼å®ç°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">DataValidator</span><span class="w"> </span><span class="n">validator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DataValidator</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">validator</span><span class="p">.</span><span class="na">addRule</span><span class="p">(</span><span class="s">&#34;email&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">email</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">email</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="s">&#34;@&#34;</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">validator</span><span class="p">.</span><span class="na">addRule</span><span class="p">(</span><span class="s">&#34;password&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">pwd</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">pwd</span><span class="p">.</span><span class="na">length</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">8</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">validator</span><span class="p">.</span><span class="na">addRule</span><span class="p">(</span><span class="s">&#34;age&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="kt">int</span><span class="w"> </span><span class="n">ageInt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Integer</span><span class="p">.</span><span class="na">parseInt</span><span class="p">(</span><span class="n">age</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">ageInt</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">18</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ageInt</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">120</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">NumberFormatException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">});</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">userData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HashMap</span><span class="o">&lt;&gt;</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">userData</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&#34;email&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;user@example.com&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">userData</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&#34;password&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;password123&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">userData</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&#34;age&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;25&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kt">boolean</span><span class="w"> </span><span class="n">isValid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">validator</span><span class="p">.</span><span class="na">validate</span><span class="p">(</span><span class="n">userData</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;æ•°æ®éªŒè¯ç»“æœï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">isValid</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// äº‹ä»¶å¤„ç†å™¨</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">class</span> <span class="nc">EventProcessor</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Consumer</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">handlers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HashMap</span><span class="o">&lt;&gt;</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">addHandler</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">eventType</span><span class="p">,</span><span class="w"> </span><span class="n">Consumer</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">handler</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">handlers</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">eventType</span><span class="p">,</span><span class="w"> </span><span class="n">handler</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">processEvent</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">eventType</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Consumer</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">handler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">handlers</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">eventType</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">handler</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">handler</span><span class="p">.</span><span class="na">accept</span><span class="p">(</span><span class="n">data</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;æœªçŸ¥äº‹ä»¶ç±»å‹ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">eventType</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// æ•°æ®éªŒè¯å™¨</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">class</span> <span class="nc">DataValidator</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Predicate</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HashMap</span><span class="o">&lt;&gt;</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">addRule</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">field</span><span class="p">,</span><span class="w"> </span><span class="n">Predicate</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">rule</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">rules</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">field</span><span class="p">,</span><span class="w"> </span><span class="n">rule</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">validate</span><span class="p">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">rules</span><span class="p">.</span><span class="na">entrySet</span><span class="p">().</span><span class="na">stream</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">.</span><span class="na">allMatch</span><span class="p">(</span><span class="n">entry</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">String</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">entry</span><span class="p">.</span><span class="na">getKey</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">Predicate</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">entry</span><span class="p">.</span><span class="na">getValue</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">String</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">field</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="kt">boolean</span><span class="w"> </span><span class="n">valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">rule</span><span class="p">.</span><span class="na">test</span><span class="p">(</span><span class="n">value</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">valid</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;å­—æ®µéªŒè¯å¤±è´¥ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">field</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="n">valid</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">});</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h2 id="æ¥å£çš„é«˜çº§ç‰¹æ€§">æ¥å£çš„é«˜çº§ç‰¹æ€§</h2>
<h3 id="é»˜è®¤æ–¹æ³•å’Œé™æ€æ–¹æ³•">é»˜è®¤æ–¹æ³•å’Œé™æ€æ–¹æ³•</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// æ¥å£æ¼”åŒ–ç¤ºä¾‹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">Vehicle</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// æŠ½è±¡æ–¹æ³•</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">start</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">stop</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// é»˜è®¤æ–¹æ³•ï¼ˆJava 8+ï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">default</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">honk</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;å˜Ÿå˜Ÿï¼&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">default</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">displayInfo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;è¿™æ˜¯ä¸€ä¸ªäº¤é€šå·¥å…·&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;æœ€å¤§é€Ÿåº¦ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">getMaxSpeed</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34; km/h&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// æŠ½è±¡æ–¹æ³•ï¼Œå­ç±»å¿…é¡»å®ç°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="nf">getMaxSpeed</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// é™æ€æ–¹æ³•ï¼ˆJava 8+ï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">printManufacturingInfo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;è½¦è¾†åˆ¶é€ ä¿¡æ¯ï¼š&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;- éµå¾ªå›½é™…å®‰å…¨æ ‡å‡†&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;- ç¯ä¿è®¤è¯&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isValidSpeed</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">speed</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">speed</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">speed</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">500</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// ç§æœ‰æ–¹æ³•ï¼ˆJava 9+ï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">validateOperation</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;æ‰§è¡Œå®‰å…¨æ£€æŸ¥...&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// ç§æœ‰é™æ€æ–¹æ³•ï¼ˆJava 9+ï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">formatSpeed</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">speed</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">speed</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34; km/h&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// ç”µåŠ¨è½¦æ¥å£</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">ElectricVehicle</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Vehicle</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">charge</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="nf">getBatteryLevel</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// é‡å†™é»˜è®¤æ–¹æ³•</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">default</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">displayInfo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Vehicle</span><span class="p">.</span><span class="na">super</span><span class="p">.</span><span class="na">displayInfo</span><span class="p">();</span><span class="w"> </span><span class="c1">// è°ƒç”¨çˆ¶æ¥å£çš„é»˜è®¤æ–¹æ³•</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;ç”µæ± ç”µé‡ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">getBatteryLevel</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;%&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;è¿™æ˜¯ä¸€ä¸ªç”µåŠ¨è½¦&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// æ–°çš„é»˜è®¤æ–¹æ³•</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">default</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">checkBattery</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getBatteryLevel</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">level</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">20</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;è­¦å‘Šï¼šç”µæ± ç”µé‡ä½ï¼Œè¯·åŠæ—¶å……ç”µï¼&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">level</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">50</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;æç¤ºï¼šç”µæ± ç”µé‡ä¸­ç­‰&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;ç”µæ± ç”µé‡å……è¶³&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// å…·ä½“å®ç°ç±»</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ElectricCar</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">ElectricVehicle</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">model</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">batteryLevel</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">isRunning</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">ElectricCar</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">batteryLevel</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">model</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">batteryLevel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">batteryLevel</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">isRunning</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">start</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">batteryLevel</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">isRunning</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">model</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34; å¯åŠ¨æˆåŠŸ&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;ç”µæ± æ²¡ç”µï¼Œæ— æ³•å¯åŠ¨&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">stop</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">isRunning</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">model</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34; å·²åœæ­¢&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">charge</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">model</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34; æ­£åœ¨å……ç”µ...&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">batteryLevel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Math</span><span class="p">.</span><span class="na">min</span><span class="p">(</span><span class="n">100</span><span class="p">,</span><span class="w"> </span><span class="n">batteryLevel</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">20</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;å……ç”µå®Œæˆï¼Œå½“å‰ç”µé‡ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">batteryLevel</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;%&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">getBatteryLevel</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">batteryLevel</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">getMaxSpeed</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">180</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// å¯ä»¥é‡å†™é»˜è®¤æ–¹æ³•</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">honk</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">model</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34; å‘å‡ºç”µå­å–‡å­å£°ï¼šå˜€å˜€ï¼&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">toString</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&#34;ElectricCar{model=&#39;&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;&#39;, batteryLevel=&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">batteryLevel</span><span class="w"> </span><span class="o">+</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">               </span><span class="s">&#34;, isRunning=&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">isRunning</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;}&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// æ··åˆåŠ¨åŠ›è½¦</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">HybridCar</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Vehicle</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">model</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">fuelLevel</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">batteryLevel</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">HybridCar</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">fuelLevel</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">batteryLevel</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">model</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">fuelLevel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fuelLevel</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">batteryLevel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">batteryLevel</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">start</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fuelLevel</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">0</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">batteryLevel</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">model</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34; æ··åˆåŠ¨åŠ›å¯åŠ¨&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;ç‡ƒæ–™å’Œç”µæ± éƒ½æ²¡æœ‰ï¼Œæ— æ³•å¯åŠ¨&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">stop</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">model</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34; å·²åœæ­¢&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">getMaxSpeed</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">200</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// ä½¿ç”¨é»˜è®¤çš„honk()å’ŒdisplayInfo()æ–¹æ³•</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// ä½¿ç”¨ç¤ºä¾‹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">InterfaceAdvancedExample</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;=== æ¥å£é«˜çº§ç‰¹æ€§ç¤ºä¾‹ ===&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// é™æ€æ–¹æ³•è°ƒç”¨</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Vehicle</span><span class="p">.</span><span class="na">printManufacturingInfo</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;é€Ÿåº¦éªŒè¯ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Vehicle</span><span class="p">.</span><span class="na">isValidSpeed</span><span class="p">(</span><span class="n">150</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// ç”µåŠ¨è½¦ç¤ºä¾‹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">ElectricCar</span><span class="w"> </span><span class="n">tesla</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ElectricCar</span><span class="p">(</span><span class="s">&#34;Tesla Model 3&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">30</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;\n&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">tesla</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">tesla</span><span class="p">.</span><span class="na">start</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">tesla</span><span class="p">.</span><span class="na">honk</span><span class="p">();</span><span class="w"> </span><span class="c1">// é‡å†™çš„æ–¹æ³•</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">tesla</span><span class="p">.</span><span class="na">displayInfo</span><span class="p">();</span><span class="w"> </span><span class="c1">// ç»§æ‰¿çš„é»˜è®¤æ–¹æ³•</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">tesla</span><span class="p">.</span><span class="na">checkBattery</span><span class="p">();</span><span class="w"> </span><span class="c1">// ElectricVehicleçš„é»˜è®¤æ–¹æ³•</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">tesla</span><span class="p">.</span><span class="na">charge</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">tesla</span><span class="p">.</span><span class="na">checkBattery</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">tesla</span><span class="p">.</span><span class="na">stop</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// æ··åˆåŠ¨åŠ›è½¦ç¤ºä¾‹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">HybridCar</span><span class="w"> </span><span class="n">prius</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HybridCar</span><span class="p">(</span><span class="s">&#34;Toyota Prius&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">80</span><span class="p">,</span><span class="w"> </span><span class="n">60</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;\næ··åˆåŠ¨åŠ›è½¦ç¤ºä¾‹ï¼š&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">prius</span><span class="p">.</span><span class="na">start</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">prius</span><span class="p">.</span><span class="na">honk</span><span class="p">();</span><span class="w"> </span><span class="c1">// ä½¿ç”¨é»˜è®¤å®ç°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">prius</span><span class="p">.</span><span class="na">displayInfo</span><span class="p">();</span><span class="w"> </span><span class="c1">// ä½¿ç”¨é»˜è®¤å®ç°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">prius</span><span class="p">.</span><span class="na">stop</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// å¤šæ€ä½¿ç”¨</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;\nå¤šæ€ç¤ºä¾‹ï¼š&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Vehicle</span><span class="o">[]</span><span class="w"> </span><span class="n">vehicles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">tesla</span><span class="p">,</span><span class="w"> </span><span class="n">prius</span><span class="p">};</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Vehicle</span><span class="w"> </span><span class="n">vehicle</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vehicles</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">vehicle</span><span class="p">.</span><span class="na">displayInfo</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;---&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h2 id="æ¥å£è®¾è®¡æ¨¡å¼">æ¥å£è®¾è®¡æ¨¡å¼</h2>
<h3 id="ç­–ç•¥æ¨¡å¼">ç­–ç•¥æ¨¡å¼</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// ç­–ç•¥æ¥å£</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">SortingStrategy</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Comparable</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">sort</span><span class="p">(</span><span class="n">T</span><span class="o">[]</span><span class="w"> </span><span class="n">array</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">getAlgorithmName</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// å…·ä½“ç­–ç•¥å®ç°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">BubbleSortStrategy</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">SortingStrategy</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Comparable</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">sort</span><span class="p">(</span><span class="n">T</span><span class="o">[]</span><span class="w"> </span><span class="n">array</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">array</span><span class="p">.</span><span class="na">length</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">1</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">array</span><span class="o">[</span><span class="n">j</span><span class="o">]</span><span class="p">.</span><span class="na">compareTo</span><span class="p">(</span><span class="n">array</span><span class="o">[</span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">1</span><span class="o">]</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">T</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">array</span><span class="o">[</span><span class="n">j</span><span class="o">]</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">array</span><span class="o">[</span><span class="n">j</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">array</span><span class="o">[</span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">1</span><span class="o">]</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">array</span><span class="o">[</span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">1</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getAlgorithmName</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&#34;å†’æ³¡æ’åº&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">QuickSortStrategy</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">SortingStrategy</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Comparable</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">sort</span><span class="p">(</span><span class="n">T</span><span class="o">[]</span><span class="w"> </span><span class="n">array</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">quickSort</span><span class="p">(</span><span class="n">array</span><span class="p">,</span><span class="w"> </span><span class="n">0</span><span class="p">,</span><span class="w"> </span><span class="n">array</span><span class="p">.</span><span class="na">length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">1</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Comparable</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">quickSort</span><span class="p">(</span><span class="n">T</span><span class="o">[]</span><span class="w"> </span><span class="n">array</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">low</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">high</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">low</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">high</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">pi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">partition</span><span class="p">(</span><span class="n">array</span><span class="p">,</span><span class="w"> </span><span class="n">low</span><span class="p">,</span><span class="w"> </span><span class="n">high</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">quickSort</span><span class="p">(</span><span class="n">array</span><span class="p">,</span><span class="w"> </span><span class="n">low</span><span class="p">,</span><span class="w"> </span><span class="n">pi</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">1</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">quickSort</span><span class="p">(</span><span class="n">array</span><span class="p">,</span><span class="w"> </span><span class="n">pi</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">1</span><span class="p">,</span><span class="w"> </span><span class="n">high</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Comparable</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">partition</span><span class="p">(</span><span class="n">T</span><span class="o">[]</span><span class="w"> </span><span class="n">array</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">low</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">high</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">T</span><span class="w"> </span><span class="n">pivot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">array</span><span class="o">[</span><span class="n">high</span><span class="o">]</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">low</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">low</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">high</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">array</span><span class="o">[</span><span class="n">j</span><span class="o">]</span><span class="p">.</span><span class="na">compareTo</span><span class="p">(</span><span class="n">pivot</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">i</span><span class="o">++</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">T</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">array</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">array</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">array</span><span class="o">[</span><span class="n">j</span><span class="o">]</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">array</span><span class="o">[</span><span class="n">j</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">T</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">array</span><span class="o">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">1</span><span class="o">]</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">array</span><span class="o">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">1</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">array</span><span class="o">[</span><span class="n">high</span><span class="o">]</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">array</span><span class="o">[</span><span class="n">high</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getAlgorithmName</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&#34;å¿«é€Ÿæ’åº&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// ä¸Šä¸‹æ–‡ç±»</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SortingContext</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">SortingStrategy</span><span class="w"> </span><span class="n">strategy</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">SortingContext</span><span class="p">(</span><span class="n">SortingStrategy</span><span class="w"> </span><span class="n">strategy</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">strategy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strategy</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setStrategy</span><span class="p">(</span><span class="n">SortingStrategy</span><span class="w"> </span><span class="n">strategy</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">strategy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strategy</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Comparable</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">executeSort</span><span class="p">(</span><span class="n">T</span><span class="o">[]</span><span class="w"> </span><span class="n">array</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kt">long</span><span class="w"> </span><span class="n">startTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="na">nanoTime</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">strategy</span><span class="p">.</span><span class="na">sort</span><span class="p">(</span><span class="n">array</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kt">long</span><span class="w"> </span><span class="n">endTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="na">nanoTime</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;ä½¿ç”¨ &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">strategy</span><span class="p">.</span><span class="na">getAlgorithmName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">                          </span><span class="s">&#34; æ’åºå®Œæˆï¼Œè€—æ—¶ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">endTime</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">startTime</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">1_000_000</span><span class="p">.</span><span class="na">0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34; ms&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// è§‚å¯Ÿè€…æ¨¡å¼</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">Observer</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">message</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">Subject</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">addObserver</span><span class="p">(</span><span class="n">Observer</span><span class="w"> </span><span class="n">observer</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">removeObserver</span><span class="p">(</span><span class="n">Observer</span><span class="w"> </span><span class="n">observer</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">notifyObservers</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">message</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">NewsAgency</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Subject</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Observer</span><span class="o">&gt;</span><span class="w"> </span><span class="n">observers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">news</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">addObserver</span><span class="p">(</span><span class="n">Observer</span><span class="w"> </span><span class="n">observer</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">observers</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">observer</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">removeObserver</span><span class="p">(</span><span class="n">Observer</span><span class="w"> </span><span class="n">observer</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">observers</span><span class="p">.</span><span class="na">remove</span><span class="p">(</span><span class="n">observer</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">notifyObservers</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">message</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Observer</span><span class="w"> </span><span class="n">observer</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">observers</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">observer</span><span class="p">.</span><span class="na">update</span><span class="p">(</span><span class="n">message</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setNews</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">news</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">news</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">news</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">notifyObservers</span><span class="p">(</span><span class="s">&#34;æ–°é—»æ›´æ–°ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">news</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">NewsChannel</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Observer</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">NewsChannel</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">message</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34; æ”¶åˆ°æ¶ˆæ¯ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">message</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// è®¾è®¡æ¨¡å¼ç¤ºä¾‹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">DesignPatternExample</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// ç­–ç•¥æ¨¡å¼ç¤ºä¾‹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;=== ç­–ç•¥æ¨¡å¼ç¤ºä¾‹ ===&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Integer</span><span class="o">[]</span><span class="w"> </span><span class="n">numbers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">64</span><span class="p">,</span><span class="w"> </span><span class="n">34</span><span class="p">,</span><span class="w"> </span><span class="n">25</span><span class="p">,</span><span class="w"> </span><span class="n">12</span><span class="p">,</span><span class="w"> </span><span class="n">22</span><span class="p">,</span><span class="w"> </span><span class="n">11</span><span class="p">,</span><span class="w"> </span><span class="n">90</span><span class="p">};</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">SortingContext</span><span class="w"> </span><span class="n">context</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SortingContext</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BubbleSortStrategy</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Integer</span><span class="o">[]</span><span class="w"> </span><span class="n">bubbleArray</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">numbers</span><span class="p">.</span><span class="na">clone</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;åŸå§‹æ•°ç»„ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Arrays</span><span class="p">.</span><span class="na">toString</span><span class="p">(</span><span class="n">bubbleArray</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">context</span><span class="p">.</span><span class="na">executeSort</span><span class="p">(</span><span class="n">bubbleArray</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;æ’åºç»“æœï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Arrays</span><span class="p">.</span><span class="na">toString</span><span class="p">(</span><span class="n">bubbleArray</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">context</span><span class="p">.</span><span class="na">setStrategy</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">QuickSortStrategy</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Integer</span><span class="o">[]</span><span class="w"> </span><span class="n">quickArray</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">numbers</span><span class="p">.</span><span class="na">clone</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;\nåŸå§‹æ•°ç»„ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Arrays</span><span class="p">.</span><span class="na">toString</span><span class="p">(</span><span class="n">quickArray</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">context</span><span class="p">.</span><span class="na">executeSort</span><span class="p">(</span><span class="n">quickArray</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;æ’åºç»“æœï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Arrays</span><span class="p">.</span><span class="na">toString</span><span class="p">(</span><span class="n">quickArray</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// è§‚å¯Ÿè€…æ¨¡å¼ç¤ºä¾‹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;\n=== è§‚å¯Ÿè€…æ¨¡å¼ç¤ºä¾‹ ===&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">NewsAgency</span><span class="w"> </span><span class="n">agency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">NewsAgency</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">NewsChannel</span><span class="w"> </span><span class="n">cnn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">NewsChannel</span><span class="p">(</span><span class="s">&#34;CNN&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">NewsChannel</span><span class="w"> </span><span class="n">bbc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">NewsChannel</span><span class="p">(</span><span class="s">&#34;BBC&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">NewsChannel</span><span class="w"> </span><span class="n">fox</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">NewsChannel</span><span class="p">(</span><span class="s">&#34;Fox News&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">agency</span><span class="p">.</span><span class="na">addObserver</span><span class="p">(</span><span class="n">cnn</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">agency</span><span class="p">.</span><span class="na">addObserver</span><span class="p">(</span><span class="n">bbc</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">agency</span><span class="p">.</span><span class="na">addObserver</span><span class="p">(</span><span class="n">fox</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">agency</span><span class="p">.</span><span class="na">setNews</span><span class="p">(</span><span class="s">&#34;é‡å¤§ç§‘æŠ€çªç ´ï¼šé‡å­è®¡ç®—æœºå®ç°æ–°é‡Œç¨‹ç¢‘&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;\nBBC é€€è®¢æ–°é—»&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">agency</span><span class="p">.</span><span class="na">removeObserver</span><span class="p">(</span><span class="n">bbc</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">agency</span><span class="p">.</span><span class="na">setNews</span><span class="p">(</span><span class="s">&#34;ç»æµæ–°é—»ï¼šè‚¡å¸‚åˆ›å†å²æ–°é«˜&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h2 id="æ¥å£æœ€ä½³å®è·µ">æ¥å£æœ€ä½³å®è·µ</h2>
<h3 id="æ¥å£è®¾è®¡åŸåˆ™">æ¥å£è®¾è®¡åŸåˆ™</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// 1. æ¥å£éš”ç¦»åŸåˆ™ - å¥½çš„è®¾è®¡</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">Readable</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">read</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">Writable</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">write</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">content</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">Seekable</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">seek</span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="n">position</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// ç»„åˆæ¥å£</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">RandomAccessFile</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Readable</span><span class="p">,</span><span class="w"> </span><span class="n">Writable</span><span class="p">,</span><span class="w"> </span><span class="n">Seekable</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="nf">size</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// 2. ä¾èµ–å€’ç½®åŸåˆ™</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">PaymentProcessor</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">processPayment</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">amount</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">currency</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">getPaymentMethod</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CreditCardProcessor</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">PaymentProcessor</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">processPayment</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">amount</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">currency</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;å¤„ç†ä¿¡ç”¨å¡æ”¯ä»˜ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34; &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">currency</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getPaymentMethod</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&#34;ä¿¡ç”¨å¡&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">PayPalProcessor</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">PaymentProcessor</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">processPayment</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">amount</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">currency</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;å¤„ç†PayPalæ”¯ä»˜ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34; &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">currency</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getPaymentMethod</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&#34;PayPal&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// é«˜å±‚æ¨¡å—ä¾èµ–æŠ½è±¡</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">OrderService</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">PaymentProcessor</span><span class="w"> </span><span class="n">paymentProcessor</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">OrderService</span><span class="p">(</span><span class="n">PaymentProcessor</span><span class="w"> </span><span class="n">paymentProcessor</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">paymentProcessor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">paymentProcessor</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">processOrder</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">amount</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">currency</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;å¤„ç†è®¢å•ï¼Œä½¿ç”¨ &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">paymentProcessor</span><span class="p">.</span><span class="na">getPaymentMethod</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">paymentProcessor</span><span class="p">.</span><span class="na">processPayment</span><span class="p">(</span><span class="n">amount</span><span class="p">,</span><span class="w"> </span><span class="n">currency</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// 3. æ¥å£ç‰ˆæœ¬æ§åˆ¶</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">UserService</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">User</span><span class="w"> </span><span class="nf">getUserById</span><span class="p">(</span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">getAllUsers</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// V2 æ–°å¢æ–¹æ³•ï¼Œä½¿ç”¨é»˜è®¤å®ç°ä¿æŒå‘åå…¼å®¹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">default</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">getUsersByRole</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">role</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">getAllUsers</span><span class="p">().</span><span class="na">stream</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">.</span><span class="na">filter</span><span class="p">(</span><span class="n">user</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">role</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">user</span><span class="p">.</span><span class="na">getRole</span><span class="p">()))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">.</span><span class="na">collect</span><span class="p">(</span><span class="n">Collectors</span><span class="p">.</span><span class="na">toList</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// V3 æ–°å¢æ–¹æ³•</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">default</span><span class="w"> </span><span class="n">Optional</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">findUserByEmail</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">email</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">getAllUsers</span><span class="p">().</span><span class="na">stream</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">.</span><span class="na">filter</span><span class="p">(</span><span class="n">user</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">email</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">user</span><span class="p">.</span><span class="na">getEmail</span><span class="p">()))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">.</span><span class="na">findFirst</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// ç”¨æˆ·å®ä½“ç±»</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">class</span> <span class="nc">User</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">email</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">role</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">User</span><span class="p">(</span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">email</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">role</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">id</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">email</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">role</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">role</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// Getters</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Long</span><span class="w"> </span><span class="nf">getId</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">id</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getName</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">name</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getEmail</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">email</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getRole</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">role</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">toString</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&#34;User{id=&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;, name=&#39;&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;&#39;, email=&#39;&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">email</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;&#39;, role=&#39;&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">role</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;&#39;}&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// 4. æ¥å£æ–‡æ¡£å’Œå¥‘çº¦</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * ç¼“å­˜æ¥å£å®šä¹‰
</span></span></span><span class="line"><span class="cl"><span class="cm"> * 
</span></span></span><span class="line"><span class="cl"><span class="cm"> * @param &lt;K&gt; é”®ç±»å‹
</span></span></span><span class="line"><span class="cl"><span class="cm"> * @param &lt;V&gt; å€¼ç±»å‹
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">Cache</span><span class="o">&lt;</span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">V</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * å­˜å‚¨é”®å€¼å¯¹
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param key é”®ï¼Œä¸èƒ½ä¸ºnull
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param value å€¼ï¼Œä¸èƒ½ä¸ºnull
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @throws IllegalArgumentException å¦‚æœkeyæˆ–valueä¸ºnull
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">put</span><span class="p">(</span><span class="n">K</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">V</span><span class="w"> </span><span class="n">value</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * è·å–å€¼
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param key é”®ï¼Œä¸èƒ½ä¸ºnull
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return å¯¹åº”çš„å€¼ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™è¿”å›null
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @throws IllegalArgumentException å¦‚æœkeyä¸ºnull
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">V</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="n">K</span><span class="w"> </span><span class="n">key</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * ç§»é™¤é”®å€¼å¯¹
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param key é”®ï¼Œä¸èƒ½ä¸ºnull
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return è¢«ç§»é™¤çš„å€¼ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™è¿”å›null
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @throws IllegalArgumentException å¦‚æœkeyä¸ºnull
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">V</span><span class="w"> </span><span class="nf">remove</span><span class="p">(</span><span class="n">K</span><span class="w"> </span><span class="n">key</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * æ£€æŸ¥æ˜¯å¦åŒ…å«æŒ‡å®šé”®
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param key é”®ï¼Œä¸èƒ½ä¸ºnull
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return å¦‚æœåŒ…å«åˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›false
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @throws IllegalArgumentException å¦‚æœkeyä¸ºnull
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">containsKey</span><span class="p">(</span><span class="n">K</span><span class="w"> </span><span class="n">key</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * è·å–ç¼“å­˜å¤§å°
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return å½“å‰ç¼“å­˜ä¸­çš„å…ƒç´ æ•°é‡
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="nf">size</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * æ¸…ç©ºç¼“å­˜
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">clear</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * è·å–ç¼“å­˜ç»Ÿè®¡ä¿¡æ¯
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return ç¼“å­˜ç»Ÿè®¡ä¿¡æ¯ï¼ŒåŒ…å«å‘½ä¸­ç‡ã€missç‡ç­‰
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">default</span><span class="w"> </span><span class="n">CacheStats</span><span class="w"> </span><span class="nf">getStats</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">CacheStats</span><span class="p">(</span><span class="n">0</span><span class="p">,</span><span class="w"> </span><span class="n">0</span><span class="p">,</span><span class="w"> </span><span class="n">0</span><span class="p">.</span><span class="na">0</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// ç¼“å­˜ç»Ÿè®¡ä¿¡æ¯</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">class</span> <span class="nc">CacheStats</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">hits</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">misses</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">hitRate</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">CacheStats</span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="n">hits</span><span class="p">,</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">misses</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">hitRate</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">hits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hits</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">misses</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">misses</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">hitRate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hitRate</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="nf">getHits</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">hits</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="nf">getMisses</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">misses</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="nf">getHitRate</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">hitRate</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">toString</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&#34;CacheStats{hits=&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">hits</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;, misses=&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">misses</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;, hitRate=&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">hitRate</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;}&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// æœ€ä½³å®è·µç¤ºä¾‹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">InterfaceBestPracticesExample</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// ä¾èµ–å€’ç½®åŸåˆ™ç¤ºä¾‹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;=== ä¾èµ–å€’ç½®åŸåˆ™ç¤ºä¾‹ ===&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">OrderService</span><span class="w"> </span><span class="n">creditCardService</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">OrderService</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">CreditCardProcessor</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">OrderService</span><span class="w"> </span><span class="n">paypalService</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">OrderService</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">PayPalProcessor</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">creditCardService</span><span class="p">.</span><span class="na">processOrder</span><span class="p">(</span><span class="n">100</span><span class="p">.</span><span class="na">0</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;USD&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">paypalService</span><span class="p">.</span><span class="na">processOrder</span><span class="p">(</span><span class="n">200</span><span class="p">.</span><span class="na">0</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;EUR&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// æ¥å£ç‰ˆæœ¬æ§åˆ¶ç¤ºä¾‹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;\n=== æ¥å£ç‰ˆæœ¬æ§åˆ¶ç¤ºä¾‹ ===&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">UserService</span><span class="w"> </span><span class="n">userService</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">UserServiceImpl</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// V1 åŠŸèƒ½</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span><span class="w"> </span><span class="n">allUsers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">userService</span><span class="p">.</span><span class="na">getAllUsers</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;æ‰€æœ‰ç”¨æˆ·ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">allUsers</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// V2 åŠŸèƒ½ï¼ˆé»˜è®¤å®ç°ï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span><span class="w"> </span><span class="n">admins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">userService</span><span class="p">.</span><span class="na">getUsersByRole</span><span class="p">(</span><span class="s">&#34;admin&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;ç®¡ç†å‘˜ç”¨æˆ·ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">admins</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// V3 åŠŸèƒ½ï¼ˆé»˜è®¤å®ç°ï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Optional</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">userService</span><span class="p">.</span><span class="na">findUserByEmail</span><span class="p">(</span><span class="s">&#34;alice@example.com&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;é‚®ç®±æŸ¥æ‰¾ç”¨æˆ·ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">user</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// UserServiceå®ç°ç±»</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">class</span> <span class="nc">UserServiceImpl</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">UserService</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span><span class="w"> </span><span class="n">users</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">UserServiceImpl</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">new</span><span class="w"> </span><span class="n">User</span><span class="p">(</span><span class="n">1L</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;Alice&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;alice@example.com&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;admin&#34;</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">new</span><span class="w"> </span><span class="n">User</span><span class="p">(</span><span class="n">2L</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;Bob&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;bob@example.com&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;user&#34;</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">new</span><span class="w"> </span><span class="n">User</span><span class="p">(</span><span class="n">3L</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;Charlie&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;charlie@example.com&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;admin&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="nf">getUserById</span><span class="p">(</span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">users</span><span class="p">.</span><span class="na">stream</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">.</span><span class="na">filter</span><span class="p">(</span><span class="n">user</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">user</span><span class="p">.</span><span class="na">getId</span><span class="p">().</span><span class="na">equals</span><span class="p">(</span><span class="n">id</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">.</span><span class="na">findFirst</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">.</span><span class="na">orElse</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">getAllUsers</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">users</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h2 id="å­¦ä¹ å»ºè®®å’Œæ€»ç»“">å­¦ä¹ å»ºè®®å’Œæ€»ç»“</h2>
<h3 id="javaæ¥å£å­¦ä¹ è·¯å¾„">Javaæ¥å£å­¦ä¹ è·¯å¾„</h3>
<ol>
<li><strong>åŸºç¡€æ¦‚å¿µ</strong>ï¼šç†è§£æ¥å£çš„å®šä¹‰ã€ç‰¹æ€§å’Œè¯­æ³•</li>
<li><strong>æ ‡è®°æ¥å£</strong>ï¼šæŒæ¡Serializableã€Cloneableç­‰é‡è¦æ ‡è®°æ¥å£</li>
<li><strong>å‡½æ•°å¼æ¥å£</strong>ï¼šå­¦ä¹ Lambdaè¡¨è¾¾å¼å’Œæ–¹æ³•å¼•ç”¨</li>
<li><strong>é«˜çº§ç‰¹æ€§</strong>ï¼šæŒæ¡é»˜è®¤æ–¹æ³•ã€é™æ€æ–¹æ³•å’Œç§æœ‰æ–¹æ³•</li>
<li><strong>è®¾è®¡æ¨¡å¼</strong>ï¼šå­¦ä¹ åŸºäºæ¥å£çš„è®¾è®¡æ¨¡å¼</li>
<li><strong>æœ€ä½³å®è·µ</strong>ï¼šæŒæ¡æ¥å£è®¾è®¡åŸåˆ™å’Œå®é™…åº”ç”¨</li>
</ol>
<h3 id="å…³é”®è¦ç‚¹æ€»ç»“">å…³é”®è¦ç‚¹æ€»ç»“</h3>
<table>
  <thead>
      <tr>
          <th>æ¦‚å¿µ</th>
          <th>ç”¨é€”</th>
          <th>ç‰¹ç‚¹</th>
          <th>åº”ç”¨åœºæ™¯</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>æŠ½è±¡æ–¹æ³•</strong></td>
          <td>å®šä¹‰å¥‘çº¦</td>
          <td>å¿…é¡»å®ç°</td>
          <td>æ ¸å¿ƒä¸šåŠ¡é€»è¾‘</td>
      </tr>
      <tr>
          <td><strong>é»˜è®¤æ–¹æ³•</strong></td>
          <td>æ¥å£æ¼”åŒ–</td>
          <td>å¯é€‰é‡å†™</td>
          <td>å‘åå…¼å®¹</td>
      </tr>
      <tr>
          <td><strong>é™æ€æ–¹æ³•</strong></td>
          <td>å·¥å…·æ–¹æ³•</td>
          <td>æ¥å£çº§åˆ«</td>
          <td>è¾…åŠ©åŠŸèƒ½</td>
      </tr>
      <tr>
          <td><strong>æ ‡è®°æ¥å£</strong></td>
          <td>ç±»å‹æ ‡è¯†</td>
          <td>æ— æ–¹æ³•</td>
          <td>ç‰¹æ®Šèƒ½åŠ›æ ‡è®°</td>
      </tr>
      <tr>
          <td><strong>å‡½æ•°å¼æ¥å£</strong></td>
          <td>Lambdaæ”¯æŒ</td>
          <td>å•ä¸€æŠ½è±¡æ–¹æ³•</td>
          <td>å‡½æ•°å¼ç¼–ç¨‹</td>
      </tr>
  </tbody>
</table>
<h3 id="å®é™…åº”ç”¨å»ºè®®">å®é™…åº”ç”¨å»ºè®®</h3>
<ul>
<li><strong>æ¥å£è®¾è®¡</strong>ï¼šéµå¾ªå•ä¸€èŒè´£å’Œæ¥å£éš”ç¦»åŸåˆ™</li>
<li><strong>ç‰ˆæœ¬æ§åˆ¶</strong>ï¼šä½¿ç”¨é»˜è®¤æ–¹æ³•ä¿æŒå‘åå…¼å®¹æ€§</li>
<li><strong>æ–‡æ¡£ç¼–å†™</strong>ï¼šè¯¦ç»†æè¿°æ¥å£å¥‘çº¦å’Œä½¿ç”¨çº¦å®š</li>
<li><strong>æµ‹è¯•ç­–ç•¥</strong>ï¼šä¸ºæ¥å£å®ç°ç¼–å†™å……åˆ†çš„å•å…ƒæµ‹è¯•</li>
<li><strong>æ€§èƒ½è€ƒè™‘</strong>ï¼šæ³¨æ„æ¥å£è°ƒç”¨çš„æ€§èƒ½å¼€é”€</li>
</ul>
<p>Javaæ¥å£æ˜¯å®ç°æŠ½è±¡ã€å¤šæ€å’Œè§£è€¦çš„é‡è¦å·¥å…·ï¼ŒæŒæ¡å…¶å„ç§ç‰¹æ€§å’Œåº”ç”¨æ¨¡å¼å¯¹äºç¼–å†™é«˜è´¨é‡çš„Javaä»£ç è‡³å…³é‡è¦ã€‚éšç€Javaç‰ˆæœ¬çš„æ¼”è¿›ï¼Œæ¥å£åŠŸèƒ½è¶Šæ¥è¶Šå¼ºå¤§ï¼Œä¸ºç°ä»£Javaå¼€å‘æä¾›äº†æ›´å¤šçš„è®¾è®¡é€‰æ‹©ã€‚</p>
]]></content:encoded>
    </item>
    <item>
      <title>TCPåè®®æ·±åº¦è§£æï¼šå¯é ä¼ è¾“çš„æ ¸å¿ƒæœºåˆ¶</title>
      <link>https://tyhzxh.github.io/posts/tcp-protocol-guide/</link>
      <pubDate>Wed, 28 Feb 2024 14:30:00 +0800</pubDate>
      <guid>https://tyhzxh.github.io/posts/tcp-protocol-guide/</guid>
      <description>æ·±å…¥è§£æTCPåè®®çš„å·¥ä½œåŸç†ã€ä¸‰æ¬¡æ¡æ‰‹ã€å››æ¬¡æŒ¥æ‰‹ã€æµé‡æ§åˆ¶ã€æ‹¥å¡æ§åˆ¶ç­‰æ ¸å¿ƒæœºåˆ¶ï¼Œä»¥åŠTCPåœ¨ç°ä»£ç½‘ç»œä¸­çš„åº”ç”¨å’Œä¼˜åŒ–</description>
      <content:encoded><![CDATA[<h2 id="tcpåè®®æ¦‚è¿°">TCPåè®®æ¦‚è¿°</h2>
<p>**TCPï¼ˆTransmission Control Protocolï¼‰**æ˜¯äº’è”ç½‘åè®®å¥—ä»¶ä¸­çš„æ ¸å¿ƒåè®®ä¹‹ä¸€ï¼Œä½äºä¼ è¾“å±‚ï¼Œä¸ºåº”ç”¨å±‚æä¾›å¯é çš„ã€é¢å‘è¿æ¥çš„å­—èŠ‚æµæœåŠ¡ã€‚TCPç¡®ä¿æ•°æ®çš„å®Œæ•´æ€§ã€é¡ºåºæ€§å’Œå¯é æ€§ï¼Œæ˜¯ç°ä»£äº’è”ç½‘é€šä¿¡çš„åŸºçŸ³ã€‚</p>
<h3 id="tcpçš„æ ¸å¿ƒç‰¹æ€§">TCPçš„æ ¸å¿ƒç‰¹æ€§</h3>
<table>
  <thead>
      <tr>
          <th>ç‰¹æ€§</th>
          <th>æè¿°</th>
          <th>ä¼˜åŠ¿</th>
          <th>åº”ç”¨åœºæ™¯</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>é¢å‘è¿æ¥</strong></td>
          <td>é€šä¿¡å‰éœ€å»ºç«‹è¿æ¥</td>
          <td>ç¡®ä¿é€šä¿¡åŒæ–¹å‡†å¤‡å°±ç»ª</td>
          <td>éœ€è¦å¯é ä¼ è¾“çš„åº”ç”¨</td>
      </tr>
      <tr>
          <td><strong>å¯é ä¼ è¾“</strong></td>
          <td>ä¿è¯æ•°æ®å®Œæ•´åˆ°è¾¾</td>
          <td>æ•°æ®ä¸ä¸¢å¤±ã€ä¸é‡å¤</td>
          <td>æ–‡ä»¶ä¼ è¾“ã€ç½‘é¡µæµè§ˆ</td>
      </tr>
      <tr>
          <td><strong>æµé‡æ§åˆ¶</strong></td>
          <td>æ§åˆ¶å‘é€é€Ÿç‡</td>
          <td>é˜²æ­¢æ¥æ”¶æ–¹ç¼“å†²åŒºæº¢å‡º</td>
          <td>å¤„ç†èƒ½åŠ›ä¸åŒçš„è®¾å¤‡</td>
      </tr>
      <tr>
          <td><strong>æ‹¥å¡æ§åˆ¶</strong></td>
          <td>é¿å…ç½‘ç»œæ‹¥å¡</td>
          <td>æé«˜ç½‘ç»œæ•´ä½“æ€§èƒ½</td>
          <td>é«˜è´Ÿè½½ç½‘ç»œç¯å¢ƒ</td>
      </tr>
      <tr>
          <td><strong>å…¨åŒå·¥é€šä¿¡</strong></td>
          <td>åŒå‘åŒæ—¶ä¼ è¾“</td>
          <td>æé«˜é€šä¿¡æ•ˆç‡</td>
          <td>å®æ—¶äº¤äº’åº”ç”¨</td>
      </tr>
  </tbody>
</table>
<h2 id="tcpæŠ¥æ–‡æ®µç»“æ„">TCPæŠ¥æ–‡æ®µç»“æ„</h2>
<h3 id="tcpå¤´éƒ¨æ ¼å¼">TCPå¤´éƒ¨æ ¼å¼</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">TCPHeader</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;TCPå¤´éƒ¨ç»“æ„è§£æ&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">header_fields</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æºç«¯å£&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;ä½ç½®&#34;</span><span class="p">:</span> <span class="s2">&#34;0-15&#34;</span><span class="p">,</span> <span class="s2">&#34;é•¿åº¦&#34;</span><span class="p">:</span> <span class="s2">&#34;16ä½&#34;</span><span class="p">,</span> <span class="s2">&#34;æè¿°&#34;</span><span class="p">:</span> <span class="s2">&#34;å‘é€æ–¹ç«¯å£å·&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;ç›®æ ‡ç«¯å£&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;ä½ç½®&#34;</span><span class="p">:</span> <span class="s2">&#34;16-31&#34;</span><span class="p">,</span> <span class="s2">&#34;é•¿åº¦&#34;</span><span class="p">:</span> <span class="s2">&#34;16ä½&#34;</span><span class="p">,</span> <span class="s2">&#34;æè¿°&#34;</span><span class="p">:</span> <span class="s2">&#34;æ¥æ”¶æ–¹ç«¯å£å·&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;åºåˆ—å·&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;ä½ç½®&#34;</span><span class="p">:</span> <span class="s2">&#34;32-63&#34;</span><span class="p">,</span> <span class="s2">&#34;é•¿åº¦&#34;</span><span class="p">:</span> <span class="s2">&#34;32ä½&#34;</span><span class="p">,</span> <span class="s2">&#34;æè¿°&#34;</span><span class="p">:</span> <span class="s2">&#34;æ•°æ®å­—èŠ‚çš„åºåˆ—å·&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;ç¡®è®¤å·&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;ä½ç½®&#34;</span><span class="p">:</span> <span class="s2">&#34;64-95&#34;</span><span class="p">,</span> <span class="s2">&#34;é•¿åº¦&#34;</span><span class="p">:</span> <span class="s2">&#34;32ä½&#34;</span><span class="p">,</span> <span class="s2">&#34;æè¿°&#34;</span><span class="p">:</span> <span class="s2">&#34;æœŸæœ›æ¥æ”¶çš„ä¸‹ä¸€ä¸ªåºåˆ—å·&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;å¤´éƒ¨é•¿åº¦&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;ä½ç½®&#34;</span><span class="p">:</span> <span class="s2">&#34;96-99&#34;</span><span class="p">,</span> <span class="s2">&#34;é•¿åº¦&#34;</span><span class="p">:</span> <span class="s2">&#34;4ä½&#34;</span><span class="p">,</span> <span class="s2">&#34;æè¿°&#34;</span><span class="p">:</span> <span class="s2">&#34;TCPå¤´éƒ¨é•¿åº¦&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;ä¿ç•™ä½&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;ä½ç½®&#34;</span><span class="p">:</span> <span class="s2">&#34;100-105&#34;</span><span class="p">,</span> <span class="s2">&#34;é•¿åº¦&#34;</span><span class="p">:</span> <span class="s2">&#34;6ä½&#34;</span><span class="p">,</span> <span class="s2">&#34;æè¿°&#34;</span><span class="p">:</span> <span class="s2">&#34;ä¿ç•™å­—æ®µ&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ§åˆ¶ä½&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;ä½ç½®&#34;</span><span class="p">:</span> <span class="s2">&#34;106-111&#34;</span><span class="p">,</span> <span class="s2">&#34;é•¿åº¦&#34;</span><span class="p">:</span> <span class="s2">&#34;6ä½&#34;</span><span class="p">,</span> <span class="s2">&#34;æè¿°&#34;</span><span class="p">:</span> <span class="s2">&#34;URGã€ACKã€PSHã€RSTã€SYNã€FIN&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;çª—å£å¤§å°&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;ä½ç½®&#34;</span><span class="p">:</span> <span class="s2">&#34;112-127&#34;</span><span class="p">,</span> <span class="s2">&#34;é•¿åº¦&#34;</span><span class="p">:</span> <span class="s2">&#34;16ä½&#34;</span><span class="p">,</span> <span class="s2">&#34;æè¿°&#34;</span><span class="p">:</span> <span class="s2">&#34;æ¥æ”¶çª—å£å¤§å°&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ ¡éªŒå’Œ&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;ä½ç½®&#34;</span><span class="p">:</span> <span class="s2">&#34;128-143&#34;</span><span class="p">,</span> <span class="s2">&#34;é•¿åº¦&#34;</span><span class="p">:</span> <span class="s2">&#34;16ä½&#34;</span><span class="p">,</span> <span class="s2">&#34;æè¿°&#34;</span><span class="p">:</span> <span class="s2">&#34;é”™è¯¯æ£€æµ‹&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;ç´§æ€¥æŒ‡é’ˆ&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;ä½ç½®&#34;</span><span class="p">:</span> <span class="s2">&#34;144-159&#34;</span><span class="p">,</span> <span class="s2">&#34;é•¿åº¦&#34;</span><span class="p">:</span> <span class="s2">&#34;16ä½&#34;</span><span class="p">,</span> <span class="s2">&#34;æè¿°&#34;</span><span class="p">:</span> <span class="s2">&#34;ç´§æ€¥æ•°æ®æŒ‡é’ˆ&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;é€‰é¡¹&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;ä½ç½®&#34;</span><span class="p">:</span> <span class="s2">&#34;160+&#34;</span><span class="p">,</span> <span class="s2">&#34;é•¿åº¦&#34;</span><span class="p">:</span> <span class="s2">&#34;å¯å˜&#34;</span><span class="p">,</span> <span class="s2">&#34;æè¿°&#34;</span><span class="p">:</span> <span class="s2">&#34;TCPé€‰é¡¹å­—æ®µ&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">parse_flags</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flags_byte</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;è§£æTCPæ ‡å¿—ä½&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">flags</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;URG&#34;</span><span class="p">:</span> <span class="nb">bool</span><span class="p">(</span><span class="n">flags_byte</span> <span class="o">&amp;</span> <span class="mh">0x20</span><span class="p">),</span>  <span class="c1"># ç´§æ€¥</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;ACK&#34;</span><span class="p">:</span> <span class="nb">bool</span><span class="p">(</span><span class="n">flags_byte</span> <span class="o">&amp;</span> <span class="mh">0x10</span><span class="p">),</span>  <span class="c1"># ç¡®è®¤</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;PSH&#34;</span><span class="p">:</span> <span class="nb">bool</span><span class="p">(</span><span class="n">flags_byte</span> <span class="o">&amp;</span> <span class="mh">0x08</span><span class="p">),</span>  <span class="c1"># æ¨é€</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;RST&#34;</span><span class="p">:</span> <span class="nb">bool</span><span class="p">(</span><span class="n">flags_byte</span> <span class="o">&amp;</span> <span class="mh">0x04</span><span class="p">),</span>  <span class="c1"># é‡ç½®</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;SYN&#34;</span><span class="p">:</span> <span class="nb">bool</span><span class="p">(</span><span class="n">flags_byte</span> <span class="o">&amp;</span> <span class="mh">0x02</span><span class="p">),</span>  <span class="c1"># åŒæ­¥</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;FIN&#34;</span><span class="p">:</span> <span class="nb">bool</span><span class="p">(</span><span class="n">flags_byte</span> <span class="o">&amp;</span> <span class="mh">0x01</span><span class="p">)</span>   <span class="c1"># ç»“æŸ</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">flags</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">create_segment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">src_port</span><span class="p">,</span> <span class="n">dst_port</span><span class="p">,</span> <span class="n">seq_num</span><span class="p">,</span> <span class="n">ack_num</span><span class="p">,</span> <span class="n">flags</span><span class="p">,</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="sa">b</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;åˆ›å»ºTCPæŠ¥æ–‡æ®µ&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">segment</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æºç«¯å£&#34;</span><span class="p">:</span> <span class="n">src_port</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;ç›®æ ‡ç«¯å£&#34;</span><span class="p">:</span> <span class="n">dst_port</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;åºåˆ—å·&#34;</span><span class="p">:</span> <span class="n">seq_num</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;ç¡®è®¤å·&#34;</span><span class="p">:</span> <span class="n">ack_num</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;å¤´éƒ¨é•¿åº¦&#34;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>  <span class="c1"># åŸºæœ¬å¤´éƒ¨é•¿åº¦</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ ‡å¿—ä½&#34;</span><span class="p">:</span> <span class="n">flags</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;çª—å£å¤§å°&#34;</span><span class="p">:</span> <span class="n">window_size</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ ¡éªŒå’Œ&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>  <span class="c1"># éœ€è¦è®¡ç®—</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ•°æ®&#34;</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ•°æ®é•¿åº¦&#34;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># è®¡ç®—æ ¡éªŒå’Œ</span>
</span></span><span class="line"><span class="cl">        <span class="n">segment</span><span class="p">[</span><span class="s2">&#34;æ ¡éªŒå’Œ&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_checksum</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">segment</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">calculate_checksum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">segment</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;è®¡ç®—TCPæ ¡éªŒå’Œï¼ˆç®€åŒ–ç‰ˆï¼‰&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># å®é™…å®ç°éœ€è¦åŒ…å«ä¼ªå¤´éƒ¨</span>
</span></span><span class="line"><span class="cl">        <span class="n">checksum</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="n">checksum</span> <span class="o">+=</span> <span class="n">segment</span><span class="p">[</span><span class="s2">&#34;æºç«¯å£&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">checksum</span> <span class="o">+=</span> <span class="n">segment</span><span class="p">[</span><span class="s2">&#34;ç›®æ ‡ç«¯å£&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">checksum</span> <span class="o">+=</span> <span class="p">(</span><span class="n">segment</span><span class="p">[</span><span class="s2">&#34;åºåˆ—å·&#34;</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">segment</span><span class="p">[</span><span class="s2">&#34;åºåˆ—å·&#34;</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">checksum</span> <span class="o">+=</span> <span class="p">(</span><span class="n">segment</span><span class="p">[</span><span class="s2">&#34;ç¡®è®¤å·&#34;</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">segment</span><span class="p">[</span><span class="s2">&#34;ç¡®è®¤å·&#34;</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># å¤„ç†è¿›ä½</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="n">checksum</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">checksum</span> <span class="o">=</span> <span class="p">(</span><span class="n">checksum</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">checksum</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="o">~</span><span class="n">checksum</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># TCPæŠ¥æ–‡æ®µç¤ºä¾‹</span>
</span></span><span class="line"><span class="cl"><span class="n">tcp_header</span> <span class="o">=</span> <span class="n">TCPHeader</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åˆ›å»ºSYNæŠ¥æ–‡æ®µ</span>
</span></span><span class="line"><span class="cl"><span class="n">syn_segment</span> <span class="o">=</span> <span class="n">tcp_header</span><span class="o">.</span><span class="n">create_segment</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">src_port</span><span class="o">=</span><span class="mi">12345</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">dst_port</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">seq_num</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">ack_num</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">flags</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;SYN&#34;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&#34;ACK&#34;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="n">window_size</span><span class="o">=</span><span class="mi">65535</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;SYNæŠ¥æ–‡æ®µ:&#34;</span><span class="p">,</span> <span class="n">syn_segment</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è§£ææ ‡å¿—ä½</span>
</span></span><span class="line"><span class="cl"><span class="n">flags_byte</span> <span class="o">=</span> <span class="mh">0x02</span>  <span class="c1"># SYNæ ‡å¿—</span>
</span></span><span class="line"><span class="cl"><span class="n">parsed_flags</span> <span class="o">=</span> <span class="n">tcp_header</span><span class="o">.</span><span class="n">parse_flags</span><span class="p">(</span><span class="n">flags_byte</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;è§£æçš„æ ‡å¿—ä½:&#34;</span><span class="p">,</span> <span class="n">parsed_flags</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="tcpè¿æ¥ç®¡ç†">TCPè¿æ¥ç®¡ç†</h2>
<h3 id="ä¸‰æ¬¡æ¡æ‰‹è¿æ¥å»ºç«‹">ä¸‰æ¬¡æ¡æ‰‹ï¼ˆè¿æ¥å»ºç«‹ï¼‰</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">TCPConnection</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;TCPè¿æ¥ç®¡ç†&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="s2">&#34;CLOSED&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">seq_num</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">ack_num</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">connections</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">three_way_handshake</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">client_id</span><span class="p">,</span> <span class="n">server_id</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;ä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹æ¨¡æ‹Ÿ&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">handshake_steps</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># ç¬¬ä¸€æ­¥ï¼šå®¢æˆ·ç«¯å‘é€SYN</span>
</span></span><span class="line"><span class="cl">        <span class="n">client_seq</span> <span class="o">=</span> <span class="mi">1000</span>
</span></span><span class="line"><span class="cl">        <span class="n">step1</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ­¥éª¤&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;å‘é€æ–¹&#34;</span><span class="p">:</span> <span class="n">client_id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ¥æ”¶æ–¹&#34;</span><span class="p">:</span> <span class="n">server_id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æŠ¥æ–‡ç±»å‹&#34;</span><span class="p">:</span> <span class="s2">&#34;SYN&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;åºåˆ—å·&#34;</span><span class="p">:</span> <span class="n">client_seq</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;ç¡®è®¤å·&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ ‡å¿—ä½&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;SYN&#34;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&#34;ACK&#34;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æè¿°&#34;</span><span class="p">:</span> <span class="s2">&#34;å®¢æˆ·ç«¯è¯·æ±‚å»ºç«‹è¿æ¥&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;å®¢æˆ·ç«¯çŠ¶æ€&#34;</span><span class="p">:</span> <span class="s2">&#34;SYN_SENT&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æœåŠ¡å™¨çŠ¶æ€&#34;</span><span class="p">:</span> <span class="s2">&#34;LISTEN&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">handshake_steps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">step1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># ç¬¬äºŒæ­¥ï¼šæœåŠ¡å™¨å‘é€SYN+ACK</span>
</span></span><span class="line"><span class="cl">        <span class="n">server_seq</span> <span class="o">=</span> <span class="mi">2000</span>
</span></span><span class="line"><span class="cl">        <span class="n">step2</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ­¥éª¤&#34;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;å‘é€æ–¹&#34;</span><span class="p">:</span> <span class="n">server_id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ¥æ”¶æ–¹&#34;</span><span class="p">:</span> <span class="n">client_id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æŠ¥æ–‡ç±»å‹&#34;</span><span class="p">:</span> <span class="s2">&#34;SYN+ACK&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;åºåˆ—å·&#34;</span><span class="p">:</span> <span class="n">server_seq</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;ç¡®è®¤å·&#34;</span><span class="p">:</span> <span class="n">client_seq</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ ‡å¿—ä½&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;SYN&#34;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&#34;ACK&#34;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æè¿°&#34;</span><span class="p">:</span> <span class="s2">&#34;æœåŠ¡å™¨ç¡®è®¤è¿æ¥è¯·æ±‚å¹¶å‘é€è‡ªå·±çš„è¿æ¥è¯·æ±‚&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;å®¢æˆ·ç«¯çŠ¶æ€&#34;</span><span class="p">:</span> <span class="s2">&#34;SYN_SENT&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æœåŠ¡å™¨çŠ¶æ€&#34;</span><span class="p">:</span> <span class="s2">&#34;SYN_RCVD&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">handshake_steps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">step2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># ç¬¬ä¸‰æ­¥ï¼šå®¢æˆ·ç«¯å‘é€ACK</span>
</span></span><span class="line"><span class="cl">        <span class="n">step3</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ­¥éª¤&#34;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;å‘é€æ–¹&#34;</span><span class="p">:</span> <span class="n">client_id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ¥æ”¶æ–¹&#34;</span><span class="p">:</span> <span class="n">server_id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æŠ¥æ–‡ç±»å‹&#34;</span><span class="p">:</span> <span class="s2">&#34;ACK&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;åºåˆ—å·&#34;</span><span class="p">:</span> <span class="n">client_seq</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;ç¡®è®¤å·&#34;</span><span class="p">:</span> <span class="n">server_seq</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ ‡å¿—ä½&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;SYN&#34;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&#34;ACK&#34;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æè¿°&#34;</span><span class="p">:</span> <span class="s2">&#34;å®¢æˆ·ç«¯ç¡®è®¤æœåŠ¡å™¨çš„è¿æ¥è¯·æ±‚&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;å®¢æˆ·ç«¯çŠ¶æ€&#34;</span><span class="p">:</span> <span class="s2">&#34;ESTABLISHED&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æœåŠ¡å™¨çŠ¶æ€&#34;</span><span class="p">:</span> <span class="s2">&#34;ESTABLISHED&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">handshake_steps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">step3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># å»ºç«‹è¿æ¥</span>
</span></span><span class="line"><span class="cl">        <span class="n">connection_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">client_id</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">server_id</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">connections</span><span class="p">[</span><span class="n">connection_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;å®¢æˆ·ç«¯&#34;</span><span class="p">:</span> <span class="n">client_id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æœåŠ¡å™¨&#34;</span><span class="p">:</span> <span class="n">server_id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;çŠ¶æ€&#34;</span><span class="p">:</span> <span class="s2">&#34;ESTABLISHED&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;å®¢æˆ·ç«¯åºåˆ—å·&#34;</span><span class="p">:</span> <span class="n">client_seq</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æœåŠ¡å™¨åºåˆ—å·&#34;</span><span class="p">:</span> <span class="n">server_seq</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;å»ºç«‹æ—¶é—´&#34;</span><span class="p">:</span> <span class="s2">&#34;2024-02-28T14:30:00Z&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ¡æ‰‹æ­¥éª¤&#34;</span><span class="p">:</span> <span class="n">handshake_steps</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;è¿æ¥ä¿¡æ¯&#34;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">connections</span><span class="p">[</span><span class="n">connection_id</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;è¿æ¥ID&#34;</span><span class="p">:</span> <span class="n">connection_id</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">four_way_handshake</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">connection_id</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;å››æ¬¡æŒ¥æ‰‹è¿‡ç¨‹æ¨¡æ‹Ÿ&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">connection_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">connections</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="p">{</span><span class="s2">&#34;é”™è¯¯&#34;</span><span class="p">:</span> <span class="s2">&#34;è¿æ¥ä¸å­˜åœ¨&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">connections</span><span class="p">[</span><span class="n">connection_id</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">client_id</span> <span class="o">=</span> <span class="n">connection</span><span class="p">[</span><span class="s2">&#34;å®¢æˆ·ç«¯&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">server_id</span> <span class="o">=</span> <span class="n">connection</span><span class="p">[</span><span class="s2">&#34;æœåŠ¡å™¨&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">handshake_steps</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># ç¬¬ä¸€æ­¥ï¼šå®¢æˆ·ç«¯å‘é€FIN</span>
</span></span><span class="line"><span class="cl">        <span class="n">step1</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ­¥éª¤&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;å‘é€æ–¹&#34;</span><span class="p">:</span> <span class="n">client_id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ¥æ”¶æ–¹&#34;</span><span class="p">:</span> <span class="n">server_id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æŠ¥æ–‡ç±»å‹&#34;</span><span class="p">:</span> <span class="s2">&#34;FIN&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ ‡å¿—ä½&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;FIN&#34;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&#34;ACK&#34;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æè¿°&#34;</span><span class="p">:</span> <span class="s2">&#34;å®¢æˆ·ç«¯è¯·æ±‚å…³é—­è¿æ¥&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;å®¢æˆ·ç«¯çŠ¶æ€&#34;</span><span class="p">:</span> <span class="s2">&#34;FIN_WAIT_1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æœåŠ¡å™¨çŠ¶æ€&#34;</span><span class="p">:</span> <span class="s2">&#34;ESTABLISHED&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">handshake_steps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">step1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># ç¬¬äºŒæ­¥ï¼šæœåŠ¡å™¨å‘é€ACK</span>
</span></span><span class="line"><span class="cl">        <span class="n">step2</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ­¥éª¤&#34;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;å‘é€æ–¹&#34;</span><span class="p">:</span> <span class="n">server_id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ¥æ”¶æ–¹&#34;</span><span class="p">:</span> <span class="n">client_id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æŠ¥æ–‡ç±»å‹&#34;</span><span class="p">:</span> <span class="s2">&#34;ACK&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ ‡å¿—ä½&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;FIN&#34;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&#34;ACK&#34;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æè¿°&#34;</span><span class="p">:</span> <span class="s2">&#34;æœåŠ¡å™¨ç¡®è®¤å®¢æˆ·ç«¯çš„å…³é—­è¯·æ±‚&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;å®¢æˆ·ç«¯çŠ¶æ€&#34;</span><span class="p">:</span> <span class="s2">&#34;FIN_WAIT_2&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æœåŠ¡å™¨çŠ¶æ€&#34;</span><span class="p">:</span> <span class="s2">&#34;CLOSE_WAIT&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">handshake_steps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">step2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># ç¬¬ä¸‰æ­¥ï¼šæœåŠ¡å™¨å‘é€FIN</span>
</span></span><span class="line"><span class="cl">        <span class="n">step3</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ­¥éª¤&#34;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;å‘é€æ–¹&#34;</span><span class="p">:</span> <span class="n">server_id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ¥æ”¶æ–¹&#34;</span><span class="p">:</span> <span class="n">client_id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æŠ¥æ–‡ç±»å‹&#34;</span><span class="p">:</span> <span class="s2">&#34;FIN&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ ‡å¿—ä½&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;FIN&#34;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&#34;ACK&#34;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æè¿°&#34;</span><span class="p">:</span> <span class="s2">&#34;æœåŠ¡å™¨è¯·æ±‚å…³é—­è¿æ¥&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;å®¢æˆ·ç«¯çŠ¶æ€&#34;</span><span class="p">:</span> <span class="s2">&#34;FIN_WAIT_2&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æœåŠ¡å™¨çŠ¶æ€&#34;</span><span class="p">:</span> <span class="s2">&#34;LAST_ACK&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">handshake_steps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">step3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># ç¬¬å››æ­¥ï¼šå®¢æˆ·ç«¯å‘é€ACK</span>
</span></span><span class="line"><span class="cl">        <span class="n">step4</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ­¥éª¤&#34;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;å‘é€æ–¹&#34;</span><span class="p">:</span> <span class="n">client_id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ¥æ”¶æ–¹&#34;</span><span class="p">:</span> <span class="n">server_id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æŠ¥æ–‡ç±»å‹&#34;</span><span class="p">:</span> <span class="s2">&#34;ACK&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ ‡å¿—ä½&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;FIN&#34;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&#34;ACK&#34;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æè¿°&#34;</span><span class="p">:</span> <span class="s2">&#34;å®¢æˆ·ç«¯ç¡®è®¤æœåŠ¡å™¨çš„å…³é—­è¯·æ±‚&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;å®¢æˆ·ç«¯çŠ¶æ€&#34;</span><span class="p">:</span> <span class="s2">&#34;TIME_WAIT&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æœåŠ¡å™¨çŠ¶æ€&#34;</span><span class="p">:</span> <span class="s2">&#34;CLOSED&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">handshake_steps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">step4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># åˆ é™¤è¿æ¥</span>
</span></span><span class="line"><span class="cl">        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">connections</span><span class="p">[</span><span class="n">connection_id</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æŒ¥æ‰‹æ­¥éª¤&#34;</span><span class="p">:</span> <span class="n">handshake_steps</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;è¿æ¥çŠ¶æ€&#34;</span><span class="p">:</span> <span class="s2">&#34;å·²å…³é—­&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¿æ¥ç®¡ç†ç¤ºä¾‹</span>
</span></span><span class="line"><span class="cl"><span class="n">tcp_conn</span> <span class="o">=</span> <span class="n">TCPConnection</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å»ºç«‹è¿æ¥</span>
</span></span><span class="line"><span class="cl"><span class="n">connection_result</span> <span class="o">=</span> <span class="n">tcp_conn</span><span class="o">.</span><span class="n">three_way_handshake</span><span class="p">(</span><span class="s2">&#34;Client_A&#34;</span><span class="p">,</span> <span class="s2">&#34;Server_B&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;ä¸‰æ¬¡æ¡æ‰‹ç»“æœ:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">connection_result</span><span class="p">[</span><span class="s2">&#34;æ¡æ‰‹æ­¥éª¤&#34;</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;æ­¥éª¤</span><span class="si">{</span><span class="n">step</span><span class="p">[</span><span class="s1">&#39;æ­¥éª¤&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">step</span><span class="p">[</span><span class="s1">&#39;å‘é€æ–¹&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> -&gt; </span><span class="si">{</span><span class="n">step</span><span class="p">[</span><span class="s1">&#39;æ¥æ”¶æ–¹&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">step</span><span class="p">[</span><span class="s1">&#39;æŠ¥æ–‡ç±»å‹&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">) - </span><span class="si">{</span><span class="n">step</span><span class="p">[</span><span class="s1">&#39;æè¿°&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">è¿æ¥å»ºç«‹æˆåŠŸ: </span><span class="si">{</span><span class="n">connection_result</span><span class="p">[</span><span class="s1">&#39;è¿æ¥ID&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å…³é—­è¿æ¥</span>
</span></span><span class="line"><span class="cl"><span class="n">close_result</span> <span class="o">=</span> <span class="n">tcp_conn</span><span class="o">.</span><span class="n">four_way_handshake</span><span class="p">(</span><span class="n">connection_result</span><span class="p">[</span><span class="s1">&#39;è¿æ¥ID&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">å››æ¬¡æŒ¥æ‰‹ç»“æœ:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">close_result</span><span class="p">[</span><span class="s2">&#34;æŒ¥æ‰‹æ­¥éª¤&#34;</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;æ­¥éª¤</span><span class="si">{</span><span class="n">step</span><span class="p">[</span><span class="s1">&#39;æ­¥éª¤&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">step</span><span class="p">[</span><span class="s1">&#39;å‘é€æ–¹&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> -&gt; </span><span class="si">{</span><span class="n">step</span><span class="p">[</span><span class="s1">&#39;æ¥æ”¶æ–¹&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">step</span><span class="p">[</span><span class="s1">&#39;æŠ¥æ–‡ç±»å‹&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">) - </span><span class="si">{</span><span class="n">step</span><span class="p">[</span><span class="s1">&#39;æè¿°&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="tcpçŠ¶æ€è½¬æ¢å›¾">TCPçŠ¶æ€è½¬æ¢å›¾</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">TCPStateMachine</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;TCPçŠ¶æ€æœº&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">states</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;CLOSED&#34;</span><span class="p">:</span> <span class="s2">&#34;å…³é—­çŠ¶æ€&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;LISTEN&#34;</span><span class="p">:</span> <span class="s2">&#34;ç›‘å¬çŠ¶æ€&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;SYN_SENT&#34;</span><span class="p">:</span> <span class="s2">&#34;å·²å‘é€SYN&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;SYN_RCVD&#34;</span><span class="p">:</span> <span class="s2">&#34;å·²æ¥æ”¶SYN&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;ESTABLISHED&#34;</span><span class="p">:</span> <span class="s2">&#34;è¿æ¥å·²å»ºç«‹&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;FIN_WAIT_1&#34;</span><span class="p">:</span> <span class="s2">&#34;ç­‰å¾…FINç¡®è®¤&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;FIN_WAIT_2&#34;</span><span class="p">:</span> <span class="s2">&#34;ç­‰å¾…å¯¹æ–¹FIN&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;CLOSE_WAIT&#34;</span><span class="p">:</span> <span class="s2">&#34;ç­‰å¾…å…³é—­&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;CLOSING&#34;</span><span class="p">:</span> <span class="s2">&#34;æ­£åœ¨å…³é—­&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;LAST_ACK&#34;</span><span class="p">:</span> <span class="s2">&#34;æœ€åç¡®è®¤&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;TIME_WAIT&#34;</span><span class="p">:</span> <span class="s2">&#34;æ—¶é—´ç­‰å¾…&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">transitions</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="s2">&#34;CLOSED&#34;</span><span class="p">,</span> <span class="s2">&#34;ä¸»åŠ¨æ‰“å¼€&#34;</span><span class="p">):</span> <span class="s2">&#34;SYN_SENT&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="s2">&#34;CLOSED&#34;</span><span class="p">,</span> <span class="s2">&#34;è¢«åŠ¨æ‰“å¼€&#34;</span><span class="p">):</span> <span class="s2">&#34;LISTEN&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="s2">&#34;LISTEN&#34;</span><span class="p">,</span> <span class="s2">&#34;æ”¶åˆ°SYN&#34;</span><span class="p">):</span> <span class="s2">&#34;SYN_RCVD&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="s2">&#34;SYN_SENT&#34;</span><span class="p">,</span> <span class="s2">&#34;æ”¶åˆ°SYN+ACK&#34;</span><span class="p">):</span> <span class="s2">&#34;ESTABLISHED&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="s2">&#34;SYN_RCVD&#34;</span><span class="p">,</span> <span class="s2">&#34;æ”¶åˆ°ACK&#34;</span><span class="p">):</span> <span class="s2">&#34;ESTABLISHED&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="s2">&#34;ESTABLISHED&#34;</span><span class="p">,</span> <span class="s2">&#34;ä¸»åŠ¨å…³é—­&#34;</span><span class="p">):</span> <span class="s2">&#34;FIN_WAIT_1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="s2">&#34;ESTABLISHED&#34;</span><span class="p">,</span> <span class="s2">&#34;æ”¶åˆ°FIN&#34;</span><span class="p">):</span> <span class="s2">&#34;CLOSE_WAIT&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="s2">&#34;FIN_WAIT_1&#34;</span><span class="p">,</span> <span class="s2">&#34;æ”¶åˆ°ACK&#34;</span><span class="p">):</span> <span class="s2">&#34;FIN_WAIT_2&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="s2">&#34;FIN_WAIT_1&#34;</span><span class="p">,</span> <span class="s2">&#34;æ”¶åˆ°FIN&#34;</span><span class="p">):</span> <span class="s2">&#34;CLOSING&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="s2">&#34;FIN_WAIT_2&#34;</span><span class="p">,</span> <span class="s2">&#34;æ”¶åˆ°FIN&#34;</span><span class="p">):</span> <span class="s2">&#34;TIME_WAIT&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="s2">&#34;CLOSE_WAIT&#34;</span><span class="p">,</span> <span class="s2">&#34;ä¸»åŠ¨å…³é—­&#34;</span><span class="p">):</span> <span class="s2">&#34;LAST_ACK&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="s2">&#34;CLOSING&#34;</span><span class="p">,</span> <span class="s2">&#34;æ”¶åˆ°ACK&#34;</span><span class="p">):</span> <span class="s2">&#34;TIME_WAIT&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="s2">&#34;LAST_ACK&#34;</span><span class="p">,</span> <span class="s2">&#34;æ”¶åˆ°ACK&#34;</span><span class="p">):</span> <span class="s2">&#34;CLOSED&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="s2">&#34;TIME_WAIT&#34;</span><span class="p">,</span> <span class="s2">&#34;è¶…æ—¶&#34;</span><span class="p">):</span> <span class="s2">&#34;CLOSED&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">get_next_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_state</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;è·å–ä¸‹ä¸€ä¸ªçŠ¶æ€&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">transition</span> <span class="o">=</span> <span class="p">(</span><span class="n">current_state</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transitions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">transition</span><span class="p">,</span> <span class="n">current_state</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">simulate_connection_lifecycle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;æ¨¡æ‹Ÿè¿æ¥ç”Ÿå‘½å‘¨æœŸ&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">lifecycle</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># å®¢æˆ·ç«¯çŠ¶æ€å˜åŒ–</span>
</span></span><span class="line"><span class="cl">        <span class="n">client_states</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="s2">&#34;CLOSED&#34;</span><span class="p">,</span> <span class="s2">&#34;ä¸»åŠ¨æ‰“å¼€&#34;</span><span class="p">,</span> <span class="s2">&#34;SYN_SENT&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="s2">&#34;SYN_SENT&#34;</span><span class="p">,</span> <span class="s2">&#34;æ”¶åˆ°SYN+ACK&#34;</span><span class="p">,</span> <span class="s2">&#34;ESTABLISHED&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="s2">&#34;ESTABLISHED&#34;</span><span class="p">,</span> <span class="s2">&#34;ä¸»åŠ¨å…³é—­&#34;</span><span class="p">,</span> <span class="s2">&#34;FIN_WAIT_1&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="s2">&#34;FIN_WAIT_1&#34;</span><span class="p">,</span> <span class="s2">&#34;æ”¶åˆ°ACK&#34;</span><span class="p">,</span> <span class="s2">&#34;FIN_WAIT_2&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="s2">&#34;FIN_WAIT_2&#34;</span><span class="p">,</span> <span class="s2">&#34;æ”¶åˆ°FIN&#34;</span><span class="p">,</span> <span class="s2">&#34;TIME_WAIT&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="s2">&#34;TIME_WAIT&#34;</span><span class="p">,</span> <span class="s2">&#34;è¶…æ—¶&#34;</span><span class="p">,</span> <span class="s2">&#34;CLOSED&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># æœåŠ¡å™¨çŠ¶æ€å˜åŒ–</span>
</span></span><span class="line"><span class="cl">        <span class="n">server_states</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="s2">&#34;CLOSED&#34;</span><span class="p">,</span> <span class="s2">&#34;è¢«åŠ¨æ‰“å¼€&#34;</span><span class="p">,</span> <span class="s2">&#34;LISTEN&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="s2">&#34;LISTEN&#34;</span><span class="p">,</span> <span class="s2">&#34;æ”¶åˆ°SYN&#34;</span><span class="p">,</span> <span class="s2">&#34;SYN_RCVD&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="s2">&#34;SYN_RCVD&#34;</span><span class="p">,</span> <span class="s2">&#34;æ”¶åˆ°ACK&#34;</span><span class="p">,</span> <span class="s2">&#34;ESTABLISHED&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="s2">&#34;ESTABLISHED&#34;</span><span class="p">,</span> <span class="s2">&#34;æ”¶åˆ°FIN&#34;</span><span class="p">,</span> <span class="s2">&#34;CLOSE_WAIT&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="s2">&#34;CLOSE_WAIT&#34;</span><span class="p">,</span> <span class="s2">&#34;ä¸»åŠ¨å…³é—­&#34;</span><span class="p">,</span> <span class="s2">&#34;LAST_ACK&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="s2">&#34;LAST_ACK&#34;</span><span class="p">,</span> <span class="s2">&#34;æ”¶åˆ°ACK&#34;</span><span class="p">,</span> <span class="s2">&#34;CLOSED&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;å®¢æˆ·ç«¯çŠ¶æ€å˜åŒ–&#34;</span><span class="p">:</span> <span class="n">client_states</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æœåŠ¡å™¨çŠ¶æ€å˜åŒ–&#34;</span><span class="p">:</span> <span class="n">server_states</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># çŠ¶æ€æœºç¤ºä¾‹</span>
</span></span><span class="line"><span class="cl"><span class="n">state_machine</span> <span class="o">=</span> <span class="n">TCPStateMachine</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">lifecycle</span> <span class="o">=</span> <span class="n">state_machine</span><span class="o">.</span><span class="n">simulate_connection_lifecycle</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;TCPè¿æ¥ç”Ÿå‘½å‘¨æœŸ:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">å®¢æˆ·ç«¯çŠ¶æ€å˜åŒ–:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">current</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">next_state</span> <span class="ow">in</span> <span class="n">lifecycle</span><span class="p">[</span><span class="s2">&#34;å®¢æˆ·ç«¯çŠ¶æ€å˜åŒ–&#34;</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;  </span><span class="si">{</span><span class="n">current</span><span class="si">}</span><span class="s2"> --[</span><span class="si">{</span><span class="n">event</span><span class="si">}</span><span class="s2">]--&gt; </span><span class="si">{</span><span class="n">next_state</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">æœåŠ¡å™¨çŠ¶æ€å˜åŒ–:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">current</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">next_state</span> <span class="ow">in</span> <span class="n">lifecycle</span><span class="p">[</span><span class="s2">&#34;æœåŠ¡å™¨çŠ¶æ€å˜åŒ–&#34;</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;  </span><span class="si">{</span><span class="n">current</span><span class="si">}</span><span class="s2"> --[</span><span class="si">{</span><span class="n">event</span><span class="si">}</span><span class="s2">]--&gt; </span><span class="si">{</span><span class="n">next_state</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="tcpå¯é ä¼ è¾“æœºåˆ¶">TCPå¯é ä¼ è¾“æœºåˆ¶</h2>
<h3 id="åºåˆ—å·å’Œç¡®è®¤æœºåˆ¶">åºåˆ—å·å’Œç¡®è®¤æœºåˆ¶</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">TCPReliableTransmission</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;TCPå¯é ä¼ è¾“æœºåˆ¶&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initial_seq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">seq_num</span> <span class="o">=</span> <span class="n">initial_seq</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">ack_num</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">send_buffer</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">receive_buffer</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">expected_seq</span> <span class="o">=</span> <span class="n">initial_seq</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">rtt_samples</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">rto</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># é‡ä¼ è¶…æ—¶æ—¶é—´</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">send_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">segment_size</span><span class="o">=</span><span class="mi">1024</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;å‘é€æ•°æ®&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">segments</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">        <span class="n">data_bytes</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">data</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># åˆ†æ®µå‘é€</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_bytes</span><span class="p">),</span> <span class="n">segment_size</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">segment_data</span> <span class="o">=</span> <span class="n">data_bytes</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">segment_size</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">segment</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;åºåˆ—å·&#34;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq_num</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;æ•°æ®&#34;</span><span class="p">:</span> <span class="n">segment_data</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é•¿åº¦&#34;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">segment_data</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;å‘é€æ—¶é—´&#34;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é‡ä¼ æ¬¡æ•°&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;å·²ç¡®è®¤&#34;</span><span class="p">:</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="n">segments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">send_buffer</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">seq_num</span><span class="p">]</span> <span class="o">=</span> <span class="n">segment</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">seq_num</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">segment_data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">segments</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">receive_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">segment</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;æ¥æ”¶æ•°æ®&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">seq_num</span> <span class="o">=</span> <span class="n">segment</span><span class="p">[</span><span class="s2">&#34;åºåˆ—å·&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="n">segment</span><span class="p">[</span><span class="s2">&#34;æ•°æ®&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">data_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># æ£€æŸ¥åºåˆ—å·</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">seq_num</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">expected_seq</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># æŒ‰åºåˆ°è¾¾</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">receive_buffer</span><span class="p">[</span><span class="n">seq_num</span><span class="p">]</span> <span class="o">=</span> <span class="n">segment</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">expected_seq</span> <span class="o">+=</span> <span class="n">data_len</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="c1"># æ£€æŸ¥ç¼“å†²åŒºä¸­æ˜¯å¦æœ‰è¿ç»­çš„æ•°æ®</span>
</span></span><span class="line"><span class="cl">            <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">expected_seq</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">receive_buffer</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">next_segment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">receive_buffer</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">expected_seq</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">                <span class="bp">self</span><span class="o">.</span><span class="n">expected_seq</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">next_segment</span><span class="p">[</span><span class="s2">&#34;æ•°æ®&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;çŠ¶æ€&#34;</span><span class="p">:</span> <span class="s2">&#34;æŒ‰åºæ¥æ”¶&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç¡®è®¤å·&#34;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">expected_seq</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;æ¥æ”¶æ•°æ®&#34;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)</span> <span class="k">else</span> <span class="n">data</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="n">seq_num</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">expected_seq</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># å¤±åºåˆ°è¾¾ï¼Œç¼“å­˜æ•°æ®</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">receive_buffer</span><span class="p">[</span><span class="n">seq_num</span><span class="p">]</span> <span class="o">=</span> <span class="n">segment</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;çŠ¶æ€&#34;</span><span class="p">:</span> <span class="s2">&#34;å¤±åºæ¥æ”¶&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç¡®è®¤å·&#34;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">expected_seq</span><span class="p">,</span>  <span class="c1"># å‘é€æœŸæœ›çš„åºåˆ—å·</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç¼“å­˜æ•°æ®&#34;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)</span> <span class="k">else</span> <span class="n">data</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># é‡å¤æ•°æ®</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;çŠ¶æ€&#34;</span><span class="p">:</span> <span class="s2">&#34;é‡å¤æ•°æ®&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç¡®è®¤å·&#34;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">expected_seq</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ä¸¢å¼ƒæ•°æ®&#34;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)</span> <span class="k">else</span> <span class="n">data</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">process_ack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ack_num</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;å¤„ç†ç¡®è®¤&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">confirmed_segments</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># ç¡®è®¤æ‰€æœ‰åºåˆ—å·å°äºack_numçš„æ®µ</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">seq_num</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">send_buffer</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">seq_num</span> <span class="o">&lt;</span> <span class="n">ack_num</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">segment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_buffer</span><span class="p">[</span><span class="n">seq_num</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">                <span class="n">segment</span><span class="p">[</span><span class="s2">&#34;å·²ç¡®è®¤&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">                <span class="n">confirmed_segments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                <span class="c1"># è®¡ç®—RTT</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="s2">&#34;å‘é€æ—¶é—´&#34;</span> <span class="ow">in</span> <span class="n">segment</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">rtt</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">segment</span><span class="p">[</span><span class="s2">&#34;å‘é€æ—¶é—´&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">                    <span class="bp">self</span><span class="o">.</span><span class="n">rtt_samples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rtt</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="bp">self</span><span class="o">.</span><span class="n">update_rto</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_buffer</span><span class="p">[</span><span class="n">seq_num</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;ç¡®è®¤çš„æ®µæ•°&#34;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">confirmed_segments</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;å‰©ä½™æœªç¡®è®¤æ®µæ•°&#34;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">send_buffer</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;å½“å‰RTO&#34;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">rto</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">update_rto</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;æ›´æ–°é‡ä¼ è¶…æ—¶æ—¶é—´&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">rtt_samples</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># ç®€åŒ–çš„RTOè®¡ç®—</span>
</span></span><span class="line"><span class="cl">        <span class="n">avg_rtt</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rtt_samples</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">:])</span> <span class="o">/</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rtt_samples</span><span class="p">),</span> <span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">rto</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">avg_rtt</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># ç®€å•çš„RTOç®—æ³•</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">check_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;æ£€æŸ¥è¶…æ—¶é‡ä¼ &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">current_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">timeout_segments</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">seq_num</span><span class="p">,</span> <span class="n">segment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_buffer</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="ow">not</span> <span class="n">segment</span><span class="p">[</span><span class="s2">&#34;å·²ç¡®è®¤&#34;</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">                <span class="n">elapsed</span> <span class="o">=</span> <span class="n">current_time</span> <span class="o">-</span> <span class="n">segment</span><span class="p">[</span><span class="s2">&#34;å‘é€æ—¶é—´&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">elapsed</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">rto</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">segment</span><span class="p">[</span><span class="s2">&#34;é‡ä¼ æ¬¡æ•°&#34;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">                    <span class="n">segment</span><span class="p">[</span><span class="s2">&#34;å‘é€æ—¶é—´&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_time</span>
</span></span><span class="line"><span class="cl">                    <span class="n">timeout_segments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">timeout_segments</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¯é ä¼ è¾“ç¤ºä¾‹</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">sender</span> <span class="o">=</span> <span class="n">TCPReliableTransmission</span><span class="p">(</span><span class="n">initial_seq</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">receiver</span> <span class="o">=</span> <span class="n">TCPReliableTransmission</span><span class="p">(</span><span class="n">initial_seq</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å‘é€æ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="n">message</span> <span class="o">=</span> <span class="s2">&#34;Hello, TCP World! This is a test message for reliable transmission.&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">segments</span> <span class="o">=</span> <span class="n">sender</span><span class="o">.</span><span class="n">send_data</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">segment_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;å‘é€çš„æ•°æ®æ®µ:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">segment</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">segments</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;æ®µ</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: åºåˆ—å·=</span><span class="si">{</span><span class="n">segment</span><span class="p">[</span><span class="s1">&#39;åºåˆ—å·&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, é•¿åº¦=</span><span class="si">{</span><span class="n">segment</span><span class="p">[</span><span class="s1">&#39;é•¿åº¦&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, æ•°æ®=&#39;</span><span class="si">{</span><span class="n">segment</span><span class="p">[</span><span class="s1">&#39;æ•°æ®&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&#39;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">æ¥æ”¶è¿‡ç¨‹:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># æ¨¡æ‹ŸæŒ‰åºæ¥æ”¶</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="n">segments</span><span class="p">[:</span><span class="mi">3</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="n">receiver</span><span class="o">.</span><span class="n">receive_data</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;æ¥æ”¶æ®µ </span><span class="si">{</span><span class="n">segment</span><span class="p">[</span><span class="s1">&#39;åºåˆ—å·&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;çŠ¶æ€&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, ç¡®è®¤å·=</span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;ç¡®è®¤å·&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ¨¡æ‹Ÿå¤±åºæ¥æ”¶ï¼ˆè·³è¿‡ä¸€ä¸ªæ®µï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">segments</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="n">receiver</span><span class="o">.</span><span class="n">receive_data</span><span class="p">(</span><span class="n">segments</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;æ¥æ”¶æ®µ </span><span class="si">{</span><span class="n">segments</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="s1">&#39;åºåˆ—å·&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;çŠ¶æ€&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, ç¡®è®¤å·=</span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;ç¡®è®¤å·&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ¥æ”¶ç¼ºå¤±çš„æ®µ</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">segments</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="n">receiver</span><span class="o">.</span><span class="n">receive_data</span><span class="p">(</span><span class="n">segments</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;æ¥æ”¶æ®µ </span><span class="si">{</span><span class="n">segments</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="s1">&#39;åºåˆ—å·&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;çŠ¶æ€&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, ç¡®è®¤å·=</span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;ç¡®è®¤å·&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="tcpæµé‡æ§åˆ¶">TCPæµé‡æ§åˆ¶</h2>
<h3 id="æ»‘åŠ¨çª—å£æœºåˆ¶">æ»‘åŠ¨çª—å£æœºåˆ¶</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">TCPFlowControl</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;TCPæµé‡æ§åˆ¶&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="mi">65535</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="o">=</span> <span class="n">window_size</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">send_window</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;base&#34;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>  <span class="c1"># å‘é€çª—å£åŸºåºå·</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;next_seq&#34;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>  <span class="c1"># ä¸‹ä¸€ä¸ªå‘é€åºå·</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;size&#34;</span><span class="p">:</span> <span class="n">window_size</span><span class="p">,</span>  <span class="c1"># çª—å£å¤§å°</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;used&#34;</span><span class="p">:</span> <span class="mi">0</span>  <span class="c1"># å·²ä½¿ç”¨çª—å£å¤§å°</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">receive_window</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;base&#34;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>  <span class="c1"># æ¥æ”¶çª—å£åŸºåºå·</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;size&#34;</span><span class="p">:</span> <span class="n">window_size</span><span class="p">,</span>  <span class="c1"># çª—å£å¤§å°</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;available&#34;</span><span class="p">:</span> <span class="n">window_size</span><span class="p">,</span>  <span class="c1"># å¯ç”¨çª—å£å¤§å°</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;buffer&#34;</span><span class="p">:</span> <span class="p">{}</span>  <span class="c1"># æ¥æ”¶ç¼“å†²åŒº</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">can_send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_size</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;æ£€æŸ¥æ˜¯å¦å¯ä»¥å‘é€æ•°æ®&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">available_window</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_window</span><span class="p">[</span><span class="s2">&#34;size&#34;</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_window</span><span class="p">[</span><span class="s2">&#34;used&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">data_size</span> <span class="o">&lt;=</span> <span class="n">available_window</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">send_segment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_size</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;å‘é€æ•°æ®æ®µ&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">can_send</span><span class="p">(</span><span class="n">data_size</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;çŠ¶æ€&#34;</span><span class="p">:</span> <span class="s2">&#34;çª—å£å·²æ»¡&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;å¯ç”¨çª—å£&#34;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_window</span><span class="p">[</span><span class="s2">&#34;size&#34;</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_window</span><span class="p">[</span><span class="s2">&#34;used&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;è¯·æ±‚å¤§å°&#34;</span><span class="p">:</span> <span class="n">data_size</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># å‘é€æ•°æ®</span>
</span></span><span class="line"><span class="cl">        <span class="n">seq_num</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_window</span><span class="p">[</span><span class="s2">&#34;next_seq&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">send_window</span><span class="p">[</span><span class="s2">&#34;next_seq&#34;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">data_size</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">send_window</span><span class="p">[</span><span class="s2">&#34;used&#34;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">data_size</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;çŠ¶æ€&#34;</span><span class="p">:</span> <span class="s2">&#34;å‘é€æˆåŠŸ&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;åºåˆ—å·&#34;</span><span class="p">:</span> <span class="n">seq_num</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ•°æ®å¤§å°&#34;</span><span class="p">:</span> <span class="n">data_size</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;å‰©ä½™çª—å£&#34;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_window</span><span class="p">[</span><span class="s2">&#34;size&#34;</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_window</span><span class="p">[</span><span class="s2">&#34;used&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">receive_ack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ack_num</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;æ¥æ”¶ç¡®è®¤&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">ack_num</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_window</span><span class="p">[</span><span class="s2">&#34;base&#34;</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># æ»‘åŠ¨å‘é€çª—å£</span>
</span></span><span class="line"><span class="cl">            <span class="n">acked_bytes</span> <span class="o">=</span> <span class="n">ack_num</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_window</span><span class="p">[</span><span class="s2">&#34;base&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">send_window</span><span class="p">[</span><span class="s2">&#34;base&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ack_num</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">send_window</span><span class="p">[</span><span class="s2">&#34;used&#34;</span><span class="p">]</span> <span class="o">-=</span> <span class="n">acked_bytes</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;çŠ¶æ€&#34;</span><span class="p">:</span> <span class="s2">&#34;çª—å£æ»‘åŠ¨&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç¡®è®¤å­—èŠ‚æ•°&#34;</span><span class="p">:</span> <span class="n">acked_bytes</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;æ–°çª—å£åŸºåºå·&#34;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_window</span><span class="p">[</span><span class="s2">&#34;base&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;å¯ç”¨çª—å£&#34;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_window</span><span class="p">[</span><span class="s2">&#34;size&#34;</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_window</span><span class="p">[</span><span class="s2">&#34;used&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">{</span><span class="s2">&#34;çŠ¶æ€&#34;</span><span class="p">:</span> <span class="s2">&#34;é‡å¤ç¡®è®¤&#34;</span><span class="p">,</span> <span class="s2">&#34;ç¡®è®¤å·&#34;</span><span class="p">:</span> <span class="n">ack_num</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">receive_segment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seq_num</span><span class="p">,</span> <span class="n">data_size</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;æ¥æ”¶æ•°æ®æ®µ&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># æ£€æŸ¥æ˜¯å¦åœ¨æ¥æ”¶çª—å£å†…</span>
</span></span><span class="line"><span class="cl">        <span class="n">window_end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">receive_window</span><span class="p">[</span><span class="s2">&#34;base&#34;</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">receive_window</span><span class="p">[</span><span class="s2">&#34;size&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">seq_num</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">receive_window</span><span class="p">[</span><span class="s2">&#34;base&#34;</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="p">{</span><span class="s2">&#34;çŠ¶æ€&#34;</span><span class="p">:</span> <span class="s2">&#34;é‡å¤æ•°æ®&#34;</span><span class="p">,</span> <span class="s2">&#34;åºåˆ—å·&#34;</span><span class="p">:</span> <span class="n">seq_num</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">seq_num</span> <span class="o">&gt;=</span> <span class="n">window_end</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="p">{</span><span class="s2">&#34;çŠ¶æ€&#34;</span><span class="p">:</span> <span class="s2">&#34;è¶…å‡ºçª—å£&#34;</span><span class="p">,</span> <span class="s2">&#34;åºåˆ—å·&#34;</span><span class="p">:</span> <span class="n">seq_num</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># æ¥æ”¶æ•°æ®</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">receive_window</span><span class="p">[</span><span class="s2">&#34;buffer&#34;</span><span class="p">][</span><span class="n">seq_num</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_size</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># æ£€æŸ¥æ˜¯å¦å¯ä»¥æ»‘åŠ¨çª—å£</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">receive_window</span><span class="p">[</span><span class="s2">&#34;base&#34;</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">receive_window</span><span class="p">[</span><span class="s2">&#34;buffer&#34;</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">            <span class="n">data_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">receive_window</span><span class="p">[</span><span class="s2">&#34;buffer&#34;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">receive_window</span><span class="p">[</span><span class="s2">&#34;base&#34;</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">receive_window</span><span class="p">[</span><span class="s2">&#34;buffer&#34;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">receive_window</span><span class="p">[</span><span class="s2">&#34;base&#34;</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">receive_window</span><span class="p">[</span><span class="s2">&#34;base&#34;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">data_size</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># æ›´æ–°å¯ç”¨çª—å£</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">receive_window</span><span class="p">[</span><span class="s2">&#34;available&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">receive_window</span><span class="p">[</span><span class="s2">&#34;size&#34;</span><span class="p">]</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">receive_window</span><span class="p">[</span><span class="s2">&#34;buffer&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;çŠ¶æ€&#34;</span><span class="p">:</span> <span class="s2">&#34;æ¥æ”¶æˆåŠŸ&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;ç¡®è®¤å·&#34;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">receive_window</span><span class="p">[</span><span class="s2">&#34;base&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;çª—å£å¤§å°&#34;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">receive_window</span><span class="p">[</span><span class="s2">&#34;available&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">update_window_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_size</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;æ›´æ–°çª—å£å¤§å°&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">old_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">receive_window</span><span class="p">[</span><span class="s2">&#34;size&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">receive_window</span><span class="p">[</span><span class="s2">&#34;size&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_size</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">receive_window</span><span class="p">[</span><span class="s2">&#34;available&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_size</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">receive_window</span><span class="p">[</span><span class="s2">&#34;buffer&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ—§çª—å£å¤§å°&#34;</span><span class="p">:</span> <span class="n">old_size</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ–°çª—å£å¤§å°&#34;</span><span class="p">:</span> <span class="n">new_size</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;å¯ç”¨çª—å£&#34;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">receive_window</span><span class="p">[</span><span class="s2">&#34;available&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æµé‡æ§åˆ¶ç¤ºä¾‹</span>
</span></span><span class="line"><span class="cl"><span class="n">flow_control</span> <span class="o">=</span> <span class="n">TCPFlowControl</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;TCPæµé‡æ§åˆ¶ç¤ºä¾‹:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;åˆå§‹å‘é€çª—å£: </span><span class="si">{</span><span class="n">flow_control</span><span class="o">.</span><span class="n">send_window</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;åˆå§‹æ¥æ”¶çª—å£: </span><span class="si">{</span><span class="n">flow_control</span><span class="o">.</span><span class="n">receive_window</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å‘é€æ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">å‘é€æ•°æ®:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">size</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mi">300</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">150</span><span class="p">],</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="n">flow_control</span><span class="o">.</span><span class="n">send_segment</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;å‘é€</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ¥æ”¶ç¡®è®¤</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">æ¥æ”¶ç¡®è®¤:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ack_result</span> <span class="o">=</span> <span class="n">flow_control</span><span class="o">.</span><span class="n">receive_ack</span><span class="p">(</span><span class="mi">1700</span><span class="p">)</span>  <span class="c1"># ç¡®è®¤å‰700å­—èŠ‚</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;ç¡®è®¤ç»“æœ: </span><span class="si">{</span><span class="n">ack_result</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç»§ç»­å‘é€</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">ç»§ç»­å‘é€:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">flow_control</span><span class="o">.</span><span class="n">send_segment</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;å‘é€ç»“æœ: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="tcpæ‹¥å¡æ§åˆ¶">TCPæ‹¥å¡æ§åˆ¶</h2>
<h3 id="æ‹¥å¡æ§åˆ¶ç®—æ³•">æ‹¥å¡æ§åˆ¶ç®—æ³•</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">TCPCongestionControl</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;TCPæ‹¥å¡æ§åˆ¶&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">cwnd</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># æ‹¥å¡çª—å£ï¼ˆMSSå•ä½ï¼‰</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">ssthresh</span> <span class="o">=</span> <span class="mi">64</span>  <span class="c1"># æ…¢å¯åŠ¨é˜ˆå€¼</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">mss</span> <span class="o">=</span> <span class="mi">1460</span>  <span class="c1"># æœ€å¤§æ®µå¤§å°</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="s2">&#34;slow_start&#34;</span>  <span class="c1"># æ‹¥å¡æ§åˆ¶çŠ¶æ€</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">dup_ack_count</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># é‡å¤ACKè®¡æ•°</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">rtt_samples</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">rto</span> <span class="o">=</span> <span class="mf">1.0</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">algorithms</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;Reno&#34;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">reno_algorithm</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;Cubic&#34;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">cubic_algorithm</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;BBR&#34;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbr_algorithm</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">reno_algorithm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;TCP Renoç®—æ³•&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">event</span> <span class="o">==</span> <span class="s2">&#34;ack_received&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="s2">&#34;slow_start&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="c1"># æ…¢å¯åŠ¨ï¼šæ¯æ”¶åˆ°ä¸€ä¸ªACKï¼Œcwndå¢åŠ 1</span>
</span></span><span class="line"><span class="cl">                <span class="bp">self</span><span class="o">.</span><span class="n">cwnd</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cwnd</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ssthresh</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="s2">&#34;congestion_avoidance&#34;</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="s2">&#34;congestion_avoidance&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="c1"># æ‹¥å¡é¿å…ï¼šæ¯ä¸ªRTTï¼Œcwndå¢åŠ 1</span>
</span></span><span class="line"><span class="cl">                <span class="bp">self</span><span class="o">.</span><span class="n">cwnd</span> <span class="o">+=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">cwnd</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">dup_ack_count</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="n">event</span> <span class="o">==</span> <span class="s2">&#34;duplicate_ack&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">dup_ack_count</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dup_ack_count</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="c1"># å¿«é€Ÿé‡ä¼ </span>
</span></span><span class="line"><span class="cl">                <span class="bp">self</span><span class="o">.</span><span class="n">ssthresh</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cwnd</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="bp">self</span><span class="o">.</span><span class="n">cwnd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ssthresh</span> <span class="o">+</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">                <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="s2">&#34;fast_recovery&#34;</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="s2">&#34;fast_recovery&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="bp">self</span><span class="o">.</span><span class="n">cwnd</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="n">event</span> <span class="o">==</span> <span class="s2">&#34;timeout&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># è¶…æ—¶é‡ä¼ </span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">ssthresh</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cwnd</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">cwnd</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="s2">&#34;slow_start&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">dup_ack_count</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="n">event</span> <span class="o">==</span> <span class="s2">&#34;new_ack&#34;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="s2">&#34;fast_recovery&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># å¿«é€Ÿæ¢å¤ç»“æŸ</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">cwnd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ssthresh</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="s2">&#34;congestion_avoidance&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">dup_ack_count</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">cubic_algorithm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;TCP CUBICç®—æ³•ï¼ˆç®€åŒ–ç‰ˆï¼‰&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;cubic_state&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">cubic_state</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;w_max&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">cwnd</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;k&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;w_est&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;epoch_start&#39;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">event</span> <span class="o">==</span> <span class="s2">&#34;ack_received&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">current_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="n">t</span> <span class="o">=</span> <span class="n">current_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">cubic_state</span><span class="p">[</span><span class="s1">&#39;epoch_start&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="c1"># CUBICå‡½æ•°ï¼šW(t) = C(t-K)Â³ + W_max</span>
</span></span><span class="line"><span class="cl">            <span class="n">C</span> <span class="o">=</span> <span class="mf">0.4</span>  <span class="c1"># CUBICå‚æ•°</span>
</span></span><span class="line"><span class="cl">            <span class="n">K</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cubic_state</span><span class="p">[</span><span class="s1">&#39;k&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">W_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cubic_state</span><span class="p">[</span><span class="s1">&#39;w_max&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="n">w_cubic</span> <span class="o">=</span> <span class="n">C</span> <span class="o">*</span> <span class="p">((</span><span class="n">t</span> <span class="o">-</span> <span class="n">K</span><span class="p">)</span> <span class="o">**</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">W_max</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="c1"># å‹å¥½æ€§æ£€æŸ¥</span>
</span></span><span class="line"><span class="cl">            <span class="n">w_est</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cubic_state</span><span class="p">[</span><span class="s1">&#39;w_est&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">w_est</span> <span class="o">+=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">w_est</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">cwnd</span><span class="p">)</span>  <span class="c1"># Reno-friendly</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">w_cubic</span> <span class="o">&lt;</span> <span class="n">w_est</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="bp">self</span><span class="o">.</span><span class="n">cwnd</span> <span class="o">=</span> <span class="n">w_est</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="bp">self</span><span class="o">.</span><span class="n">cwnd</span> <span class="o">=</span> <span class="n">w_cubic</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">cubic_state</span><span class="p">[</span><span class="s1">&#39;w_est&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">w_est</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="n">event</span> <span class="o">==</span> <span class="s2">&#34;congestion&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># æ‹¥å¡äº‹ä»¶</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">cubic_state</span><span class="p">[</span><span class="s1">&#39;w_max&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cwnd</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">cwnd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cwnd</span> <span class="o">*</span> <span class="mf">0.7</span>  <span class="c1"># CUBICçš„Î²å€¼</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">cubic_state</span><span class="p">[</span><span class="s1">&#39;k&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cubic_state</span><span class="p">[</span><span class="s1">&#39;w_max&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.3</span> <span class="o">/</span> <span class="mf">0.4</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">cubic_state</span><span class="p">[</span><span class="s1">&#39;epoch_start&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">bbr_algorithm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;BBRç®—æ³•ï¼ˆç®€åŒ–ç‰ˆï¼‰&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;bbr_state&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">bbr_state</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;mode&#39;</span><span class="p">:</span> <span class="s1">&#39;startup&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;pacing_rate&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;bandwidth&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;rtt_min&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;cycle_index&#39;</span><span class="p">:</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">event</span> <span class="o">==</span> <span class="s2">&#34;ack_received&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">rtt</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;rtt&#39;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">delivered</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;delivered&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mss</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="c1"># æ›´æ–°å¸¦å®½ä¼°è®¡</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">rtt</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">bw_sample</span> <span class="o">=</span> <span class="n">delivered</span> <span class="o">/</span> <span class="n">rtt</span>
</span></span><span class="line"><span class="cl">                <span class="bp">self</span><span class="o">.</span><span class="n">bbr_state</span><span class="p">[</span><span class="s1">&#39;bandwidth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bbr_state</span><span class="p">[</span><span class="s1">&#39;bandwidth&#39;</span><span class="p">],</span> <span class="n">bw_sample</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="c1"># æ›´æ–°æœ€å°RTT</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">bbr_state</span><span class="p">[</span><span class="s1">&#39;rtt_min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bbr_state</span><span class="p">[</span><span class="s1">&#39;rtt_min&#39;</span><span class="p">],</span> <span class="n">rtt</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="c1"># è®¡ç®—BDPï¼ˆå¸¦å®½æ—¶å»¶ç§¯ï¼‰</span>
</span></span><span class="line"><span class="cl">            <span class="n">bdp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbr_state</span><span class="p">[</span><span class="s1">&#39;bandwidth&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbr_state</span><span class="p">[</span><span class="s1">&#39;rtt_min&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbr_state</span><span class="p">[</span><span class="s1">&#39;mode&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;startup&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="c1"># å¯åŠ¨é˜¶æ®µï¼šå¿«é€Ÿæ¢æµ‹å¸¦å®½</span>
</span></span><span class="line"><span class="cl">                <span class="bp">self</span><span class="o">.</span><span class="n">cwnd</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">bdp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cwnd</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cwnd</span> <span class="o">&gt;</span> <span class="mi">1000</span><span class="p">:</span>  <span class="c1"># ç®€åŒ–çš„é€€å‡ºæ¡ä»¶</span>
</span></span><span class="line"><span class="cl">                    <span class="bp">self</span><span class="o">.</span><span class="n">bbr_state</span><span class="p">[</span><span class="s1">&#39;mode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;drain&#39;</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbr_state</span><span class="p">[</span><span class="s1">&#39;mode&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;drain&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="c1"># æ’ç©ºé˜¶æ®µ</span>
</span></span><span class="line"><span class="cl">                <span class="bp">self</span><span class="o">.</span><span class="n">cwnd</span> <span class="o">=</span> <span class="n">bdp</span>
</span></span><span class="line"><span class="cl">                <span class="bp">self</span><span class="o">.</span><span class="n">bbr_state</span><span class="p">[</span><span class="s1">&#39;mode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;probe_bw&#39;</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbr_state</span><span class="p">[</span><span class="s1">&#39;mode&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;probe_bw&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="c1"># å¸¦å®½æ¢æµ‹é˜¶æ®µ</span>
</span></span><span class="line"><span class="cl">                <span class="n">gain_cycle</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">                <span class="n">gain</span> <span class="o">=</span> <span class="n">gain_cycle</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">bbr_state</span><span class="p">[</span><span class="s1">&#39;cycle_index&#39;</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">                <span class="bp">self</span><span class="o">.</span><span class="n">cwnd</span> <span class="o">=</span> <span class="n">gain</span> <span class="o">*</span> <span class="n">bdp</span>
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                <span class="bp">self</span><span class="o">.</span><span class="n">bbr_state</span><span class="p">[</span><span class="s1">&#39;cycle_index&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bbr_state</span><span class="p">[</span><span class="s1">&#39;cycle_index&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">gain_cycle</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">simulate_congestion_control</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&#34;Reno&#34;</span><span class="p">,</span> <span class="n">events</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;æ¨¡æ‹Ÿæ‹¥å¡æ§åˆ¶è¿‡ç¨‹&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">events</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">events</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">(</span><span class="s2">&#34;ack_received&#34;</span><span class="p">,</span> <span class="p">{}),</span>
</span></span><span class="line"><span class="cl">                <span class="p">(</span><span class="s2">&#34;ack_received&#34;</span><span class="p">,</span> <span class="p">{}),</span>
</span></span><span class="line"><span class="cl">                <span class="p">(</span><span class="s2">&#34;ack_received&#34;</span><span class="p">,</span> <span class="p">{}),</span>
</span></span><span class="line"><span class="cl">                <span class="p">(</span><span class="s2">&#34;duplicate_ack&#34;</span><span class="p">,</span> <span class="p">{}),</span>
</span></span><span class="line"><span class="cl">                <span class="p">(</span><span class="s2">&#34;duplicate_ack&#34;</span><span class="p">,</span> <span class="p">{}),</span>
</span></span><span class="line"><span class="cl">                <span class="p">(</span><span class="s2">&#34;duplicate_ack&#34;</span><span class="p">,</span> <span class="p">{}),</span>  <span class="c1"># è§¦å‘å¿«é€Ÿé‡ä¼ </span>
</span></span><span class="line"><span class="cl">                <span class="p">(</span><span class="s2">&#34;new_ack&#34;</span><span class="p">,</span> <span class="p">{}),</span>
</span></span><span class="line"><span class="cl">                <span class="p">(</span><span class="s2">&#34;timeout&#34;</span><span class="p">,</span> <span class="p">{}),</span>
</span></span><span class="line"><span class="cl">                <span class="p">(</span><span class="s2">&#34;ack_received&#34;</span><span class="p">,</span> <span class="p">{}),</span>
</span></span><span class="line"><span class="cl">                <span class="p">(</span><span class="s2">&#34;ack_received&#34;</span><span class="p">,</span> <span class="p">{})</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">history</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">event</span><span class="p">,</span> <span class="n">params</span> <span class="ow">in</span> <span class="n">events</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">old_cwnd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cwnd</span>
</span></span><span class="line"><span class="cl">            <span class="n">old_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="c1"># æ‰§è¡Œç®—æ³•</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">algorithm</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">algorithms</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="bp">self</span><span class="o">.</span><span class="n">algorithms</span><span class="p">[</span><span class="n">algorithm</span><span class="p">](</span><span class="n">event</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="n">history</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;äº‹ä»¶&#34;</span><span class="p">:</span> <span class="n">event</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;æ—§æ‹¥å¡çª—å£&#34;</span><span class="p">:</span> <span class="n">old_cwnd</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;æ–°æ‹¥å¡çª—å£&#34;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">cwnd</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;æ—§çŠ¶æ€&#34;</span><span class="p">:</span> <span class="n">old_state</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;æ–°çŠ¶æ€&#34;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;æ…¢å¯åŠ¨é˜ˆå€¼&#34;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ssthresh</span>
</span></span><span class="line"><span class="cl">            <span class="p">})</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">history</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ‹¥å¡æ§åˆ¶ç¤ºä¾‹</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">congestion_control</span> <span class="o">=</span> <span class="n">TCPCongestionControl</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;TCPæ‹¥å¡æ§åˆ¶ç¤ºä¾‹ (Renoç®—æ³•):&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">history</span> <span class="o">=</span> <span class="n">congestion_control</span><span class="o">.</span><span class="n">simulate_congestion_control</span><span class="p">(</span><span class="s2">&#34;Reno&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">record</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">history</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;æ­¥éª¤</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">record</span><span class="p">[</span><span class="s1">&#39;äº‹ä»¶&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;  æ‹¥å¡çª—å£: </span><span class="si">{</span><span class="n">record</span><span class="p">[</span><span class="s1">&#39;æ—§æ‹¥å¡çª—å£&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> -&gt; </span><span class="si">{</span><span class="n">record</span><span class="p">[</span><span class="s1">&#39;æ–°æ‹¥å¡çª—å£&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;  çŠ¶æ€: </span><span class="si">{</span><span class="n">record</span><span class="p">[</span><span class="s1">&#39;æ—§çŠ¶æ€&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> -&gt; </span><span class="si">{</span><span class="n">record</span><span class="p">[</span><span class="s1">&#39;æ–°çŠ¶æ€&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;  æ…¢å¯åŠ¨é˜ˆå€¼: </span><span class="si">{</span><span class="n">record</span><span class="p">[</span><span class="s1">&#39;æ…¢å¯åŠ¨é˜ˆå€¼&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ¯”è¾ƒä¸åŒç®—æ³•</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;ä¸åŒæ‹¥å¡æ§åˆ¶ç®—æ³•æ¯”è¾ƒ:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">algorithms</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;Reno&#34;</span><span class="p">,</span> <span class="s2">&#34;Cubic&#34;</span><span class="p">,</span> <span class="s2">&#34;BBR&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">alg</span> <span class="ow">in</span> <span class="n">algorithms</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">cc</span> <span class="o">=</span> <span class="n">TCPCongestionControl</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">alg</span> <span class="o">==</span> <span class="s2">&#34;BBR&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># BBRéœ€è¦ç‰¹æ®Šçš„äº‹ä»¶å‚æ•°</span>
</span></span><span class="line"><span class="cl">        <span class="n">events</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&#34;ack_received&#34;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&#34;rtt&#34;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s2">&#34;delivered&#34;</span><span class="p">:</span> <span class="mi">1460</span><span class="p">})</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">events</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&#34;ack_received&#34;</span><span class="p">,</span> <span class="p">{})</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">history</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">simulate_congestion_control</span><span class="p">(</span><span class="n">alg</span><span class="p">,</span> <span class="n">events</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">final_cwnd</span> <span class="o">=</span> <span class="n">history</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&#34;æ–°æ‹¥å¡çª—å£&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">alg</span><span class="si">}</span><span class="s2">: æœ€ç»ˆæ‹¥å¡çª—å£ = </span><span class="si">{</span><span class="n">final_cwnd</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="tcpæ€§èƒ½ä¼˜åŒ–">TCPæ€§èƒ½ä¼˜åŒ–</h2>
<h3 id="æ€§èƒ½è°ƒä¼˜æŠ€æœ¯">æ€§èƒ½è°ƒä¼˜æŠ€æœ¯</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">TCPPerformanceOptimization</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;TCPæ€§èƒ½ä¼˜åŒ–&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">optimization_techniques</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;çª—å£ç¼©æ”¾&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;æè¿°&#34;</span><span class="p">:</span> <span class="s2">&#34;æ”¯æŒå¤§äº64KBçš„çª—å£&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;RFC&#34;</span><span class="p">:</span> <span class="s2">&#34;RFC 7323&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é€‚ç”¨åœºæ™¯&#34;</span><span class="p">:</span> <span class="s2">&#34;é«˜å¸¦å®½é•¿å»¶è¿Ÿç½‘ç»œ&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;é€‰æ‹©æ€§ç¡®è®¤&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;æè¿°&#34;</span><span class="p">:</span> <span class="s2">&#34;SACKé€‰é¡¹ï¼Œæé«˜é‡ä¼ æ•ˆç‡&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;RFC&#34;</span><span class="p">:</span> <span class="s2">&#34;RFC 2018&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é€‚ç”¨åœºæ™¯&#34;</span><span class="p">:</span> <span class="s2">&#34;ä¸¢åŒ…ç‡è¾ƒé«˜çš„ç½‘ç»œ&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ—¶é—´æˆ³é€‰é¡¹&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;æè¿°&#34;</span><span class="p">:</span> <span class="s2">&#34;ç²¾ç¡®RTTæµ‹é‡å’ŒPAWS&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;RFC&#34;</span><span class="p">:</span> <span class="s2">&#34;RFC 7323&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é€‚ç”¨åœºæ™¯&#34;</span><span class="p">:</span> <span class="s2">&#34;éœ€è¦ç²¾ç¡®RTTæµ‹é‡&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;Nagleç®—æ³•&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;æè¿°&#34;</span><span class="p">:</span> <span class="s2">&#34;å‡å°‘å°åŒ…å‘é€&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é€‚ç”¨åœºæ™¯&#34;</span><span class="p">:</span> <span class="s2">&#34;æ‰¹é‡æ•°æ®ä¼ è¾“&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;æ³¨æ„äº‹é¡¹&#34;</span><span class="p">:</span> <span class="s2">&#34;å¯èƒ½å¢åŠ å»¶è¿Ÿ&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;å»¶è¿Ÿç¡®è®¤&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;æè¿°&#34;</span><span class="p">:</span> <span class="s2">&#34;åˆå¹¶ACKå‡å°‘ç½‘ç»œæµé‡&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é€‚ç”¨åœºæ™¯&#34;</span><span class="p">:</span> <span class="s2">&#34;åŒå‘æ•°æ®æµ&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;æ³¨æ„äº‹é¡¹&#34;</span><span class="p">:</span> <span class="s2">&#34;å¯èƒ½å¢åŠ RTT&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">calculate_bandwidth_delay_product</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bandwidth_mbps</span><span class="p">,</span> <span class="n">rtt_ms</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;è®¡ç®—å¸¦å®½æ—¶å»¶ç§¯&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">bandwidth_bps</span> <span class="o">=</span> <span class="n">bandwidth_mbps</span> <span class="o">*</span> <span class="mi">1_000_000</span>
</span></span><span class="line"><span class="cl">        <span class="n">rtt_seconds</span> <span class="o">=</span> <span class="n">rtt_ms</span> <span class="o">/</span> <span class="mi">1000</span>
</span></span><span class="line"><span class="cl">        <span class="n">bdp_bytes</span> <span class="o">=</span> <span class="n">bandwidth_bps</span> <span class="o">*</span> <span class="n">rtt_seconds</span> <span class="o">/</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;å¸¦å®½&#34;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">bandwidth_mbps</span><span class="si">}</span><span class="s2"> Mbps&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;RTT&#34;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">rtt_ms</span><span class="si">}</span><span class="s2"> ms&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;BDP&#34;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">bdp_bytes</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> bytes&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;å»ºè®®çª—å£å¤§å°&#34;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">bdp_bytes</span> <span class="o">*</span> <span class="mi">2</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> bytes&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;éœ€è¦çª—å£ç¼©æ”¾&#34;</span><span class="p">:</span> <span class="n">bdp_bytes</span> <span class="o">&gt;</span> <span class="mi">65535</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">analyze_tcp_performance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">throughput_mbps</span><span class="p">,</span> <span class="n">rtt_ms</span><span class="p">,</span> <span class="n">loss_rate</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;åˆ†æTCPæ€§èƒ½&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># Mathiså…¬å¼ï¼šThroughput â‰¤ (MSS / RTT) * sqrt(1.5 / p)</span>
</span></span><span class="line"><span class="cl">        <span class="n">mss</span> <span class="o">=</span> <span class="mi">1460</span>  <span class="c1"># å­—èŠ‚</span>
</span></span><span class="line"><span class="cl">        <span class="n">rtt_seconds</span> <span class="o">=</span> <span class="n">rtt_ms</span> <span class="o">/</span> <span class="mi">1000</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">loss_rate</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">theoretical_max</span> <span class="o">=</span> <span class="p">(</span><span class="n">mss</span> <span class="o">/</span> <span class="n">rtt_seconds</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.5</span> <span class="o">/</span> <span class="n">loss_rate</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span> <span class="o">/</span> <span class="mi">1_000_000</span> <span class="o">*</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">theoretical_max</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># çª—å£é™åˆ¶çš„ååé‡</span>
</span></span><span class="line"><span class="cl">        <span class="n">window_limited</span> <span class="o">=</span> <span class="p">(</span><span class="mi">65535</span> <span class="o">/</span> <span class="n">rtt_seconds</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1_000_000</span> <span class="o">*</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">efficiency</span> <span class="o">=</span> <span class="p">(</span><span class="n">throughput_mbps</span> <span class="o">/</span> <span class="nb">min</span><span class="p">(</span><span class="n">theoretical_max</span><span class="p">,</span> <span class="n">window_limited</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">if</span> <span class="n">theoretical_max</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">analysis</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;å®é™…ååé‡&#34;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">throughput_mbps</span><span class="si">}</span><span class="s2"> Mbps&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;ç†è®ºæœ€å¤§ååé‡&#34;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">theoretical_max</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Mbps&#34;</span> <span class="k">if</span> <span class="n">theoretical_max</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&#34;æ— é™åˆ¶&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;çª—å£é™åˆ¶ååé‡&#34;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">window_limited</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Mbps&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ•ˆç‡&#34;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">efficiency</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ€§èƒ½ç“¶é¢ˆ&#34;</span><span class="p">:</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># è¯†åˆ«æ€§èƒ½ç“¶é¢ˆ</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">throughput_mbps</span> <span class="o">&lt;</span> <span class="n">window_limited</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">analysis</span><span class="p">[</span><span class="s2">&#34;æ€§èƒ½ç“¶é¢ˆ&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&#34;å¯èƒ½å—æ‹¥å¡æ§åˆ¶é™åˆ¶&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">window_limited</span> <span class="o">&lt;</span> <span class="n">theoretical_max</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">analysis</span><span class="p">[</span><span class="s2">&#34;æ€§èƒ½ç“¶é¢ˆ&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&#34;å—æ¥æ”¶çª—å£é™åˆ¶ï¼Œå»ºè®®å¯ç”¨çª—å£ç¼©æ”¾&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">loss_rate</span> <span class="o">&gt;</span> <span class="mf">0.01</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">analysis</span><span class="p">[</span><span class="s2">&#34;æ€§èƒ½ç“¶é¢ˆ&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&#34;ä¸¢åŒ…ç‡è¿‡é«˜ï¼Œå½±å“æ€§èƒ½&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">analysis</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">recommend_optimizations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scenario</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;æ¨èä¼˜åŒ–æ–¹æ¡ˆ&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">recommendations</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;é«˜å¸¦å®½é•¿å»¶è¿Ÿ&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;å¯ç”¨çª—å£ç¼©æ”¾é€‰é¡¹&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ä½¿ç”¨CUBICæˆ–BBRæ‹¥å¡æ§åˆ¶&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;è°ƒæ•´æ¥æ”¶ç¼“å†²åŒºå¤§å°&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;è€ƒè™‘ä½¿ç”¨å¤šè¿æ¥å¹¶è¡Œä¼ è¾“&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;é«˜ä¸¢åŒ…ç‡&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;å¯ç”¨SACKé€‰é¡¹&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ä½¿ç”¨æ›´æ¿€è¿›çš„æ‹¥å¡æ§åˆ¶ç®—æ³•&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;è€ƒè™‘ä½¿ç”¨FECï¼ˆå‰å‘çº é”™ï¼‰&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ä¼˜åŒ–é‡ä¼ ç­–ç•¥&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;ä½å»¶è¿Ÿè¦æ±‚&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç¦ç”¨Nagleç®—æ³•&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;å‡å°‘å»¶è¿Ÿç¡®è®¤æ—¶é—´&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ä½¿ç”¨ä¸“ç”¨ç½‘ç»œè·¯å¾„&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ä¼˜åŒ–åº”ç”¨å±‚åè®®&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;ç§»åŠ¨ç½‘ç»œ&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ä½¿ç”¨BBRæ‹¥å¡æ§åˆ¶&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;å¯ç”¨è¿æ¥è¿ç§»&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;è€ƒè™‘ä½¿ç”¨MPTCP&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ä¼˜åŒ–é‡ä¼ è¶…æ—¶&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ•°æ®ä¸­å¿ƒ&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ä½¿ç”¨DCTCPç®—æ³•&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;å¯ç”¨ECNæ ‡è®°&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ä¼˜åŒ–ç¼“å†²åŒºç®¡ç†&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ä½¿ç”¨RDMAæŠ€æœ¯&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">recommendations</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">scenario</span><span class="p">,</span> <span class="p">[</span><span class="s2">&#34;è¯·æä¾›å…·ä½“åœºæ™¯&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ€§èƒ½ä¼˜åŒ–ç¤ºä¾‹</span>
</span></span><span class="line"><span class="cl"><span class="n">perf_optimizer</span> <span class="o">=</span> <span class="n">TCPPerformanceOptimization</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è®¡ç®—BDP</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;å¸¦å®½æ—¶å»¶ç§¯è®¡ç®—:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">scenarios</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>   <span class="c1"># 100Mbps, 10ms RTT</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>  <span class="c1"># 1Gbps, 50ms RTT</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>    <span class="c1"># 10Mbps, 200ms RTT</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">bandwidth</span><span class="p">,</span> <span class="n">rtt</span> <span class="ow">in</span> <span class="n">scenarios</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">bdp</span> <span class="o">=</span> <span class="n">perf_optimizer</span><span class="o">.</span><span class="n">calculate_bandwidth_delay_product</span><span class="p">(</span><span class="n">bandwidth</span><span class="p">,</span> <span class="n">rtt</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">åœºæ™¯: </span><span class="si">{</span><span class="n">bdp</span><span class="p">[</span><span class="s1">&#39;å¸¦å®½&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">bdp</span><span class="p">[</span><span class="s1">&#39;RTT&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;  BDP: </span><span class="si">{</span><span class="n">bdp</span><span class="p">[</span><span class="s1">&#39;BDP&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;  å»ºè®®çª—å£: </span><span class="si">{</span><span class="n">bdp</span><span class="p">[</span><span class="s1">&#39;å»ºè®®çª—å£å¤§å°&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;  éœ€è¦çª—å£ç¼©æ”¾: </span><span class="si">{</span><span class="n">bdp</span><span class="p">[</span><span class="s1">&#39;éœ€è¦çª—å£ç¼©æ”¾&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ€§èƒ½åˆ†æ</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n\n</span><span class="s2">TCPæ€§èƒ½åˆ†æ:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">performance_cases</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">),</span>    <span class="c1"># 50Mbpså®é™…ï¼Œ10ms RTTï¼Œ0.1%ä¸¢åŒ…</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">),</span>    <span class="c1"># 800Mbpså®é™…ï¼Œ50ms RTTï¼Œ1%ä¸¢åŒ…</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>      <span class="c1"># 5Mbpså®é™…ï¼Œ200ms RTTï¼Œ5%ä¸¢åŒ…</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">throughput</span><span class="p">,</span> <span class="n">rtt</span><span class="p">,</span> <span class="n">loss</span> <span class="ow">in</span> <span class="n">performance_cases</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">analysis</span> <span class="o">=</span> <span class="n">perf_optimizer</span><span class="o">.</span><span class="n">analyze_tcp_performance</span><span class="p">(</span><span class="n">throughput</span><span class="p">,</span> <span class="n">rtt</span><span class="p">,</span> <span class="n">loss</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">åœºæ™¯: </span><span class="si">{</span><span class="n">throughput</span><span class="si">}</span><span class="s2">Mbps, </span><span class="si">{</span><span class="n">rtt</span><span class="si">}</span><span class="s2">ms RTT, </span><span class="si">{</span><span class="n">loss</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="s2">%ä¸¢åŒ…&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;  å®é™…ååé‡: </span><span class="si">{</span><span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;å®é™…ååé‡&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;  ç†è®ºæœ€å¤§: </span><span class="si">{</span><span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;ç†è®ºæœ€å¤§ååé‡&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;  æ•ˆç‡: </span><span class="si">{</span><span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;æ•ˆç‡&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;æ€§èƒ½ç“¶é¢ˆ&#39;</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;  ç“¶é¢ˆ: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;æ€§èƒ½ç“¶é¢ˆ&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ä¼˜åŒ–å»ºè®®</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n\n</span><span class="s2">ä¼˜åŒ–å»ºè®®:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">scenarios</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;é«˜å¸¦å®½é•¿å»¶è¿Ÿ&#34;</span><span class="p">,</span> <span class="s2">&#34;é«˜ä¸¢åŒ…ç‡&#34;</span><span class="p">,</span> <span class="s2">&#34;ä½å»¶è¿Ÿè¦æ±‚&#34;</span><span class="p">,</span> <span class="s2">&#34;ç§»åŠ¨ç½‘ç»œ&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">scenario</span> <span class="ow">in</span> <span class="n">scenarios</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">recommendations</span> <span class="o">=</span> <span class="n">perf_optimizer</span><span class="o">.</span><span class="n">recommend_optimizations</span><span class="p">(</span><span class="n">scenario</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="se">\n</span><span class="si">{</span><span class="n">scenario</span><span class="si">}</span><span class="s2">åœºæ™¯:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">rec</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">recommendations</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;  </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">rec</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="tcpåœ¨ç°ä»£ç½‘ç»œä¸­çš„åº”ç”¨">TCPåœ¨ç°ä»£ç½‘ç»œä¸­çš„åº”ç”¨</h2>
<h3 id="tcpå˜ç§å’Œæ‰©å±•">TCPå˜ç§å’Œæ‰©å±•</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">ModernTCPVariants</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;ç°ä»£TCPå˜ç§&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">variants</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;TCP Reno&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;å¹´ä»½&#34;</span><span class="p">:</span> <span class="mi">1990</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç‰¹ç‚¹&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;å¿«é€Ÿé‡ä¼ &#34;</span><span class="p">,</span> <span class="s2">&#34;å¿«é€Ÿæ¢å¤&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é€‚ç”¨åœºæ™¯&#34;</span><span class="p">:</span> <span class="s2">&#34;ä¼ ç»Ÿç½‘ç»œç¯å¢ƒ&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ä¼˜ç¼ºç‚¹&#34;</span><span class="p">:</span> <span class="s2">&#34;ç®€å•å¯é ï¼Œä½†åœ¨é«˜BDPç½‘ç»œä¸­æ€§èƒ½ä¸ä½³&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;TCP NewReno&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;å¹´ä»½&#34;</span><span class="p">:</span> <span class="mi">1999</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç‰¹ç‚¹&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;æ”¹è¿›çš„å¿«é€Ÿæ¢å¤&#34;</span><span class="p">,</span> <span class="s2">&#34;éƒ¨åˆ†ç¡®è®¤å¤„ç†&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é€‚ç”¨åœºæ™¯&#34;</span><span class="p">:</span> <span class="s2">&#34;å¤šä¸¢åŒ…ç¯å¢ƒ&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ä¼˜ç¼ºç‚¹&#34;</span><span class="p">:</span> <span class="s2">&#34;æ”¹å–„äº†å¤šä¸¢åŒ…å¤„ç†ï¼Œä½†ä»æœ‰é™åˆ¶&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;TCP SACK&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;å¹´ä»½&#34;</span><span class="p">:</span> <span class="mi">1996</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç‰¹ç‚¹&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;é€‰æ‹©æ€§ç¡®è®¤&#34;</span><span class="p">,</span> <span class="s2">&#34;ç²¾ç¡®é‡ä¼ &#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é€‚ç”¨åœºæ™¯&#34;</span><span class="p">:</span> <span class="s2">&#34;ä¸¢åŒ…ç‡è¾ƒé«˜çš„ç½‘ç»œ&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ä¼˜ç¼ºç‚¹&#34;</span><span class="p">:</span> <span class="s2">&#34;æé«˜é‡ä¼ æ•ˆç‡ï¼Œä½†å¢åŠ å¤æ‚æ€§&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;TCP Vegas&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;å¹´ä»½&#34;</span><span class="p">:</span> <span class="mi">1994</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç‰¹ç‚¹&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;åŸºäºå»¶è¿Ÿçš„æ‹¥å¡æ§åˆ¶&#34;</span><span class="p">,</span> <span class="s2">&#34;ä¸»åŠ¨é¿å…æ‹¥å¡&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é€‚ç”¨åœºæ™¯&#34;</span><span class="p">:</span> <span class="s2">&#34;å»¶è¿Ÿæ•æ„Ÿåº”ç”¨&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ä¼˜ç¼ºç‚¹&#34;</span><span class="p">:</span> <span class="s2">&#34;ä½å»¶è¿Ÿï¼Œä½†ä¸å…¶ä»–ç®—æ³•å…±å­˜å›°éš¾&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;TCP CUBIC&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;å¹´ä»½&#34;</span><span class="p">:</span> <span class="mi">2008</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç‰¹ç‚¹&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;ä¸‰æ¬¡å‡½æ•°å¢é•¿&#34;</span><span class="p">,</span> <span class="s2">&#34;RTTæ— å…³&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é€‚ç”¨åœºæ™¯&#34;</span><span class="p">:</span> <span class="s2">&#34;é«˜é€Ÿé•¿è·ç¦»ç½‘ç»œ&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ä¼˜ç¼ºç‚¹&#34;</span><span class="p">:</span> <span class="s2">&#34;é«˜å¸¦å®½åˆ©ç”¨ç‡ï¼ŒLinuxé»˜è®¤ç®—æ³•&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;TCP BBR&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;å¹´ä»½&#34;</span><span class="p">:</span> <span class="mi">2016</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç‰¹ç‚¹&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;åŸºäºå¸¦å®½å’ŒRTT&#34;</span><span class="p">,</span> <span class="s2">&#34;æ¨¡å‹é©±åŠ¨&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é€‚ç”¨åœºæ™¯&#34;</span><span class="p">:</span> <span class="s2">&#34;å„ç§ç½‘ç»œç¯å¢ƒ&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ä¼˜ç¼ºç‚¹&#34;</span><span class="p">:</span> <span class="s2">&#34;ä¼˜ç§€çš„æ€§èƒ½ï¼Œä½†å¯èƒ½è¿‡äºæ¿€è¿›&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;MPTCP&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;å¹´ä»½&#34;</span><span class="p">:</span> <span class="mi">2013</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç‰¹ç‚¹&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;å¤šè·¯å¾„ä¼ è¾“&#34;</span><span class="p">,</span> <span class="s2">&#34;è¿æ¥èšåˆ&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é€‚ç”¨åœºæ™¯&#34;</span><span class="p">:</span> <span class="s2">&#34;ç§»åŠ¨è®¾å¤‡ã€æ•°æ®ä¸­å¿ƒ&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ä¼˜ç¼ºç‚¹&#34;</span><span class="p">:</span> <span class="s2">&#34;æé«˜ååé‡å’Œå¯é æ€§ï¼Œä½†å¤æ‚åº¦é«˜&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;QUIC&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;å¹´ä»½&#34;</span><span class="p">:</span> <span class="mi">2021</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç‰¹ç‚¹&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;åŸºäºUDP&#34;</span><span class="p">,</span> <span class="s2">&#34;å†…ç½®åŠ å¯†&#34;</span><span class="p">,</span> <span class="s2">&#34;0-RTT&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é€‚ç”¨åœºæ™¯&#34;</span><span class="p">:</span> <span class="s2">&#34;Webåº”ç”¨ã€å®æ—¶é€šä¿¡&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ä¼˜ç¼ºç‚¹&#34;</span><span class="p">:</span> <span class="s2">&#34;ä½å»¶è¿Ÿï¼Œä½†éœ€è¦æ–°çš„åŸºç¡€è®¾æ–½&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">compare_algorithms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;æ¯”è¾ƒä¸åŒç®—æ³•&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">metrics</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;ååé‡&#34;</span><span class="p">,</span> <span class="s2">&#34;å»¶è¿Ÿ&#34;</span><span class="p">,</span> <span class="s2">&#34;å…¬å¹³æ€§&#34;</span><span class="p">,</span> <span class="s2">&#34;å¤æ‚åº¦&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">comparison</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;TCP Reno&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;ååé‡&#34;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s2">&#34;å»¶è¿Ÿ&#34;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s2">&#34;å…¬å¹³æ€§&#34;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s2">&#34;å¤æ‚åº¦&#34;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;TCP CUBIC&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;ååé‡&#34;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="s2">&#34;å»¶è¿Ÿ&#34;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s2">&#34;å…¬å¹³æ€§&#34;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s2">&#34;å¤æ‚åº¦&#34;</span><span class="p">:</span> <span class="mi">5</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;TCP BBR&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;ååé‡&#34;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="s2">&#34;å»¶è¿Ÿ&#34;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s2">&#34;å…¬å¹³æ€§&#34;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s2">&#34;å¤æ‚åº¦&#34;</span><span class="p">:</span> <span class="mi">7</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;MPTCP&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;ååé‡&#34;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&#34;å»¶è¿Ÿ&#34;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s2">&#34;å…¬å¹³æ€§&#34;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s2">&#34;å¤æ‚åº¦&#34;</span><span class="p">:</span> <span class="mi">9</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;QUIC&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;ååé‡&#34;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s2">&#34;å»¶è¿Ÿ&#34;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&#34;å…¬å¹³æ€§&#34;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s2">&#34;å¤æ‚åº¦&#34;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">comparison</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">get_deployment_status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;è·å–éƒ¨ç½²çŠ¶æ€&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;TCP Reno/NewReno&#34;</span><span class="p">:</span> <span class="s2">&#34;å¹¿æ³›éƒ¨ç½²ï¼Œä¼ ç»Ÿç³»ç»Ÿé»˜è®¤&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;TCP CUBIC&#34;</span><span class="p">:</span> <span class="s2">&#34;Linuxé»˜è®¤ï¼Œå¹¿æ³›ä½¿ç”¨&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;TCP BBR&#34;</span><span class="p">:</span> <span class="s2">&#34;GoogleæœåŠ¡å¤§è§„æ¨¡éƒ¨ç½²ï¼Œé€æ¸æ™®åŠ&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;MPTCP&#34;</span><span class="p">:</span> <span class="s2">&#34;ç§»åŠ¨è¿è¥å•†å’Œæ•°æ®ä¸­å¿ƒè¯•ç‚¹&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;QUIC&#34;</span><span class="p">:</span> <span class="s2">&#34;HTTP/3æ ‡å‡†ï¼Œä¸»è¦æµè§ˆå™¨æ”¯æŒ&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># TCPå®‰å…¨è€ƒè™‘</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">TCPSecurity</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;TCPå®‰å…¨æœºåˆ¶&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">security_issues</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;TCPåŠ«æŒ&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;æè¿°&#34;</span><span class="p">:</span> <span class="s2">&#34;æ”»å‡»è€…ä¼ªé€ TCPæ®µæ¥ç®¡è¿æ¥&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é˜²æŠ¤æªæ–½&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;åºåˆ—å·éšæœºåŒ–&#34;</span><span class="p">,</span> <span class="s2">&#34;ä½¿ç”¨TLS&#34;</span><span class="p">,</span> <span class="s2">&#34;ç½‘ç»œåˆ†æ®µ&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;SYNæ´ªæ°´æ”»å‡»&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;æè¿°&#34;</span><span class="p">:</span> <span class="s2">&#34;å¤§é‡SYNè¯·æ±‚è€—å°½æœåŠ¡å™¨èµ„æº&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é˜²æŠ¤æªæ–½&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;SYN Cookies&#34;</span><span class="p">,</span> <span class="s2">&#34;è¿æ¥é™åˆ¶&#34;</span><span class="p">,</span> <span class="s2">&#34;é˜²ç«å¢™è¿‡æ»¤&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;RSTæ”»å‡»&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;æè¿°&#34;</span><span class="p">:</span> <span class="s2">&#34;ä¼ªé€ RSTæ®µå¼ºåˆ¶å…³é—­è¿æ¥&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é˜²æŠ¤æªæ–½&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;åºåˆ—å·éªŒè¯&#34;</span><span class="p">,</span> <span class="s2">&#34;ä½¿ç”¨TLS&#34;</span><span class="p">,</span> <span class="s2">&#34;ç½‘ç»œç›‘æ§&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;çª—å£æ”»å‡»&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;æè¿°&#34;</span><span class="p">:</span> <span class="s2">&#34;æ“çºµæ¥æ”¶çª—å£å½±å“æ€§èƒ½&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é˜²æŠ¤æªæ–½&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;çª—å£å¤§å°é™åˆ¶&#34;</span><span class="p">,</span> <span class="s2">&#34;æµé‡ç›‘æ§&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">implement_syn_cookies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">client_ip</span><span class="p">,</span> <span class="n">client_port</span><span class="p">,</span> <span class="n">server_port</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;å®ç°SYN Cookiesï¼ˆç®€åŒ–ç‰ˆï¼‰&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">import</span> <span class="nn">hashlib</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># ç®€åŒ–çš„SYN Cookieç”Ÿæˆ</span>
</span></span><span class="line"><span class="cl">        <span class="n">secret_key</span> <span class="o">=</span> <span class="s2">&#34;tcp_secret_key_2024&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span> <span class="o">//</span> <span class="mi">64</span>  <span class="c1"># 64ç§’æ—¶é—´çª—å£</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># æ„é€ Cookie</span>
</span></span><span class="line"><span class="cl">        <span class="n">cookie_data</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">client_ip</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">client_port</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">server_port</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">secret_key</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cookie_hash</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">cookie_data</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># å–å‰24ä½ä½œä¸ºåºåˆ—å·</span>
</span></span><span class="line"><span class="cl">        <span class="n">syn_cookie</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">cookie_hash</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;SYN_Cookie&#34;</span><span class="p">:</span> <span class="n">syn_cookie</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ—¶é—´æˆ³&#34;</span><span class="p">:</span> <span class="n">timestamp</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æœ‰æ•ˆæœŸ&#34;</span><span class="p">:</span> <span class="s2">&#34;64ç§’&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;éªŒè¯æ–¹æ³•&#34;</span><span class="p">:</span> <span class="s2">&#34;é‡æ–°è®¡ç®—å¹¶æ¯”è¾ƒ&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">validate_syn_cookie</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">client_ip</span><span class="p">,</span> <span class="n">client_port</span><span class="p">,</span> <span class="n">server_port</span><span class="p">,</span> <span class="n">received_ack</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;éªŒè¯SYN Cookie&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">import</span> <span class="nn">hashlib</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">secret_key</span> <span class="o">=</span> <span class="s2">&#34;tcp_secret_key_2024&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">current_time</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span> <span class="o">//</span> <span class="mi">64</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># æ£€æŸ¥å½“å‰å’Œå‰ä¸€ä¸ªæ—¶é—´çª—å£</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">timestamp</span> <span class="ow">in</span> <span class="p">[</span><span class="n">current_time</span><span class="p">,</span> <span class="n">current_time</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">            <span class="n">cookie_data</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">client_ip</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">client_port</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">server_port</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">secret_key</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">cookie_hash</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">cookie_data</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="n">expected_cookie</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">cookie_hash</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">received_ack</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">==</span> <span class="n">expected_cookie</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;éªŒè¯ç»“æœ&#34;</span><span class="p">:</span> <span class="s2">&#34;æˆåŠŸ&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;æ—¶é—´æˆ³&#34;</span><span class="p">:</span> <span class="n">timestamp</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;Cookie&#34;</span><span class="p">:</span> <span class="n">expected_cookie</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">{</span><span class="s2">&#34;éªŒè¯ç»“æœ&#34;</span><span class="p">:</span> <span class="s2">&#34;å¤±è´¥&#34;</span><span class="p">,</span> <span class="s2">&#34;åŸå› &#34;</span><span class="p">:</span> <span class="s2">&#34;Cookieæ— æ•ˆæˆ–è¿‡æœŸ&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;ç°ä»£TCPå˜ç§æ¯”è¾ƒ:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">variants</span> <span class="o">=</span> <span class="n">ModernTCPVariants</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">comparison</span> <span class="o">=</span> <span class="n">variants</span><span class="o">.</span><span class="n">compare_algorithms</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">ç®—æ³•æ€§èƒ½å¯¹æ¯” (1-10åˆ†):&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="s1">&#39;ç®—æ³•&#39;</span><span class="si">:</span><span class="s2">&lt;12</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;ååé‡&#39;</span><span class="si">:</span><span class="s2">&lt;8</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;å»¶è¿Ÿ&#39;</span><span class="si">:</span><span class="s2">&lt;8</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;å…¬å¹³æ€§&#39;</span><span class="si">:</span><span class="s2">&lt;8</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;å¤æ‚åº¦&#39;</span><span class="si">:</span><span class="s2">&lt;8</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;-&#34;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">alg</span><span class="p">,</span> <span class="n">scores</span> <span class="ow">in</span> <span class="n">comparison</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">alg</span><span class="si">:</span><span class="s2">&lt;12</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">scores</span><span class="p">[</span><span class="s1">&#39;ååé‡&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">&lt;8</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">scores</span><span class="p">[</span><span class="s1">&#39;å»¶è¿Ÿ&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">&lt;8</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">scores</span><span class="p">[</span><span class="s1">&#39;å…¬å¹³æ€§&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">&lt;8</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">scores</span><span class="p">[</span><span class="s1">&#39;å¤æ‚åº¦&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">&lt;8</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">éƒ¨ç½²çŠ¶æ€:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">deployment</span> <span class="o">=</span> <span class="n">variants</span><span class="o">.</span><span class="n">get_deployment_status</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">alg</span><span class="p">,</span> <span class="n">status</span> <span class="ow">in</span> <span class="n">deployment</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;  </span><span class="si">{</span><span class="n">alg</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># TCPå®‰å…¨ç¤ºä¾‹</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n\n</span><span class="s2">TCPå®‰å…¨æœºåˆ¶:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">security</span> <span class="o">=</span> <span class="n">TCPSecurity</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># SYN Cookiesç¤ºä¾‹</span>
</span></span><span class="line"><span class="cl"><span class="n">cookie_result</span> <span class="o">=</span> <span class="n">security</span><span class="o">.</span><span class="n">implement_syn_cookies</span><span class="p">(</span><span class="s2">&#34;192.168.1.100&#34;</span><span class="p">,</span> <span class="mi">12345</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;SYN Cookieç”Ÿæˆ: </span><span class="si">{</span><span class="n">cookie_result</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">validation_result</span> <span class="o">=</span> <span class="n">security</span><span class="o">.</span><span class="n">validate_syn_cookie</span><span class="p">(</span><span class="s2">&#34;192.168.1.100&#34;</span><span class="p">,</span> <span class="mi">12345</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="n">cookie_result</span><span class="p">[</span><span class="s2">&#34;SYN_Cookie&#34;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;CookieéªŒè¯: </span><span class="si">{</span><span class="n">validation_result</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="å­¦ä¹ å»ºè®®å’Œæ€»ç»“">å­¦ä¹ å»ºè®®å’Œæ€»ç»“</h2>
<h3 id="tcpå­¦ä¹ è·¯å¾„">TCPå­¦ä¹ è·¯å¾„</h3>
<ol>
<li><strong>åŸºç¡€æ¦‚å¿µ</strong>ï¼šç†è§£TCPçš„åŸºæœ¬ç‰¹æ€§å’Œå·¥ä½œåŸç†</li>
<li><strong>åè®®ç»†èŠ‚</strong>ï¼šæŒæ¡æŠ¥æ–‡æ ¼å¼ã€çŠ¶æ€æœºã€è¿æ¥ç®¡ç†</li>
<li><strong>å¯é ä¼ è¾“</strong>ï¼šå­¦ä¹ åºåˆ—å·ã€ç¡®è®¤ã€é‡ä¼ æœºåˆ¶</li>
<li><strong>æµé‡æ§åˆ¶</strong>ï¼šç†è§£æ»‘åŠ¨çª—å£æœºåˆ¶</li>
<li><strong>æ‹¥å¡æ§åˆ¶</strong>ï¼šæŒæ¡å„ç§æ‹¥å¡æ§åˆ¶ç®—æ³•</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šå­¦ä¹ TCPè°ƒä¼˜æŠ€æœ¯</li>
<li><strong>ç°ä»£å‘å±•</strong>ï¼šäº†è§£æ–°çš„TCPå˜ç§å’Œæ›¿ä»£æ–¹æ¡ˆ</li>
</ol>
<h3 id="å…³é”®è¦ç‚¹æ€»ç»“">å…³é”®è¦ç‚¹æ€»ç»“</h3>
<table>
  <thead>
      <tr>
          <th>æœºåˆ¶</th>
          <th>ç›®çš„</th>
          <th>å®ç°æ–¹å¼</th>
          <th>é‡è¦æ€§</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>ä¸‰æ¬¡æ¡æ‰‹</strong></td>
          <td>å»ºç«‹å¯é è¿æ¥</td>
          <td>SYN â†’ SYN+ACK â†’ ACK</td>
          <td>åŸºç¡€</td>
      </tr>
      <tr>
          <td><strong>åºåˆ—å·</strong></td>
          <td>ä¿è¯æ•°æ®é¡ºåº</td>
          <td>32ä½åºåˆ—å·ç©ºé—´</td>
          <td>æ ¸å¿ƒ</td>
      </tr>
      <tr>
          <td><strong>ç¡®è®¤æœºåˆ¶</strong></td>
          <td>ç¡®ä¿æ•°æ®åˆ°è¾¾</td>
          <td>ç´¯ç§¯ç¡®è®¤ + é€‰æ‹©ç¡®è®¤</td>
          <td>æ ¸å¿ƒ</td>
      </tr>
      <tr>
          <td><strong>æµé‡æ§åˆ¶</strong></td>
          <td>é˜²æ­¢æ¥æ”¶æ–¹æº¢å‡º</td>
          <td>æ»‘åŠ¨çª—å£</td>
          <td>é‡è¦</td>
      </tr>
      <tr>
          <td><strong>æ‹¥å¡æ§åˆ¶</strong></td>
          <td>é¿å…ç½‘ç»œæ‹¥å¡</td>
          <td>æ…¢å¯åŠ¨ + æ‹¥å¡é¿å…</td>
          <td>å…³é”®</td>
      </tr>
  </tbody>
</table>
<h3 id="å®é™…åº”ç”¨å»ºè®®">å®é™…åº”ç”¨å»ºè®®</h3>
<ul>
<li><strong>æœåŠ¡å™¨é…ç½®</strong>ï¼šåˆç†è®¾ç½®TCPå‚æ•°ï¼Œå¦‚çª—å£å¤§å°ã€è¶…æ—¶æ—¶é—´</li>
<li><strong>åº”ç”¨è®¾è®¡</strong>ï¼šè€ƒè™‘TCPçš„ç‰¹æ€§ï¼Œåˆç†ä½¿ç”¨è¿æ¥</li>
<li><strong>ç½‘ç»œç›‘æ§</strong>ï¼šç›‘æ§TCPè¿æ¥çŠ¶æ€å’Œæ€§èƒ½æŒ‡æ ‡</li>
<li><strong>å®‰å…¨é˜²æŠ¤</strong>ï¼šå®æ–½é€‚å½“çš„å®‰å…¨æªæ–½é˜²èŒƒTCPæ”»å‡»</li>
<li><strong>æ€§èƒ½è°ƒä¼˜</strong>ï¼šæ ¹æ®ç½‘ç»œç¯å¢ƒé€‰æ‹©åˆé€‚çš„æ‹¥å¡æ§åˆ¶ç®—æ³•</li>
</ul>
<h3 id="æœªæ¥å‘å±•è¶‹åŠ¿">æœªæ¥å‘å±•è¶‹åŠ¿</h3>
<ul>
<li><strong>QUICåè®®</strong>ï¼šåŸºäºUDPçš„å¯é ä¼ è¾“ï¼ŒHTTP/3çš„åŸºç¡€</li>
<li><strong>å¤šè·¯å¾„TCP</strong>ï¼šåˆ©ç”¨å¤šä¸ªç½‘ç»œè·¯å¾„æé«˜æ€§èƒ½</li>
<li><strong>æœºå™¨å­¦ä¹ </strong>ï¼šæ™ºèƒ½æ‹¥å¡æ§åˆ¶å’Œå‚æ•°è°ƒä¼˜</li>
<li><strong>ç¡¬ä»¶åŠ é€Ÿ</strong>ï¼šç½‘å¡å’Œäº¤æ¢æœºçš„TCPå¤„ç†åŠ é€Ÿ</li>
<li><strong>äº‘åŸç”Ÿä¼˜åŒ–</strong>ï¼šé’ˆå¯¹å®¹å™¨å’Œå¾®æœåŠ¡çš„TCPä¼˜åŒ–</li>
</ul>
<p>TCPåè®®ä½œä¸ºäº’è”ç½‘çš„åŸºçŸ³ï¼Œå…¶æ·±å…¥ç†è§£å¯¹äºç½‘ç»œç¼–ç¨‹ã€ç³»ç»Ÿè®¾è®¡å’Œæ€§èƒ½ä¼˜åŒ–éƒ½è‡³å…³é‡è¦ã€‚éšç€ç½‘ç»œæŠ€æœ¯çš„å‘å±•ï¼ŒTCPä¹Ÿåœ¨ä¸æ–­æ¼”è¿›ï¼Œå­¦ä¹ å…¶åŸç†å’Œæœ€æ–°å‘å±•è¶‹åŠ¿å°†æœ‰åŠ©äºæ„å»ºæ›´é«˜æ•ˆã€æ›´å¯é çš„ç½‘ç»œåº”ç”¨ã€‚</p>
]]></content:encoded>
    </item>
    <item>
      <title>HTTPåè®®è¯¦è§£ï¼šä»åŸºç¡€åˆ°é«˜çº§åº”ç”¨</title>
      <link>https://tyhzxh.github.io/posts/http-protocol-guide/</link>
      <pubDate>Wed, 28 Feb 2024 10:15:00 +0800</pubDate>
      <guid>https://tyhzxh.github.io/posts/http-protocol-guide/</guid>
      <description>æ·±å…¥è§£æHTTPåè®®çš„å·¥ä½œåŸç†ã€è¯·æ±‚å“åº”æœºåˆ¶ã€çŠ¶æ€ç ã€ç¼“å­˜ç­–ç•¥ã€å®‰å…¨æœºåˆ¶ä»¥åŠHTTP/2å’ŒHTTP/3çš„æ–°ç‰¹æ€§ï¼Œæ¶µç›–Webå¼€å‘ä¸­çš„å®é™…åº”ç”¨</description>
      <content:encoded><![CDATA[<h2 id="httpåè®®æ¦‚è¿°">HTTPåè®®æ¦‚è¿°</h2>
<p>**HTTPï¼ˆHyperText Transfer Protocolï¼‰**æ˜¯äº’è”ç½‘ä¸Šåº”ç”¨æœ€å¹¿æ³›çš„ç½‘ç»œåè®®ä¹‹ä¸€ï¼Œæ˜¯Webçš„åŸºç¡€ã€‚å®ƒå®šä¹‰äº†å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´å¦‚ä½•è¿›è¡Œé€šä¿¡ï¼Œæ˜¯ä¸€ä¸ªåŸºäºè¯·æ±‚-å“åº”æ¨¡å¼çš„ã€æ— çŠ¶æ€çš„åº”ç”¨å±‚åè®®ã€‚</p>
<h3 id="httpçš„æ ¸å¿ƒç‰¹ç‚¹">HTTPçš„æ ¸å¿ƒç‰¹ç‚¹</h3>
<table>
  <thead>
      <tr>
          <th>ç‰¹ç‚¹</th>
          <th>æè¿°</th>
          <th>å½±å“</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>æ— çŠ¶æ€</strong></td>
          <td>æ¯ä¸ªè¯·æ±‚éƒ½æ˜¯ç‹¬ç«‹çš„</td>
          <td>éœ€è¦é¢å¤–æœºåˆ¶ä¿æŒçŠ¶æ€</td>
      </tr>
      <tr>
          <td><strong>æ— è¿æ¥</strong></td>
          <td>è¯·æ±‚å®Œæˆåæ–­å¼€è¿æ¥</td>
          <td>HTTP/1.1å¼•å…¥æŒä¹…è¿æ¥</td>
      </tr>
      <tr>
          <td><strong>ç®€å•å¿«é€Ÿ</strong></td>
          <td>åè®®ç®€å•ï¼Œå¤„ç†é€Ÿåº¦å¿«</td>
          <td>æ˜“äºå®ç°å’Œè°ƒè¯•</td>
      </tr>
      <tr>
          <td><strong>çµæ´»</strong></td>
          <td>æ”¯æŒå¤šç§æ•°æ®ç±»å‹</td>
          <td>å¯ä¼ è¾“ä»»æ„ç±»å‹æ•°æ®</td>
      </tr>
  </tbody>
</table>
<h2 id="httpåè®®ç‰ˆæœ¬æ¼”è¿›">HTTPåè®®ç‰ˆæœ¬æ¼”è¿›</h2>
<h3 id="http10-vs-http11-vs-http2-vs-http3">HTTP/1.0 vs HTTP/1.1 vs HTTP/2 vs HTTP/3</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># HTTPç‰ˆæœ¬ç‰¹æ€§å¯¹æ¯”</span>
</span></span><span class="line"><span class="cl"><span class="n">http_versions</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;HTTP/1.0&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;å‘å¸ƒå¹´ä»½&#34;</span><span class="p">:</span> <span class="mi">1996</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;ä¸»è¦ç‰¹æ€§&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;åŸºæœ¬çš„è¯·æ±‚-å“åº”æœºåˆ¶&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ”¯æŒGETã€POSTã€HEADæ–¹æ³•&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ¯ä¸ªè¯·æ±‚å»ºç«‹æ–°è¿æ¥&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;ç¼ºç‚¹&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;è¿æ¥å¼€é”€å¤§&#34;</span><span class="p">,</span> <span class="s2">&#34;æ— æ³•å¤ç”¨è¿æ¥&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;HTTP/1.1&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;å‘å¸ƒå¹´ä»½&#34;</span><span class="p">:</span> <span class="mi">1997</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;ä¸»è¦ç‰¹æ€§&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æŒä¹…è¿æ¥ï¼ˆKeep-Aliveï¼‰&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;ç®¡é“åŒ–ï¼ˆPipeliningï¼‰&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;åˆ†å—ä¼ è¾“ç¼–ç &#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;Hostå¤´å­—æ®µ&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ›´å¤šHTTPæ–¹æ³•&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;æ”¹è¿›&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;å‡å°‘è¿æ¥å¼€é”€&#34;</span><span class="p">,</span> <span class="s2">&#34;æ”¯æŒè™šæ‹Ÿä¸»æœº&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;HTTP/2&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;å‘å¸ƒå¹´ä»½&#34;</span><span class="p">:</span> <span class="mi">2015</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;ä¸»è¦ç‰¹æ€§&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;äºŒè¿›åˆ¶åˆ†å¸§&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;å¤šè·¯å¤ç”¨&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;å¤´éƒ¨å‹ç¼©ï¼ˆHPACKï¼‰&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æœåŠ¡å™¨æ¨é€&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æµä¼˜å…ˆçº§&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;æ€§èƒ½æå‡&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;è§£å†³é˜Ÿå¤´é˜»å¡&#34;</span><span class="p">,</span> <span class="s2">&#34;å‡å°‘å»¶è¿Ÿ&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;HTTP/3&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;å‘å¸ƒå¹´ä»½&#34;</span><span class="p">:</span> <span class="mi">2022</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;ä¸»è¦ç‰¹æ€§&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;åŸºäºQUICåè®®&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;UDPä¼ è¾“&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;å†…ç½®åŠ å¯†&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;è¿æ¥è¿ç§»&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;0-RTTè¿æ¥å»ºç«‹&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;ä¼˜åŠ¿&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;æ›´å¿«çš„è¿æ¥å»ºç«‹&#34;</span><span class="p">,</span> <span class="s2">&#34;æ›´å¥½çš„ç§»åŠ¨ç½‘ç»œæ”¯æŒ&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">version</span><span class="p">,</span> <span class="n">details</span> <span class="ow">in</span> <span class="n">http_versions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="se">\n</span><span class="si">{</span><span class="n">version</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">details</span><span class="p">[</span><span class="s1">&#39;å‘å¸ƒå¹´ä»½&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">å¹´):&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">details</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ä¸»è¦ç‰¹æ€§&#39;</span><span class="p">,</span> <span class="p">[]):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;  â€¢ </span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="httpè¯·æ±‚å’Œå“åº”ç»“æ„">HTTPè¯·æ±‚å’Œå“åº”ç»“æ„</h2>
<h3 id="httpè¯·æ±‚ç»“æ„">HTTPè¯·æ±‚ç»“æ„</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="nf">GET</span> <span class="nn">/api/users/123</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</span></span><span class="line"><span class="cl"><span class="n">Host</span><span class="o">:</span> <span class="l">api.example.com</span>
</span></span><span class="line"><span class="cl"><span class="n">User-Agent</span><span class="o">:</span> <span class="l">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36</span>
</span></span><span class="line"><span class="cl"><span class="n">Accept</span><span class="o">:</span> <span class="l">application/json</span>
</span></span><span class="line"><span class="cl"><span class="n">Authorization</span><span class="o">:</span> <span class="l">Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...</span>
</span></span><span class="line"><span class="cl"><span class="n">Content-Type</span><span class="o">:</span> <span class="l">application/json</span>
</span></span><span class="line"><span class="cl"><span class="n">Content-Length</span><span class="o">:</span> <span class="l">85</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;å¼ ä¸‰&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;email&#34;</span><span class="p">:</span> <span class="s2">&#34;zhangsan@example.com&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h4 id="è¯·æ±‚ç»“æ„è§£æ">è¯·æ±‚ç»“æ„è§£æ</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">HTTPRequest</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;HTTPè¯·æ±‚ç»“æ„è§£æ&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw_request</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">raw_request</span> <span class="o">=</span> <span class="n">raw_request</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">parse_request</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">parse_request</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;è§£æHTTPè¯·æ±‚&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">lines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_request</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># è§£æè¯·æ±‚è¡Œ</span>
</span></span><span class="line"><span class="cl">        <span class="n">request_line</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">request_line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># è§£æè¯·æ±‚å¤´</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">headers</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">        <span class="n">body_start</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">body_start</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="s1">&#39;:&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="n">key</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># è§£æè¯·æ±‚ä½“</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">body_start</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">body</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="n">body_start</span><span class="p">:])</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">body</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">get_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;è·å–è¯·æ±‚ä¿¡æ¯&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;method&#34;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;path&#34;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;version&#34;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;headers&#34;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;body&#34;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">body</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="n">sample_request</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;GET /api/users HTTP/1.1
</span></span></span><span class="line"><span class="cl"><span class="s2">Host: api.example.com
</span></span></span><span class="line"><span class="cl"><span class="s2">User-Agent: Mozilla/5.0
</span></span></span><span class="line"><span class="cl"><span class="s2">Accept: application/json
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">request</span> <span class="o">=</span> <span class="n">HTTPRequest</span><span class="p">(</span><span class="n">sample_request</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;è¯·æ±‚ä¿¡æ¯:&#34;</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">get_info</span><span class="p">())</span>
</span></span></code></pre></div><h3 id="httpå“åº”ç»“æ„">HTTPå“åº”ç»“æ„</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
</span></span><span class="line"><span class="cl"><span class="n">Date</span><span class="o">:</span> <span class="l">Mon, 27 Feb 2024 10:15:30 GMT</span>
</span></span><span class="line"><span class="cl"><span class="n">Server</span><span class="o">:</span> <span class="l">nginx/1.18.0</span>
</span></span><span class="line"><span class="cl"><span class="n">Content-Type</span><span class="o">:</span> <span class="l">application/json; charset=utf-8</span>
</span></span><span class="line"><span class="cl"><span class="n">Content-Length</span><span class="o">:</span> <span class="l">156</span>
</span></span><span class="line"><span class="cl"><span class="n">Cache-Control</span><span class="o">:</span> <span class="l">max-age=3600</span>
</span></span><span class="line"><span class="cl"><span class="n">ETag</span><span class="o">:</span> <span class="l">&#34;33a64df551425fcc55e4d42a148795d9f25f89d4&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">Access-Control-Allow-Origin</span><span class="o">:</span> <span class="l">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;id&#34;</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;å¼ ä¸‰&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;email&#34;</span><span class="p">:</span> <span class="s2">&#34;zhangsan@example.com&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;created_at&#34;</span><span class="p">:</span> <span class="s2">&#34;2024-02-27T10:15:30Z&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;status&#34;</span><span class="p">:</span> <span class="s2">&#34;active&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h4 id="å“åº”ç»“æ„è§£æ">å“åº”ç»“æ„è§£æ</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">HTTPResponse</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;HTTPå“åº”ç»“æ„è§£æ&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw_response</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">raw_response</span> <span class="o">=</span> <span class="n">raw_response</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">parse_response</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">parse_response</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;è§£æHTTPå“åº”&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">lines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_response</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># è§£æçŠ¶æ€è¡Œ</span>
</span></span><span class="line"><span class="cl">        <span class="n">status_line</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">parts</span> <span class="o">=</span> <span class="n">status_line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">status_code</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">reason_phrase</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># è§£æå“åº”å¤´</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">headers</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">        <span class="n">body_start</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">body_start</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="s1">&#39;:&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="n">key</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># è§£æå“åº”ä½“</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">body_start</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">body</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="n">body_start</span><span class="p">:])</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">body</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">is_success</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;åˆ¤æ–­æ˜¯å¦æˆåŠŸå“åº”&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">200</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">status_code</span> <span class="o">&lt;</span> <span class="mi">300</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">get_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;è·å–å“åº”ä¿¡æ¯&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;version&#34;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;status_code&#34;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;reason_phrase&#34;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">reason_phrase</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;headers&#34;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;body&#34;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;is_success&#34;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_success</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span></code></pre></div><h2 id="httpæ–¹æ³•è¯¦è§£">HTTPæ–¹æ³•è¯¦è§£</h2>
<h3 id="å¸¸ç”¨httpæ–¹æ³•">å¸¸ç”¨HTTPæ–¹æ³•</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">HTTPMethods</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;HTTPæ–¹æ³•è¯¦è§£å’Œç¤ºä¾‹&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nd">@staticmethod</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">get_method_info</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;è·å–HTTPæ–¹æ³•ä¿¡æ¯&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">methods</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;GET&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç”¨é€”&#34;</span><span class="p">:</span> <span class="s2">&#34;è·å–èµ„æº&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç‰¹ç‚¹&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;å®‰å…¨&#34;</span><span class="p">,</span> <span class="s2">&#34;å¹‚ç­‰&#34;</span><span class="p">,</span> <span class="s2">&#34;å¯ç¼“å­˜&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç¤ºä¾‹&#34;</span><span class="p">:</span> <span class="s2">&#34;GET /api/users/123&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;POST&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç”¨é€”&#34;</span><span class="p">:</span> <span class="s2">&#34;åˆ›å»ºèµ„æºæˆ–æäº¤æ•°æ®&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç‰¹ç‚¹&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;ä¸å®‰å…¨&#34;</span><span class="p">,</span> <span class="s2">&#34;éå¹‚ç­‰&#34;</span><span class="p">,</span> <span class="s2">&#34;ä¸å¯ç¼“å­˜&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç¤ºä¾‹&#34;</span><span class="p">:</span> <span class="s2">&#34;POST /api/users&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;PUT&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç”¨é€”&#34;</span><span class="p">:</span> <span class="s2">&#34;æ›´æ–°æˆ–åˆ›å»ºèµ„æº&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç‰¹ç‚¹&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;ä¸å®‰å…¨&#34;</span><span class="p">,</span> <span class="s2">&#34;å¹‚ç­‰&#34;</span><span class="p">,</span> <span class="s2">&#34;ä¸å¯ç¼“å­˜&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç¤ºä¾‹&#34;</span><span class="p">:</span> <span class="s2">&#34;PUT /api/users/123&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;DELETE&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç”¨é€”&#34;</span><span class="p">:</span> <span class="s2">&#34;åˆ é™¤èµ„æº&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç‰¹ç‚¹&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;ä¸å®‰å…¨&#34;</span><span class="p">,</span> <span class="s2">&#34;å¹‚ç­‰&#34;</span><span class="p">,</span> <span class="s2">&#34;ä¸å¯ç¼“å­˜&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç¤ºä¾‹&#34;</span><span class="p">:</span> <span class="s2">&#34;DELETE /api/users/123&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;PATCH&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç”¨é€”&#34;</span><span class="p">:</span> <span class="s2">&#34;éƒ¨åˆ†æ›´æ–°èµ„æº&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç‰¹ç‚¹&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;ä¸å®‰å…¨&#34;</span><span class="p">,</span> <span class="s2">&#34;éå¹‚ç­‰&#34;</span><span class="p">,</span> <span class="s2">&#34;ä¸å¯ç¼“å­˜&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç¤ºä¾‹&#34;</span><span class="p">:</span> <span class="s2">&#34;PATCH /api/users/123&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;HEAD&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç”¨é€”&#34;</span><span class="p">:</span> <span class="s2">&#34;è·å–èµ„æºå¤´ä¿¡æ¯&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç‰¹ç‚¹&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;å®‰å…¨&#34;</span><span class="p">,</span> <span class="s2">&#34;å¹‚ç­‰&#34;</span><span class="p">,</span> <span class="s2">&#34;å¯ç¼“å­˜&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç¤ºä¾‹&#34;</span><span class="p">:</span> <span class="s2">&#34;HEAD /api/users/123&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;OPTIONS&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç”¨é€”&#34;</span><span class="p">:</span> <span class="s2">&#34;è·å–æœåŠ¡å™¨æ”¯æŒçš„æ–¹æ³•&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç‰¹ç‚¹&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;å®‰å…¨&#34;</span><span class="p">,</span> <span class="s2">&#34;å¹‚ç­‰&#34;</span><span class="p">,</span> <span class="s2">&#34;ä¸å¯ç¼“å­˜&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç¤ºä¾‹&#34;</span><span class="p">:</span> <span class="s2">&#34;OPTIONS /api/users&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">methods</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># RESTful APIè®¾è®¡ç¤ºä¾‹</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">RESTfulAPI</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;RESTful APIè®¾è®¡ç¤ºä¾‹&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">users</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">next_id</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">handle_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;å¤„ç†HTTPè¯·æ±‚&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;/api/users&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;GET&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">path</span> <span class="o">==</span> <span class="s1">&#39;/api/users&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_users</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">user_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_id</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_user</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span> <span class="ow">and</span> <span class="n">path</span> <span class="o">==</span> <span class="s1">&#39;/api/users&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_user</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;PUT&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">user_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_id</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_user</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;DELETE&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">user_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_id</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">delete_user</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;PATCH&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">user_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_id</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">patch_user</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">{</span><span class="s2">&#34;error&#34;</span><span class="p">:</span> <span class="s2">&#34;Not Found&#34;</span><span class="p">,</span> <span class="s2">&#34;status&#34;</span><span class="p">:</span> <span class="mi">404</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">extract_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;ä»è·¯å¾„ä¸­æå–ID&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">parts</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="k">if</span> <span class="n">parts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">get_users</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;è·å–æ‰€æœ‰ç”¨æˆ·&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">{</span><span class="s2">&#34;users&#34;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="s2">&#34;status&#34;</span><span class="p">:</span> <span class="mi">200</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">get_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;è·å–å•ä¸ªç”¨æˆ·&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">user_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="p">{</span><span class="s2">&#34;user&#34;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="p">[</span><span class="n">user_id</span><span class="p">],</span> <span class="s2">&#34;status&#34;</span><span class="p">:</span> <span class="mi">200</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">{</span><span class="s2">&#34;error&#34;</span><span class="p">:</span> <span class="s2">&#34;User not found&#34;</span><span class="p">,</span> <span class="s2">&#34;status&#34;</span><span class="p">:</span> <span class="mi">404</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">create_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;åˆ›å»ºç”¨æˆ·&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">user_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next_id</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">next_id</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">user</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;id&#34;</span><span class="p">:</span> <span class="n">user_id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;name&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;email&#34;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;email&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;created_at&#34;</span><span class="p">:</span> <span class="s2">&#34;2024-02-27T10:15:30Z&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="p">[</span><span class="n">user_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">user</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">{</span><span class="s2">&#34;user&#34;</span><span class="p">:</span> <span class="n">user</span><span class="p">,</span> <span class="s2">&#34;status&#34;</span><span class="p">:</span> <span class="mi">201</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">update_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;æ›´æ–°ç”¨æˆ·ï¼ˆå®Œæ•´æ›¿æ¢ï¼‰&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">user</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;id&#34;</span><span class="p">:</span> <span class="n">user_id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;name&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;email&#34;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;email&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;updated_at&#34;</span><span class="p">:</span> <span class="s2">&#34;2024-02-27T10:15:30Z&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="p">[</span><span class="n">user_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">user</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">{</span><span class="s2">&#34;user&#34;</span><span class="p">:</span> <span class="n">user</span><span class="p">,</span> <span class="s2">&#34;status&#34;</span><span class="p">:</span> <span class="mi">200</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">patch_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;éƒ¨åˆ†æ›´æ–°ç”¨æˆ·&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">user_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="p">{</span><span class="s2">&#34;error&#34;</span><span class="p">:</span> <span class="s2">&#34;User not found&#34;</span><span class="p">,</span> <span class="s2">&#34;status&#34;</span><span class="p">:</span> <span class="mi">404</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">user</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="p">[</span><span class="n">user_id</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">user</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">user</span><span class="p">[</span><span class="s2">&#34;updated_at&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;2024-02-27T10:15:30Z&#34;</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="p">[</span><span class="n">user_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">user</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">{</span><span class="s2">&#34;user&#34;</span><span class="p">:</span> <span class="n">user</span><span class="p">,</span> <span class="s2">&#34;status&#34;</span><span class="p">:</span> <span class="mi">200</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">delete_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;åˆ é™¤ç”¨æˆ·&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">user_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="p">[</span><span class="n">user_id</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="p">{</span><span class="s2">&#34;message&#34;</span><span class="p">:</span> <span class="s2">&#34;User deleted&#34;</span><span class="p">,</span> <span class="s2">&#34;status&#34;</span><span class="p">:</span> <span class="mi">204</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">{</span><span class="s2">&#34;error&#34;</span><span class="p">:</span> <span class="s2">&#34;User not found&#34;</span><span class="p">,</span> <span class="s2">&#34;status&#34;</span><span class="p">:</span> <span class="mi">404</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="n">api</span> <span class="o">=</span> <span class="n">RESTfulAPI</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åˆ›å»ºç”¨æˆ·</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">handle_request</span><span class="p">(</span><span class="s1">&#39;POST&#39;</span><span class="p">,</span> <span class="s1">&#39;/api/users&#39;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;å¼ ä¸‰&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;email&#34;</span><span class="p">:</span> <span class="s2">&#34;zhangsan@example.com&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;åˆ›å»ºç”¨æˆ·:&#34;</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è·å–ç”¨æˆ·</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">handle_request</span><span class="p">(</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;/api/users/1&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;è·å–ç”¨æˆ·:&#34;</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ›´æ–°ç”¨æˆ·</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">handle_request</span><span class="p">(</span><span class="s1">&#39;PATCH&#39;</span><span class="p">,</span> <span class="s1">&#39;/api/users/1&#39;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;å¼ ä¸‰ä¸°&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;æ›´æ–°ç”¨æˆ·:&#34;</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="httpçŠ¶æ€ç è¯¦è§£">HTTPçŠ¶æ€ç è¯¦è§£</h2>
<h3 id="çŠ¶æ€ç åˆ†ç±»å’Œå«ä¹‰">çŠ¶æ€ç åˆ†ç±»å’Œå«ä¹‰</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">HTTPStatusCodes</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;HTTPçŠ¶æ€ç è¯¦è§£&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">status_codes</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># 1xx ä¿¡æ¯æ€§çŠ¶æ€ç </span>
</span></span><span class="line"><span class="cl">            <span class="mi">100</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Continue&#34;</span><span class="p">,</span> <span class="s2">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;ç»§ç»­è¯·æ±‚&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="mi">101</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Switching Protocols&#34;</span><span class="p">,</span> <span class="s2">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;åˆ‡æ¢åè®®&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="mi">102</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Processing&#34;</span><span class="p">,</span> <span class="s2">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;å¤„ç†ä¸­&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="c1"># 2xx æˆåŠŸçŠ¶æ€ç </span>
</span></span><span class="line"><span class="cl">            <span class="mi">200</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;OK&#34;</span><span class="p">,</span> <span class="s2">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;è¯·æ±‚æˆåŠŸ&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="mi">201</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Created&#34;</span><span class="p">,</span> <span class="s2">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;èµ„æºå·²åˆ›å»º&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="mi">202</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Accepted&#34;</span><span class="p">,</span> <span class="s2">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;è¯·æ±‚å·²æ¥å—&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="mi">204</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;No Content&#34;</span><span class="p">,</span> <span class="s2">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;æ— å†…å®¹&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="mi">206</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Partial Content&#34;</span><span class="p">,</span> <span class="s2">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;éƒ¨åˆ†å†…å®¹&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="c1"># 3xx é‡å®šå‘çŠ¶æ€ç </span>
</span></span><span class="line"><span class="cl">            <span class="mi">301</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Moved Permanently&#34;</span><span class="p">,</span> <span class="s2">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;æ°¸ä¹…é‡å®šå‘&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="mi">302</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Found&#34;</span><span class="p">,</span> <span class="s2">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;ä¸´æ—¶é‡å®šå‘&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="mi">304</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Not Modified&#34;</span><span class="p">,</span> <span class="s2">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;æœªä¿®æ”¹&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="mi">307</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Temporary Redirect&#34;</span><span class="p">,</span> <span class="s2">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;ä¸´æ—¶é‡å®šå‘&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="mi">308</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Permanent Redirect&#34;</span><span class="p">,</span> <span class="s2">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;æ°¸ä¹…é‡å®šå‘&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="c1"># 4xx å®¢æˆ·ç«¯é”™è¯¯çŠ¶æ€ç </span>
</span></span><span class="line"><span class="cl">            <span class="mi">400</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Bad Request&#34;</span><span class="p">,</span> <span class="s2">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;è¯·æ±‚é”™è¯¯&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="mi">401</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Unauthorized&#34;</span><span class="p">,</span> <span class="s2">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;æœªæˆæƒ&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="mi">403</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Forbidden&#34;</span><span class="p">,</span> <span class="s2">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;ç¦æ­¢è®¿é—®&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="mi">404</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Not Found&#34;</span><span class="p">,</span> <span class="s2">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;èµ„æºæœªæ‰¾åˆ°&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="mi">405</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Method Not Allowed&#34;</span><span class="p">,</span> <span class="s2">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;æ–¹æ³•ä¸å…è®¸&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="mi">409</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Conflict&#34;</span><span class="p">,</span> <span class="s2">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;å†²çª&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="mi">422</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Unprocessable Entity&#34;</span><span class="p">,</span> <span class="s2">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;æ— æ³•å¤„ç†çš„å®ä½“&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="mi">429</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Too Many Requests&#34;</span><span class="p">,</span> <span class="s2">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;è¯·æ±‚è¿‡å¤š&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="c1"># 5xx æœåŠ¡å™¨é”™è¯¯çŠ¶æ€ç </span>
</span></span><span class="line"><span class="cl">            <span class="mi">500</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Internal Server Error&#34;</span><span class="p">,</span> <span class="s2">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;æœåŠ¡å™¨å†…éƒ¨é”™è¯¯&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="mi">501</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Not Implemented&#34;</span><span class="p">,</span> <span class="s2">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;æœªå®ç°&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="mi">502</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Bad Gateway&#34;</span><span class="p">,</span> <span class="s2">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;ç½‘å…³é”™è¯¯&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="mi">503</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Service Unavailable&#34;</span><span class="p">,</span> <span class="s2">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;æœåŠ¡ä¸å¯ç”¨&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="mi">504</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Gateway Timeout&#34;</span><span class="p">,</span> <span class="s2">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;ç½‘å…³è¶…æ—¶&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">get_status_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;è·å–çŠ¶æ€ç ä¿¡æ¯&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">code</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">status_codes</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">status_codes</span><span class="p">[</span><span class="n">code</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">{</span><span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Unknown&#34;</span><span class="p">,</span> <span class="s2">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;æœªçŸ¥çŠ¶æ€ç &#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">get_category</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;è·å–çŠ¶æ€ç ç±»åˆ«&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="mi">100</span> <span class="o">&lt;=</span> <span class="n">code</span> <span class="o">&lt;</span> <span class="mi">200</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="s2">&#34;ä¿¡æ¯æ€§å“åº”&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="mi">200</span> <span class="o">&lt;=</span> <span class="n">code</span> <span class="o">&lt;</span> <span class="mi">300</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="s2">&#34;æˆåŠŸå“åº”&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="mi">300</span> <span class="o">&lt;=</span> <span class="n">code</span> <span class="o">&lt;</span> <span class="mi">400</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="s2">&#34;é‡å®šå‘&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="mi">400</span> <span class="o">&lt;=</span> <span class="n">code</span> <span class="o">&lt;</span> <span class="mi">500</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="s2">&#34;å®¢æˆ·ç«¯é”™è¯¯&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="mi">500</span> <span class="o">&lt;=</span> <span class="n">code</span> <span class="o">&lt;</span> <span class="mi">600</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="s2">&#34;æœåŠ¡å™¨é”™è¯¯&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="s2">&#34;æœªçŸ¥ç±»åˆ«&#34;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">is_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;åˆ¤æ–­æ˜¯å¦ä¸ºé”™è¯¯çŠ¶æ€ç &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">code</span> <span class="o">&gt;=</span> <span class="mi">400</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># çŠ¶æ€ç ä½¿ç”¨ç¤ºä¾‹</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">handle_api_response</span><span class="p">(</span><span class="n">status_code</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;å¤„ç†APIå“åº”&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">status_handler</span> <span class="o">=</span> <span class="n">HTTPStatusCodes</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">info</span> <span class="o">=</span> <span class="n">status_handler</span><span class="o">.</span><span class="n">get_status_info</span><span class="p">(</span><span class="n">status_code</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">category</span> <span class="o">=</span> <span class="n">status_handler</span><span class="o">.</span><span class="n">get_category</span><span class="p">(</span><span class="n">status_code</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">response</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;status_code&#34;</span><span class="p">:</span> <span class="n">status_code</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;status_name&#34;</span><span class="p">:</span> <span class="n">info</span><span class="p">[</span><span class="s2">&#34;name&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;description&#34;</span><span class="p">:</span> <span class="n">info</span><span class="p">[</span><span class="s2">&#34;description&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;category&#34;</span><span class="p">:</span> <span class="n">category</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;is_error&#34;</span><span class="p">:</span> <span class="n">status_handler</span><span class="o">.</span><span class="n">is_error</span><span class="p">(</span><span class="n">status_code</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">response</span><span class="p">[</span><span class="s2">&#34;data&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">response</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;æˆåŠŸå“åº”:&#34;</span><span class="p">,</span> <span class="n">handle_api_response</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="p">{</span><span class="s2">&#34;message&#34;</span><span class="p">:</span> <span class="s2">&#34;æ“ä½œæˆåŠŸ&#34;</span><span class="p">}))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;å®¢æˆ·ç«¯é”™è¯¯:&#34;</span><span class="p">,</span> <span class="n">handle_api_response</span><span class="p">(</span><span class="mi">404</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;æœåŠ¡å™¨é”™è¯¯:&#34;</span><span class="p">,</span> <span class="n">handle_api_response</span><span class="p">(</span><span class="mi">500</span><span class="p">))</span>
</span></span></code></pre></div><h2 id="httpå¤´å­—æ®µè¯¦è§£">HTTPå¤´å­—æ®µè¯¦è§£</h2>
<h3 id="å¸¸ç”¨è¯·æ±‚å¤´">å¸¸ç”¨è¯·æ±‚å¤´</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">HTTPHeaders</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;HTTPå¤´å­—æ®µè¯¦è§£&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">request_headers</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;Accept&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç”¨é€”&#34;</span><span class="p">:</span> <span class="s2">&#34;æŒ‡å®šå®¢æˆ·ç«¯èƒ½å¤Ÿæ¥æ”¶çš„å†…å®¹ç±»å‹&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç¤ºä¾‹&#34;</span><span class="p">:</span> <span class="s2">&#34;Accept: application/json, text/html&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é‡è¦æ€§&#34;</span><span class="p">:</span> <span class="s2">&#34;é«˜&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;Accept-Encoding&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç”¨é€”&#34;</span><span class="p">:</span> <span class="s2">&#34;æŒ‡å®šå®¢æˆ·ç«¯æ”¯æŒçš„ç¼–ç æ ¼å¼&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç¤ºä¾‹&#34;</span><span class="p">:</span> <span class="s2">&#34;Accept-Encoding: gzip, deflate, br&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é‡è¦æ€§&#34;</span><span class="p">:</span> <span class="s2">&#34;ä¸­&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;Accept-Language&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç”¨é€”&#34;</span><span class="p">:</span> <span class="s2">&#34;æŒ‡å®šå®¢æˆ·ç«¯åå¥½çš„è¯­è¨€&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç¤ºä¾‹&#34;</span><span class="p">:</span> <span class="s2">&#34;Accept-Language: zh-CN,zh;q=0.9,en;q=0.8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é‡è¦æ€§&#34;</span><span class="p">:</span> <span class="s2">&#34;ä¸­&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;Authorization&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç”¨é€”&#34;</span><span class="p">:</span> <span class="s2">&#34;åŒ…å«è®¤è¯å‡­æ®&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç¤ºä¾‹&#34;</span><span class="p">:</span> <span class="s2">&#34;Authorization: Bearer eyJhbGciOiJIUzI1NiIs...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é‡è¦æ€§&#34;</span><span class="p">:</span> <span class="s2">&#34;é«˜&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;Cache-Control&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç”¨é€”&#34;</span><span class="p">:</span> <span class="s2">&#34;æŒ‡å®šç¼“å­˜æœºåˆ¶&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç¤ºä¾‹&#34;</span><span class="p">:</span> <span class="s2">&#34;Cache-Control: no-cache, max-age=0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é‡è¦æ€§&#34;</span><span class="p">:</span> <span class="s2">&#34;é«˜&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;Content-Type&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç”¨é€”&#34;</span><span class="p">:</span> <span class="s2">&#34;æŒ‡å®šè¯·æ±‚ä½“çš„åª’ä½“ç±»å‹&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç¤ºä¾‹&#34;</span><span class="p">:</span> <span class="s2">&#34;Content-Type: application/json; charset=utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é‡è¦æ€§&#34;</span><span class="p">:</span> <span class="s2">&#34;é«˜&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;Cookie&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç”¨é€”&#34;</span><span class="p">:</span> <span class="s2">&#34;å‘é€å­˜å‚¨çš„Cookie&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç¤ºä¾‹&#34;</span><span class="p">:</span> <span class="s2">&#34;Cookie: sessionid=abc123; csrftoken=xyz789&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é‡è¦æ€§&#34;</span><span class="p">:</span> <span class="s2">&#34;é«˜&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;Host&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç”¨é€”&#34;</span><span class="p">:</span> <span class="s2">&#34;æŒ‡å®šæœåŠ¡å™¨çš„åŸŸåå’Œç«¯å£&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç¤ºä¾‹&#34;</span><span class="p">:</span> <span class="s2">&#34;Host: api.example.com:443&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é‡è¦æ€§&#34;</span><span class="p">:</span> <span class="s2">&#34;å¿…éœ€&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;Referer&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç”¨é€”&#34;</span><span class="p">:</span> <span class="s2">&#34;æŒ‡å®šè¯·æ±‚æ¥æºé¡µé¢&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç¤ºä¾‹&#34;</span><span class="p">:</span> <span class="s2">&#34;Referer: https://example.com/page&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é‡è¦æ€§&#34;</span><span class="p">:</span> <span class="s2">&#34;ä¸­&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;User-Agent&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç”¨é€”&#34;</span><span class="p">:</span> <span class="s2">&#34;æ ‡è¯†å®¢æˆ·ç«¯åº”ç”¨ç¨‹åº&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç¤ºä¾‹&#34;</span><span class="p">:</span> <span class="s2">&#34;User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é‡è¦æ€§&#34;</span><span class="p">:</span> <span class="s2">&#34;ä¸­&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">response_headers</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;Access-Control-Allow-Origin&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç”¨é€”&#34;</span><span class="p">:</span> <span class="s2">&#34;CORSè·¨åŸŸè®¿é—®æ§åˆ¶&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç¤ºä¾‹&#34;</span><span class="p">:</span> <span class="s2">&#34;Access-Control-Allow-Origin: *&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é‡è¦æ€§&#34;</span><span class="p">:</span> <span class="s2">&#34;é«˜&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;Cache-Control&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç”¨é€”&#34;</span><span class="p">:</span> <span class="s2">&#34;æŒ‡å®šç¼“å­˜ç­–ç•¥&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç¤ºä¾‹&#34;</span><span class="p">:</span> <span class="s2">&#34;Cache-Control: public, max-age=3600&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é‡è¦æ€§&#34;</span><span class="p">:</span> <span class="s2">&#34;é«˜&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;Content-Encoding&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç”¨é€”&#34;</span><span class="p">:</span> <span class="s2">&#34;æŒ‡å®šå†…å®¹ç¼–ç æ ¼å¼&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç¤ºä¾‹&#34;</span><span class="p">:</span> <span class="s2">&#34;Content-Encoding: gzip&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é‡è¦æ€§&#34;</span><span class="p">:</span> <span class="s2">&#34;ä¸­&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;Content-Length&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç”¨é€”&#34;</span><span class="p">:</span> <span class="s2">&#34;æŒ‡å®šå“åº”ä½“é•¿åº¦&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç¤ºä¾‹&#34;</span><span class="p">:</span> <span class="s2">&#34;Content-Length: 1024&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é‡è¦æ€§&#34;</span><span class="p">:</span> <span class="s2">&#34;é«˜&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;Content-Type&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç”¨é€”&#34;</span><span class="p">:</span> <span class="s2">&#34;æŒ‡å®šå“åº”ä½“çš„åª’ä½“ç±»å‹&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç¤ºä¾‹&#34;</span><span class="p">:</span> <span class="s2">&#34;Content-Type: application/json; charset=utf-8&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é‡è¦æ€§&#34;</span><span class="p">:</span> <span class="s2">&#34;é«˜&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;ETag&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç”¨é€”&#34;</span><span class="p">:</span> <span class="s2">&#34;èµ„æºçš„å”¯ä¸€æ ‡è¯†ç¬¦&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç¤ºä¾‹&#34;</span><span class="p">:</span> <span class="s2">&#34;ETag: </span><span class="se">\&#34;</span><span class="s2">33a64df551425fcc55e4d42a148795d9f25f89d4</span><span class="se">\&#34;</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é‡è¦æ€§&#34;</span><span class="p">:</span> <span class="s2">&#34;ä¸­&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;Expires&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç”¨é€”&#34;</span><span class="p">:</span> <span class="s2">&#34;æŒ‡å®šèµ„æºè¿‡æœŸæ—¶é—´&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç¤ºä¾‹&#34;</span><span class="p">:</span> <span class="s2">&#34;Expires: Wed, 21 Oct 2024 07:28:00 GMT&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é‡è¦æ€§&#34;</span><span class="p">:</span> <span class="s2">&#34;ä¸­&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;Last-Modified&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç”¨é€”&#34;</span><span class="p">:</span> <span class="s2">&#34;èµ„æºæœ€åä¿®æ”¹æ—¶é—´&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç¤ºä¾‹&#34;</span><span class="p">:</span> <span class="s2">&#34;Last-Modified: Wed, 21 Oct 2024 07:28:00 GMT&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é‡è¦æ€§&#34;</span><span class="p">:</span> <span class="s2">&#34;ä¸­&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;Location&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç”¨é€”&#34;</span><span class="p">:</span> <span class="s2">&#34;é‡å®šå‘çš„ç›®æ ‡URL&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç¤ºä¾‹&#34;</span><span class="p">:</span> <span class="s2">&#34;Location: https://example.com/new-page&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é‡è¦æ€§&#34;</span><span class="p">:</span> <span class="s2">&#34;é«˜&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;Set-Cookie&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç”¨é€”&#34;</span><span class="p">:</span> <span class="s2">&#34;è®¾ç½®Cookie&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç¤ºä¾‹&#34;</span><span class="p">:</span> <span class="s2">&#34;Set-Cookie: sessionid=abc123; HttpOnly; Secure&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é‡è¦æ€§&#34;</span><span class="p">:</span> <span class="s2">&#34;é«˜&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¤´å­—æ®µå¤„ç†ç¤ºä¾‹</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">HeaderProcessor</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;HTTPå¤´å­—æ®µå¤„ç†å™¨&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">headers</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">add_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;æ·»åŠ å¤´å­—æ®µ&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">get_content_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;è·å–å†…å®¹ç±»å‹&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">content_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="s1">&#39;;&#39;</span> <span class="ow">in</span> <span class="n">content_type</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">content_type</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">content_type</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">get_charset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;è·å–å­—ç¬¦ç¼–ç &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">content_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="s1">&#39;charset=&#39;</span> <span class="ow">in</span> <span class="n">content_type</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">content_type</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;charset=&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s1">&#39;utf-8&#39;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">is_json</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;åˆ¤æ–­æ˜¯å¦ä¸ºJSONæ ¼å¼&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_content_type</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;application/json&#39;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">get_cache_control</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;è§£æCache-Controlå¤´&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cache_control</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Cache-Control&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">directives</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">directive</span> <span class="ow">in</span> <span class="n">cache_control</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">directive</span> <span class="o">=</span> <span class="n">directive</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="s1">&#39;=&#39;</span> <span class="ow">in</span> <span class="n">directive</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">directive</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">directives</span><span class="p">[</span><span class="n">key</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">directives</span><span class="p">[</span><span class="n">directive</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">directives</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">get_authorization_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;è·å–è®¤è¯ç±»å‹&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">auth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Authorization&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">auth</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">auth</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="n">processor</span> <span class="o">=</span> <span class="n">HeaderProcessor</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">processor</span><span class="o">.</span><span class="n">add_header</span><span class="p">(</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json; charset=utf-8&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">processor</span><span class="o">.</span><span class="n">add_header</span><span class="p">(</span><span class="s1">&#39;Cache-Control&#39;</span><span class="p">,</span> <span class="s1">&#39;public, max-age=3600, must-revalidate&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">processor</span><span class="o">.</span><span class="n">add_header</span><span class="p">(</span><span class="s1">&#39;Authorization&#39;</span><span class="p">,</span> <span class="s1">&#39;Bearer eyJhbGciOiJIUzI1NiIs...&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;å†…å®¹ç±»å‹:&#34;</span><span class="p">,</span> <span class="n">processor</span><span class="o">.</span><span class="n">get_content_type</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;å­—ç¬¦ç¼–ç :&#34;</span><span class="p">,</span> <span class="n">processor</span><span class="o">.</span><span class="n">get_charset</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;æ˜¯å¦JSON:&#34;</span><span class="p">,</span> <span class="n">processor</span><span class="o">.</span><span class="n">is_json</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;ç¼“å­˜æ§åˆ¶:&#34;</span><span class="p">,</span> <span class="n">processor</span><span class="o">.</span><span class="n">get_cache_control</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;è®¤è¯ç±»å‹:&#34;</span><span class="p">,</span> <span class="n">processor</span><span class="o">.</span><span class="n">get_authorization_type</span><span class="p">())</span>
</span></span></code></pre></div><h2 id="httpç¼“å­˜æœºåˆ¶">HTTPç¼“å­˜æœºåˆ¶</h2>
<h3 id="ç¼“å­˜ç­–ç•¥è¯¦è§£">ç¼“å­˜ç­–ç•¥è¯¦è§£</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">hashlib</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">HTTPCache</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;HTTPç¼“å­˜æœºåˆ¶å®ç°&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">cache</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">generate_etag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;ç”ŸæˆETag&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">content</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">is_fresh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cache_entry</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;æ£€æŸ¥ç¼“å­˜æ˜¯å¦æ–°é²œ&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="s1">&#39;expires&#39;</span> <span class="ow">in</span> <span class="n">cache_entry</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">cache_entry</span><span class="p">[</span><span class="s1">&#39;expires&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="s1">&#39;max_age&#39;</span> <span class="ow">in</span> <span class="n">cache_entry</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">age</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">cache_entry</span><span class="p">[</span><span class="s1">&#39;cached_at&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">age</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">cache_entry</span><span class="p">[</span><span class="s1">&#39;max_age&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">handle_cache_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;å¤„ç†ç¼“å­˜è¯·æ±‚&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">headers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">headers</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">cache_entry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># æ£€æŸ¥æ˜¯å¦æœ‰ç¼“å­˜</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="ow">not</span> <span class="n">cache_entry</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="p">{</span><span class="s2">&#34;cache_status&#34;</span><span class="p">:</span> <span class="s2">&#34;MISS&#34;</span><span class="p">,</span> <span class="s2">&#34;should_fetch&#34;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># æ£€æŸ¥ç¼“å­˜æ˜¯å¦æ–°é²œ</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fresh</span><span class="p">(</span><span class="n">cache_entry</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="p">{</span><span class="s2">&#34;cache_status&#34;</span><span class="p">:</span> <span class="s2">&#34;STALE&#34;</span><span class="p">,</span> <span class="s2">&#34;should_fetch&#34;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># æ£€æŸ¥æ¡ä»¶è¯·æ±‚</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="s1">&#39;If-None-Match&#39;</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">headers</span><span class="p">[</span><span class="s1">&#39;If-None-Match&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">cache_entry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;etag&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="p">{</span><span class="s2">&#34;cache_status&#34;</span><span class="p">:</span> <span class="s2">&#34;NOT_MODIFIED&#34;</span><span class="p">,</span> <span class="s2">&#34;should_fetch&#34;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="s1">&#39;If-Modified-Since&#39;</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">if_modified</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;If-Modified-Since&#39;</span><span class="p">],</span> 
</span></span><span class="line"><span class="cl">                                          <span class="s1">&#39;</span><span class="si">%a</span><span class="s1">, </span><span class="si">%d</span><span class="s1"> %b %Y %H:%M:%S GMT&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">cache_entry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;last_modified&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">if_modified</span> <span class="o">&gt;=</span> <span class="n">cache_entry</span><span class="p">[</span><span class="s1">&#39;last_modified&#39;</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="p">{</span><span class="s2">&#34;cache_status&#34;</span><span class="p">:</span> <span class="s2">&#34;NOT_MODIFIED&#34;</span><span class="p">,</span> <span class="s2">&#34;should_fetch&#34;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">{</span><span class="s2">&#34;cache_status&#34;</span><span class="p">:</span> <span class="s2">&#34;HIT&#34;</span><span class="p">,</span> <span class="s2">&#34;should_fetch&#34;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&#34;data&#34;</span><span class="p">:</span> <span class="n">cache_entry</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">store_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">response_data</span><span class="p">,</span> <span class="n">headers</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;å­˜å‚¨å“åº”åˆ°ç¼“å­˜&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cache_entry</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;data&#34;</span><span class="p">:</span> <span class="n">response_data</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;cached_at&#34;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;headers&#34;</span><span class="p">:</span> <span class="n">headers</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># å¤„ç†ETag</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="s1">&#39;ETag&#39;</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">cache_entry</span><span class="p">[</span><span class="s1">&#39;etag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">headers</span><span class="p">[</span><span class="s1">&#39;ETag&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># å¤„ç†Last-Modified</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="s1">&#39;Last-Modified&#39;</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">cache_entry</span><span class="p">[</span><span class="s1">&#39;last_modified&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Last-Modified&#39;</span><span class="p">],</span> <span class="s1">&#39;</span><span class="si">%a</span><span class="s1">, </span><span class="si">%d</span><span class="s1"> %b %Y %H:%M:%S GMT&#39;</span>
</span></span><span class="line"><span class="cl">            <span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># å¤„ç†Expires</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="s1">&#39;Expires&#39;</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">cache_entry</span><span class="p">[</span><span class="s1">&#39;expires&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Expires&#39;</span><span class="p">],</span> <span class="s1">&#39;</span><span class="si">%a</span><span class="s1">, </span><span class="si">%d</span><span class="s1"> %b %Y %H:%M:%S GMT&#39;</span>
</span></span><span class="line"><span class="cl">            <span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># å¤„ç†Cache-Control</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="s1">&#39;Cache-Control&#39;</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">cache_control</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_cache_control</span><span class="p">(</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Cache-Control&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="s1">&#39;max-age&#39;</span> <span class="ow">in</span> <span class="n">cache_control</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">cache_entry</span><span class="p">[</span><span class="s1">&#39;max_age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">cache_control</span><span class="p">[</span><span class="s1">&#39;max-age&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="s1">&#39;no-cache&#39;</span> <span class="ow">in</span> <span class="n">cache_control</span> <span class="ow">or</span> <span class="s1">&#39;no-store&#39;</span> <span class="ow">in</span> <span class="n">cache_control</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span>  <span class="c1"># ä¸ç¼“å­˜</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="n">url</span><span class="p">]</span> <span class="o">=</span> <span class="n">cache_entry</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">parse_cache_control</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cache_control_header</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;è§£æCache-Controlå¤´&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">directives</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">directive</span> <span class="ow">in</span> <span class="n">cache_control_header</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">directive</span> <span class="o">=</span> <span class="n">directive</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="s1">&#39;=&#39;</span> <span class="ow">in</span> <span class="n">directive</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">directive</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">directives</span><span class="p">[</span><span class="n">key</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">directives</span><span class="p">[</span><span class="n">directive</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">directives</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¼“å­˜ç­–ç•¥ç¤ºä¾‹</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">CacheStrategy</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;ç¼“å­˜ç­–ç•¥ç¤ºä¾‹&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nd">@staticmethod</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">get_cache_headers</span><span class="p">(</span><span class="n">resource_type</span><span class="p">,</span> <span class="n">max_age</span><span class="o">=</span><span class="mi">3600</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;æ ¹æ®èµ„æºç±»å‹è·å–ç¼“å­˜å¤´&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">strategies</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;static&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;Cache-Control&#34;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&#34;public, max-age=</span><span class="si">{</span><span class="n">max_age</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">365</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">,</span>  <span class="c1"># 1å¹´</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;Expires&#34;</span><span class="p">:</span> <span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">365</span><span class="p">))</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                    <span class="s1">&#39;</span><span class="si">%a</span><span class="s1">, </span><span class="si">%d</span><span class="s1"> %b %Y %H:%M:%S GMT&#39;</span>
</span></span><span class="line"><span class="cl">                <span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;api&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;Cache-Control&#34;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&#34;private, max-age=</span><span class="si">{</span><span class="n">max_age</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">,</span>  <span class="c1"># 1å°æ—¶</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ETag&#34;</span><span class="p">:</span> <span class="s1">&#39;&#34;&#39;</span> <span class="o">+</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;&#34;&#39;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;dynamic&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;Cache-Control&#34;</span><span class="p">:</span> <span class="s2">&#34;no-cache, must-revalidate&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;Pragma&#34;</span><span class="p">:</span> <span class="s2">&#34;no-cache&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;sensitive&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;Cache-Control&#34;</span><span class="p">:</span> <span class="s2">&#34;no-store, no-cache, must-revalidate&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;Pragma&#34;</span><span class="p">:</span> <span class="s2">&#34;no-cache&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;Expires&#34;</span><span class="p">:</span> <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">strategies</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">resource_type</span><span class="p">,</span> <span class="n">strategies</span><span class="p">[</span><span class="s2">&#34;dynamic&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="n">cache</span> <span class="o">=</span> <span class="n">HTTPCache</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ¨¡æ‹Ÿç¬¬ä¸€æ¬¡è¯·æ±‚</span>
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;https://api.example.com/users&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">cache</span><span class="o">.</span><span class="n">handle_cache_request</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;ç¬¬ä¸€æ¬¡è¯·æ±‚:&#34;</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å­˜å‚¨å“åº”</span>
</span></span><span class="line"><span class="cl"><span class="n">response_data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;users&#34;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&#34;id&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;å¼ ä¸‰&#34;</span><span class="p">}]}</span>
</span></span><span class="line"><span class="cl"><span class="n">response_headers</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;Cache-Control&#34;</span><span class="p">:</span> <span class="s2">&#34;public, max-age=3600&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;ETag&#34;</span><span class="p">:</span> <span class="s1">&#39;&#34;abc123&#34;&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;Last-Modified&#34;</span><span class="p">:</span> <span class="s2">&#34;Mon, 27 Feb 2024 10:15:30 GMT&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">cache</span><span class="o">.</span><span class="n">store_response</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">response_data</span><span class="p">,</span> <span class="n">response_headers</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ¨¡æ‹Ÿç¬¬äºŒæ¬¡è¯·æ±‚</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">cache</span><span class="o">.</span><span class="n">handle_cache_request</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;ç¬¬äºŒæ¬¡è¯·æ±‚:&#34;</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ¨¡æ‹Ÿæ¡ä»¶è¯·æ±‚</span>
</span></span><span class="line"><span class="cl"><span class="n">conditional_headers</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;If-None-Match&#34;</span><span class="p">:</span> <span class="s1">&#39;&#34;abc123&#34;&#39;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">cache</span><span class="o">.</span><span class="n">handle_cache_request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">conditional_headers</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;æ¡ä»¶è¯·æ±‚:&#34;</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="httpå®‰å…¨æœºåˆ¶">HTTPå®‰å…¨æœºåˆ¶</h2>
<h3 id="httpså’Œå®‰å…¨å¤´">HTTPSå’Œå®‰å…¨å¤´</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">HTTPSecurity</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;HTTPå®‰å…¨æœºåˆ¶&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">security_headers</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;Strict-Transport-Security&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç”¨é€”&#34;</span><span class="p">:</span> <span class="s2">&#34;å¼ºåˆ¶ä½¿ç”¨HTTPS&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç¤ºä¾‹&#34;</span><span class="p">:</span> <span class="s2">&#34;Strict-Transport-Security: max-age=31536000; includeSubDomains&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é˜²æŠ¤&#34;</span><span class="p">:</span> <span class="s2">&#34;ä¸­é—´äººæ”»å‡»&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;Content-Security-Policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç”¨é€”&#34;</span><span class="p">:</span> <span class="s2">&#34;é˜²æ­¢XSSæ”»å‡»&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç¤ºä¾‹&#34;</span><span class="p">:</span> <span class="s2">&#34;Content-Security-Policy: default-src &#39;self&#39;; script-src &#39;self&#39; &#39;unsafe-inline&#39;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é˜²æŠ¤&#34;</span><span class="p">:</span> <span class="s2">&#34;è·¨ç«™è„šæœ¬æ”»å‡»&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;X-Frame-Options&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç”¨é€”&#34;</span><span class="p">:</span> <span class="s2">&#34;é˜²æ­¢ç‚¹å‡»åŠ«æŒ&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç¤ºä¾‹&#34;</span><span class="p">:</span> <span class="s2">&#34;X-Frame-Options: DENY&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é˜²æŠ¤&#34;</span><span class="p">:</span> <span class="s2">&#34;ç‚¹å‡»åŠ«æŒæ”»å‡»&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;X-Content-Type-Options&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç”¨é€”&#34;</span><span class="p">:</span> <span class="s2">&#34;é˜²æ­¢MIMEç±»å‹å—…æ¢&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç¤ºä¾‹&#34;</span><span class="p">:</span> <span class="s2">&#34;X-Content-Type-Options: nosniff&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é˜²æŠ¤&#34;</span><span class="p">:</span> <span class="s2">&#34;MIMEå—…æ¢æ”»å‡»&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;X-XSS-Protection&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç”¨é€”&#34;</span><span class="p">:</span> <span class="s2">&#34;å¯ç”¨XSSè¿‡æ»¤å™¨&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç¤ºä¾‹&#34;</span><span class="p">:</span> <span class="s2">&#34;X-XSS-Protection: 1; mode=block&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é˜²æŠ¤&#34;</span><span class="p">:</span> <span class="s2">&#34;åå°„å‹XSSæ”»å‡»&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;Referrer-Policy&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç”¨é€”&#34;</span><span class="p">:</span> <span class="s2">&#34;æ§åˆ¶Refererå¤´ä¿¡æ¯&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ç¤ºä¾‹&#34;</span><span class="p">:</span> <span class="s2">&#34;Referrer-Policy: strict-origin-when-cross-origin&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;é˜²æŠ¤&#34;</span><span class="p">:</span> <span class="s2">&#34;ä¿¡æ¯æ³„éœ²&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">get_security_headers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">security_level</span><span class="o">=</span><span class="s2">&#34;high&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;è·å–å®‰å…¨å¤´é…ç½®&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">security_level</span> <span class="o">==</span> <span class="s2">&#34;high&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;Strict-Transport-Security&#34;</span><span class="p">:</span> <span class="s2">&#34;max-age=31536000; includeSubDomains; preload&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;Content-Security-Policy&#34;</span><span class="p">:</span> <span class="s2">&#34;default-src &#39;self&#39;; script-src &#39;self&#39;; style-src &#39;self&#39; &#39;unsafe-inline&#39;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;X-Frame-Options&#34;</span><span class="p">:</span> <span class="s2">&#34;DENY&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;X-Content-Type-Options&#34;</span><span class="p">:</span> <span class="s2">&#34;nosniff&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;X-XSS-Protection&#34;</span><span class="p">:</span> <span class="s2">&#34;1; mode=block&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;Referrer-Policy&#34;</span><span class="p">:</span> <span class="s2">&#34;strict-origin-when-cross-origin&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="n">security_level</span> <span class="o">==</span> <span class="s2">&#34;medium&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;Strict-Transport-Security&#34;</span><span class="p">:</span> <span class="s2">&#34;max-age=31536000&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;Content-Security-Policy&#34;</span><span class="p">:</span> <span class="s2">&#34;default-src &#39;self&#39; &#39;unsafe-inline&#39;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;X-Frame-Options&#34;</span><span class="p">:</span> <span class="s2">&#34;SAMEORIGIN&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;X-Content-Type-Options&#34;</span><span class="p">:</span> <span class="s2">&#34;nosniff&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;X-Content-Type-Options&#34;</span><span class="p">:</span> <span class="s2">&#34;nosniff&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">validate_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;éªŒè¯è¯·æ±‚å®‰å…¨æ€§&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">issues</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># æ£€æŸ¥Content-Type</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">body</span> <span class="ow">and</span> <span class="s1">&#39;Content-Type&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&#34;ç¼ºå°‘Content-Typeå¤´&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># æ£€æŸ¥CSRFä¿æŠ¤</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;application/json&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="s1">&#39;X-Requested-With&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">headers</span> <span class="ow">and</span> <span class="s1">&#39;X-CSRF-Token&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&#34;å¯èƒ½å­˜åœ¨CSRFé£é™©&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># æ£€æŸ¥è®¤è¯</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="s1">&#39;Authorization&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">headers</span> <span class="ow">and</span> <span class="s1">&#39;Cookie&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&#34;ç¼ºå°‘è®¤è¯ä¿¡æ¯&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;is_secure&#34;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">issues</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;issues&#34;</span><span class="p">:</span> <span class="n">issues</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># CORSå¤„ç†</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">CORSHandler</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;CORSè·¨åŸŸèµ„æºå…±äº«å¤„ç†&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">allowed_origins</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">allowed_methods</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">allowed_headers</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">allowed_origins</span> <span class="o">=</span> <span class="n">allowed_origins</span> <span class="ow">or</span> <span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">allowed_methods</span> <span class="o">=</span> <span class="n">allowed_methods</span> <span class="ow">or</span> <span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;POST&#39;</span><span class="p">,</span> <span class="s1">&#39;PUT&#39;</span><span class="p">,</span> <span class="s1">&#39;DELETE&#39;</span><span class="p">,</span> <span class="s1">&#39;OPTIONS&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">allowed_headers</span> <span class="o">=</span> <span class="n">allowed_headers</span> <span class="ow">or</span> <span class="p">[</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">,</span> <span class="s1">&#39;Authorization&#39;</span><span class="p">,</span> <span class="s1">&#39;X-Requested-With&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">handle_preflight</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">origin</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">headers</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;å¤„ç†é¢„æ£€è¯·æ±‚&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">response_headers</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># æ£€æŸ¥æ¥æº</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_origin_allowed</span><span class="p">(</span><span class="n">origin</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">response_headers</span><span class="p">[</span><span class="s1">&#39;Access-Control-Allow-Origin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">origin</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># æ£€æŸ¥æ–¹æ³•</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">method</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allowed_methods</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">response_headers</span><span class="p">[</span><span class="s1">&#39;Access-Control-Allow-Methods&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">allowed_methods</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># æ£€æŸ¥å¤´éƒ¨</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">headers</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">requested_headers</span> <span class="o">=</span> <span class="p">[</span><span class="n">h</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">headers</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">            <span class="n">allowed</span> <span class="o">=</span> <span class="p">[</span><span class="n">h</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">requested_headers</span> <span class="k">if</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allowed_headers</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">allowed</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">response_headers</span><span class="p">[</span><span class="s1">&#39;Access-Control-Allow-Headers&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">allowed</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">response_headers</span><span class="p">[</span><span class="s1">&#39;Access-Control-Max-Age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;86400&#39;</span>  <span class="c1"># 24å°æ—¶</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">response_headers</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">handle_actual_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">origin</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;å¤„ç†å®é™…è¯·æ±‚&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">response_headers</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_origin_allowed</span><span class="p">(</span><span class="n">origin</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">response_headers</span><span class="p">[</span><span class="s1">&#39;Access-Control-Allow-Origin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">origin</span>
</span></span><span class="line"><span class="cl">            <span class="n">response_headers</span><span class="p">[</span><span class="s1">&#39;Access-Control-Allow-Credentials&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;true&#39;</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">response_headers</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">is_origin_allowed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">origin</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;æ£€æŸ¥æ¥æºæ˜¯å¦è¢«å…è®¸&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s1">&#39;*&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allowed_origins</span> <span class="ow">or</span> <span class="n">origin</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allowed_origins</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="n">security</span> <span class="o">=</span> <span class="n">HTTPSecurity</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;é«˜å®‰å…¨çº§åˆ«å¤´éƒ¨:&#34;</span><span class="p">,</span> <span class="n">security</span><span class="o">.</span><span class="n">get_security_headers</span><span class="p">(</span><span class="s2">&#34;high&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># CORSç¤ºä¾‹</span>
</span></span><span class="line"><span class="cl"><span class="n">cors</span> <span class="o">=</span> <span class="n">CORSHandler</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">allowed_origins</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;https://example.com&#39;</span><span class="p">,</span> <span class="s1">&#39;https://app.example.com&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="n">allowed_methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;POST&#39;</span><span class="p">,</span> <span class="s1">&#39;PUT&#39;</span><span class="p">,</span> <span class="s1">&#39;DELETE&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="n">allowed_headers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">,</span> <span class="s1">&#39;Authorization&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">preflight_headers</span> <span class="o">=</span> <span class="n">cors</span><span class="o">.</span><span class="n">handle_preflight</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;https://example.com&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">method</span><span class="o">=</span><span class="s1">&#39;POST&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">headers</span><span class="o">=</span><span class="s1">&#39;Content-Type, Authorization&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;é¢„æ£€å“åº”å¤´:&#34;</span><span class="p">,</span> <span class="n">preflight_headers</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="http2-å’Œ-http3-æ–°ç‰¹æ€§">HTTP/2 å’Œ HTTP/3 æ–°ç‰¹æ€§</h2>
<h3 id="http2-ç‰¹æ€§">HTTP/2 ç‰¹æ€§</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">HTTP2Features</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;HTTP/2 ç‰¹æ€§æ¼”ç¤º&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">streams</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">next_stream_id</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">create_stream</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;åˆ›å»ºHTTP/2æµ&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">stream_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next_stream_id</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">next_stream_id</span> <span class="o">+=</span> <span class="mi">2</span>  <span class="c1"># å®¢æˆ·ç«¯æµIDä¸ºå¥‡æ•°</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">stream</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;id&#34;</span><span class="p">:</span> <span class="n">stream_id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;method&#34;</span><span class="p">:</span> <span class="n">method</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;path&#34;</span><span class="p">:</span> <span class="n">path</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;headers&#34;</span><span class="p">:</span> <span class="n">headers</span> <span class="ow">or</span> <span class="p">{},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;state&#34;</span><span class="p">:</span> <span class="s2">&#34;open&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;priority&#34;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>  <span class="c1"># é»˜è®¤ä¼˜å…ˆçº§</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;dependency&#34;</span><span class="p">:</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">streams</span><span class="p">[</span><span class="n">stream_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">stream</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">stream_id</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">set_priority</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stream_id</span><span class="p">,</span> <span class="n">priority</span><span class="p">,</span> <span class="n">dependency</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;è®¾ç½®æµä¼˜å…ˆçº§&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">stream_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">streams</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">streams</span><span class="p">[</span><span class="n">stream_id</span><span class="p">][</span><span class="s2">&#34;priority&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">priority</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">streams</span><span class="p">[</span><span class="n">stream_id</span><span class="p">][</span><span class="s2">&#34;dependency&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dependency</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">server_push</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_stream_id</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;æœåŠ¡å™¨æ¨é€&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">push_stream_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next_stream_id</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">next_stream_id</span> <span class="o">+=</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">push_stream</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;id&#34;</span><span class="p">:</span> <span class="n">push_stream_id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;GET&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;path&#34;</span><span class="p">:</span> <span class="n">path</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;headers&#34;</span><span class="p">:</span> <span class="n">headers</span> <span class="ow">or</span> <span class="p">{},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;state&#34;</span><span class="p">:</span> <span class="s2">&#34;reserved_local&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;parent&#34;</span><span class="p">:</span> <span class="n">parent_stream_id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;pushed&#34;</span><span class="p">:</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">streams</span><span class="p">[</span><span class="n">push_stream_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">push_stream</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">push_stream_id</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">compress_headers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">headers</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;HPACKå¤´éƒ¨å‹ç¼©æ¨¡æ‹Ÿ&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># ç®€åŒ–çš„å¤´éƒ¨å‹ç¼©ç¤ºä¾‹</span>
</span></span><span class="line"><span class="cl">        <span class="n">compressed_size</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="n">static_table</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;:method&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;GET&#34;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&#34;POST&#34;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;:path&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;/&#34;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;:scheme&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;https&#34;</span><span class="p">:</span> <span class="mi">7</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;content-type&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;application/json&#34;</span><span class="p">:</span> <span class="mi">31</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">headers</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">static_table</span> <span class="ow">and</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">static_table</span><span class="p">[</span><span class="n">name</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">                <span class="n">compressed_size</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># ç´¢å¼•å¼•ç”¨</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">compressed_size</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>  <span class="c1"># å­—é¢é‡</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">original_size</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">headers</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">        <span class="n">compression_ratio</span> <span class="o">=</span> <span class="n">compressed_size</span> <span class="o">/</span> <span class="n">original_size</span> <span class="k">if</span> <span class="n">original_size</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;original_size&#34;</span><span class="p">:</span> <span class="n">original_size</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;compressed_size&#34;</span><span class="p">:</span> <span class="n">compressed_size</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;compression_ratio&#34;</span><span class="p">:</span> <span class="n">compression_ratio</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># HTTP/3 ç‰¹æ€§</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">HTTP3Features</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;HTTP/3 ç‰¹æ€§æ¼”ç¤º&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">connections</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">connection_id</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">create_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">server_name</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;åˆ›å»ºQUICè¿æ¥&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">connection_id</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">connection</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;id&#34;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">connection_id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;server_name&#34;</span><span class="p">:</span> <span class="n">server_name</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;state&#34;</span><span class="p">:</span> <span class="s2">&#34;handshaking&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;streams&#34;</span><span class="p">:</span> <span class="p">{},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;rtt&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;congestion_window&#34;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;migration_capable&#34;</span><span class="p">:</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">connections</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">connection_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">connection</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">connection_id</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">zero_rtt_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">connection_id</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">early_data</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;0-RTTè¯·æ±‚&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">connection_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">connections</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">connections</span><span class="p">[</span><span class="n">connection_id</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># æ¨¡æ‹Ÿ0-RTTè¯·æ±‚</span>
</span></span><span class="line"><span class="cl">        <span class="n">request</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;method&#34;</span><span class="p">:</span> <span class="n">method</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;path&#34;</span><span class="p">:</span> <span class="n">path</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;early_data&#34;</span><span class="p">:</span> <span class="n">early_data</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;rtt&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>  <span class="c1"># 0-RTT</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;timestamp&#34;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">request</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">connection_migration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">connection_id</span><span class="p">,</span> <span class="n">new_address</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;è¿æ¥è¿ç§»&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">connection_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">connections</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">connections</span><span class="p">[</span><span class="n">connection_id</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">connection</span><span class="p">[</span><span class="s2">&#34;migration_capable&#34;</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">            <span class="n">connection</span><span class="p">[</span><span class="s2">&#34;address&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_address</span>
</span></span><span class="line"><span class="cl">            <span class="n">connection</span><span class="p">[</span><span class="s2">&#34;migrated&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">get_performance_comparison</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;æ€§èƒ½å¯¹æ¯”&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;HTTP/1.1&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;è¿æ¥å»ºç«‹&#34;</span><span class="p">:</span> <span class="s2">&#34;3-RTT (TCP + TLS)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;å¤šè·¯å¤ç”¨&#34;</span><span class="p">:</span> <span class="s2">&#34;æ— &#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;å¤´éƒ¨å‹ç¼©&#34;</span><span class="p">:</span> <span class="s2">&#34;æ— &#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;æœåŠ¡å™¨æ¨é€&#34;</span><span class="p">:</span> <span class="s2">&#34;æ— &#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;HTTP/2&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;è¿æ¥å»ºç«‹&#34;</span><span class="p">:</span> <span class="s2">&#34;3-RTT (TCP + TLS)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;å¤šè·¯å¤ç”¨&#34;</span><span class="p">:</span> <span class="s2">&#34;æœ‰ (å•è¿æ¥)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;å¤´éƒ¨å‹ç¼©&#34;</span><span class="p">:</span> <span class="s2">&#34;HPACK&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;æœåŠ¡å™¨æ¨é€&#34;</span><span class="p">:</span> <span class="s2">&#34;æœ‰&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;HTTP/3&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;è¿æ¥å»ºç«‹&#34;</span><span class="p">:</span> <span class="s2">&#34;1-RTT (QUIC)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;å¤šè·¯å¤ç”¨&#34;</span><span class="p">:</span> <span class="s2">&#34;æœ‰ (æ— é˜Ÿå¤´é˜»å¡)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;å¤´éƒ¨å‹ç¼©&#34;</span><span class="p">:</span> <span class="s2">&#34;QPACK&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;æœåŠ¡å™¨æ¨é€&#34;</span><span class="p">:</span> <span class="s2">&#34;æœ‰&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;è¿æ¥è¿ç§»&#34;</span><span class="p">:</span> <span class="s2">&#34;æœ‰&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;0-RTT&#34;</span><span class="p">:</span> <span class="s2">&#34;æœ‰&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="n">http2</span> <span class="o">=</span> <span class="n">HTTP2Features</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åˆ›å»ºå¤šä¸ªæµ</span>
</span></span><span class="line"><span class="cl"><span class="n">stream1</span> <span class="o">=</span> <span class="n">http2</span><span class="o">.</span><span class="n">create_stream</span><span class="p">(</span><span class="s2">&#34;GET&#34;</span><span class="p">,</span> <span class="s2">&#34;/api/users&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">stream2</span> <span class="o">=</span> <span class="n">http2</span><span class="o">.</span><span class="n">create_stream</span><span class="p">(</span><span class="s2">&#34;GET&#34;</span><span class="p">,</span> <span class="s2">&#34;/api/posts&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">stream3</span> <span class="o">=</span> <span class="n">http2</span><span class="o">.</span><span class="n">create_stream</span><span class="p">(</span><span class="s2">&#34;GET&#34;</span><span class="p">,</span> <span class="s2">&#34;/static/app.js&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è®¾ç½®ä¼˜å…ˆçº§</span>
</span></span><span class="line"><span class="cl"><span class="n">http2</span><span class="o">.</span><span class="n">set_priority</span><span class="p">(</span><span class="n">stream3</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>  <span class="c1"># é™æ€èµ„æºä¼˜å…ˆçº§è¾ƒä½</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æœåŠ¡å™¨æ¨é€</span>
</span></span><span class="line"><span class="cl"><span class="n">push_stream</span> <span class="o">=</span> <span class="n">http2</span><span class="o">.</span><span class="n">server_push</span><span class="p">(</span><span class="n">stream1</span><span class="p">,</span> <span class="s2">&#34;/static/style.css&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¤´éƒ¨å‹ç¼©</span>
</span></span><span class="line"><span class="cl"><span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;:method&#34;</span><span class="p">:</span> <span class="s2">&#34;GET&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;:path&#34;</span><span class="p">:</span> <span class="s2">&#34;/api/users&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;:scheme&#34;</span><span class="p">:</span> <span class="s2">&#34;https&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;content-type&#34;</span><span class="p">:</span> <span class="s2">&#34;application/json&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">compression_result</span> <span class="o">=</span> <span class="n">http2</span><span class="o">.</span><span class="n">compress_headers</span><span class="p">(</span><span class="n">headers</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;å¤´éƒ¨å‹ç¼©ç»“æœ:&#34;</span><span class="p">,</span> <span class="n">compression_result</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># HTTP/3ç¤ºä¾‹</span>
</span></span><span class="line"><span class="cl"><span class="n">http3</span> <span class="o">=</span> <span class="n">HTTP3Features</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">conn_id</span> <span class="o">=</span> <span class="n">http3</span><span class="o">.</span><span class="n">create_connection</span><span class="p">(</span><span class="s2">&#34;api.example.com&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 0-RTTè¯·æ±‚</span>
</span></span><span class="line"><span class="cl"><span class="n">zero_rtt_req</span> <span class="o">=</span> <span class="n">http3</span><span class="o">.</span><span class="n">zero_rtt_request</span><span class="p">(</span><span class="n">conn_id</span><span class="p">,</span> <span class="s2">&#34;GET&#34;</span><span class="p">,</span> <span class="s2">&#34;/api/users&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;0-RTTè¯·æ±‚:&#34;</span><span class="p">,</span> <span class="n">zero_rtt_req</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ€§èƒ½å¯¹æ¯”</span>
</span></span><span class="line"><span class="cl"><span class="n">comparison</span> <span class="o">=</span> <span class="n">http3</span><span class="o">.</span><span class="n">get_performance_comparison</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">version</span><span class="p">,</span> <span class="n">features</span> <span class="ow">in</span> <span class="n">comparison</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="se">\n</span><span class="si">{</span><span class="n">version</span><span class="si">}</span><span class="s2">:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">feature</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">features</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;  </span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="å®é™…åº”ç”¨å’Œæœ€ä½³å®è·µ">å®é™…åº”ç”¨å’Œæœ€ä½³å®è·µ</h2>
<h3 id="web-apiè®¾è®¡æœ€ä½³å®è·µ">Web APIè®¾è®¡æœ€ä½³å®è·µ</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">WebAPIBestPractices</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;Web APIè®¾è®¡æœ€ä½³å®è·µ&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">api_guidelines</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;URLè®¾è®¡&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ä½¿ç”¨åè¯è€ŒéåŠ¨è¯&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ä½¿ç”¨å¤æ•°å½¢å¼&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ä¿æŒURLç®€æ´&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ä½¿ç”¨è¿å­—ç¬¦åˆ†éš”å•è¯&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;HTTPæ–¹æ³•ä½¿ç”¨&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;GET: è·å–èµ„æº&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;POST: åˆ›å»ºèµ„æº&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;PUT: å®Œæ•´æ›´æ–°èµ„æº&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;PATCH: éƒ¨åˆ†æ›´æ–°èµ„æº&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;DELETE: åˆ é™¤èµ„æº&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;çŠ¶æ€ç ä½¿ç”¨&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;200: æˆåŠŸ&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;201: åˆ›å»ºæˆåŠŸ&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;204: æ— å†…å®¹&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;400: è¯·æ±‚é”™è¯¯&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;401: æœªæˆæƒ&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;403: ç¦æ­¢è®¿é—®&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;404: èµ„æºæœªæ‰¾åˆ°&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;500: æœåŠ¡å™¨é”™è¯¯&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;å“åº”æ ¼å¼&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ä½¿ç”¨JSONæ ¼å¼&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ä¿æŒå“åº”ç»“æ„ä¸€è‡´&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;åŒ…å«é€‚å½“çš„å…ƒæ•°æ®&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;æä¾›é”™è¯¯è¯¦æƒ…&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">design_api_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">meta</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;è®¾è®¡APIå“åº”æ ¼å¼&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">response</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">error</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">response</span><span class="p">[</span><span class="s2">&#34;success&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">            <span class="n">response</span><span class="p">[</span><span class="s2">&#34;error&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;code&#34;</span><span class="p">:</span> <span class="n">error</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;code&#34;</span><span class="p">,</span> <span class="s2">&#34;UNKNOWN_ERROR&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;message&#34;</span><span class="p">:</span> <span class="n">error</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;message&#34;</span><span class="p">,</span> <span class="s2">&#34;An error occurred&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;details&#34;</span><span class="p">:</span> <span class="n">error</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;details&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">response</span><span class="p">[</span><span class="s2">&#34;success&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">            <span class="n">response</span><span class="p">[</span><span class="s2">&#34;data&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">meta</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">response</span><span class="p">[</span><span class="s2">&#34;meta&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">meta</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">response</span><span class="p">[</span><span class="s2">&#34;timestamp&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">response</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">paginate_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">,</span> <span class="n">page</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">per_page</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;åˆ†é¡µå“åº”&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">start</span> <span class="o">=</span> <span class="p">(</span><span class="n">page</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">per_page</span>
</span></span><span class="line"><span class="cl">        <span class="n">end</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">per_page</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">paginated_items</span> <span class="o">=</span> <span class="n">items</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">total</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">total_pages</span> <span class="o">=</span> <span class="p">(</span><span class="n">total</span> <span class="o">+</span> <span class="n">per_page</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="n">per_page</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">design_api_response</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">data</span><span class="o">=</span><span class="n">paginated_items</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">meta</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;pagination&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;page&#34;</span><span class="p">:</span> <span class="n">page</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;per_page&#34;</span><span class="p">:</span> <span class="n">per_page</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;total&#34;</span><span class="p">:</span> <span class="n">total</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;total_pages&#34;</span><span class="p">:</span> <span class="n">total_pages</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;has_next&#34;</span><span class="p">:</span> <span class="n">page</span> <span class="o">&lt;</span> <span class="n">total_pages</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;has_prev&#34;</span><span class="p">:</span> <span class="n">page</span> <span class="o">&gt;</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">validate_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request_data</span><span class="p">,</span> <span class="n">required_fields</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;è¯·æ±‚éªŒè¯&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">required_fields</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">required_fields</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">request_data</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;ç¼ºå°‘å¿…éœ€å­—æ®µ: </span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">elif</span> <span class="ow">not</span> <span class="n">request_data</span><span class="p">[</span><span class="n">field</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;å­—æ®µä¸èƒ½ä¸ºç©º: </span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;is_valid&#34;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;errors&#34;</span><span class="p">:</span> <span class="n">errors</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ€§èƒ½ä¼˜åŒ–å»ºè®®</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">HTTPPerformanceOptimization</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;HTTPæ€§èƒ½ä¼˜åŒ–&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">optimization_techniques</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;ç¼“å­˜ç­–ç•¥&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;è®¾ç½®é€‚å½“çš„Cache-Controlå¤´&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ä½¿ç”¨ETagè¿›è¡Œæ¡ä»¶è¯·æ±‚&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;å®æ–½CDNç¼“å­˜&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ä½¿ç”¨æµè§ˆå™¨ç¼“å­˜&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;å‹ç¼©æŠ€æœ¯&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;å¯ç”¨Gzip/Brotliå‹ç¼©&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;å‹ç¼©é™æ€èµ„æº&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ä¼˜åŒ–å›¾ç‰‡æ ¼å¼&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ä½¿ç”¨WebPæ ¼å¼&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;è¿æ¥ä¼˜åŒ–&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ä½¿ç”¨HTTP/2æˆ–HTTP/3&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;å¯ç”¨Keep-Alive&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;å‡å°‘DNSæŸ¥è¯¢&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ä½¿ç”¨è¿æ¥æ± &#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;è¯·æ±‚ä¼˜åŒ–&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;å‡å°‘HTTPè¯·æ±‚æ•°é‡&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;åˆå¹¶CSSå’ŒJavaScriptæ–‡ä»¶&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ä½¿ç”¨é›ªç¢§å›¾&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;å»¶è¿ŸåŠ è½½éå…³é”®èµ„æº&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">analyze_performance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response_time</span><span class="p">,</span> <span class="n">response_size</span><span class="p">,</span> <span class="n">cache_hit_ratio</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;æ€§èƒ½åˆ†æ&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">analysis</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;response_time&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;value&#34;</span><span class="p">:</span> <span class="n">response_time</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;status&#34;</span><span class="p">:</span> <span class="s2">&#34;good&#34;</span> <span class="k">if</span> <span class="n">response_time</span> <span class="o">&lt;</span> <span class="mi">200</span> <span class="k">else</span> <span class="s2">&#34;needs_improvement&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;response_size&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;value&#34;</span><span class="p">:</span> <span class="n">response_size</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;status&#34;</span><span class="p">:</span> <span class="s2">&#34;good&#34;</span> <span class="k">if</span> <span class="n">response_size</span> <span class="o">&lt;</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span> <span class="k">else</span> <span class="s2">&#34;large&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;cache_efficiency&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;hit_ratio&#34;</span><span class="p">:</span> <span class="n">cache_hit_ratio</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;status&#34;</span><span class="p">:</span> <span class="s2">&#34;good&#34;</span> <span class="k">if</span> <span class="n">cache_hit_ratio</span> <span class="o">&gt;</span> <span class="mf">0.8</span> <span class="k">else</span> <span class="s2">&#34;needs_improvement&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">recommendations</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">response_time</span> <span class="o">&gt;</span> <span class="mi">200</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">recommendations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&#34;è€ƒè™‘ä½¿ç”¨CDNæˆ–ä¼˜åŒ–æœåŠ¡å™¨å“åº”æ—¶é—´&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">response_size</span> <span class="o">&gt;</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">recommendations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&#34;å¯ç”¨å‹ç¼©æˆ–ä¼˜åŒ–å“åº”å†…å®¹&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">cache_hit_ratio</span> <span class="o">&lt;</span> <span class="mf">0.8</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">recommendations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&#34;ä¼˜åŒ–ç¼“å­˜ç­–ç•¥&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">analysis</span><span class="p">[</span><span class="s2">&#34;recommendations&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">recommendations</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">analysis</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="n">api</span> <span class="o">=</span> <span class="n">WebAPIBestPractices</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è®¾è®¡æˆåŠŸå“åº”</span>
</span></span><span class="line"><span class="cl"><span class="n">success_response</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">design_api_response</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;id&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;å¼ ä¸‰&#34;</span><span class="p">,</span> <span class="s2">&#34;email&#34;</span><span class="p">:</span> <span class="s2">&#34;zhangsan@example.com&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;æˆåŠŸå“åº”:&#34;</span><span class="p">,</span> <span class="n">success_response</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è®¾è®¡é”™è¯¯å“åº”</span>
</span></span><span class="line"><span class="cl"><span class="n">error_response</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">design_api_response</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">error</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;code&#34;</span><span class="p">:</span> <span class="s2">&#34;VALIDATION_ERROR&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;message&#34;</span><span class="p">:</span> <span class="s2">&#34;è¯·æ±‚æ•°æ®éªŒè¯å¤±è´¥&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;details&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;é‚®ç®±æ ¼å¼ä¸æ­£ç¡®&#34;</span><span class="p">,</span> <span class="s2">&#34;å¯†ç é•¿åº¦ä¸è¶³&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;é”™è¯¯å“åº”:&#34;</span><span class="p">,</span> <span class="n">error_response</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åˆ†é¡µå“åº”</span>
</span></span><span class="line"><span class="cl"><span class="n">users</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&#34;id&#34;</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&#34;ç”¨æˆ·</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">}</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl"><span class="n">paginated</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">paginate_response</span><span class="p">(</span><span class="n">users</span><span class="p">,</span> <span class="n">page</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">per_page</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;åˆ†é¡µå“åº”:&#34;</span><span class="p">,</span> <span class="n">paginated</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ€§èƒ½åˆ†æ</span>
</span></span><span class="line"><span class="cl"><span class="n">perf</span> <span class="o">=</span> <span class="n">HTTPPerformanceOptimization</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">analysis</span> <span class="o">=</span> <span class="n">perf</span><span class="o">.</span><span class="n">analyze_performance</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">response_time</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span>  <span class="c1"># ms</span>
</span></span><span class="line"><span class="cl">    <span class="n">response_size</span><span class="o">=</span><span class="mi">512</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">,</span>  <span class="c1"># bytes</span>
</span></span><span class="line"><span class="cl">    <span class="n">cache_hit_ratio</span><span class="o">=</span><span class="mf">0.75</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;æ€§èƒ½åˆ†æ:&#34;</span><span class="p">,</span> <span class="n">analysis</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="å­¦ä¹ å»ºè®®å’Œæ€»ç»“">å­¦ä¹ å»ºè®®å’Œæ€»ç»“</h2>
<h3 id="httpå­¦ä¹ è·¯å¾„">HTTPå­¦ä¹ è·¯å¾„</h3>
<ol>
<li><strong>åŸºç¡€æ¦‚å¿µ</strong>ï¼šç†è§£HTTPçš„å·¥ä½œåŸç†å’Œç‰¹ç‚¹</li>
<li><strong>åè®®ç»†èŠ‚</strong>ï¼šæŒæ¡è¯·æ±‚å“åº”æ ¼å¼ã€çŠ¶æ€ç ã€å¤´å­—æ®µ</li>
<li><strong>ç¼“å­˜æœºåˆ¶</strong>ï¼šå­¦ä¹ HTTPç¼“å­˜ç­–ç•¥å’Œå®ç°</li>
<li><strong>å®‰å…¨æœºåˆ¶</strong>ï¼šäº†è§£HTTPSã€CORSã€å®‰å…¨å¤´ç­‰</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šæŒæ¡HTTPæ€§èƒ½ä¼˜åŒ–æŠ€å·§</li>
<li><strong>æ–°ç‰ˆæœ¬ç‰¹æ€§</strong>ï¼šå­¦ä¹ HTTP/2å’ŒHTTP/3çš„æ–°ç‰¹æ€§</li>
</ol>
<h3 id="å…³é”®è¦ç‚¹æ€»ç»“">å…³é”®è¦ç‚¹æ€»ç»“</h3>
<table>
  <thead>
      <tr>
          <th>æ–¹é¢</th>
          <th>è¦ç‚¹</th>
          <th>å®è·µå»ºè®®</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>è¯·æ±‚æ–¹æ³•</strong></td>
          <td>æ­£ç¡®ä½¿ç”¨GETã€POSTã€PUTã€DELETEç­‰</td>
          <td>éµå¾ªRESTfulè®¾è®¡åŸåˆ™</td>
      </tr>
      <tr>
          <td><strong>çŠ¶æ€ç </strong></td>
          <td>è¿”å›åˆé€‚çš„HTTPçŠ¶æ€ç </td>
          <td>æä¾›æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯</td>
      </tr>
      <tr>
          <td><strong>ç¼“å­˜</strong></td>
          <td>åˆç†è®¾ç½®ç¼“å­˜ç­–ç•¥</td>
          <td>å¹³è¡¡æ€§èƒ½å’Œæ•°æ®æ–°é²œåº¦</td>
      </tr>
      <tr>
          <td><strong>å®‰å…¨</strong></td>
          <td>å®æ–½é€‚å½“çš„å®‰å…¨æªæ–½</td>
          <td>ä½¿ç”¨HTTPSå’Œå®‰å…¨å¤´</td>
      </tr>
      <tr>
          <td><strong>æ€§èƒ½</strong></td>
          <td>ä¼˜åŒ–è¯·æ±‚å’Œå“åº”</td>
          <td>ä½¿ç”¨å‹ç¼©å’ŒCDN</td>
      </tr>
  </tbody>
</table>
<h3 id="å®é™…åº”ç”¨å»ºè®®">å®é™…åº”ç”¨å»ºè®®</h3>
<ul>
<li><strong>APIè®¾è®¡</strong>ï¼šéµå¾ªRESTfulåŸåˆ™ï¼Œä¿æŒæ¥å£ä¸€è‡´æ€§</li>
<li><strong>é”™è¯¯å¤„ç†</strong>ï¼šæä¾›è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯å’Œå¤„ç†å»ºè®®</li>
<li><strong>æ–‡æ¡£åŒ–</strong>ï¼šç»´æŠ¤å®Œæ•´çš„APIæ–‡æ¡£</li>
<li><strong>ç›‘æ§</strong>ï¼šå®æ–½æ€§èƒ½ç›‘æ§å’Œæ—¥å¿—è®°å½•</li>
<li><strong>ç‰ˆæœ¬æ§åˆ¶</strong>ï¼šåˆç†ç®¡ç†APIç‰ˆæœ¬</li>
</ul>
<p>HTTPåè®®æ˜¯Webå¼€å‘çš„åŸºç¡€ï¼Œæ·±å…¥ç†è§£å…¶å·¥ä½œåŸç†å’Œæœ€ä½³å®è·µå¯¹äºæ„å»ºé«˜è´¨é‡çš„Webåº”ç”¨è‡³å…³é‡è¦ã€‚éšç€HTTP/2å’ŒHTTP/3çš„æ™®åŠï¼ŒæŒæ¡æ–°ç‰¹æ€§å°†æœ‰åŠ©äºè¿›ä¸€æ­¥æå‡åº”ç”¨æ€§èƒ½ã€‚</p>
]]></content:encoded>
    </item>
    <item>
      <title>ç»å…¸æ’åºç®—æ³•å®ç°ä¸åˆ†æ</title>
      <link>https://tyhzxh.github.io/posts/sorting-algorithms-implementation/</link>
      <pubDate>Tue, 27 Feb 2024 22:11:13 +0800</pubDate>
      <guid>https://tyhzxh.github.io/posts/sorting-algorithms-implementation/</guid>
      <description>è¯¦ç»†ä»‹ç»å’Œå®ç°ç»å…¸æ’åºç®—æ³•ï¼ŒåŒ…æ‹¬é€‰æ‹©æ’åºã€æ’å…¥æ’åºã€å†’æ³¡æ’åºã€å¿«é€Ÿæ’åºã€å½’å¹¶æ’åºå’Œå †æ’åºï¼Œå¹¶æä¾›æ€§èƒ½æµ‹è¯•ä»£ç </description>
      <content:encoded><![CDATA[<h2 id="å‰è¨€">å‰è¨€</h2>
<p>è¿™æ˜¯æŸæ¬¡å­¦æ ¡æ•°æ®ç»“æ„å®éªŒä¸­å®ç°çš„åŸºæœ¬æ’åºç®—æ³•ã€‚æ•°æ®ç»“æ„è¿™é—¨è¯¾çš„éš¾ç‚¹åœ¨äºå®ç°çš„å¤æ‚æ€§ï¼Œæ¯æ¬¡å®éªŒéƒ½éœ€è¦å°è£…æ•°æ®ç»“æ„ï¼Œç¼–å†™æµ‹è¯•ç¨‹åºï¼Œå¯¹äºåˆå­¦è€…æ¥è¯´ç¡®å®æ˜¯ä¸€ä¸ªæŒ‘æˆ˜ã€‚</p>
<p>é€šè¿‡è¿™æ¬¡å®éªŒï¼Œæˆ‘æ·±åˆ»ä½“ä¼šåˆ°äº†ä»£ç è´¨é‡çš„é‡è¦æ€§ã€‚è™½ç„¶å½“æ—¶çš„ä»£ç å¯èƒ½ä¸å¤Ÿä¼˜é›…ï¼Œä½†è¿™æ­£æ˜¯å­¦ä¹ è¿‡ç¨‹ä¸­çš„å®è´µç»å†ã€‚</p>
<h2 id="åŸºæœ¬æ•°æ®ç»“æ„å°è£…">åŸºæœ¬æ•°æ®ç»“æ„å°è£…</h2>
<p>é¦–å…ˆå®šä¹‰åŸºæœ¬çš„æ•°æ®ç»“æ„å’Œå·¥å…·å‡½æ•°ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;stdio.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;ctime&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;cstdlib&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cp">#define ERROR 0
</span></span></span><span class="line"><span class="cl"><span class="cp">#define OK 1
</span></span></span><span class="line"><span class="cl"><span class="cp">#define Overflow 2
</span></span></span><span class="line"><span class="cl"><span class="cp">#define Underflow 3
</span></span></span><span class="line"><span class="cl"><span class="cp">#define NotPresent 4    </span><span class="c1">// å…ƒç´ ä¸å­˜åœ¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cp">#define Duplicate 5     </span><span class="c1">// å…ƒç´ é‡å¤å­˜åœ¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cp">#define MaxSize 100001
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">typedef</span> <span class="kt">int</span> <span class="n">KeyType</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">typedef</span> <span class="kt">int</span> <span class="n">Status</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">typedef</span> <span class="kt">int</span> <span class="n">DataType</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">typedef</span> <span class="k">struct</span> <span class="nc">Entry</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">KeyType</span> <span class="n">key</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">DataType</span> <span class="n">data</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="n">entry</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">typedef</span> <span class="k">struct</span> <span class="nc">list</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Entry</span> <span class="n">D</span><span class="p">[</span><span class="n">MaxSize</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="n">List</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// è¾“å‡ºå‡½æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">Status</span> <span class="nf">printlist</span><span class="p">(</span><span class="n">list</span><span class="o">*</span> <span class="n">l</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">l</span><span class="o">-&gt;</span><span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d &#34;</span><span class="p">,</span> <span class="n">l</span><span class="o">-&gt;</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">key</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">OK</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// äº¤æ¢å‡½æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">swap</span><span class="p">(</span><span class="n">Entry</span><span class="o">*</span> <span class="n">a</span><span class="p">,</span> <span class="n">Entry</span><span class="o">*</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Entry</span> <span class="n">temp</span> <span class="o">=</span> <span class="o">*</span><span class="n">a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">*</span><span class="n">a</span> <span class="o">=</span> <span class="o">*</span><span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">*</span><span class="n">b</span> <span class="o">=</span> <span class="n">temp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h2 id="æ’åºç®—æ³•å®ç°">æ’åºç®—æ³•å®ç°</h2>
<h3 id="1-ç®€å•é€‰æ‹©æ’åº">1. ç®€å•é€‰æ‹©æ’åº</h3>
<p>é€‰æ‹©æ’åºçš„åŸºæœ¬æ€æƒ³æ˜¯æ¯æ¬¡ä»æœªæ’åºçš„å…ƒç´ ä¸­é€‰æ‹©æœ€å°çš„å…ƒç´ ï¼Œæ”¾åˆ°å·²æ’åºåºåˆ—çš„æœ«å°¾ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">Status</span> <span class="nf">choosesort</span><span class="p">(</span><span class="n">list</span><span class="o">*</span> <span class="n">l</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">l</span><span class="o">-&gt;</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">min</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">l</span><span class="o">-&gt;</span><span class="n">n</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">-&gt;</span><span class="n">D</span><span class="p">[</span><span class="n">min</span><span class="p">].</span><span class="n">key</span> <span class="o">&gt;</span> <span class="n">l</span><span class="o">-&gt;</span><span class="n">D</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">min</span> <span class="o">=</span> <span class="n">j</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">swap</span><span class="p">(</span><span class="o">&amp;</span><span class="n">l</span><span class="o">-&gt;</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">l</span><span class="o">-&gt;</span><span class="n">D</span><span class="p">[</span><span class="n">min</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">OK</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼šO(nÂ²)<br>
<strong>ç©ºé—´å¤æ‚åº¦</strong>ï¼šO(1)<br>
<strong>ç¨³å®šæ€§</strong>ï¼šä¸ç¨³å®š</p>
<h3 id="2-ç›´æ¥æ’å…¥æ’åº">2. ç›´æ¥æ’å…¥æ’åº</h3>
<p>æ’å…¥æ’åºçš„åŸºæœ¬æ€æƒ³æ˜¯å°†ä¸€ä¸ªè®°å½•æ’å…¥åˆ°å·²ç»æ’å¥½åºçš„æœ‰åºè¡¨ä¸­ï¼Œä»è€Œå¾—åˆ°ä¸€ä¸ªæ–°çš„ã€è®°å½•æ•°å¢1çš„æœ‰åºè¡¨ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">Status</span> <span class="nf">insertsort</span><span class="p">(</span><span class="n">list</span><span class="o">*</span> <span class="n">l</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">l</span><span class="o">-&gt;</span><span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">Entry</span> <span class="n">temp</span> <span class="o">=</span> <span class="n">l</span><span class="o">-&gt;</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="n">j</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span><span class="p">(</span><span class="n">j</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">-&gt;</span><span class="n">D</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">key</span> <span class="o">&gt;</span> <span class="n">temp</span><span class="p">.</span><span class="n">key</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">l</span><span class="o">-&gt;</span><span class="n">D</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span><span class="o">-&gt;</span><span class="n">D</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">                <span class="n">l</span><span class="o">-&gt;</span><span class="n">D</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="n">j</span><span class="o">--</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">OK</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼šO(nÂ²)<br>
<strong>ç©ºé—´å¤æ‚åº¦</strong>ï¼šO(1)<br>
<strong>ç¨³å®šæ€§</strong>ï¼šç¨³å®š</p>
<h3 id="3-å†’æ³¡æ’åº">3. å†’æ³¡æ’åº</h3>
<p>å†’æ³¡æ’åºæ˜¯ä¸€ç§ç®€å•çš„æ’åºç®—æ³•ï¼Œå®ƒé‡å¤åœ°èµ°è®¿è¿‡è¦æ’åºçš„æ•°åˆ—ï¼Œä¸€æ¬¡æ¯”è¾ƒä¸¤ä¸ªå…ƒç´ ï¼Œå¦‚æœå®ƒä»¬çš„é¡ºåºé”™è¯¯å°±æŠŠå®ƒä»¬äº¤æ¢è¿‡æ¥ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">Bubblesort</span><span class="p">(</span><span class="n">list</span><span class="o">*</span> <span class="n">l</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">l</span><span class="o">-&gt;</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="p">(</span><span class="n">end</span> <span class="o">&lt;</span> <span class="n">l</span><span class="o">-&gt;</span><span class="n">n</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">l</span><span class="o">-&gt;</span><span class="n">D</span><span class="p">[</span><span class="n">start</span><span class="p">].</span><span class="n">key</span> <span class="o">&gt;</span> <span class="n">l</span><span class="o">-&gt;</span><span class="n">D</span><span class="p">[</span><span class="n">end</span><span class="p">].</span><span class="n">key</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">Entry</span> <span class="n">temp</span> <span class="o">=</span> <span class="n">l</span><span class="o">-&gt;</span><span class="n">D</span><span class="p">[</span><span class="n">start</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">                <span class="n">l</span><span class="o">-&gt;</span><span class="n">D</span><span class="p">[</span><span class="n">start</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span><span class="o">-&gt;</span><span class="n">D</span><span class="p">[</span><span class="n">end</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">                <span class="n">l</span><span class="o">-&gt;</span><span class="n">D</span><span class="p">[</span><span class="n">end</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">++</span><span class="n">start</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="o">++</span><span class="n">end</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼šO(nÂ²)<br>
<strong>ç©ºé—´å¤æ‚åº¦</strong>ï¼šO(1)<br>
<strong>ç¨³å®šæ€§</strong>ï¼šç¨³å®š</p>
<h3 id="4-å¿«é€Ÿæ’åº">4. å¿«é€Ÿæ’åº</h3>
<p>å¿«é€Ÿæ’åºä½¿ç”¨åˆ†æ²»æ³•ç­–ç•¥æ¥æŠŠä¸€ä¸ªåºåˆ—åˆ†ä¸ºè¾ƒå°å’Œè¾ƒå¤§çš„2ä¸ªå­åºåˆ—ï¼Œç„¶åé€’å½’åœ°æ’åºä¸¤ä¸ªå­åºåˆ—ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">QuickSort</span><span class="p">(</span><span class="n">List</span><span class="o">*</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">low</span><span class="p">,</span> <span class="kt">int</span> <span class="n">high</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">low</span> <span class="o">&lt;</span> <span class="n">high</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">low</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">high</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">Entry</span> <span class="n">pivot</span> <span class="o">=</span> <span class="n">l</span><span class="o">-&gt;</span><span class="n">D</span><span class="p">[</span><span class="n">low</span><span class="p">];</span> <span class="c1">// é€‰æ‹©ç¬¬ä¸€ä¸ªå…ƒç´ ä½œä¸ºåŸºå‡†
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">j</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// ä»å³å‘å·¦æ‰¾å°äºåŸºå‡†çš„å…ƒç´ 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">while</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">j</span> <span class="o">&amp;&amp;</span> <span class="n">l</span><span class="o">-&gt;</span><span class="n">D</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">key</span> <span class="o">&gt;</span> <span class="n">pivot</span><span class="p">.</span><span class="n">key</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">j</span><span class="o">--</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">l</span><span class="o">-&gt;</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span><span class="o">-&gt;</span><span class="n">D</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">            <span class="c1">// ä»å·¦å‘å³æ‰¾å¤§äºåŸºå‡†çš„å…ƒç´ 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">while</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">j</span> <span class="o">&amp;&amp;</span> <span class="n">l</span><span class="o">-&gt;</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">key</span> <span class="o">&lt;</span> <span class="n">pivot</span><span class="p">.</span><span class="n">key</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">i</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">l</span><span class="o">-&gt;</span><span class="n">D</span><span class="p">[</span><span class="n">j</span><span class="o">--</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span><span class="o">-&gt;</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">l</span><span class="o">-&gt;</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pivot</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">QuickSort</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">low</span><span class="p">,</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>   <span class="c1">// é€’å½’æ’åºå·¦åŠéƒ¨åˆ†
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">QuickSort</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">high</span><span class="p">);</span> <span class="c1">// é€’å½’æ’åºå³åŠéƒ¨åˆ†
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼šå¹³å‡O(n log n)ï¼Œæœ€åO(nÂ²)<br>
<strong>ç©ºé—´å¤æ‚åº¦</strong>ï¼šO(log n)<br>
<strong>ç¨³å®šæ€§</strong>ï¼šä¸ç¨³å®š</p>
<blockquote>
<p>å¿«é€Ÿæ’åºç¡®å®å¾ˆç²¾å¦™ï¼Œç†è§£å’Œè®°å¿†éƒ½éœ€è¦æ—¶é—´ã€‚å®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯åˆ†æ²»æ³•ï¼Œé€šè¿‡é€‰æ‹©ä¸€ä¸ªåŸºå‡†å…ƒç´ ï¼Œå°†æ•°ç»„åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œç„¶åé€’å½’åœ°å¯¹ä¸¤éƒ¨åˆ†è¿›è¡Œæ’åºã€‚</p></blockquote>
<h3 id="5-å½’å¹¶æ’åº">5. å½’å¹¶æ’åº</h3>
<p>å½’å¹¶æ’åºé‡‡ç”¨åˆ†æ²»æ³•çš„ä¸€ä¸ªéå¸¸å…¸å‹çš„åº”ç”¨ã€‚å°†å·²æœ‰åºçš„å­åºåˆ—åˆå¹¶ï¼Œå¾—åˆ°å®Œå…¨æœ‰åºçš„åºåˆ—ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">merge</span><span class="p">(</span><span class="n">list</span><span class="o">*</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">left</span><span class="p">,</span> <span class="kt">int</span> <span class="n">lmid</span><span class="p">,</span> <span class="kt">int</span> <span class="n">rmid</span><span class="p">,</span> <span class="kt">int</span> <span class="n">right</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">left</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">rmid</span><span class="p">;</span> <span class="c1">// i,jæŒ‡å‘leftå’Œright
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">list</span> <span class="n">temp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// åˆå¹¶ä¸¤ä¸ªæœ‰åºåºåˆ—
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">while</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;=</span> <span class="n">lmid</span> <span class="o">&amp;&amp;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">right</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">-&gt;</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">key</span> <span class="o">&lt;=</span> <span class="n">l</span><span class="o">-&gt;</span><span class="n">D</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">key</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">temp</span><span class="p">.</span><span class="n">D</span><span class="p">[</span><span class="n">index</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span><span class="o">-&gt;</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="o">++</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">temp</span><span class="p">.</span><span class="n">D</span><span class="p">[</span><span class="n">index</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span><span class="o">-&gt;</span><span class="n">D</span><span class="p">[</span><span class="n">j</span><span class="o">++</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// å¤åˆ¶å‰©ä½™å…ƒç´ 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">while</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;=</span> <span class="n">lmid</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">temp</span><span class="p">.</span><span class="n">D</span><span class="p">[</span><span class="n">index</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span><span class="o">-&gt;</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="o">++</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">j</span> <span class="o">&lt;=</span> <span class="n">right</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">temp</span><span class="p">.</span><span class="n">D</span><span class="p">[</span><span class="n">index</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span><span class="o">-&gt;</span><span class="n">D</span><span class="p">[</span><span class="n">j</span><span class="o">++</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// å°†ä¸´æ—¶æ•°ç»„çš„å†…å®¹å¤åˆ¶å›åŸæ•°ç»„
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="n">left</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">right</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">l</span><span class="o">-&gt;</span><span class="n">D</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">.</span><span class="n">D</span><span class="p">[</span><span class="n">n</span><span class="o">++</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Status</span> <span class="nf">mergesort</span><span class="p">(</span><span class="n">list</span><span class="o">*</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">left</span><span class="p">,</span> <span class="kt">int</span> <span class="n">right</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="n">left</span> <span class="o">&lt;</span> <span class="n">right</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="n">left</span> <span class="o">+</span> <span class="p">(</span><span class="n">right</span> <span class="o">-</span> <span class="n">left</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">mergesort</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">mid</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">mergesort</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">right</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">merge</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">right</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">OK</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼šO(n log n)<br>
<strong>ç©ºé—´å¤æ‚åº¦</strong>ï¼šO(n)<br>
<strong>ç¨³å®šæ€§</strong>ï¼šç¨³å®š</p>
<h3 id="6-å †æ’åº">6. å †æ’åº</h3>
<p>å †æ’åºæ˜¯æŒ‡åˆ©ç”¨å †è¿™ç§æ•°æ®ç»“æ„æ‰€è®¾è®¡çš„ä¸€ç§æ’åºç®—æ³•ã€‚å †æ˜¯ä¸€ä¸ªè¿‘ä¼¼å®Œå…¨äºŒå‰æ ‘çš„ç»“æ„ï¼Œå¹¶åŒæ—¶æ»¡è¶³å †ç§¯çš„æ€§è´¨ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">downadjust</span><span class="p">(</span><span class="n">list</span><span class="o">*</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">start</span><span class="p">,</span> <span class="kt">int</span> <span class="n">end</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Entry</span> <span class="n">temp</span> <span class="o">=</span> <span class="n">l</span><span class="o">-&gt;</span><span class="n">D</span><span class="p">[</span><span class="n">start</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">start</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">end</span><span class="p">;</span> <span class="n">i</span> <span class="o">*=</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// å¦‚æœå·¦å­ç»“ç‚¹å°äºå³å­ç»“ç‚¹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">end</span> <span class="o">&amp;&amp;</span> <span class="n">l</span><span class="o">-&gt;</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">key</span> <span class="o">&gt;</span> <span class="n">l</span><span class="o">-&gt;</span><span class="n">D</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">].</span><span class="n">key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">i</span><span class="o">++</span><span class="p">;</span> <span class="c1">// iæŒ‡å‘å³å­ç»“ç‚¹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            
</span></span><span class="line"><span class="cl">        <span class="c1">// å¦‚æœçˆ¶ç»“ç‚¹å¤§äºå­ç»“ç‚¹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">if</span><span class="p">(</span><span class="n">temp</span><span class="p">.</span><span class="n">key</span> <span class="o">&gt;=</span> <span class="n">l</span><span class="o">-&gt;</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span><span class="p">;</span> <span class="c1">// è°ƒæ•´ç»“æŸ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            
</span></span><span class="line"><span class="cl">        <span class="n">l</span><span class="o">-&gt;</span><span class="n">D</span><span class="p">[</span><span class="n">start</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span><span class="o">-&gt;</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="c1">// å¦åˆ™å°†å­ç»“ç‚¹å€¼èµ‹ç»™çˆ¶ç»“ç‚¹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">start</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// é‡æ–°èµ‹å€¼å¼€å§‹æŒ‡é’ˆ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">l</span><span class="o">-&gt;</span><span class="n">D</span><span class="p">[</span><span class="n">start</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">;</span> <span class="c1">// è°ƒæ•´ç»“æŸåï¼Œå°†tempå€¼æ”¾åœ¨æœ€ç»ˆä½ç½®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Status</span> <span class="nf">heapsort</span><span class="p">(</span><span class="n">list</span><span class="o">*</span> <span class="n">l</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// å»ºå †
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">l</span><span class="o">-&gt;</span><span class="n">n</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">downadjust</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">l</span><span class="o">-&gt;</span><span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">OK</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼šO(n log n)<br>
<strong>ç©ºé—´å¤æ‚åº¦</strong>ï¼šO(1)<br>
<strong>ç¨³å®šæ€§</strong>ï¼šä¸ç¨³å®š</p>
<h2 id="æµ‹è¯•æ¡†æ¶">æµ‹è¯•æ¡†æ¶</h2>
<h3 id="æ•°æ®åˆå§‹åŒ–">æ•°æ®åˆå§‹åŒ–</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">list</span><span class="o">*</span> <span class="nf">initlist</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">list</span><span class="o">*</span> <span class="n">l</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">l</span> <span class="o">=</span> <span class="p">(</span><span class="n">list</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">list</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="n">l</span><span class="o">-&gt;</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="n">MaxSize</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">nullptr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">    <span class="n">srand</span><span class="p">(</span><span class="n">time</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span> <span class="c1">// ç”Ÿæˆéšæœºç§å­
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">l</span><span class="o">-&gt;</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">rand</span><span class="p">()</span> <span class="o">%</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// éšæœºæ•°èµ‹å€¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">l</span><span class="o">-&gt;</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">rand</span><span class="p">()</span> <span class="o">%</span> <span class="mi">50</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">l</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">deletelist</span><span class="p">(</span><span class="n">list</span><span class="o">*</span> <span class="n">l</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">l</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">free</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="æ€§èƒ½æµ‹è¯•å‡½æ•°">æ€§èƒ½æµ‹è¯•å‡½æ•°</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">Status</span> <span class="nf">testchoosesort</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">list</span><span class="o">*</span> <span class="n">l0</span> <span class="o">=</span> <span class="n">initlist</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\n\n</span><span class="s">make a new list!</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">printlist</span><span class="p">(</span><span class="n">l0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">clock_t</span> <span class="n">start</span><span class="p">,</span> <span class="n">finish</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">start</span> <span class="o">=</span> <span class="n">clock</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">choosesort</span><span class="p">(</span><span class="n">l0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">finish</span> <span class="o">=</span> <span class="n">clock</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\n</span><span class="s">after choosesort</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">printlist</span><span class="p">(</span><span class="n">l0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="kt">double</span> <span class="n">TheTimes</span> <span class="o">=</span> <span class="p">(</span><span class="kt">double</span><span class="p">)(</span><span class="n">finish</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span> <span class="o">/</span> <span class="n">CLOCKS_PER_SEC</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;æ¶ˆè€—%fç§’ã€‚</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">TheTimes</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">deletelist</span><span class="p">(</span><span class="n">l0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">OK</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Status</span> <span class="nf">testquicksort</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">list</span><span class="o">*</span> <span class="n">l0</span> <span class="o">=</span> <span class="n">initlist</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\n\n</span><span class="s">make a new list!</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">printlist</span><span class="p">(</span><span class="n">l0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">clock_t</span> <span class="n">start</span><span class="p">,</span> <span class="n">finish</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">start</span> <span class="o">=</span> <span class="n">clock</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">QuickSort</span><span class="p">(</span><span class="n">l0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">l0</span><span class="o">-&gt;</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">finish</span> <span class="o">=</span> <span class="n">clock</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\n</span><span class="s">after quicksort</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">printlist</span><span class="p">(</span><span class="n">l0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="kt">double</span> <span class="n">TheTimes</span> <span class="o">=</span> <span class="p">(</span><span class="kt">double</span><span class="p">)(</span><span class="n">finish</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span> <span class="o">/</span> <span class="n">CLOCKS_PER_SEC</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;æ¶ˆè€—%fç§’ã€‚</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">TheTimes</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">deletelist</span><span class="p">(</span><span class="n">l0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">OK</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// ä¸»æµ‹è¯•å‡½æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;æµ‹è¯•ä¸åŒè§„æ¨¡æ•°æ®çš„æ’åºæ€§èƒ½ï¼š</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">testinsertsort</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">testchoosesort</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">testBubblesort</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">testquicksort</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">testmergesort</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h2 id="ç®—æ³•æ€§èƒ½æ¯”è¾ƒ">ç®—æ³•æ€§èƒ½æ¯”è¾ƒ</h2>
<table>
  <thead>
      <tr>
          <th>æ’åºç®—æ³•</th>
          <th>å¹³å‡æ—¶é—´å¤æ‚åº¦</th>
          <th>æœ€åæ—¶é—´å¤æ‚åº¦</th>
          <th>æœ€å¥½æ—¶é—´å¤æ‚åº¦</th>
          <th>ç©ºé—´å¤æ‚åº¦</th>
          <th>ç¨³å®šæ€§</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>é€‰æ‹©æ’åº</td>
          <td>O(nÂ²)</td>
          <td>O(nÂ²)</td>
          <td>O(nÂ²)</td>
          <td>O(1)</td>
          <td>ä¸ç¨³å®š</td>
      </tr>
      <tr>
          <td>æ’å…¥æ’åº</td>
          <td>O(nÂ²)</td>
          <td>O(nÂ²)</td>
          <td>O(n)</td>
          <td>O(1)</td>
          <td>ç¨³å®š</td>
      </tr>
      <tr>
          <td>å†’æ³¡æ’åº</td>
          <td>O(nÂ²)</td>
          <td>O(nÂ²)</td>
          <td>O(n)</td>
          <td>O(1)</td>
          <td>ç¨³å®š</td>
      </tr>
      <tr>
          <td>å¿«é€Ÿæ’åº</td>
          <td>O(n log n)</td>
          <td>O(nÂ²)</td>
          <td>O(n log n)</td>
          <td>O(log n)</td>
          <td>ä¸ç¨³å®š</td>
      </tr>
      <tr>
          <td>å½’å¹¶æ’åº</td>
          <td>O(n log n)</td>
          <td>O(n log n)</td>
          <td>O(n log n)</td>
          <td>O(n)</td>
          <td>ç¨³å®š</td>
      </tr>
      <tr>
          <td>å †æ’åº</td>
          <td>O(n log n)</td>
          <td>O(n log n)</td>
          <td>O(n log n)</td>
          <td>O(1)</td>
          <td>ä¸ç¨³å®š</td>
      </tr>
  </tbody>
</table>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>é€šè¿‡è¿™æ¬¡æ’åºç®—æ³•çš„å®ç°å’Œæµ‹è¯•ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼š</p>
<ol>
<li>
<p><strong>ç®€å•æ’åºç®—æ³•</strong>ï¼ˆé€‰æ‹©ã€æ’å…¥ã€å†’æ³¡ï¼‰å®ç°ç®€å•ï¼Œä½†æ—¶é—´å¤æ‚åº¦è¾ƒé«˜ï¼Œé€‚åˆå°è§„æ¨¡æ•°æ®ã€‚</p>
</li>
<li>
<p><strong>é«˜æ•ˆæ’åºç®—æ³•</strong>ï¼ˆå¿«é€Ÿã€å½’å¹¶ã€å †ï¼‰æ—¶é—´å¤æ‚åº¦è¾ƒä½ï¼Œé€‚åˆå¤§è§„æ¨¡æ•°æ®å¤„ç†ã€‚</p>
</li>
<li>
<p><strong>ç¨³å®šæ€§</strong>åœ¨æŸäº›åº”ç”¨åœºæ™¯ä¸­å¾ˆé‡è¦ï¼Œéœ€è¦æ ¹æ®å…·ä½“éœ€æ±‚é€‰æ‹©åˆé€‚çš„ç®—æ³•ã€‚</p>
</li>
<li>
<p><strong>ç©ºé—´å¤æ‚åº¦</strong>ä¹Ÿæ˜¯é€‰æ‹©ç®—æ³•æ—¶éœ€è¦è€ƒè™‘çš„é‡è¦å› ç´ ã€‚</p>
</li>
</ol>
<p>å­¦ä¹ æ’åºç®—æ³•ä¸ä»…ä»…æ˜¯ä¸ºäº†åº”ä»˜è€ƒè¯•ï¼Œæ›´é‡è¦çš„æ˜¯ç†è§£ç®—æ³•è®¾è®¡çš„æ€æƒ³å’Œä¼˜åŒ–ç­–ç•¥ã€‚æ¯ç§ç®—æ³•éƒ½æœ‰å…¶é€‚ç”¨çš„åœºæ™¯ï¼Œåœ¨å®é™…å¼€å‘ä¸­éœ€è¦æ ¹æ®å…·ä½“æƒ…å†µé€‰æ‹©æœ€åˆé€‚çš„ç®—æ³•ã€‚</p>
<blockquote>
<p>ä»£ç è´¨é‡çš„æå‡ç¡®å®éœ€è¦å¤§é‡çš„ç»ƒä¹ å’Œæ€è€ƒã€‚è™½ç„¶å½“æ—¶çš„ä»£ç å¯èƒ½ä¸å¤Ÿå®Œç¾ï¼Œä½†è¿™æ­£æ˜¯æˆé•¿è¿‡ç¨‹ä¸­çš„é‡è¦ä¸€æ­¥ã€‚</p></blockquote>
]]></content:encoded>
    </item>
    <item>
      <title>åŠ¨æ€è§„åˆ’å®Œå…¨æ”»ç•¥ï¼šä»å…¥é—¨åˆ°ç²¾é€š</title>
      <link>https://tyhzxh.github.io/posts/dynamic-programming-guide/</link>
      <pubDate>Tue, 27 Feb 2024 22:05:43 +0800</pubDate>
      <guid>https://tyhzxh.github.io/posts/dynamic-programming-guide/</guid>
      <description>åŠ¨æ€è§„åˆ’ç³»ç»Ÿè®­ç»ƒæ–¹æ¡ˆï¼Œä»æ ¸å¿ƒæ€ç»´åˆ°é«˜é¢‘é¢˜å‹å†åˆ°å®æˆ˜æŠ€å·§çš„å…¨é¢è¦†ç›–ï¼ŒåŒ…å«å®Œæ•´çš„å­¦ä¹ è·¯çº¿å’Œé¿å‘æŒ‡å—</description>
      <content:encoded><![CDATA[<blockquote>
<p>ä»Šå¤©å¼€å§‹ï¼DPï¼é’ˆå¯¹åŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰çš„ç³»ç»Ÿè®­ç»ƒï¼Œè¿™æ˜¯ä¸€å¥—å®Œæ•´çš„è®­ç»ƒæ–¹æ¡ˆï¼Œä»<strong>æ ¸å¿ƒæ€ç»´</strong>åˆ°<strong>é«˜é¢‘é¢˜å‹</strong>å†åˆ°<strong>å®æˆ˜æŠ€å·§</strong>å…¨é¢è¦†ç›–ã€‚</p></blockquote>
<h2 id="ä¸€åŠ¨æ€è§„åˆ’æ ¸å¿ƒæ€ç»´è®­ç»ƒ">ä¸€ã€åŠ¨æ€è§„åˆ’æ ¸å¿ƒæ€ç»´è®­ç»ƒ</h2>
<h3 id="1-ç ´é™¤ä¸¤å¤§è¯¯åŒº">1. ç ´é™¤ä¸¤å¤§è¯¯åŒº</h3>
<ul>
<li>
<p>âŒ <strong>è¯¯åŒº1</strong>ï¼šå¿…é¡»æ‰¾åˆ°æœ€ä¼˜å­ç»“æ„æ‰èƒ½ç”¨DP<br>
âœ… <strong>æ­£ç¡®å§¿åŠ¿</strong>ï¼šå…ˆæš´åŠ›é€’å½’ â†’ å‘ç°é‡å å­é—®é¢˜ â†’ æ”¹è®°å¿†åŒ–æœç´¢ â†’ å†æ¨å¯¼DPæ–¹ç¨‹</p>
</li>
<li>
<p>âŒ <strong>è¯¯åŒº2</strong>ï¼šDPå¿…é¡»ç”¨æ•°ç»„å­˜å‚¨çŠ¶æ€<br>
âœ… <strong>æ­£ç¡®å§¿åŠ¿</strong>ï¼šå­¦ä¼šçŠ¶æ€å‹ç¼©ï¼ˆå¦‚æ‰“å®¶åŠ«èˆç”¨ä¸¤ä¸ªå˜é‡ä»£æ›¿æ•°ç»„ï¼‰</p>
</li>
</ul>
<h3 id="2-å››æ­¥è§£é¢˜æ³•ç”¨çˆ¬æ¥¼æ¢¯é—®é¢˜å®è·µ">2. å››æ­¥è§£é¢˜æ³•ï¼ˆç”¨çˆ¬æ¥¼æ¢¯é—®é¢˜å®è·µï¼‰</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># åŸé¢˜ï¼šæ¯æ¬¡çˆ¬1æˆ–2é˜¶ï¼Œåˆ°né˜¶æœ‰å¤šå°‘ç§æ–¹æ³•ï¼Ÿ</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 1. å®šä¹‰çŠ¶æ€ï¼šdp[i]è¡¨ç¤ºåˆ°ié˜¶çš„æ–¹æ³•æ•°</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 2. åˆå§‹çŠ¶æ€ï¼šdp[0]=1, dp[1]=1ï¼ˆæ³¨æ„ä¸æ˜¯å¸¸è§„çš„dp[0]=0ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 3. çŠ¶æ€è½¬ç§»ï¼šdp[i] = dp[i-1] + dp[i-2]</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 4. ä¼˜åŒ–ç©ºé—´ï¼šåªéœ€prevå’Œcurrä¸¤ä¸ªå˜é‡æ»šåŠ¨è®¡ç®—</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">climbStairs</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span> <span class="k">return</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">prev</span><span class="p">,</span> <span class="n">curr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">prev</span><span class="p">,</span> <span class="n">curr</span> <span class="o">=</span> <span class="n">curr</span><span class="p">,</span> <span class="n">prev</span> <span class="o">+</span> <span class="n">curr</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">curr</span>
</span></span></code></pre></div><h3 id="3-é«˜é¢‘çŠ¶æ€è½¬ç§»ç±»å‹">3. é«˜é¢‘çŠ¶æ€è½¬ç§»ç±»å‹</h3>
<table>
  <thead>
      <tr>
          <th>ç±»å‹</th>
          <th>ç»å…¸ä¾‹é¢˜</th>
          <th>çŠ¶æ€è½¬ç§»å…³é”®ç‚¹</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>å•åºåˆ—çº¿æ€§DP</td>
          <td>æ‰“å®¶åŠ«èˆ(198)</td>
          <td><code>dp[i] = max(dp[i-1], dp[i-2]+nums[i])</code></td>
      </tr>
      <tr>
          <td>åŒåºåˆ—åŒ¹é…DP</td>
          <td>æœ€é•¿å…¬å…±å­åºåˆ—(1143)</td>
          <td><code>dp[i][j] = 1+dp[i-1][j-1] if s[i]==t[j]</code></td>
      </tr>
      <tr>
          <td>åŒºé—´DP</td>
          <td>æœ€é•¿å›æ–‡å­ä¸²(5)</td>
          <td><code>dp[i][j] = (s[i]==s[j]) and dp[i+1][j-1]</code></td>
      </tr>
      <tr>
          <td>èƒŒåŒ…DP</td>
          <td>åˆ†å‰²ç­‰å’Œå­é›†(416)</td>
          <td><code>dp[j] = dp[j] or dp[j-num]</code></td>
      </tr>
      <tr>
          <td>çŠ¶æ€æœºDP</td>
          <td>ä¹°å–è‚¡ç¥¨æœ€ä½³æ—¶æœº(121/122)</td>
          <td>æŒæœ‰/æœªæŒæœ‰ä¸¤ç§çŠ¶æ€è½¬æ¢</td>
      </tr>
  </tbody>
</table>
<h2 id="äºŒé˜¶æ¢¯å¼è®­ç»ƒè·¯çº¿">äºŒã€é˜¶æ¢¯å¼è®­ç»ƒè·¯çº¿</h2>
<h3 id="é˜¶æ®µ1åŸºç¡€æ¨¡å‹æ­å»º1-2å‘¨">é˜¶æ®µ1ï¼šåŸºç¡€æ¨¡å‹æ­å»ºï¼ˆ1-2å‘¨ï¼‰</h3>
<table>
  <thead>
      <tr>
          <th>é¢˜ç›®</th>
          <th>è®­ç»ƒé‡ç‚¹</th>
          <th>çªç ´æŠ€å·§</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>70. çˆ¬æ¥¼æ¢¯</td>
          <td>æ–æ³¢é‚£å¥‘å‹DP</td>
          <td>ç©ºé—´å‹ç¼©åˆ°O(1)</td>
      </tr>
      <tr>
          <td>118. æ¨è¾‰ä¸‰è§’</td>
          <td>äºŒç»´DPå¡«è¡¨é€»è¾‘</td>
          <td>è§‚å¯Ÿè¡Œåˆ—å…³ç³»</td>
      </tr>
      <tr>
          <td>121. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº</td>
          <td>çŠ¶æ€æœºæ¨¡å‹</td>
          <td>ç»´æŠ¤min_priceå’Œmax_profit</td>
      </tr>
      <tr>
          <td>53. æœ€å¤§å­æ•°ç»„å’Œ</td>
          <td>å†³ç­–å‹DPï¼ˆé€‰æˆ–ä¸é€‰ï¼‰</td>
          <td>ç”¨curr_maxä»£æ›¿dpæ•°ç»„</td>
      </tr>
      <tr>
          <td>746. ä½¿ç”¨æœ€å°èŠ±è´¹çˆ¬æ¥¼æ¢¯</td>
          <td>è·¯å¾„æˆæœ¬è®¡ç®—</td>
          <td>é€†å‘æ¨å¯¼æ›´ç®€å•</td>
      </tr>
  </tbody>
</table>
<h3 id="é˜¶æ®µ2ç»å…¸é¢˜å‹çªç ´2-3å‘¨">é˜¶æ®µ2ï¼šç»å…¸é¢˜å‹çªç ´ï¼ˆ2-3å‘¨ï¼‰</h3>
<table>
  <thead>
      <tr>
          <th>é¢˜ç›®</th>
          <th>éš¾ç‚¹è§£æ</th>
          <th>ä»£ç æ¨¡æ¿ç‰‡æ®µ</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>198. æ‰“å®¶åŠ«èˆ</strong></td>
          <td>ç›¸é‚»ä¸èƒ½é€‰</td>
          <td><code>max(dp[i-1], dp[i-2]+nums[i])</code></td>
      </tr>
      <tr>
          <td><strong>322. é›¶é’±å…‘æ¢</strong></td>
          <td>å®Œå…¨èƒŒåŒ…æœ€å°å€¼</td>
          <td><code>dp[amt] = min(dp[amt], dp[amt-coin]+1)</code></td>
      </tr>
      <tr>
          <td><strong>300. æœ€é•¿é€’å¢å­åºåˆ—</strong></td>
          <td>O(nÂ²)ä¸O(nlogn)ä¸¤ç§è§£æ³•</td>
          <td>äºŒåˆ†æŸ¥æ‰¾ç»´æŠ¤tailsæ•°ç»„</td>
      </tr>
      <tr>
          <td><strong>1143. æœ€é•¿å…¬å…±å­åºåˆ—</strong></td>
          <td>åŒåºåˆ—åŒ¹é…</td>
          <td><code>if s[i]==t[j]: dp[i][j]=dp[i-1][j-1]+1</code></td>
      </tr>
      <tr>
          <td><strong>139. å•è¯æ‹†åˆ†</strong></td>
          <td>å­—ç¬¦ä¸²åˆ†æ®µåˆ¤æ–­</td>
          <td><code>dp[i] = any(dp[j] and s[j:i] in dict)</code></td>
      </tr>
  </tbody>
</table>
<h3 id="é˜¶æ®µ3é«˜éš¾åº¦æŒ‘æˆ˜3-4å‘¨">é˜¶æ®µ3ï¼šé«˜éš¾åº¦æŒ‘æˆ˜ï¼ˆ3-4å‘¨ï¼‰</h3>
<table>
  <thead>
      <tr>
          <th>é¢˜ç›®</th>
          <th>ç ´é¢˜å…³é”®ç‚¹</th>
          <th>ä¼˜åŒ–æŠ€å·§</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>72. ç¼–è¾‘è·ç¦»</strong></td>
          <td>ä¸‰ç§æ“ä½œçš„çŠ¶æ€è½¬ç§»</td>
          <td>ç©ºé—´å‹ç¼©åˆ°ä¸€ç»´æ•°ç»„</td>
      </tr>
      <tr>
          <td><strong>152. ä¹˜ç§¯æœ€å¤§å­æ•°ç»„</strong></td>
          <td>å¤„ç†è´Ÿæ•°ä¹˜ç§¯</td>
          <td>åŒæ—¶ç»´æŠ¤maxå’Œmin</td>
      </tr>
      <tr>
          <td><strong>312. æˆ³æ°”çƒ</strong></td>
          <td>åŒºé—´DPé€†å‘æ€ç»´</td>
          <td>ä»æœ€åæˆ³ç ´çš„æ°”çƒå€’æ¨</td>
      </tr>
      <tr>
          <td><strong>10. æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…</strong></td>
          <td>æ˜Ÿå·åŒ¹é…çš„ç‰¹æ®Šå¤„ç†</td>
          <td>åˆ†æƒ…å†µè®¨è®ºpatternçš„ç¬¬äºŒä¸ªå­—ç¬¦</td>
      </tr>
      <tr>
          <td><strong>887. é¸¡è›‹æ‰è½</strong></td>
          <td>å†³ç­–æœ€ä¼˜åŒ–çš„æ•°å­¦æ¨å¯¼</td>
          <td>é€†å‘æ€ç»´+äºŒåˆ†æŸ¥æ‰¾ä¼˜åŒ–</td>
      </tr>
  </tbody>
</table>
<h2 id="ä¸‰é¿å‘æŒ‡å—ä¸å®æˆ˜æŠ€å·§">ä¸‰ã€é¿å‘æŒ‡å—ä¸å®æˆ˜æŠ€å·§</h2>
<h3 id="1-äº”å¤§å¸¸è§é”™è¯¯ç±»å‹">1. äº”å¤§å¸¸è§é”™è¯¯ç±»å‹</h3>
<ul>
<li>ğŸš« <strong>åˆå§‹åŒ–é”™è¯¯</strong>ï¼šæ¯”å¦‚èƒŒåŒ…é—®é¢˜ä¸­dp[0]åº”è¯¥åˆå§‹åŒ–ä¸ºTrue</li>
<li>ğŸš« <strong>éå†é¡ºåºé”™è¯¯</strong>ï¼šå®Œå…¨èƒŒåŒ…è¦æ­£åºå¾ªç¯ï¼Œ01èƒŒåŒ…è¦å€’åºå¾ªç¯</li>
<li>ğŸš« <strong>çŠ¶æ€è½¬ç§»é—æ¼</strong>ï¼šå¦‚ç¼–è¾‘è·ç¦»å¿˜è®°è€ƒè™‘replaceæ“ä½œ</li>
<li>ğŸš« <strong>äºŒç»´DPè¡Œåˆ—æ··æ·†</strong>ï¼šæŠŠsçš„é•¿åº¦å½“ä½œè¡Œè¿˜æ˜¯åˆ—è¦ç»Ÿä¸€</li>
<li>ğŸš« <strong>ç©ºé—´å‹ç¼©é™·é˜±</strong>ï¼šè¦†ç›–æœªä½¿ç”¨çš„æ—§å€¼å¯¼è‡´é”™è¯¯</li>
</ul>
<h3 id="2-ä¸‰æ­¥ä¼˜åŒ–æ–¹æ³•è®º">2. ä¸‰æ­¥ä¼˜åŒ–æ–¹æ³•è®º</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="k">1.</span> <span class="gs">**æš´åŠ›é€’å½’**</span> â†’ å†™å‡ºåŸºæœ¬çŠ¶æ€è½¬ç§»
</span></span><span class="line"><span class="cl">   <span class="k">-</span> æ–æ³¢é‚£å¥‘æ•°åˆ—é€’å½’ç‰ˆ
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl"><span class="k">2.</span> <span class="gs">**è®°å¿†åŒ–æœç´¢**</span> â†’ æ·»åŠ ç¼“å­˜ï¼ˆ<span class="ni">@lru_cache</span>ï¼‰
</span></span><span class="line"><span class="cl">   <span class="k">-</span> ç”¨è£…é¥°å™¨è‡ªåŠ¨ç¼“å­˜å‚æ•°
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl"><span class="k">3.</span> <span class="gs">**æ¨å¯¼DPæ–¹ç¨‹**</span> â†’ ä¼˜åŒ–ç©ºé—´å¤æ‚åº¦
</span></span><span class="line"><span class="cl">   <span class="k">-</span> è§‚å¯ŸçŠ¶æ€ä¾èµ–å…³ç³»ï¼Œå‹ç¼©ç»´åº¦
</span></span></code></pre></div><h3 id="3-é¢è¯•åº”ç­”æŠ€å·§">3. é¢è¯•åº”ç­”æŠ€å·§</h3>
<ul>
<li>ğŸ’¡ å…ˆè¯´å‡ºæš´åŠ›è§£çš„æ—¶é—´å¤æ‚åº¦</li>
<li>ğŸ’¡ æ˜ç¡®è¯´å‡ºDPæ•°ç»„çš„å®šä¹‰å’Œç»´åº¦</li>
<li>ğŸ’¡ åœ¨ç™½æ¿ä¸Šå…ˆå†™çŠ¶æ€è½¬ç§»æ–¹ç¨‹å†ç¼–ç </li>
<li>ğŸ’¡ ä¸»åŠ¨è®¨è®ºç©ºé—´ä¼˜åŒ–å¯èƒ½æ€§</li>
</ul>
<h2 id="å››é…å¥—è®­ç»ƒèµ„æº">å››ã€é…å¥—è®­ç»ƒèµ„æº</h2>
<h3 id="1-å¯è§†åŒ–å­¦ä¹ ">1. å¯è§†åŒ–å­¦ä¹ </h3>
<ul>
<li><strong>DPV ç®—æ³•å¯è§†åŒ–ç½‘ç«™</strong> - åŠ¨æ€å±•ç¤ºDPæ‰§è¡Œè¿‡ç¨‹</li>
<li><strong>VisuAlgo åŠ¨æ€è§„åˆ’ä¸“é¢˜</strong> - åŒ…å«LCSã€èƒŒåŒ…ç­‰é—®é¢˜åŠ¨ç”»</li>
</ul>
<h3 id="2-ä¸“é¡¹é¢˜å•">2. ä¸“é¡¹é¢˜å•</h3>
<ul>
<li><strong>LeetCodeåŠ¨æ€è§„åˆ’åˆ†ç±»</strong> â†’ æŒ‰é€šè¿‡ç‡æ’åºç»ƒä¹ </li>
<li><strong>ç»å…¸DPé—®é¢˜Top 50</strong> â†’ æ¶µç›–æ‰€æœ‰DPç±»å‹</li>
</ul>
<h3 id="3-é”™é¢˜æœ¬æ¨¡æ¿">3. é”™é¢˜æœ¬æ¨¡æ¿</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gu">## 72. ç¼–è¾‘è·ç¦»
</span></span></span><span class="line"><span class="cl"><span class="gu">### é”™è¯¯è®°å½•
</span></span></span><span class="line"><span class="cl"><span class="gu"></span><span class="k">-</span> åˆå§‹ç‰ˆæœ¬å¿˜è®°å¤„ç†ç©ºå­—ç¬¦ä¸²æƒ…å†µ
</span></span><span class="line"><span class="cl"><span class="k">-</span> è¯¯å°†æ›¿æ¢æ“ä½œçš„æˆæœ¬è®¡ç®—ä¸º2ï¼ˆæ­£ç¡®æ˜¯1ï¼‰
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gu">### çŠ¶æ€è½¬ç§»è¡¨
</span></span></span><span class="line"><span class="cl"><span class="gu"></span>|       | &#34;&#34; | r | o | s |
</span></span><span class="line"><span class="cl">|-------|----|---|---|---|
</span></span><span class="line"><span class="cl">| &#34;&#34;    | 0 | 1 | 2 | 3 |
</span></span><span class="line"><span class="cl">| h     | 1 | 1 | 2 | 3 | 
</span></span><span class="line"><span class="cl">| o     | 2 | 2 | 1 | 2 |
</span></span><span class="line"><span class="cl">| r     | 3 | 2 | 2 | 2 |
</span></span><span class="line"><span class="cl">| s     | 4 | 3 | 3 | 2 |
</span></span></code></pre></div><h2 id="äº”è®­ç»ƒè®¡åˆ’å»ºè®®">äº”ã€è®­ç»ƒè®¡åˆ’å»ºè®®</h2>
<h3 id="æ¯æ—¥ä»»åŠ¡">æ¯æ—¥ä»»åŠ¡</h3>
<ul>
<li><strong>ä¸Šåˆ</strong>ï¼šç²¾åš1é“æ–°DPé¢˜ï¼ˆæŒ‰é˜¶æ®µé€‰æ‹©éš¾åº¦ï¼‰</li>
<li><strong>ä¸‹åˆ</strong>ï¼šå¤ä¹ 2é“æ—§é¢˜ï¼Œå†™å‡ºç©ºé—´ä¼˜åŒ–ç‰ˆæœ¬</li>
<li><strong>æ™šä¸Š</strong>ï¼šè§‚çœ‹å¯¹åº”é¢˜ç›®çš„è®²è§£è§†é¢‘</li>
</ul>
<h3 id="æ¯å‘¨æ£€éªŒ">æ¯å‘¨æ£€éªŒ</h3>
<ul>
<li>å‘¨èµ›è‡³å°‘å®Œæˆ2é“DPç›¸å…³é¢˜ç›®</li>
<li>æ•´ç†æœ¬å‘¨çš„DPç±»å‹æ€ç»´å¯¼å›¾</li>
</ul>
<h2 id="é¢„æœŸæ•ˆæœ">é¢„æœŸæ•ˆæœ</h2>
<p>åšæŒæŒ‰ç…§è¿™ä¸ªæ–¹æ¡ˆè®­ç»ƒ<strong>2ä¸ªæœˆ</strong>åï¼Œä½ ä¼šæ˜æ˜¾å‘ç°ï¼š</p>
<ol>
<li>âœ… ä¸­ç­‰DPé¢˜èƒ½åœ¨15åˆ†é’Ÿå†…æ‰¾åˆ°æ€è·¯</li>
<li>âœ… èƒ½è½»æ¾åº”å¯¹å­—ç¬¦ä¸²åŒ¹é…ã€èƒŒåŒ…ç±»é—®é¢˜</li>
<li>âœ… é¢å¯¹hardé¢˜æ—¶æœ‰æ¸…æ™°çš„æ‹†è§£ç­–ç•¥</li>
</ol>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<blockquote>
<p>åŠ¨æ€è§„åˆ’çš„æœ¬è´¨æ˜¯ç”¨ç©ºé—´æ¢æ—¶é—´ï¼Œæ ¸å¿ƒæ˜¯æ‰¾åˆ°<strong>é‡å å­é—®é¢˜</strong>å’Œ<strong>æœ€ä¼˜å­ç»“æ„</strong>ã€‚å¤šåŠ¨æ‰‹ç”»çŠ¶æ€è½¬ç§»è¡¨ï¼Œä½ çš„å¤§è„‘ä¼šé€æ¸å»ºç«‹DPçš„æ€ç»´æ¨¡å¼ã€‚</p></blockquote>
<p>è®°ä½ï¼š<strong>Practice makes perfect!</strong> åŠ¨æ€è§„åˆ’éœ€è¦å¤§é‡çš„ç»ƒä¹ æ¥åŸ¹å…»ç›´è§‰ï¼Œä½†ä¸€æ—¦æŒæ¡ï¼Œå®ƒå°†æˆä¸ºä½ ç®—æ³•å·¥å…·ç®±ä¸­æœ€å¼ºå¤§çš„æ­¦å™¨ä¹‹ä¸€ã€‚</p>
<hr>
<p><em>æŒç»­æ›´æ–°ä¸­ï¼Œæ¬¢è¿äº¤æµè®¨è®ºï¼</em></p>
]]></content:encoded>
    </item>
    <item>
      <title>æœç´¢ç®—æ³•è¯¦è§£ï¼šBFSä¸DFSçš„åŸç†å’Œåº”ç”¨</title>
      <link>https://tyhzxh.github.io/posts/search-algorithms-guide/</link>
      <pubDate>Tue, 27 Feb 2024 22:05:13 +0800</pubDate>
      <guid>https://tyhzxh.github.io/posts/search-algorithms-guide/</guid>
      <description>æ·±å…¥è§£æå¹¿åº¦ä¼˜å…ˆæœç´¢(BFS)å’Œæ·±åº¦ä¼˜å…ˆæœç´¢(DFS)ç®—æ³•çš„åŸç†ã€å®ç°å’Œåº”ç”¨åœºæ™¯ï¼ŒåŒ…æ‹¬å›¾éå†ã€æœ€çŸ­è·¯å¾„ã€è¿é€šæ€§æ£€æµ‹ç­‰ç»å…¸é—®é¢˜çš„è§£å†³æ–¹æ¡ˆ</description>
      <content:encoded><![CDATA[<h2 id="æœç´¢ç®—æ³•æ¦‚è¿°">æœç´¢ç®—æ³•æ¦‚è¿°</h2>
<p><strong>æœç´¢ç®—æ³•</strong>æ˜¯è®¡ç®—æœºç§‘å­¦ä¸­çš„åŸºç¡€ç®—æ³•ï¼Œç”¨äºåœ¨æ•°æ®ç»“æ„ä¸­æŸ¥æ‰¾ç‰¹å®šå…ƒç´ æˆ–è·¯å¾„ã€‚åœ¨å›¾è®ºå’Œæ ‘ç»“æ„ä¸­ï¼Œæœ€é‡è¦çš„ä¸¤ç§æœç´¢ç®—æ³•æ˜¯<strong>å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰<strong>å’Œ</strong>æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰</strong>ã€‚</p>
<h2 id="å¹¿åº¦ä¼˜å…ˆæœç´¢bfs">å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰</h2>
<h3 id="bfsåŸºæœ¬åŸç†">BFSåŸºæœ¬åŸç†</h3>
<p>**å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBreadth-First Searchï¼‰**æ˜¯ä¸€ç§å›¾éå†ç®—æ³•ï¼Œå®ƒä»èµ·å§‹èŠ‚ç‚¹å¼€å§‹ï¼Œé€å±‚å‘å¤–æ‰©å±•ï¼Œå…ˆè®¿é—®è·ç¦»èµ·å§‹èŠ‚ç‚¹æœ€è¿‘çš„æ‰€æœ‰èŠ‚ç‚¹ï¼Œå†è®¿é—®è·ç¦»æ›´è¿œçš„èŠ‚ç‚¹ã€‚</p>
<h3 id="bfsæ ¸å¿ƒç‰¹ç‚¹">BFSæ ¸å¿ƒç‰¹ç‚¹</h3>
<table>
  <thead>
      <tr>
          <th>ç‰¹ç‚¹</th>
          <th>æè¿°</th>
          <th>åº”ç”¨åœºæ™¯</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>å±‚æ¬¡éå†</strong></td>
          <td>æŒ‰è·ç¦»èµ·å§‹ç‚¹çš„å±‚æ¬¡é€å±‚è®¿é—®</td>
          <td>æœ€çŸ­è·¯å¾„é—®é¢˜</td>
      </tr>
      <tr>
          <td><strong>é˜Ÿåˆ—å®ç°</strong></td>
          <td>ä½¿ç”¨é˜Ÿåˆ—ï¼ˆFIFOï¼‰å­˜å‚¨å¾…è®¿é—®èŠ‚ç‚¹</td>
          <td>ä¿è¯è®¿é—®é¡ºåº</td>
      </tr>
      <tr>
          <td><strong>å®Œå¤‡æ€§</strong></td>
          <td>å¦‚æœè§£å­˜åœ¨ï¼Œä¸€å®šèƒ½æ‰¾åˆ°</td>
          <td>çŠ¶æ€ç©ºé—´æœç´¢</td>
      </tr>
      <tr>
          <td><strong>æœ€ä¼˜æ€§</strong></td>
          <td>åœ¨æ— æƒå›¾ä¸­èƒ½æ‰¾åˆ°æœ€çŸ­è·¯å¾„</td>
          <td>æœ€çŸ­è·¯å¾„ç®—æ³•</td>
      </tr>
  </tbody>
</table>
<h3 id="bfsç®—æ³•å®ç°">BFSç®—æ³•å®ç°</h3>
<h4 id="1-åŸºç¡€bfsæ¨¡æ¿">1. åŸºç¡€BFSæ¨¡æ¿</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">deque</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">bfs_template</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">start</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    BFSç®—æ³•é€šç”¨æ¨¡æ¿
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Args:
</span></span></span><span class="line"><span class="cl"><span class="s2">        graph: å›¾çš„é‚»æ¥è¡¨è¡¨ç¤º {node: [neighbors]}
</span></span></span><span class="line"><span class="cl"><span class="s2">        start: èµ·å§‹èŠ‚ç‚¹
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Returns:
</span></span></span><span class="line"><span class="cl"><span class="s2">        visited: è®¿é—®è¿‡çš„èŠ‚ç‚¹é›†åˆ
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">visited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">queue</span> <span class="o">=</span> <span class="n">deque</span><span class="p">([</span><span class="n">start</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">queue</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">current</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;è®¿é—®èŠ‚ç‚¹: </span><span class="si">{</span><span class="n">current</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># éå†å½“å‰èŠ‚ç‚¹çš„æ‰€æœ‰é‚»å±…</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">neighbor</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="p">[]):</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">neighbor</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">neighbor</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">queue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">neighbor</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">visited</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹å›¾</span>
</span></span><span class="line"><span class="cl"><span class="n">graph</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">visited_nodes</span> <span class="o">=</span> <span class="n">bfs_template</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;BFSè®¿é—®çš„èŠ‚ç‚¹:&#34;</span><span class="p">,</span> <span class="n">visited_nodes</span><span class="p">)</span>
</span></span></code></pre></div><h4 id="2-bfsæ±‚æœ€çŸ­è·¯å¾„">2. BFSæ±‚æœ€çŸ­è·¯å¾„</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">bfs_shortest_path</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    ä½¿ç”¨BFSæ±‚æ— æƒå›¾ä¸­çš„æœ€çŸ­è·¯å¾„
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Args:
</span></span></span><span class="line"><span class="cl"><span class="s2">        graph: å›¾çš„é‚»æ¥è¡¨
</span></span></span><span class="line"><span class="cl"><span class="s2">        start: èµ·å§‹èŠ‚ç‚¹
</span></span></span><span class="line"><span class="cl"><span class="s2">        target: ç›®æ ‡èŠ‚ç‚¹
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Returns:
</span></span></span><span class="line"><span class="cl"><span class="s2">        (distance, path): æœ€çŸ­è·ç¦»å’Œè·¯å¾„
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">start</span> <span class="o">==</span> <span class="n">target</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="n">start</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">visited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">start</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">queue</span> <span class="o">=</span> <span class="n">deque</span><span class="p">([(</span><span class="n">start</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="n">start</span><span class="p">])])</span>  <span class="c1"># (èŠ‚ç‚¹, è·ç¦», è·¯å¾„)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">queue</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">current</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">neighbor</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="p">[]):</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">neighbor</span> <span class="o">==</span> <span class="n">target</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="n">distance</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">path</span> <span class="o">+</span> <span class="p">[</span><span class="n">neighbor</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">neighbor</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">neighbor</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">queue</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">neighbor</span><span class="p">,</span> <span class="n">distance</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">path</span> <span class="o">+</span> <span class="p">[</span><span class="n">neighbor</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">[]</span>  <span class="c1"># æ— æ³•åˆ°è¾¾</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="n">distance</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span> <span class="n">bfs_shortest_path</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;ä»Aåˆ°Fçš„æœ€çŸ­è·ç¦»: </span><span class="si">{</span><span class="n">distance</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;æœ€çŸ­è·¯å¾„: </span><span class="si">{</span><span class="s1">&#39; -&gt; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h4 id="3-bfså±‚æ¬¡éå†">3. BFSå±‚æ¬¡éå†</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">bfs_level_order</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">start</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    BFSå±‚æ¬¡éå†ï¼Œè¿”å›æ¯ä¸€å±‚çš„èŠ‚ç‚¹
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Args:
</span></span></span><span class="line"><span class="cl"><span class="s2">        graph: å›¾çš„é‚»æ¥è¡¨
</span></span></span><span class="line"><span class="cl"><span class="s2">        start: èµ·å§‹èŠ‚ç‚¹
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Returns:
</span></span></span><span class="line"><span class="cl"><span class="s2">        levels: æ¯ä¸€å±‚çš„èŠ‚ç‚¹åˆ—è¡¨
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">visited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">start</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">current_level</span> <span class="o">=</span> <span class="p">[</span><span class="n">start</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">levels</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">current_level</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">levels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_level</span><span class="p">[:])</span>  <span class="c1"># å¤åˆ¶å½“å‰å±‚</span>
</span></span><span class="line"><span class="cl">        <span class="n">next_level</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">current_level</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">neighbor</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="p">[]):</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">neighbor</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">neighbor</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="n">next_level</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">neighbor</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">current_level</span> <span class="o">=</span> <span class="n">next_level</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">levels</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="n">levels</span> <span class="o">=</span> <span class="n">bfs_level_order</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">level</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">levels</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;ç¬¬</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">å±‚: </span><span class="si">{</span><span class="n">level</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="bfsåœ¨äºŒå‰æ ‘ä¸­çš„åº”ç”¨">BFSåœ¨äºŒå‰æ ‘ä¸­çš„åº”ç”¨</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">TreeNode</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">val</span> <span class="o">=</span> <span class="n">val</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">left</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">right</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">bfs_tree_traversal</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    äºŒå‰æ ‘çš„BFSéå†ï¼ˆå±‚åºéå†ï¼‰
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Args:
</span></span></span><span class="line"><span class="cl"><span class="s2">        root: äºŒå‰æ ‘æ ¹èŠ‚ç‚¹
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Returns:
</span></span></span><span class="line"><span class="cl"><span class="s2">        result: å±‚åºéå†ç»“æœ
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">queue</span> <span class="o">=</span> <span class="n">deque</span><span class="p">([</span><span class="n">root</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">queue</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">node</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">val</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">left</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">queue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">left</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">right</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">queue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">right</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">result</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">bfs_tree_level_order</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    äºŒå‰æ ‘çš„åˆ†å±‚éå†
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Args:
</span></span></span><span class="line"><span class="cl"><span class="s2">        root: äºŒå‰æ ‘æ ¹èŠ‚ç‚¹
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Returns:
</span></span></span><span class="line"><span class="cl"><span class="s2">        levels: æ¯ä¸€å±‚çš„èŠ‚ç‚¹å€¼åˆ—è¡¨
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">levels</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">queue</span> <span class="o">=</span> <span class="n">deque</span><span class="p">([</span><span class="n">root</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">queue</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">level_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">queue</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">current_level</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">level_size</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">node</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="n">current_level</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">val</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">left</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">queue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">left</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">right</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">queue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">right</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">levels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_level</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">levels</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ„å»ºç¤ºä¾‹äºŒå‰æ ‘</span>
</span></span><span class="line"><span class="cl"><span class="c1">#       3</span>
</span></span><span class="line"><span class="cl"><span class="c1">#      / \</span>
</span></span><span class="line"><span class="cl"><span class="c1">#     9   20</span>
</span></span><span class="line"><span class="cl"><span class="c1">#        /  \</span>
</span></span><span class="line"><span class="cl"><span class="c1">#       15   7</span>
</span></span><span class="line"><span class="cl"><span class="n">root</span> <span class="o">=</span> <span class="n">TreeNode</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">root</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">TreeNode</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">root</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">TreeNode</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">root</span><span class="o">.</span><span class="n">right</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">TreeNode</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">root</span><span class="o">.</span><span class="n">right</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">TreeNode</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;BFSéå†:&#34;</span><span class="p">,</span> <span class="n">bfs_tree_traversal</span><span class="p">(</span><span class="n">root</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;åˆ†å±‚éå†:&#34;</span><span class="p">,</span> <span class="n">bfs_tree_level_order</span><span class="p">(</span><span class="n">root</span><span class="p">))</span>
</span></span></code></pre></div><h2 id="æ·±åº¦ä¼˜å…ˆæœç´¢dfs">æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰</h2>
<h3 id="dfsåŸºæœ¬åŸç†">DFSåŸºæœ¬åŸç†</h3>
<p>**æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDepth-First Searchï¼‰**æ˜¯ä¸€ç§å›¾éå†ç®—æ³•ï¼Œå®ƒä»èµ·å§‹èŠ‚ç‚¹å¼€å§‹ï¼Œæ²¿ç€ä¸€æ¡è·¯å¾„å°½å¯èƒ½æ·±å…¥ï¼Œç›´åˆ°æ— æ³•ç»§ç»­ä¸ºæ­¢ï¼Œç„¶åå›æº¯åˆ°ä¸Šä¸€ä¸ªèŠ‚ç‚¹ï¼Œç»§ç»­æ¢ç´¢å…¶ä»–è·¯å¾„ã€‚</p>
<h3 id="dfsæ ¸å¿ƒç‰¹ç‚¹">DFSæ ¸å¿ƒç‰¹ç‚¹</h3>
<table>
  <thead>
      <tr>
          <th>ç‰¹ç‚¹</th>
          <th>æè¿°</th>
          <th>åº”ç”¨åœºæ™¯</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>æ·±åº¦ä¼˜å…ˆ</strong></td>
          <td>ä¼˜å…ˆæ¢ç´¢æ›´æ·±çš„è·¯å¾„</td>
          <td>è·¯å¾„æœç´¢é—®é¢˜</td>
      </tr>
      <tr>
          <td><strong>æ ˆå®ç°</strong></td>
          <td>ä½¿ç”¨æ ˆï¼ˆLIFOï¼‰æˆ–é€’å½’å®ç°</td>
          <td>å›æº¯ç®—æ³•</td>
      </tr>
      <tr>
          <td><strong>ç©ºé—´æ•ˆç‡</strong></td>
          <td>ç©ºé—´å¤æ‚åº¦ç›¸å¯¹è¾ƒä½</td>
          <td>å†…å­˜å—é™ç¯å¢ƒ</td>
      </tr>
      <tr>
          <td><strong>è·¯å¾„è®°å½•</strong></td>
          <td>å®¹æ˜“è®°å½•å®Œæ•´è·¯å¾„</td>
          <td>è·¯å¾„ç›¸å…³é—®é¢˜</td>
      </tr>
  </tbody>
</table>
<h3 id="dfsç®—æ³•å®ç°">DFSç®—æ³•å®ç°</h3>
<h4 id="1-é€’å½’dfs">1. é€’å½’DFS</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">dfs_recursive</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">visited</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    é€’å½’å®ç°çš„DFS
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Args:
</span></span></span><span class="line"><span class="cl"><span class="s2">        graph: å›¾çš„é‚»æ¥è¡¨
</span></span></span><span class="line"><span class="cl"><span class="s2">        start: èµ·å§‹èŠ‚ç‚¹
</span></span></span><span class="line"><span class="cl"><span class="s2">        visited: å·²è®¿é—®èŠ‚ç‚¹é›†åˆ
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Returns:
</span></span></span><span class="line"><span class="cl"><span class="s2">        visited: è®¿é—®è¿‡çš„èŠ‚ç‚¹é›†åˆ
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">visited</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">visited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;è®¿é—®èŠ‚ç‚¹: </span><span class="si">{</span><span class="n">start</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">neighbor</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="p">[]):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">neighbor</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">dfs_recursive</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">neighbor</span><span class="p">,</span> <span class="n">visited</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">visited</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="n">visited_nodes</span> <span class="o">=</span> <span class="n">dfs_recursive</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;DFSè®¿é—®çš„èŠ‚ç‚¹:&#34;</span><span class="p">,</span> <span class="n">visited_nodes</span><span class="p">)</span>
</span></span></code></pre></div><h4 id="2-è¿­ä»£dfs">2. è¿­ä»£DFS</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">dfs_iterative</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">start</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    è¿­ä»£å®ç°çš„DFS
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Args:
</span></span></span><span class="line"><span class="cl"><span class="s2">        graph: å›¾çš„é‚»æ¥è¡¨
</span></span></span><span class="line"><span class="cl"><span class="s2">        start: èµ·å§‹èŠ‚ç‚¹
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Returns:
</span></span></span><span class="line"><span class="cl"><span class="s2">        visited: è®¿é—®è¿‡çš„èŠ‚ç‚¹é›†åˆ
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">visited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">stack</span> <span class="o">=</span> <span class="p">[</span><span class="n">start</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">stack</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">current</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">current</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;è®¿é—®èŠ‚ç‚¹: </span><span class="si">{</span><span class="n">current</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="c1"># å°†é‚»å±…èŠ‚ç‚¹åŠ å…¥æ ˆï¼ˆé€†åºä»¥ä¿æŒå­—å…¸åºï¼‰</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">neighbor</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="p">[])):</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">neighbor</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">neighbor</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">visited</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="n">visited_nodes</span> <span class="o">=</span> <span class="n">dfs_iterative</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;DFSè®¿é—®çš„èŠ‚ç‚¹:&#34;</span><span class="p">,</span> <span class="n">visited_nodes</span><span class="p">)</span>
</span></span></code></pre></div><h4 id="3-dfsè·¯å¾„æœç´¢">3. DFSè·¯å¾„æœç´¢</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">dfs_find_path</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    ä½¿ç”¨DFSæŸ¥æ‰¾ä»èµ·å§‹èŠ‚ç‚¹åˆ°ç›®æ ‡èŠ‚ç‚¹çš„è·¯å¾„
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Args:
</span></span></span><span class="line"><span class="cl"><span class="s2">        graph: å›¾çš„é‚»æ¥è¡¨
</span></span></span><span class="line"><span class="cl"><span class="s2">        start: èµ·å§‹èŠ‚ç‚¹
</span></span></span><span class="line"><span class="cl"><span class="s2">        target: ç›®æ ‡èŠ‚ç‚¹
</span></span></span><span class="line"><span class="cl"><span class="s2">        path: å½“å‰è·¯å¾„
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Returns:
</span></span></span><span class="line"><span class="cl"><span class="s2">        path: æ‰¾åˆ°çš„è·¯å¾„ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™è¿”å›None
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">path</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="p">[</span><span class="n">start</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">start</span> <span class="o">==</span> <span class="n">target</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">path</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">neighbor</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="p">[]):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">neighbor</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">path</span><span class="p">:</span>  <span class="c1"># é¿å…ç¯è·¯</span>
</span></span><span class="line"><span class="cl">            <span class="n">new_path</span> <span class="o">=</span> <span class="n">dfs_find_path</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">neighbor</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">new_path</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="n">new_path</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">dfs_find_all_paths</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    ä½¿ç”¨DFSæŸ¥æ‰¾ä»èµ·å§‹èŠ‚ç‚¹åˆ°ç›®æ ‡èŠ‚ç‚¹çš„æ‰€æœ‰è·¯å¾„
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Args:
</span></span></span><span class="line"><span class="cl"><span class="s2">        graph: å›¾çš„é‚»æ¥è¡¨
</span></span></span><span class="line"><span class="cl"><span class="s2">        start: èµ·å§‹èŠ‚ç‚¹
</span></span></span><span class="line"><span class="cl"><span class="s2">        target: ç›®æ ‡èŠ‚ç‚¹
</span></span></span><span class="line"><span class="cl"><span class="s2">        path: å½“å‰è·¯å¾„
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Returns:
</span></span></span><span class="line"><span class="cl"><span class="s2">        paths: æ‰€æœ‰å¯èƒ½çš„è·¯å¾„åˆ—è¡¨
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">path</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="p">[</span><span class="n">start</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">start</span> <span class="o">==</span> <span class="n">target</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">[</span><span class="n">path</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">paths</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">neighbor</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="p">[]):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">neighbor</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">path</span><span class="p">:</span>  <span class="c1"># é¿å…ç¯è·¯</span>
</span></span><span class="line"><span class="cl">            <span class="n">new_paths</span> <span class="o">=</span> <span class="n">dfs_find_all_paths</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">neighbor</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">paths</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">new_paths</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">paths</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="n">path</span> <span class="o">=</span> <span class="n">dfs_find_path</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;ä»Aåˆ°Fçš„ä¸€æ¡è·¯å¾„: </span><span class="si">{</span><span class="s1">&#39; -&gt; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="k">if</span> <span class="n">path</span> <span class="k">else</span> <span class="s1">&#39;æ— è·¯å¾„&#39;</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">all_paths</span> <span class="o">=</span> <span class="n">dfs_find_all_paths</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;ä»Aåˆ°Fçš„æ‰€æœ‰è·¯å¾„:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">path</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">all_paths</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;è·¯å¾„</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="s1">&#39; -&gt; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="dfsåœ¨äºŒå‰æ ‘ä¸­çš„åº”ç”¨">DFSåœ¨äºŒå‰æ ‘ä¸­çš„åº”ç”¨</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">dfs_tree_preorder</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    äºŒå‰æ ‘çš„å‰åºéå†ï¼ˆæ ¹-å·¦-å³ï¼‰
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">preorder</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">node</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">val</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">preorder</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">left</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">preorder</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">right</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">preorder</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">result</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">dfs_tree_inorder</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    äºŒå‰æ ‘çš„ä¸­åºéå†ï¼ˆå·¦-æ ¹-å³ï¼‰
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">inorder</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">node</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">inorder</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">left</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">val</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">inorder</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">right</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">inorder</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">result</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">dfs_tree_postorder</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    äºŒå‰æ ‘çš„ååºéå†ï¼ˆå·¦-å³-æ ¹ï¼‰
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">postorder</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">node</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">postorder</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">left</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">postorder</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">right</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">val</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">postorder</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">result</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;å‰åºéå†:&#34;</span><span class="p">,</span> <span class="n">dfs_tree_preorder</span><span class="p">(</span><span class="n">root</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;ä¸­åºéå†:&#34;</span><span class="p">,</span> <span class="n">dfs_tree_inorder</span><span class="p">(</span><span class="n">root</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;ååºéå†:&#34;</span><span class="p">,</span> <span class="n">dfs_tree_postorder</span><span class="p">(</span><span class="n">root</span><span class="p">))</span>
</span></span></code></pre></div><h2 id="bfs-vs-dfs-å¯¹æ¯”åˆ†æ">BFS vs DFS å¯¹æ¯”åˆ†æ</h2>
<h3 id="ç®—æ³•ç‰¹æ€§å¯¹æ¯”">ç®—æ³•ç‰¹æ€§å¯¹æ¯”</h3>
<table>
  <thead>
      <tr>
          <th>ç‰¹æ€§</th>
          <th>BFS</th>
          <th>DFS</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>éå†æ–¹å¼</strong></td>
          <td>é€å±‚æ‰©å±•</td>
          <td>æ·±åº¦ä¼˜å…ˆ</td>
      </tr>
      <tr>
          <td><strong>æ•°æ®ç»“æ„</strong></td>
          <td>é˜Ÿåˆ—ï¼ˆQueueï¼‰</td>
          <td>æ ˆï¼ˆStackï¼‰æˆ–é€’å½’</td>
      </tr>
      <tr>
          <td><strong>ç©ºé—´å¤æ‚åº¦</strong></td>
          <td>O(w) wä¸ºæœ€å¤§å®½åº¦</td>
          <td>O(h) hä¸ºæœ€å¤§æ·±åº¦</td>
      </tr>
      <tr>
          <td><strong>æ—¶é—´å¤æ‚åº¦</strong></td>
          <td>O(V + E)</td>
          <td>O(V + E)</td>
      </tr>
      <tr>
          <td><strong>æœ€çŸ­è·¯å¾„</strong></td>
          <td>æ— æƒå›¾æœ€çŸ­è·¯å¾„</td>
          <td>ä¸ä¿è¯æœ€çŸ­è·¯å¾„</td>
      </tr>
      <tr>
          <td><strong>å†…å­˜ä½¿ç”¨</strong></td>
          <td>å¯èƒ½è¾ƒé«˜</td>
          <td>ç›¸å¯¹è¾ƒä½</td>
      </tr>
  </tbody>
</table>
<h3 id="é€‚ç”¨åœºæ™¯å¯¹æ¯”">é€‚ç”¨åœºæ™¯å¯¹æ¯”</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">compare_bfs_dfs</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    BFSå’ŒDFSçš„é€‚ç”¨åœºæ™¯å¯¹æ¯”
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">scenarios</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;BFSé€‚ç”¨åœºæ™¯&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ±‚æ— æƒå›¾çš„æœ€çŸ­è·¯å¾„&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;å±‚æ¬¡éå†é—®é¢˜&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æœ€å°‘æ­¥æ•°é—®é¢˜&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;è¿é€šæ€§æ£€æµ‹ï¼ˆè¾ƒå¿«æ‰¾åˆ°è§£ï¼‰&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;ç¤¾äº¤ç½‘ç»œä¸­çš„å…³ç³»å±‚æ¬¡åˆ†æ&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;DFSé€‚ç”¨åœºæ™¯&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;è·¯å¾„æœç´¢é—®é¢˜&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ‹“æ‰‘æ’åº&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;å¼ºè¿é€šåˆ†é‡æ£€æµ‹&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;å›æº¯ç®—æ³•&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ ‘çš„éå†&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;æ£€æµ‹å›¾ä¸­çš„ç¯&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">category</span><span class="p">,</span> <span class="n">cases</span> <span class="ow">in</span> <span class="n">scenarios</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="se">\n</span><span class="si">{</span><span class="n">category</span><span class="si">}</span><span class="s2">:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="k">case</span> <span class="ow">in</span> <span class="n">cases</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;  - </span><span class="si">{</span><span class="n">case</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="æœç´¢ç®—æ³•çš„ç»å…¸åº”ç”¨">æœç´¢ç®—æ³•çš„ç»å…¸åº”ç”¨</h2>
<h3 id="1-å²›å±¿æ•°é‡é—®é¢˜">1. å²›å±¿æ•°é‡é—®é¢˜</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">num_islands_bfs</span><span class="p">(</span><span class="n">grid</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    ä½¿ç”¨BFSè§£å†³å²›å±¿æ•°é‡é—®é¢˜
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Args:
</span></span></span><span class="line"><span class="cl"><span class="s2">        grid: äºŒç»´ç½‘æ ¼ï¼Œ&#39;1&#39;è¡¨ç¤ºé™†åœ°ï¼Œ&#39;0&#39;è¡¨ç¤ºæ°´
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Returns:
</span></span></span><span class="line"><span class="cl"><span class="s2">        count: å²›å±¿æ•°é‡
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">grid</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">grid</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">visited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">bfs</span><span class="p">(</span><span class="n">start_r</span><span class="p">,</span> <span class="n">start_c</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">queue</span> <span class="o">=</span> <span class="n">deque</span><span class="p">([(</span><span class="n">start_r</span><span class="p">,</span> <span class="n">start_c</span><span class="p">)])</span>
</span></span><span class="line"><span class="cl">        <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">start_r</span><span class="p">,</span> <span class="n">start_c</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">directions</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="n">queue</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">dr</span><span class="p">,</span> <span class="n">dc</span> <span class="ow">in</span> <span class="n">directions</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">nr</span><span class="p">,</span> <span class="n">nc</span> <span class="o">=</span> <span class="n">r</span> <span class="o">+</span> <span class="n">dr</span><span class="p">,</span> <span class="n">c</span> <span class="o">+</span> <span class="n">dc</span>
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">nr</span> <span class="o">&lt;</span> <span class="n">rows</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">nc</span> <span class="o">&lt;</span> <span class="n">cols</span> <span class="ow">and</span> 
</span></span><span class="line"><span class="cl">                    <span class="p">(</span><span class="n">nr</span><span class="p">,</span> <span class="n">nc</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited</span> <span class="ow">and</span> <span class="n">grid</span><span class="p">[</span><span class="n">nr</span><span class="p">][</span><span class="n">nc</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                    <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">nr</span><span class="p">,</span> <span class="n">nc</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                    <span class="n">queue</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">nr</span><span class="p">,</span> <span class="n">nc</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span> <span class="ow">and</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">bfs</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">count</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">num_islands_dfs</span><span class="p">(</span><span class="n">grid</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    ä½¿ç”¨DFSè§£å†³å²›å±¿æ•°é‡é—®é¢˜
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">grid</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">grid</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">dfs</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">r</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">r</span> <span class="o">&gt;=</span> <span class="n">rows</span> <span class="ow">or</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">c</span> <span class="o">&gt;=</span> <span class="n">cols</span> <span class="ow">or</span> 
</span></span><span class="line"><span class="cl">            <span class="n">grid</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;1&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">grid</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>  <span class="c1"># æ ‡è®°ä¸ºå·²è®¿é—®</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># è®¿é—®å››ä¸ªæ–¹å‘</span>
</span></span><span class="line"><span class="cl">        <span class="n">dfs</span><span class="p">(</span><span class="n">r</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">dfs</span><span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">dfs</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">dfs</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">dfs</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">count</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="n">grid</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;å²›å±¿æ•°é‡ (BFS):&#34;</span><span class="p">,</span> <span class="n">num_islands_bfs</span><span class="p">([</span><span class="n">row</span><span class="p">[:]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">grid</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;å²›å±¿æ•°é‡ (DFS):&#34;</span><span class="p">,</span> <span class="n">num_islands_dfs</span><span class="p">([</span><span class="n">row</span><span class="p">[:]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">grid</span><span class="p">]))</span>
</span></span></code></pre></div><h3 id="2-å•è¯æœç´¢é—®é¢˜">2. å•è¯æœç´¢é—®é¢˜</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">word_search</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="n">word</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    åœ¨äºŒç»´å­—ç¬¦ç½‘æ ¼ä¸­æœç´¢å•è¯
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Args:
</span></span></span><span class="line"><span class="cl"><span class="s2">        board: äºŒç»´å­—ç¬¦æ•°ç»„
</span></span></span><span class="line"><span class="cl"><span class="s2">        word: è¦æœç´¢çš„å•è¯
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Returns:
</span></span></span><span class="line"><span class="cl"><span class="s2">        bool: æ˜¯å¦æ‰¾åˆ°å•è¯
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">board</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">word</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">board</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">dfs</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># æ‰¾åˆ°å®Œæ•´å•è¯</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># è¾¹ç•Œæ£€æŸ¥æˆ–å­—ç¬¦ä¸åŒ¹é…</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">r</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">r</span> <span class="o">&gt;=</span> <span class="n">rows</span> <span class="ow">or</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">c</span> <span class="o">&gt;=</span> <span class="n">cols</span> <span class="ow">or</span> 
</span></span><span class="line"><span class="cl">            <span class="n">board</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">!=</span> <span class="n">word</span><span class="p">[</span><span class="n">index</span><span class="p">]):</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># æ ‡è®°å½“å‰ä½ç½®ä¸ºå·²è®¿é—®</span>
</span></span><span class="line"><span class="cl">        <span class="n">temp</span> <span class="o">=</span> <span class="n">board</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">board</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;#&#39;</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># æœç´¢å››ä¸ªæ–¹å‘</span>
</span></span><span class="line"><span class="cl">        <span class="n">found</span> <span class="o">=</span> <span class="p">(</span><span class="n">dfs</span><span class="p">(</span><span class="n">r</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">or</span>
</span></span><span class="line"><span class="cl">                <span class="n">dfs</span><span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">or</span>
</span></span><span class="line"><span class="cl">                <span class="n">dfs</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">or</span>
</span></span><span class="line"><span class="cl">                <span class="n">dfs</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># æ¢å¤åŸå­—ç¬¦ï¼ˆå›æº¯ï¼‰</span>
</span></span><span class="line"><span class="cl">        <span class="n">board</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">found</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># ä»æ¯ä¸ªä½ç½®å¼€å§‹æœç´¢</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">dfs</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="n">board</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;æœç´¢ &#39;ABCCED&#39;:&#34;</span><span class="p">,</span> <span class="n">word_search</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="s2">&#34;ABCCED&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;æœç´¢ &#39;SEE&#39;:&#34;</span><span class="p">,</span> <span class="n">word_search</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="s2">&#34;SEE&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;æœç´¢ &#39;ABCB&#39;:&#34;</span><span class="p">,</span> <span class="n">word_search</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="s2">&#34;ABCB&#34;</span><span class="p">))</span>
</span></span></code></pre></div><h3 id="3-æ‹“æ‰‘æ’åº">3. æ‹“æ‰‘æ’åº</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">topological_sort_dfs</span><span class="p">(</span><span class="n">graph</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    ä½¿ç”¨DFSå®ç°æ‹“æ‰‘æ’åº
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Args:
</span></span></span><span class="line"><span class="cl"><span class="s2">        graph: æœ‰å‘å›¾çš„é‚»æ¥è¡¨
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Returns:
</span></span></span><span class="line"><span class="cl"><span class="s2">        result: æ‹“æ‰‘æ’åºç»“æœ
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">visited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">temp_visited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">dfs</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">temp_visited</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">False</span>  <span class="c1"># æ£€æµ‹åˆ°ç¯</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">temp_visited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">neighbor</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="p">[]):</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="ow">not</span> <span class="n">dfs</span><span class="p">(</span><span class="n">neighbor</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">temp_visited</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># å¯¹æ‰€æœ‰èŠ‚ç‚¹è¿›è¡ŒDFS</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">graph</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">node</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="ow">not</span> <span class="n">dfs</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="p">[]</span>  <span class="c1"># å›¾ä¸­æœ‰ç¯ï¼Œæ— æ³•è¿›è¡Œæ‹“æ‰‘æ’åº</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">result</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># åè½¬ç»“æœ</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">topological_sort_bfs</span><span class="p">(</span><span class="n">graph</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    ä½¿ç”¨BFSï¼ˆKahnç®—æ³•ï¼‰å®ç°æ‹“æ‰‘æ’åº
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># è®¡ç®—å…¥åº¦</span>
</span></span><span class="line"><span class="cl">    <span class="n">in_degree</span> <span class="o">=</span> <span class="p">{</span><span class="n">node</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">graph</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">graph</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">neighbor</span> <span class="ow">in</span> <span class="n">graph</span><span class="p">[</span><span class="n">node</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">            <span class="n">in_degree</span><span class="p">[</span><span class="n">neighbor</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_degree</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">neighbor</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># æ‰¾åˆ°æ‰€æœ‰å…¥åº¦ä¸º0çš„èŠ‚ç‚¹</span>
</span></span><span class="line"><span class="cl">    <span class="n">queue</span> <span class="o">=</span> <span class="n">deque</span><span class="p">([</span><span class="n">node</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">in_degree</span> <span class="k">if</span> <span class="n">in_degree</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">queue</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">current</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># å‡å°‘é‚»å±…èŠ‚ç‚¹çš„å…¥åº¦</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">neighbor</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="p">[]):</span>
</span></span><span class="line"><span class="cl">            <span class="n">in_degree</span><span class="p">[</span><span class="n">neighbor</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">in_degree</span><span class="p">[</span><span class="n">neighbor</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">queue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">neighbor</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># æ£€æŸ¥æ˜¯å¦æ‰€æœ‰èŠ‚ç‚¹éƒ½è¢«è®¿é—®ï¼ˆæ— ç¯ï¼‰</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">in_degree</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">[]</span>  <span class="c1"># å›¾ä¸­æœ‰ç¯</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">result</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨ï¼šè¯¾ç¨‹ä¾èµ–å…³ç³»</span>
</span></span><span class="line"><span class="cl"><span class="n">course_graph</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;æ•°å­¦åŸºç¡€&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;çº¿æ€§ä»£æ•°&#39;</span><span class="p">,</span> <span class="s1">&#39;æ¦‚ç‡è®º&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;çº¿æ€§ä»£æ•°&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;æœºå™¨å­¦ä¹ &#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;æ¦‚ç‡è®º&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;æœºå™¨å­¦ä¹ &#39;</span><span class="p">,</span> <span class="s1">&#39;ç»Ÿè®¡å­¦&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;ç¼–ç¨‹åŸºç¡€&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;æ•°æ®ç»“æ„&#39;</span><span class="p">,</span> <span class="s1">&#39;ç®—æ³•&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;æ•°æ®ç»“æ„&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;ç®—æ³•&#39;</span><span class="p">,</span> <span class="s1">&#39;æ•°æ®åº“&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;ç®—æ³•&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;æœºå™¨å­¦ä¹ &#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;æœºå™¨å­¦ä¹ &#39;</span><span class="p">:</span> <span class="p">[],</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;ç»Ÿè®¡å­¦&#39;</span><span class="p">:</span> <span class="p">[],</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;æ•°æ®åº“&#39;</span><span class="p">:</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;æ‹“æ‰‘æ’åº (DFS):&#34;</span><span class="p">,</span> <span class="n">topological_sort_dfs</span><span class="p">(</span><span class="n">course_graph</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;æ‹“æ‰‘æ’åº (BFS):&#34;</span><span class="p">,</span> <span class="n">topological_sort_bfs</span><span class="p">(</span><span class="n">course_graph</span><span class="p">))</span>
</span></span></code></pre></div><h2 id="æœç´¢ç®—æ³•ä¼˜åŒ–æŠ€å·§">æœç´¢ç®—æ³•ä¼˜åŒ–æŠ€å·§</h2>
<h3 id="1-åŒå‘bfs">1. åŒå‘BFS</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">bidirectional_bfs</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    åŒå‘BFSï¼šä»èµ·ç‚¹å’Œç»ˆç‚¹åŒæ—¶æœç´¢ï¼Œæé«˜æ•ˆç‡
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Args:
</span></span></span><span class="line"><span class="cl"><span class="s2">        graph: å›¾çš„é‚»æ¥è¡¨
</span></span></span><span class="line"><span class="cl"><span class="s2">        start: èµ·å§‹èŠ‚ç‚¹
</span></span></span><span class="line"><span class="cl"><span class="s2">        target: ç›®æ ‡èŠ‚ç‚¹
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Returns:
</span></span></span><span class="line"><span class="cl"><span class="s2">        distance: æœ€çŸ­è·ç¦»
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">start</span> <span class="o">==</span> <span class="n">target</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># å‰å‘æœç´¢</span>
</span></span><span class="line"><span class="cl">    <span class="n">forward_visited</span> <span class="o">=</span> <span class="p">{</span><span class="n">start</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">forward_queue</span> <span class="o">=</span> <span class="n">deque</span><span class="p">([</span><span class="n">start</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># åå‘æœç´¢</span>
</span></span><span class="line"><span class="cl">    <span class="n">backward_visited</span> <span class="o">=</span> <span class="p">{</span><span class="n">target</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">backward_queue</span> <span class="o">=</span> <span class="n">deque</span><span class="p">([</span><span class="n">target</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">forward_queue</span> <span class="ow">or</span> <span class="n">backward_queue</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># å‰å‘æœç´¢ä¸€æ­¥</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">forward_queue</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">current</span> <span class="o">=</span> <span class="n">forward_queue</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="n">current_dist</span> <span class="o">=</span> <span class="n">forward_visited</span><span class="p">[</span><span class="n">current</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">neighbor</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="p">[]):</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">neighbor</span> <span class="ow">in</span> <span class="n">backward_visited</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="k">return</span> <span class="n">current_dist</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">backward_visited</span><span class="p">[</span><span class="n">neighbor</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">neighbor</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">forward_visited</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">forward_visited</span><span class="p">[</span><span class="n">neighbor</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_dist</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">                    <span class="n">forward_queue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">neighbor</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># åå‘æœç´¢ä¸€æ­¥</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">backward_queue</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">current</span> <span class="o">=</span> <span class="n">backward_queue</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="n">current_dist</span> <span class="o">=</span> <span class="n">backward_visited</span><span class="p">[</span><span class="n">current</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">neighbor</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="p">[]):</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">neighbor</span> <span class="ow">in</span> <span class="n">forward_visited</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="k">return</span> <span class="n">current_dist</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">forward_visited</span><span class="p">[</span><span class="n">neighbor</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">neighbor</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">backward_visited</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">backward_visited</span><span class="p">[</span><span class="n">neighbor</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_dist</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">                    <span class="n">backward_queue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">neighbor</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>  <span class="c1"># æ— æ³•åˆ°è¾¾</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="n">distance</span> <span class="o">=</span> <span class="n">bidirectional_bfs</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;åŒå‘BFSæœ€çŸ­è·ç¦»: </span><span class="si">{</span><span class="n">distance</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="2-è®°å¿†åŒ–dfs">2. è®°å¿†åŒ–DFS</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">dfs_with_memoization</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">memo</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    å¸¦è®°å¿†åŒ–çš„DFSï¼Œé¿å…é‡å¤è®¡ç®—
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Args:
</span></span></span><span class="line"><span class="cl"><span class="s2">        graph: å›¾çš„é‚»æ¥è¡¨
</span></span></span><span class="line"><span class="cl"><span class="s2">        start: èµ·å§‹èŠ‚ç‚¹
</span></span></span><span class="line"><span class="cl"><span class="s2">        target: ç›®æ ‡èŠ‚ç‚¹
</span></span></span><span class="line"><span class="cl"><span class="s2">        memo: è®°å¿†åŒ–å­—å…¸
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Returns:
</span></span></span><span class="line"><span class="cl"><span class="s2">        bool: æ˜¯å¦èƒ½åˆ°è¾¾ç›®æ ‡èŠ‚ç‚¹
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">memo</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">memo</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">start</span> <span class="o">==</span> <span class="n">target</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">start</span> <span class="ow">in</span> <span class="n">memo</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">memo</span><span class="p">[</span><span class="n">start</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">memo</span><span class="p">[</span><span class="n">start</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># é˜²æ­¢ç¯è·¯</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">neighbor</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="p">[]):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">dfs_with_memoization</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">neighbor</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">memo</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">memo</span><span class="p">[</span><span class="n">start</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="n">can_reach</span> <span class="o">=</span> <span class="n">dfs_with_memoization</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;èƒ½å¦ä»Aåˆ°è¾¾F: </span><span class="si">{</span><span class="n">can_reach</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="å®é™…åº”ç”¨æ¡ˆä¾‹">å®é™…åº”ç”¨æ¡ˆä¾‹</h2>
<h3 id="1-ç¤¾äº¤ç½‘ç»œåˆ†æ">1. ç¤¾äº¤ç½‘ç»œåˆ†æ</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">SocialNetwork</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;ç¤¾äº¤ç½‘ç»œåˆ†æç³»ç»Ÿ&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">friends</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># å¥½å‹å…³ç³»å›¾</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">add_friendship</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">person1</span><span class="p">,</span> <span class="n">person2</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;æ·»åŠ å¥½å‹å…³ç³»&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">person1</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">friends</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">friends</span><span class="p">[</span><span class="n">person1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">person2</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">friends</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">friends</span><span class="p">[</span><span class="n">person2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">friends</span><span class="p">[</span><span class="n">person1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">person2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">friends</span><span class="p">[</span><span class="n">person2</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">person1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">find_mutual_friends</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">person1</span><span class="p">,</span> <span class="n">person2</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;æŸ¥æ‰¾å…±åŒå¥½å‹&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">friends1</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">friends</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">person1</span><span class="p">,</span> <span class="p">[]))</span>
</span></span><span class="line"><span class="cl">        <span class="n">friends2</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">friends</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">person2</span><span class="p">,</span> <span class="p">[]))</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">friends1</span> <span class="o">&amp;</span> <span class="n">friends2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">shortest_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">person1</span><span class="p">,</span> <span class="n">person2</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;æŸ¥æ‰¾æœ€çŸ­ç¤¾äº¤è·ç¦»&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">bfs_shortest_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">friends</span><span class="p">,</span> <span class="n">person1</span><span class="p">,</span> <span class="n">person2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">find_communities</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;ä½¿ç”¨DFSæŸ¥æ‰¾ç¤¾äº¤ç¾¤ä½“&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">visited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">communities</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">def</span> <span class="nf">dfs_community</span><span class="p">(</span><span class="n">person</span><span class="p">,</span> <span class="n">community</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">person</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">community</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">person</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">friend</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">friends</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">person</span><span class="p">,</span> <span class="p">[]):</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">friend</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">dfs_community</span><span class="p">(</span><span class="n">friend</span><span class="p">,</span> <span class="n">community</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">person</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">friends</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">person</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">community</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">                <span class="n">dfs_community</span><span class="p">(</span><span class="n">person</span><span class="p">,</span> <span class="n">community</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">communities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">community</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">communities</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="n">social_net</span> <span class="o">=</span> <span class="n">SocialNetwork</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">social_net</span><span class="o">.</span><span class="n">add_friendship</span><span class="p">(</span><span class="s2">&#34;Alice&#34;</span><span class="p">,</span> <span class="s2">&#34;Bob&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">social_net</span><span class="o">.</span><span class="n">add_friendship</span><span class="p">(</span><span class="s2">&#34;Bob&#34;</span><span class="p">,</span> <span class="s2">&#34;Charlie&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">social_net</span><span class="o">.</span><span class="n">add_friendship</span><span class="p">(</span><span class="s2">&#34;Alice&#34;</span><span class="p">,</span> <span class="s2">&#34;David&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">social_net</span><span class="o">.</span><span class="n">add_friendship</span><span class="p">(</span><span class="s2">&#34;Eve&#34;</span><span class="p">,</span> <span class="s2">&#34;Frank&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;å…±åŒå¥½å‹:&#34;</span><span class="p">,</span> <span class="n">social_net</span><span class="o">.</span><span class="n">find_mutual_friends</span><span class="p">(</span><span class="s2">&#34;Alice&#34;</span><span class="p">,</span> <span class="s2">&#34;Charlie&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">distance</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span> <span class="n">social_net</span><span class="o">.</span><span class="n">shortest_connection</span><span class="p">(</span><span class="s2">&#34;Alice&#34;</span><span class="p">,</span> <span class="s2">&#34;Charlie&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;ç¤¾äº¤è·ç¦»: </span><span class="si">{</span><span class="n">distance</span><span class="si">}</span><span class="s2">, è·¯å¾„: </span><span class="si">{</span><span class="s1">&#39; -&gt; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;ç¤¾äº¤ç¾¤ä½“:&#34;</span><span class="p">,</span> <span class="n">social_net</span><span class="o">.</span><span class="n">find_communities</span><span class="p">())</span>
</span></span></code></pre></div><h3 id="2-è¿·å®«æ±‚è§£">2. è¿·å®«æ±‚è§£</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">MazeSolver</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;è¿·å®«æ±‚è§£å™¨&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maze</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">maze</span> <span class="o">=</span> <span class="n">maze</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">maze</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">cols</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">maze</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">directions</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">solve_bfs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;ä½¿ç”¨BFSæ±‚è§£æœ€çŸ­è·¯å¾„&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">queue</span> <span class="o">=</span> <span class="n">deque</span><span class="p">([(</span><span class="n">start</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">start</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[(</span><span class="n">start</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">start</span><span class="p">[</span><span class="mi">1</span><span class="p">])])])</span>
</span></span><span class="line"><span class="cl">        <span class="n">visited</span> <span class="o">=</span> <span class="p">{</span><span class="n">start</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="n">queue</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="o">==</span> <span class="n">end</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="n">path</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">dr</span><span class="p">,</span> <span class="n">dc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">directions</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">nr</span><span class="p">,</span> <span class="n">nc</span> <span class="o">=</span> <span class="n">r</span> <span class="o">+</span> <span class="n">dr</span><span class="p">,</span> <span class="n">c</span> <span class="o">+</span> <span class="n">dc</span>
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">nr</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">nc</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">cols</span> <span class="ow">and</span>
</span></span><span class="line"><span class="cl">                    <span class="p">(</span><span class="n">nr</span><span class="p">,</span> <span class="n">nc</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">maze</span><span class="p">[</span><span class="n">nr</span><span class="p">][</span><span class="n">nc</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                    <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">nr</span><span class="p">,</span> <span class="n">nc</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                    <span class="n">queue</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">nr</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span> <span class="n">path</span> <span class="o">+</span> <span class="p">[(</span><span class="n">nr</span><span class="p">,</span> <span class="n">nc</span><span class="p">)]))</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">solve_dfs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">visited</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;ä½¿ç”¨DFSæ±‚è§£è·¯å¾„&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">path</span> <span class="o">=</span> <span class="p">[</span><span class="n">start</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">visited</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">visited</span> <span class="o">=</span> <span class="p">{</span><span class="n">start</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">start</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">start</span> <span class="o">==</span> <span class="n">end</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">path</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">dr</span><span class="p">,</span> <span class="n">dc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">directions</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">nr</span><span class="p">,</span> <span class="n">nc</span> <span class="o">=</span> <span class="n">r</span> <span class="o">+</span> <span class="n">dr</span><span class="p">,</span> <span class="n">c</span> <span class="o">+</span> <span class="n">dc</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">nr</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">nc</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">cols</span> <span class="ow">and</span>
</span></span><span class="line"><span class="cl">                <span class="p">(</span><span class="n">nr</span><span class="p">,</span> <span class="n">nc</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">maze</span><span class="p">[</span><span class="n">nr</span><span class="p">][</span><span class="n">nc</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">nr</span><span class="p">,</span> <span class="n">nc</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">solve_dfs</span><span class="p">((</span><span class="n">nr</span><span class="p">,</span> <span class="n">nc</span><span class="p">),</span> <span class="n">end</span><span class="p">,</span> <span class="n">path</span> <span class="o">+</span> <span class="p">[(</span><span class="n">nr</span><span class="p">,</span> <span class="n">nc</span><span class="p">)],</span> <span class="n">visited</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="k">return</span> <span class="n">result</span>
</span></span><span class="line"><span class="cl">                <span class="n">visited</span><span class="o">.</span><span class="n">remove</span><span class="p">((</span><span class="n">nr</span><span class="p">,</span> <span class="n">nc</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹è¿·å®«ï¼š0è¡¨ç¤ºé€šè·¯ï¼Œ1è¡¨ç¤ºå¢™å£</span>
</span></span><span class="line"><span class="cl"><span class="n">maze</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">solver</span> <span class="o">=</span> <span class="n">MazeSolver</span><span class="p">(</span><span class="n">maze</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">start</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">end</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">bfs_path</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">solve_bfs</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">dfs_path</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">solve_dfs</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;BFSè·¯å¾„:&#34;</span><span class="p">,</span> <span class="n">bfs_path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;DFSè·¯å¾„:&#34;</span><span class="p">,</span> <span class="n">dfs_path</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="å­¦ä¹ å»ºè®®å’Œæ€»ç»“">å­¦ä¹ å»ºè®®å’Œæ€»ç»“</h2>
<h3 id="å­¦ä¹ è·¯å¾„">å­¦ä¹ è·¯å¾„</h3>
<ol>
<li><strong>ç†è§£åŸºæœ¬æ¦‚å¿µ</strong>ï¼šæŒæ¡BFSå’ŒDFSçš„æ ¸å¿ƒæ€æƒ³</li>
<li><strong>ç†Ÿç»ƒå®ç°</strong>ï¼šèƒ½å¤Ÿç”¨é€’å½’å’Œè¿­ä»£ä¸¤ç§æ–¹å¼å®ç°</li>
<li><strong>åº”ç”¨ç»ƒä¹ </strong>ï¼šé€šè¿‡ç»å…¸é—®é¢˜åŠ æ·±ç†è§£</li>
<li><strong>ä¼˜åŒ–æŠ€å·§</strong>ï¼šå­¦ä¹ åŒå‘æœç´¢ã€è®°å¿†åŒ–ç­‰ä¼˜åŒ–æ–¹æ³•</li>
<li><strong>å®é™…åº”ç”¨</strong>ï¼šå°†ç®—æ³•åº”ç”¨åˆ°å®é™…é—®é¢˜ä¸­</li>
</ol>
<h3 id="å…³é”®è¦ç‚¹">å…³é”®è¦ç‚¹</h3>
<table>
  <thead>
      <tr>
          <th>è¦ç‚¹</th>
          <th>BFS</th>
          <th>DFS</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>ä½•æ—¶ä½¿ç”¨</strong></td>
          <td>æœ€çŸ­è·¯å¾„ã€å±‚æ¬¡é—®é¢˜</td>
          <td>è·¯å¾„æœç´¢ã€å›æº¯é—®é¢˜</td>
      </tr>
      <tr>
          <td><strong>å®ç°æ–¹å¼</strong></td>
          <td>é˜Ÿåˆ— + è¿­ä»£</td>
          <td>æ ˆ/é€’å½’</td>
      </tr>
      <tr>
          <td><strong>ç©ºé—´å¤æ‚åº¦</strong></td>
          <td>å¯èƒ½è¾ƒé«˜</td>
          <td>ç›¸å¯¹è¾ƒä½</td>
      </tr>
      <tr>
          <td><strong>è·¯å¾„ç‰¹æ€§</strong></td>
          <td>æœ€çŸ­è·¯å¾„</td>
          <td>ä»»æ„è·¯å¾„</td>
      </tr>
  </tbody>
</table>
<h3 id="å¸¸è§åº”ç”¨é¢†åŸŸ">å¸¸è§åº”ç”¨é¢†åŸŸ</h3>
<ul>
<li><strong>å›¾è®ºç®—æ³•</strong>ï¼šè¿é€šæ€§æ£€æµ‹ã€æœ€çŸ­è·¯å¾„ã€æ‹“æ‰‘æ’åº</li>
<li><strong>æ ‘éå†</strong>ï¼šå‰åºã€ä¸­åºã€ååºã€å±‚åºéå†</li>
<li><strong>æ¸¸æˆå¼€å‘</strong>ï¼šè·¯å¾„è§„åˆ’ã€AIå†³ç­–</li>
<li><strong>ç½‘ç»œåˆ†æ</strong>ï¼šç¤¾äº¤ç½‘ç»œã€ç½‘é¡µçˆ¬è™«</li>
<li><strong>äººå·¥æ™ºèƒ½</strong>ï¼šçŠ¶æ€ç©ºé—´æœç´¢ã€é—®é¢˜æ±‚è§£</li>
</ul>
<p>æœç´¢ç®—æ³•æ˜¯è®¡ç®—æœºç§‘å­¦çš„åŸºç¡€ï¼ŒæŒæ¡BFSå’ŒDFSä¸ä»…æœ‰åŠ©äºè§£å†³å…·ä½“é—®é¢˜ï¼Œæ›´é‡è¦çš„æ˜¯åŸ¹å…»ç®—æ³•æ€ç»´å’Œé—®é¢˜åˆ†æèƒ½åŠ›ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¦æ ¹æ®é—®é¢˜ç‰¹ç‚¹é€‰æ‹©åˆé€‚çš„æœç´¢ç­–ç•¥ï¼Œå¹¶è€ƒè™‘æ€§èƒ½ä¼˜åŒ–ã€‚</p>
]]></content:encoded>
    </item>
    <item>
      <title>é€’å½’ä¸åˆ†æ²»ç®—æ³•è¯¦è§£</title>
      <link>https://tyhzxh.github.io/posts/recursion-and-divide-conquer/</link>
      <pubDate>Tue, 27 Feb 2024 22:03:04 +0800</pubDate>
      <guid>https://tyhzxh.github.io/posts/recursion-and-divide-conquer/</guid>
      <description>æ·±å…¥è§£æé€’å½’ä¸åˆ†æ²»ç®—æ³•çš„æ ¸å¿ƒæ€æƒ³ï¼Œä»¥ç»å…¸æ±‰è¯ºå¡”é—®é¢˜ä¸ºä¾‹ï¼Œè¯¦ç»†è®²è§£é€’å½’ç®—æ³•çš„è®¾è®¡æ€è·¯å’Œå®ç°æ–¹æ³•</description>
      <content:encoded><![CDATA[<h2 id="é€’å½’ç®—æ³•æ¦‚è¿°">é€’å½’ç®—æ³•æ¦‚è¿°</h2>
<p>é€’å½’æ˜¯ä¸€ç§é‡è¦çš„ç®—æ³•è®¾è®¡æ€æƒ³ï¼Œå®ƒå°†å¤æ‚é—®é¢˜åˆ†è§£ä¸ºè§„æ¨¡æ›´å°çš„åŒç±»å­é—®é¢˜æ¥è§£å†³ã€‚é€’å½’ç®—æ³•çš„æ ¸å¿ƒåœ¨äºæ‰¾åˆ°é—®é¢˜çš„<strong>é€’å½’å…³ç³»</strong>å’Œ<strong>è¾¹ç•Œæ¡ä»¶</strong>ã€‚</p>
<h2 id="ç»å…¸æ±‰è¯ºå¡”é—®é¢˜">ç»å…¸æ±‰è¯ºå¡”é—®é¢˜</h2>
<p>æ±‰è¯ºå¡”æ˜¯å­¦ä¹ é€’å½’ç®—æ³•çš„ç»å…¸é—®é¢˜ã€‚è¿™ä¸ªé—®é¢˜çœ‹ä¼¼ç®€å•ï¼Œä½†è•´å«ç€æ·±åˆ»çš„é€’å½’æ€æƒ³ã€‚</p>
<h3 id="é—®é¢˜æè¿°">é—®é¢˜æè¿°</h3>
<p>æœ‰ä¸‰æ ¹æŸ±å­Aã€Bã€Cï¼Œnä¸ªåœ†ç›˜ä»ä¸‹é¢å¼€å§‹æŒ‰å¤§å°é¡ºåºæ‘†æ”¾åœ¨AæŸ±å­ä¸Šã€‚è§„åˆ™å¦‚ä¸‹ï¼š</p>
<ol>
<li>ä»»ä½•æ—¶å€™ï¼Œå°åœ†ç›˜ä¸Šéƒ½ä¸èƒ½æ”¾å¤§åœ†ç›˜</li>
<li>ä¸‰æ ¹æŸ±å­ä¹‹é—´ä¸€æ¬¡åªèƒ½ç§»åŠ¨ä¸€ä¸ªåœ†ç›˜</li>
<li>æ±‚å°†æ‰€æœ‰åœ†ç›˜ä»AæŸ±ç§»åŠ¨åˆ°CæŸ±çš„æœ€å°‘ç§»åŠ¨æ­¥éª¤</li>
</ol>
<h3 id="é€’å½’è§£æ³•">é€’å½’è§£æ³•</h3>
<h4 id="æ ¸å¿ƒæ€æƒ³">æ ¸å¿ƒæ€æƒ³</h4>
<p>è¦å°†nä¸ªç›˜å­ä»Aç§»åŠ¨åˆ°Cï¼Œå¯ä»¥åˆ†è§£ä¸ºä¸‰ä¸ªæ­¥éª¤ï¼š</p>
<ol>
<li>å°†ä¸Šé¢çš„n-1ä¸ªç›˜å­ä»Aç§»åŠ¨åˆ°Bï¼ˆä»¥Cä¸ºè¾…åŠ©ï¼‰</li>
<li>å°†æœ€å¤§çš„ç›˜å­ä»Aç§»åŠ¨åˆ°C</li>
<li>å°†n-1ä¸ªç›˜å­ä»Bç§»åŠ¨åˆ°Cï¼ˆä»¥Aä¸ºè¾…åŠ©ï¼‰</li>
</ol>
<h4 id="é€’å½’å…¬å¼">é€’å½’å…¬å¼</h4>
<pre tabindex="0"><code>Hanoi(A, C, B, n) = Hanoi(A, B, C, n-1) + move(A, C, n) + Hanoi(B, C, A, n-1)
</code></pre><p>å…¶ä¸­ï¼š</p>
<ul>
<li><code>Hanoi(A, C, B, n)</code> è¡¨ç¤ºå°†nä¸ªç›˜å­ä»AæŸ±ç§»åŠ¨åˆ°CæŸ±ï¼ŒBæŸ±ä½œä¸ºè¾…åŠ©</li>
<li><code>move(A, C, n)</code> è¡¨ç¤ºå°†ç¼–å·ä¸ºnçš„ç›˜å­ä»Aç§»åŠ¨åˆ°C</li>
</ul>
<h4 id="ä»£ç å®ç°">ä»£ç å®ç°</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">move</span><span class="p">(</span><span class="kt">char</span> <span class="n">from</span><span class="p">,</span> <span class="kt">char</span> <span class="n">to</span><span class="p">,</span> <span class="kt">int</span> <span class="n">disk</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;ç§»åŠ¨ç›˜å­ &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">disk</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;: &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">from</span> <span class="o">&lt;&lt;</span> <span class="s">&#34; --&gt; &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">to</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">hanoi</span><span class="p">(</span><span class="kt">char</span> <span class="n">from</span><span class="p">,</span> <span class="kt">char</span> <span class="n">to</span><span class="p">,</span> <span class="kt">char</span> <span class="n">aux</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// è¾¹ç•Œæ¡ä»¶ï¼šåªæœ‰ä¸€ä¸ªç›˜å­æ—¶ï¼Œç›´æ¥ç§»åŠ¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">move</span><span class="p">(</span><span class="n">from</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// é€’å½’æ­¥éª¤1ï¼šå°†ä¸Šé¢n-1ä¸ªç›˜å­ç§»åŠ¨åˆ°è¾…åŠ©æŸ±
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">hanoi</span><span class="p">(</span><span class="n">from</span><span class="p">,</span> <span class="n">aux</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">// é€’å½’æ­¥éª¤2ï¼šç§»åŠ¨æœ€å¤§çš„ç›˜å­
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">move</span><span class="p">(</span><span class="n">from</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">// é€’å½’æ­¥éª¤3ï¼šå°†n-1ä¸ªç›˜å­ä»è¾…åŠ©æŸ±ç§»åŠ¨åˆ°ç›®æ ‡æŸ±
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">hanoi</span><span class="p">(</span><span class="n">aux</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">from</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;è¯·è¾“å…¥ç›˜å­æ•°é‡: &#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;æ±‰è¯ºå¡”ç§»åŠ¨æ­¥éª¤ï¼š&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">hanoi</span><span class="p">(</span><span class="sc">&#39;A&#39;</span><span class="p">,</span> <span class="sc">&#39;C&#39;</span><span class="p">,</span> <span class="sc">&#39;B&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h4 id="pythonç‰ˆæœ¬å®ç°">Pythonç‰ˆæœ¬å®ç°</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">move</span><span class="p">(</span><span class="n">from_pole</span><span class="p">,</span> <span class="n">to_pole</span><span class="p">,</span> <span class="n">disk</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;ç§»åŠ¨å•ä¸ªç›˜å­&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;ç§»åŠ¨ç›˜å­ </span><span class="si">{</span><span class="n">disk</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">from_pole</span><span class="si">}</span><span class="s2"> --&gt; </span><span class="si">{</span><span class="n">to_pole</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">hanoi</span><span class="p">(</span><span class="n">from_pole</span><span class="p">,</span> <span class="n">to_pole</span><span class="p">,</span> <span class="n">aux_pole</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    æ±‰è¯ºå¡”é€’å½’è§£æ³•
</span></span></span><span class="line"><span class="cl"><span class="s2">    from_pole: èµ·å§‹æŸ±
</span></span></span><span class="line"><span class="cl"><span class="s2">    to_pole: ç›®æ ‡æŸ±
</span></span></span><span class="line"><span class="cl"><span class="s2">    aux_pole: è¾…åŠ©æŸ±
</span></span></span><span class="line"><span class="cl"><span class="s2">    n: ç›˜å­æ•°é‡
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># è¾¹ç•Œæ¡ä»¶ï¼šåªæœ‰ä¸€ä¸ªç›˜å­æ—¶ï¼Œç›´æ¥ç§»åŠ¨</span>
</span></span><span class="line"><span class="cl">        <span class="n">move</span><span class="p">(</span><span class="n">from_pole</span><span class="p">,</span> <span class="n">to_pole</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># æ­¥éª¤1ï¼šå°†ä¸Šé¢n-1ä¸ªç›˜å­ç§»åŠ¨åˆ°è¾…åŠ©æŸ±</span>
</span></span><span class="line"><span class="cl">        <span class="n">hanoi</span><span class="p">(</span><span class="n">from_pole</span><span class="p">,</span> <span class="n">aux_pole</span><span class="p">,</span> <span class="n">to_pole</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># æ­¥éª¤2ï¼šç§»åŠ¨æœ€å¤§çš„ç›˜å­åˆ°ç›®æ ‡æŸ±</span>
</span></span><span class="line"><span class="cl">        <span class="n">move</span><span class="p">(</span><span class="n">from_pole</span><span class="p">,</span> <span class="n">to_pole</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># æ­¥éª¤3ï¼šå°†n-1ä¸ªç›˜å­ä»è¾…åŠ©æŸ±ç§»åŠ¨åˆ°ç›®æ ‡æŸ±</span>
</span></span><span class="line"><span class="cl">        <span class="n">hanoi</span><span class="p">(</span><span class="n">aux_pole</span><span class="p">,</span> <span class="n">to_pole</span><span class="p">,</span> <span class="n">from_pole</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">count_moves</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;è®¡ç®—ç§»åŠ¨æ¬¡æ•°&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">2</span><span class="o">**</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&#34;è¯·è¾“å…¥ç›˜å­æ•°é‡: &#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="se">\n</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">ä¸ªç›˜å­çš„æ±‰è¯ºå¡”ç§»åŠ¨æ­¥éª¤ï¼š&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">hanoi</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">æ€»ç§»åŠ¨æ¬¡æ•°: </span><span class="si">{</span><span class="n">count_moves</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="é€’å½’çš„æœ¬è´¨ç†è§£">é€’å½’çš„æœ¬è´¨ç†è§£</h3>
<h4 id="1-é€’å½’æ˜¯ä¸€ç§æ ‘å½¢ç»“æ„">1. é€’å½’æ˜¯ä¸€ç§æ ‘å½¢ç»“æ„</h4>
<p>é€’å½’ç®—æ³•çš„æ‰§è¡Œè¿‡ç¨‹å¯ä»¥çœ‹ä½œæ˜¯ä¸€æ£µæ ‘ï¼š</p>
<ul>
<li>æ¯ä¸ªèŠ‚ç‚¹ä»£è¡¨ä¸€ä¸ªå­é—®é¢˜</li>
<li>å¶å­èŠ‚ç‚¹æ˜¯æœ€å°çš„å­é—®é¢˜ï¼ˆè¾¹ç•Œæ¡ä»¶ï¼‰</li>
<li>ä»æ ¹èŠ‚ç‚¹åˆ°å¶å­èŠ‚ç‚¹çš„è·¯å¾„å°±æ˜¯é—®é¢˜çš„åˆ†è§£è¿‡ç¨‹</li>
</ul>
<h4 id="2-æœ€å°åŒ–é—®é¢˜æ€æƒ³">2. æœ€å°åŒ–é—®é¢˜æ€æƒ³</h4>
<p>é€’å½’çš„æ ¸å¿ƒæ˜¯å°†å¤æ‚é—®é¢˜ä¸æ–­åˆ†è§£ï¼Œç›´åˆ°å˜æˆæœ€ç®€å•çš„æƒ…å†µï¼š</p>
<ul>
<li><strong>æœ€å°åŒ–é—®é¢˜</strong>ï¼šåªæœ‰ä¸€ä¸ªç›˜å­æ—¶ï¼Œç›´æ¥ç§»åŠ¨</li>
<li><strong>å­é—®é¢˜</strong>ï¼šå°†nä¸ªç›˜å­çš„é—®é¢˜åˆ†è§£ä¸ºä¸¤ä¸ªn-1ä¸ªç›˜å­çš„å­é—®é¢˜</li>
<li><strong>ç»„åˆè§£</strong>ï¼šå­é—®é¢˜çš„è§£ç»„åˆèµ·æ¥å°±æ˜¯åŸé—®é¢˜çš„è§£</li>
</ul>
<h4 id="3-é€’å½’ä¸‰è¦ç´ ">3. é€’å½’ä¸‰è¦ç´ </h4>
<ol>
<li><strong>é€’å½’å…³ç³»</strong>ï¼šå¤§é—®é¢˜å¦‚ä½•åˆ†è§£ä¸ºå°é—®é¢˜</li>
<li><strong>è¾¹ç•Œæ¡ä»¶</strong>ï¼šé€’å½’çš„ç»ˆæ­¢æ¡ä»¶</li>
<li><strong>é€’å½’å‡è®¾</strong>ï¼šå‡è®¾å­é—®é¢˜å·²ç»æ­£ç¡®è§£å†³</li>
</ol>
<h3 id="æ±‰è¯ºå¡”çš„è¿­ä»£è§£æ³•">æ±‰è¯ºå¡”çš„è¿­ä»£è§£æ³•</h3>
<p>é™¤äº†é€’å½’è§£æ³•ï¼Œæ±‰è¯ºå¡”è¿˜æœ‰åŸºäºäºŒè¿›åˆ¶çš„è¿­ä»£è§£æ³•ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">hanoi_iterative</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;æ±‰è¯ºå¡”çš„è¿­ä»£è§£æ³•&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">total_moves</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># å®šä¹‰æŸ±å­</span>
</span></span><span class="line"><span class="cl">    <span class="n">poles</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># æ ¹æ®nçš„å¥‡å¶æ€§ç¡®å®šç§»åŠ¨æ–¹å‘</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># nä¸ºå¶æ•°æ—¶ï¼ŒæŒ‰ A-&gt;B-&gt;C-&gt;A çš„é¡ºåº</span>
</span></span><span class="line"><span class="cl">        <span class="n">direction</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># nä¸ºå¥‡æ•°æ—¶ï¼ŒæŒ‰ A-&gt;C-&gt;B-&gt;A çš„é¡ºåº</span>
</span></span><span class="line"><span class="cl">        <span class="n">direction</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">total_moves</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># æ‰¾åˆ°äºŒè¿›åˆ¶è¡¨ç¤ºä¸­æœ€å³è¾¹çš„1çš„ä½ç½®</span>
</span></span><span class="line"><span class="cl">        <span class="n">disk</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">&amp;</span> <span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">bit_length</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># ç¡®å®šç§»åŠ¨æ–¹å‘</span>
</span></span><span class="line"><span class="cl">        <span class="n">from_pole</span> <span class="o">=</span> <span class="n">poles</span><span class="p">[(</span><span class="n">i</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="n">disk</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">%</span> <span class="mi">3</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">to_pole</span> <span class="o">=</span> <span class="n">poles</span><span class="p">[</span><span class="n">direction</span><span class="p">[(</span><span class="n">i</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="n">disk</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">%</span> <span class="mi">3</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;ç§»åŠ¨ç›˜å­ </span><span class="si">{</span><span class="n">disk</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">from_pole</span><span class="si">}</span><span class="s2"> --&gt; </span><span class="si">{</span><span class="n">to_pole</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;3ä¸ªç›˜å­çš„æ±‰è¯ºå¡”è¿­ä»£è§£æ³•ï¼š&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">hanoi_iterative</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="åˆ†æ²»ç®—æ³•æ€æƒ³">åˆ†æ²»ç®—æ³•æ€æƒ³</h2>
<p>åˆ†æ²»ç®—æ³•æ˜¯é€’å½’æ€æƒ³çš„é‡è¦åº”ç”¨ï¼Œå®ƒå°†é—®é¢˜åˆ†è§£ä¸ºè‹¥å¹²ä¸ªè§„æ¨¡è¾ƒå°çš„åŒç±»å­é—®é¢˜ï¼Œé€’å½’åœ°è§£å†³è¿™äº›å­é—®é¢˜ï¼Œç„¶ååˆå¹¶ç»“æœã€‚</p>
<h3 id="åˆ†æ²»ç®—æ³•çš„åŸºæœ¬æ­¥éª¤">åˆ†æ²»ç®—æ³•çš„åŸºæœ¬æ­¥éª¤</h3>
<ol>
<li><strong>åˆ†è§£ï¼ˆDivideï¼‰</strong>ï¼šå°†åŸé—®é¢˜åˆ†è§£ä¸ºè‹¥å¹²ä¸ªè§„æ¨¡è¾ƒå°çš„å­é—®é¢˜</li>
<li><strong>è§£å†³ï¼ˆConquerï¼‰</strong>ï¼šé€’å½’åœ°è§£å†³å„ä¸ªå­é—®é¢˜</li>
<li><strong>åˆå¹¶ï¼ˆCombineï¼‰</strong>ï¼šå°†å­é—®é¢˜çš„è§£åˆå¹¶ä¸ºåŸé—®é¢˜çš„è§£</li>
</ol>
<h3 id="ç»å…¸åˆ†æ²»ç®—æ³•ç¤ºä¾‹">ç»å…¸åˆ†æ²»ç®—æ³•ç¤ºä¾‹</h3>
<h4 id="å½’å¹¶æ’åº">å½’å¹¶æ’åº</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">merge_sort</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;å½’å¹¶æ’åº - åˆ†æ²»ç®—æ³•çš„ç»å…¸åº”ç”¨&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">arr</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># åˆ†è§£ï¼šå°†æ•°ç»„åˆ†ä¸ºä¸¤åŠ</span>
</span></span><span class="line"><span class="cl">    <span class="n">mid</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">    <span class="n">left</span> <span class="o">=</span> <span class="n">merge_sort</span><span class="p">(</span><span class="n">arr</span><span class="p">[:</span><span class="n">mid</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">right</span> <span class="o">=</span> <span class="n">merge_sort</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">mid</span><span class="p">:])</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># åˆå¹¶ï¼šå°†ä¸¤ä¸ªæœ‰åºæ•°ç»„åˆå¹¶</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;åˆå¹¶ä¸¤ä¸ªæœ‰åºæ•°ç»„&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">=</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">left</span><span class="p">)</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">right</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">left</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">right</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">left</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">right</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># æ·»åŠ å‰©ä½™å…ƒç´ </span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">left</span><span class="p">[</span><span class="n">i</span><span class="p">:])</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">right</span><span class="p">[</span><span class="n">j</span><span class="p">:])</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">result</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="n">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">64</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">90</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;åŸæ•°ç»„: </span><span class="si">{</span><span class="n">arr</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">sorted_arr</span> <span class="o">=</span> <span class="n">merge_sort</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;æ’åºå: </span><span class="si">{</span><span class="n">sorted_arr</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h4 id="å¿«é€Ÿå¹‚ç®—æ³•">å¿«é€Ÿå¹‚ç®—æ³•</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">quick_power</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">exp</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;å¿«é€Ÿå¹‚ç®—æ³• - åˆ†æ²»æ€æƒ³çš„åº”ç”¨&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">exp</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">exp</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">base</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># åˆ†è§£ï¼šå°†æŒ‡æ•°åˆ†ä¸ºä¸¤åŠ</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">exp</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">half</span> <span class="o">=</span> <span class="n">quick_power</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">exp</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">half</span> <span class="o">*</span> <span class="n">half</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">base</span> <span class="o">*</span> <span class="n">quick_power</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">exp</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">quick_power</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;2^10 = </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="é€’å½’ç®—æ³•çš„ä¼˜åŒ–">é€’å½’ç®—æ³•çš„ä¼˜åŒ–</h2>
<h3 id="1-è®°å¿†åŒ–é€’å½’">1. è®°å¿†åŒ–é€’å½’</h3>
<p>å¯¹äºæœ‰é‡å¤å­é—®é¢˜çš„é€’å½’ï¼Œå¯ä»¥ä½¿ç”¨è®°å¿†åŒ–æ¥é¿å…é‡å¤è®¡ç®—ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">fibonacci_memo</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">memo</span><span class="o">=</span><span class="p">{}):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;å¸¦è®°å¿†åŒ–çš„æ–æ³¢é‚£å¥‘æ•°åˆ—&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">memo</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">memo</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">n</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">memo</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">fibonacci_memo</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">memo</span><span class="p">)</span> <span class="o">+</span> <span class="n">fibonacci_memo</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">memo</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">memo</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;fibonacci(40) = </span><span class="si">{</span><span class="n">fibonacci_memo</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="2-å°¾é€’å½’ä¼˜åŒ–">2. å°¾é€’å½’ä¼˜åŒ–</h3>
<p>å°¾é€’å½’å¯ä»¥è¢«ç¼–è¯‘å™¨ä¼˜åŒ–ä¸ºå¾ªç¯ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">factorial_tail</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">acc</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;å°¾é€’å½’å®ç°é˜¶ä¹˜&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">acc</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">factorial_tail</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">acc</span> <span class="o">*</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;5! = </span><span class="si">{</span><span class="n">factorial_tail</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="é€’å½’ç®—æ³•çš„åº”ç”¨åœºæ™¯">é€’å½’ç®—æ³•çš„åº”ç”¨åœºæ™¯</h2>
<ol>
<li><strong>æ ‘å’Œå›¾çš„éå†</strong>ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢</li>
<li><strong>åˆ†æ²»ç®—æ³•</strong>ï¼šå½’å¹¶æ’åºã€å¿«é€Ÿæ’åº</li>
<li><strong>åŠ¨æ€è§„åˆ’</strong>ï¼šæœ€ä¼˜å­ç»“æ„é—®é¢˜</li>
<li><strong>å›æº¯ç®—æ³•</strong>ï¼šNçš‡åé—®é¢˜ã€æ•°ç‹¬æ±‚è§£</li>
<li><strong>æ•°å­¦è®¡ç®—</strong>ï¼šé˜¶ä¹˜ã€æ–æ³¢é‚£å¥‘æ•°åˆ—</li>
</ol>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>é€’å½’ä¸åˆ†æ²»æ˜¯ç®—æ³•è®¾è®¡ä¸­çš„é‡è¦æ€æƒ³ï¼š</p>
<h3 id="é€’å½’ç®—æ³•çš„ä¼˜ç‚¹">é€’å½’ç®—æ³•çš„ä¼˜ç‚¹</h3>
<ul>
<li>ä»£ç ç®€æ´ï¼Œé€»è¾‘æ¸…æ™°</li>
<li>è‡ªç„¶åœ°è¡¨è¾¾é—®é¢˜çš„é€’å½’ç»“æ„</li>
<li>æ˜“äºç†è§£å’Œå®ç°</li>
</ul>
<h3 id="é€’å½’ç®—æ³•çš„ç¼ºç‚¹">é€’å½’ç®—æ³•çš„ç¼ºç‚¹</h3>
<ul>
<li>å¯èƒ½å­˜åœ¨é‡å¤è®¡ç®—</li>
<li>ç©ºé—´å¤æ‚åº¦è¾ƒé«˜ï¼ˆå‡½æ•°è°ƒç”¨æ ˆï¼‰</li>
<li>å¯èƒ½å¯¼è‡´æ ˆæº¢å‡º</li>
</ul>
<h3 id="ä½¿ç”¨å»ºè®®">ä½¿ç”¨å»ºè®®</h3>
<ol>
<li>æ˜ç¡®é€’å½’å…³ç³»å’Œè¾¹ç•Œæ¡ä»¶</li>
<li>è€ƒè™‘æ˜¯å¦å­˜åœ¨é‡å¤å­é—®é¢˜</li>
<li>æ³¨æ„é€’å½’æ·±åº¦ï¼Œé¿å…æ ˆæº¢å‡º</li>
<li>å¿…è¦æ—¶ä½¿ç”¨è®°å¿†åŒ–æˆ–æ”¹ä¸ºè¿­ä»£å®ç°</li>
</ol>
<p>æŒæ¡é€’å½’ä¸åˆ†æ²»æ€æƒ³å¯¹äºç®—æ³•å­¦ä¹ å’Œé—®é¢˜è§£å†³éƒ½å…·æœ‰é‡è¦æ„ä¹‰ï¼Œå®ƒä»¬æ˜¯è®¸å¤šé«˜çº§ç®—æ³•çš„åŸºç¡€ã€‚</p>
]]></content:encoded>
    </item>
    <item>
      <title>è´ªå¿ƒç®—æ³•è¯¦è§£ï¼šä»åŸºç¡€æ¦‚å¿µåˆ°ç»å…¸é—®é¢˜</title>
      <link>https://tyhzxh.github.io/posts/greedy-algorithm-guide/</link>
      <pubDate>Tue, 27 Feb 2024 22:02:23 +0800</pubDate>
      <guid>https://tyhzxh.github.io/posts/greedy-algorithm-guide/</guid>
      <description>æ·±å…¥è§£æè´ªå¿ƒç®—æ³•çš„æ ¸å¿ƒæ€æƒ³ã€è®¾è®¡åŸåˆ™å’Œåº”ç”¨åœºæ™¯ï¼Œé€šè¿‡ç»å…¸é—®é¢˜å®ä¾‹æŒæ¡è´ªå¿ƒç­–ç•¥çš„é€‰æ‹©å’Œè¯æ˜æ–¹æ³•ï¼ŒåŒ…æ‹¬æ´»åŠ¨é€‰æ‹©ã€èƒŒåŒ…é—®é¢˜ã€æœ€çŸ­è·¯å¾„ç­‰</description>
      <content:encoded><![CDATA[<h2 id="è´ªå¿ƒç®—æ³•æ¦‚è¿°">è´ªå¿ƒç®—æ³•æ¦‚è¿°</h2>
<p>**è´ªå¿ƒç®—æ³•ï¼ˆGreedy Algorithmï¼‰**æ˜¯ä¸€ç§åœ¨æ¯ä¸€æ­¥é€‰æ‹©ä¸­éƒ½é‡‡å–åœ¨å½“å‰çŠ¶æ€ä¸‹æœ€å¥½æˆ–æœ€ä¼˜ï¼ˆå³æœ€æœ‰åˆ©ï¼‰çš„é€‰æ‹©ï¼Œä»è€Œå¸Œæœ›å¯¼è‡´ç»“æœæ˜¯æœ€å¥½æˆ–æœ€ä¼˜çš„ç®—æ³•ã€‚è´ªå¿ƒç®—æ³•åœ¨ç®—æ³•ç«èµ›å’Œå®é™…å·¥ç¨‹ä¸­éƒ½æœ‰ç€é‡è¦çš„åœ°ä½ã€‚</p>
<h2 id="è´ªå¿ƒç®—æ³•çš„æ ¸å¿ƒæ€æƒ³">è´ªå¿ƒç®—æ³•çš„æ ¸å¿ƒæ€æƒ³</h2>
<h3 id="åŸºæœ¬åŸç†">åŸºæœ¬åŸç†</h3>
<p>è´ªå¿ƒç®—æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š</p>
<ol>
<li><strong>å±€éƒ¨æœ€ä¼˜é€‰æ‹©</strong>ï¼šåœ¨æ¯ä¸€æ­¥éƒ½åšå‡ºå½“å‰çœ‹èµ·æ¥æœ€ä¼˜çš„é€‰æ‹©</li>
<li><strong>ä¸å›æº¯</strong>ï¼šä¸€æ—¦åšå‡ºé€‰æ‹©ï¼Œå°±ä¸å†æ”¹å˜</li>
<li><strong>å¸Œæœ›å…¨å±€æœ€ä¼˜</strong>ï¼šé€šè¿‡å±€éƒ¨æœ€ä¼˜é€‰æ‹©è¾¾åˆ°å…¨å±€æœ€ä¼˜è§£</li>
</ol>
<h3 id="è´ªå¿ƒé€‰æ‹©æ€§è´¨">è´ªå¿ƒé€‰æ‹©æ€§è´¨</h3>
<p>ä¸€ä¸ªé—®é¢˜èƒ½å¤Ÿç”¨è´ªå¿ƒç®—æ³•è§£å†³ï¼Œå¿…é¡»å…·å¤‡ä»¥ä¸‹æ€§è´¨ï¼š</p>
<table>
  <thead>
      <tr>
          <th>æ€§è´¨</th>
          <th>æè¿°</th>
          <th>é‡è¦æ€§</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>è´ªå¿ƒé€‰æ‹©æ€§è´¨</strong></td>
          <td>é€šè¿‡å±€éƒ¨æœ€ä¼˜é€‰æ‹©èƒ½è¾¾åˆ°å…¨å±€æœ€ä¼˜</td>
          <td>æ ¸å¿ƒæ€§è´¨</td>
      </tr>
      <tr>
          <td><strong>æœ€ä¼˜å­ç»“æ„</strong></td>
          <td>é—®é¢˜çš„æœ€ä¼˜è§£åŒ…å«å­é—®é¢˜çš„æœ€ä¼˜è§£</td>
          <td>å¿…è¦æ¡ä»¶</td>
      </tr>
      <tr>
          <td><strong>æ— åæ•ˆæ€§</strong></td>
          <td>å½“å‰é€‰æ‹©ä¸å½±å“ä¹‹å‰çš„é€‰æ‹©</td>
          <td>ä¿è¯æ­£ç¡®æ€§</td>
      </tr>
  </tbody>
</table>
<h2 id="è´ªå¿ƒç®—æ³•è®¾è®¡æ­¥éª¤">è´ªå¿ƒç®—æ³•è®¾è®¡æ­¥éª¤</h2>
<h3 id="1-é—®é¢˜åˆ†æ">1. é—®é¢˜åˆ†æ</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">greedy_algorithm_template</span><span class="p">(</span><span class="n">problem_input</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    è´ªå¿ƒç®—æ³•é€šç”¨æ¨¡æ¿
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># æ­¥éª¤1ï¼šå°†é—®é¢˜åˆ†è§£ä¸ºå­é—®é¢˜</span>
</span></span><span class="line"><span class="cl">    <span class="n">subproblems</span> <span class="o">=</span> <span class="n">decompose_problem</span><span class="p">(</span><span class="n">problem_input</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># æ­¥éª¤2ï¼šç¡®å®šè´ªå¿ƒç­–ç•¥</span>
</span></span><span class="line"><span class="cl">    <span class="n">strategy</span> <span class="o">=</span> <span class="n">define_greedy_strategy</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># æ­¥éª¤3ï¼šæŒ‰è´ªå¿ƒç­–ç•¥æ’åº</span>
</span></span><span class="line"><span class="cl">    <span class="n">sorted_items</span> <span class="o">=</span> <span class="n">sort_by_strategy</span><span class="p">(</span><span class="n">subproblems</span><span class="p">,</span> <span class="n">strategy</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># æ­¥éª¤4ï¼šé€æ­¥æ„é€ è§£</span>
</span></span><span class="line"><span class="cl">    <span class="n">solution</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sorted_items</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">is_feasible</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">solution</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">solution</span>
</span></span></code></pre></div><h3 id="2-è´ªå¿ƒç­–ç•¥é€‰æ‹©">2. è´ªå¿ƒç­–ç•¥é€‰æ‹©</h3>
<p>å¸¸è§çš„è´ªå¿ƒç­–ç•¥åŒ…æ‹¬ï¼š</p>
<table>
  <thead>
      <tr>
          <th>ç­–ç•¥ç±»å‹</th>
          <th>æè¿°</th>
          <th>é€‚ç”¨åœºæ™¯</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>æœ€å¤§ä¼˜å…ˆ</strong></td>
          <td>ä¼˜å…ˆé€‰æ‹©æœ€å¤§å€¼</td>
          <td>æœ€å¤§æ”¶ç›Šé—®é¢˜</td>
      </tr>
      <tr>
          <td><strong>æœ€å°ä¼˜å…ˆ</strong></td>
          <td>ä¼˜å…ˆé€‰æ‹©æœ€å°å€¼</td>
          <td>æœ€å°æˆæœ¬é—®é¢˜</td>
      </tr>
      <tr>
          <td><strong>æ¯”å€¼ä¼˜å…ˆ</strong></td>
          <td>æŒ‰æŸç§æ¯”å€¼æ’åº</td>
          <td>æ•ˆç‡ä¼˜åŒ–é—®é¢˜</td>
      </tr>
      <tr>
          <td><strong>æˆªæ­¢æ—¶é—´ä¼˜å…ˆ</strong></td>
          <td>æŒ‰æ—¶é—´æ’åº</td>
          <td>è°ƒåº¦é—®é¢˜</td>
      </tr>
  </tbody>
</table>
<h2 id="ç»å…¸è´ªå¿ƒç®—æ³•é—®é¢˜">ç»å…¸è´ªå¿ƒç®—æ³•é—®é¢˜</h2>
<h3 id="1-æ´»åŠ¨é€‰æ‹©é—®é¢˜">1. æ´»åŠ¨é€‰æ‹©é—®é¢˜</h3>
<h4 id="é—®é¢˜æè¿°">é—®é¢˜æè¿°</h4>
<p>ç»™å®šnä¸ªæ´»åŠ¨ï¼Œæ¯ä¸ªæ´»åŠ¨éƒ½æœ‰å¼€å§‹æ—¶é—´å’Œç»“æŸæ—¶é—´ï¼Œé€‰æ‹©æœ€å¤šçš„æ´»åŠ¨ä½¿å¾—å®ƒä»¬ä¸å†²çªã€‚</p>
<h4 id="è´ªå¿ƒç­–ç•¥">è´ªå¿ƒç­–ç•¥</h4>
<p><strong>æŒ‰ç»“æŸæ—¶é—´æ’åºï¼Œä¼˜å…ˆé€‰æ‹©ç»“æŸæ—¶é—´æœ€æ—©çš„æ´»åŠ¨</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">activity_selection</span><span class="p">(</span><span class="n">activities</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    æ´»åŠ¨é€‰æ‹©é—®é¢˜ - è´ªå¿ƒç®—æ³•
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Args:
</span></span></span><span class="line"><span class="cl"><span class="s2">        activities: [(start_time, end_time, activity_id), ...]
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Returns:
</span></span></span><span class="line"><span class="cl"><span class="s2">        selected_activities: é€‰ä¸­çš„æ´»åŠ¨åˆ—è¡¨
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># æŒ‰ç»“æŸæ—¶é—´æ’åº</span>
</span></span><span class="line"><span class="cl">    <span class="n">activities</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">selected</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">last_end_time</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">activity_id</span> <span class="ow">in</span> <span class="n">activities</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># å¦‚æœå½“å‰æ´»åŠ¨çš„å¼€å§‹æ—¶é—´ &gt;= ä¸Šä¸€ä¸ªæ´»åŠ¨çš„ç»“æŸæ—¶é—´</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">start</span> <span class="o">&gt;=</span> <span class="n">last_end_time</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">selected</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">activity_id</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="n">last_end_time</span> <span class="o">=</span> <span class="n">end</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">selected</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="n">activities</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">),</span>   <span class="c1"># æ´»åŠ¨A: 1-4</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span>   <span class="c1"># æ´»åŠ¨B: 3-5</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span>   <span class="c1"># æ´»åŠ¨C: 0-6</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">),</span>   <span class="c1"># æ´»åŠ¨D: 5-7</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">),</span>   <span class="c1"># æ´»åŠ¨E: 3-9</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">),</span>   <span class="c1"># æ´»åŠ¨F: 5-9</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span>  <span class="c1"># æ´»åŠ¨G: 6-10</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">),</span>  <span class="c1"># æ´»åŠ¨H: 8-11</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="s1">&#39;I&#39;</span><span class="p">),</span>  <span class="c1"># æ´»åŠ¨I: 8-12</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="s1">&#39;J&#39;</span><span class="p">),</span>  <span class="c1"># æ´»åŠ¨J: 2-14</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">)</span>  <span class="c1"># æ´»åŠ¨K: 12-16</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">activity_selection</span><span class="p">(</span><span class="n">activities</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;é€‰ä¸­çš„æ´»åŠ¨:&#34;</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># è¾“å‡º: [(1, 4, &#39;A&#39;), (5, 7, &#39;D&#39;), (8, 11, &#39;H&#39;), (12, 16, &#39;K&#39;)]</span>
</span></span></code></pre></div><h4 id="æ­£ç¡®æ€§è¯æ˜">æ­£ç¡®æ€§è¯æ˜</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">prove_activity_selection</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    æ´»åŠ¨é€‰æ‹©é—®é¢˜æ­£ç¡®æ€§è¯æ˜æ€è·¯ï¼š
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    1. è´ªå¿ƒé€‰æ‹©æ€§è´¨ï¼š
</span></span></span><span class="line"><span class="cl"><span class="s2">       - è®¾æœ€ä¼˜è§£ä¸ºOPTï¼Œè´ªå¿ƒè§£ä¸ºGREEDY
</span></span></span><span class="line"><span class="cl"><span class="s2">       - å¦‚æœOPTçš„ç¬¬ä¸€ä¸ªæ´»åŠ¨ä¸æ˜¯æœ€æ—©ç»“æŸçš„ï¼Œ
</span></span></span><span class="line"><span class="cl"><span class="s2">         å¯ä»¥æ›¿æ¢ä¸ºæœ€æ—©ç»“æŸçš„æ´»åŠ¨ï¼Œä¸ä¼šä½¿è§£å˜å·®
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    2. æœ€ä¼˜å­ç»“æ„ï¼š
</span></span></span><span class="line"><span class="cl"><span class="s2">       - é€‰æ‹©ç¬¬ä¸€ä¸ªæ´»åŠ¨åï¼Œå‰©ä½™é—®é¢˜ä»æ˜¯æ´»åŠ¨é€‰æ‹©é—®é¢˜
</span></span></span><span class="line"><span class="cl"><span class="s2">       - åŸé—®é¢˜çš„æœ€ä¼˜è§£ = ç¬¬ä¸€ä¸ªæ´»åŠ¨ + å­é—®é¢˜çš„æœ€ä¼˜è§£
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">pass</span>
</span></span></code></pre></div><h3 id="2-åˆ†æ•°èƒŒåŒ…é—®é¢˜">2. åˆ†æ•°èƒŒåŒ…é—®é¢˜</h3>
<h4 id="é—®é¢˜æè¿°-1">é—®é¢˜æè¿°</h4>
<p>æœ‰ä¸€ä¸ªå®¹é‡ä¸ºWçš„èƒŒåŒ…å’Œnä¸ªç‰©å“ï¼Œæ¯ä¸ªç‰©å“æœ‰é‡é‡å’Œä»·å€¼ï¼Œå¯ä»¥å–ç‰©å“çš„ä¸€éƒ¨åˆ†ï¼Œæ±‚æœ€å¤§ä»·å€¼ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">fractional_knapsack</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">capacity</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    åˆ†æ•°èƒŒåŒ…é—®é¢˜ - è´ªå¿ƒç®—æ³•
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Args:
</span></span></span><span class="line"><span class="cl"><span class="s2">        items: [(weight, value, item_id), ...]
</span></span></span><span class="line"><span class="cl"><span class="s2">        capacity: èƒŒåŒ…å®¹é‡
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Returns:
</span></span></span><span class="line"><span class="cl"><span class="s2">        (max_value, selected_items): æœ€å¤§ä»·å€¼å’Œé€‰ä¸­çš„ç‰©å“
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># æŒ‰ä»·å€¼å¯†åº¦ï¼ˆä»·å€¼/é‡é‡ï¼‰é™åºæ’åº</span>
</span></span><span class="line"><span class="cl">    <span class="n">items</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">total_value</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">selected_items</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">remaining_capacity</span> <span class="o">=</span> <span class="n">capacity</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">weight</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">item_id</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">remaining_capacity</span> <span class="o">&gt;=</span> <span class="n">weight</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># å®Œå…¨è£…å…¥</span>
</span></span><span class="line"><span class="cl">            <span class="n">selected_items</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">weight</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">item_id</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="n">total_value</span> <span class="o">+=</span> <span class="n">value</span>
</span></span><span class="line"><span class="cl">            <span class="n">remaining_capacity</span> <span class="o">-=</span> <span class="n">weight</span>
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="n">remaining_capacity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># éƒ¨åˆ†è£…å…¥</span>
</span></span><span class="line"><span class="cl">            <span class="n">fraction</span> <span class="o">=</span> <span class="n">remaining_capacity</span> <span class="o">/</span> <span class="n">weight</span>
</span></span><span class="line"><span class="cl">            <span class="n">selected_items</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">weight</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">item_id</span><span class="p">,</span> <span class="n">fraction</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="n">total_value</span> <span class="o">+=</span> <span class="n">value</span> <span class="o">*</span> <span class="n">fraction</span>
</span></span><span class="line"><span class="cl">            <span class="n">remaining_capacity</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">total_value</span><span class="p">,</span> <span class="n">selected_items</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="n">items</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">),</span>   <span class="c1"># ç‰©å“A: é‡é‡10, ä»·å€¼60, å¯†åº¦6.0</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span>  <span class="c1"># ç‰©å“B: é‡é‡20, ä»·å€¼100, å¯†åº¦5.0</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">)</span>   <span class="c1"># ç‰©å“C: é‡é‡30, ä»·å€¼120, å¯†åº¦4.0</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">max_value</span><span class="p">,</span> <span class="n">selected</span> <span class="o">=</span> <span class="n">fractional_knapsack</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;æœ€å¤§ä»·å€¼: </span><span class="si">{</span><span class="n">max_value</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;é€‰ä¸­çš„ç‰©å“:&#34;</span><span class="p">,</span> <span class="n">selected</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># è¾“å‡º: æœ€å¤§ä»·å€¼: 240.0</span>
</span></span><span class="line"><span class="cl"><span class="c1"># é€‰ä¸­çš„ç‰©å“: [(10, 60, &#39;A&#39;, 1.0), (20, 100, &#39;B&#39;, 1.0), (30, 120, &#39;C&#39;, 0.6667)]</span>
</span></span></code></pre></div><h3 id="3-å“ˆå¤«æ›¼ç¼–ç ">3. å“ˆå¤«æ›¼ç¼–ç </h3>
<h4 id="é—®é¢˜æè¿°-2">é—®é¢˜æè¿°</h4>
<p>ç»™å®šå­—ç¬¦é¢‘ç‡ï¼Œæ„é€ æœ€ä¼˜å‰ç¼€ç¼–ç ï¼Œä½¿å¾—ç¼–ç æ€»é•¿åº¦æœ€å°ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">heapq</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span><span class="p">,</span> <span class="n">Counter</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">HuffmanNode</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">char</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">char</span> <span class="o">=</span> <span class="n">char</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">freq</span> <span class="o">=</span> <span class="n">freq</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">left</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">right</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">freq</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">freq</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">huffman_encoding</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    å“ˆå¤«æ›¼ç¼–ç  - è´ªå¿ƒç®—æ³•
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Args:
</span></span></span><span class="line"><span class="cl"><span class="s2">        text: è¾“å…¥æ–‡æœ¬
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Returns:
</span></span></span><span class="line"><span class="cl"><span class="s2">        (encoded_text, huffman_tree, codes): ç¼–ç ç»“æœã€å“ˆå¤«æ›¼æ ‘ã€ç¼–ç è¡¨
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># ç»Ÿè®¡å­—ç¬¦é¢‘ç‡</span>
</span></span><span class="line"><span class="cl">    <span class="n">freq_map</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># åˆ›å»ºä¼˜å…ˆé˜Ÿåˆ—ï¼ˆæœ€å°å †ï¼‰</span>
</span></span><span class="line"><span class="cl">    <span class="n">heap</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">char</span><span class="p">,</span> <span class="n">freq</span> <span class="ow">in</span> <span class="n">freq_map</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">        <span class="n">heapq</span><span class="o">.</span><span class="n">heappush</span><span class="p">(</span><span class="n">heap</span><span class="p">,</span> <span class="n">HuffmanNode</span><span class="p">(</span><span class="n">char</span><span class="p">,</span> <span class="n">freq</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># æ„å»ºå“ˆå¤«æ›¼æ ‘</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">heap</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># å–å‡ºé¢‘ç‡æœ€å°çš„ä¸¤ä¸ªèŠ‚ç‚¹</span>
</span></span><span class="line"><span class="cl">        <span class="n">left</span> <span class="o">=</span> <span class="n">heapq</span><span class="o">.</span><span class="n">heappop</span><span class="p">(</span><span class="n">heap</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">right</span> <span class="o">=</span> <span class="n">heapq</span><span class="o">.</span><span class="n">heappop</span><span class="p">(</span><span class="n">heap</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># åˆ›å»ºæ–°çš„å†…éƒ¨èŠ‚ç‚¹</span>
</span></span><span class="line"><span class="cl">        <span class="n">merged</span> <span class="o">=</span> <span class="n">HuffmanNode</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">freq</span><span class="o">=</span><span class="n">left</span><span class="o">.</span><span class="n">freq</span> <span class="o">+</span> <span class="n">right</span><span class="o">.</span><span class="n">freq</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">left</span><span class="o">=</span><span class="n">left</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">right</span><span class="o">=</span><span class="n">right</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">heapq</span><span class="o">.</span><span class="n">heappush</span><span class="p">(</span><span class="n">heap</span><span class="p">,</span> <span class="n">merged</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># æ ¹èŠ‚ç‚¹</span>
</span></span><span class="line"><span class="cl">    <span class="n">root</span> <span class="o">=</span> <span class="n">heap</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">heap</span> <span class="k">else</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># ç”Ÿæˆç¼–ç è¡¨</span>
</span></span><span class="line"><span class="cl">    <span class="n">codes</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">generate_codes</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">code</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">node</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">char</span><span class="p">:</span>  <span class="c1"># å¶å­èŠ‚ç‚¹</span>
</span></span><span class="line"><span class="cl">                <span class="n">codes</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">char</span><span class="p">]</span> <span class="o">=</span> <span class="n">code</span> <span class="k">if</span> <span class="n">code</span> <span class="k">else</span> <span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>  <span class="c1"># å†…éƒ¨èŠ‚ç‚¹</span>
</span></span><span class="line"><span class="cl">                <span class="n">generate_codes</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">code</span> <span class="o">+</span> <span class="s2">&#34;0&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">generate_codes</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">right</span><span class="p">,</span> <span class="n">code</span> <span class="o">+</span> <span class="s2">&#34;1&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">generate_codes</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># ç¼–ç æ–‡æœ¬</span>
</span></span><span class="line"><span class="cl">    <span class="n">encoded_text</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">codes</span><span class="p">[</span><span class="n">char</span><span class="p">]</span> <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">encoded_text</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="n">codes</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="n">text</span> <span class="o">=</span> <span class="s2">&#34;ABRACADABRA&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">encoded</span><span class="p">,</span> <span class="n">tree</span><span class="p">,</span> <span class="n">codes</span> <span class="o">=</span> <span class="n">huffman_encoding</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;åŸæ–‡æœ¬:&#34;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;å­—ç¬¦ç¼–ç :&#34;</span><span class="p">,</span> <span class="n">codes</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;ç¼–ç ç»“æœ:&#34;</span><span class="p">,</span> <span class="n">encoded</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;å‹ç¼©ç‡: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">encoded</span><span class="p">)</span><span class="si">}</span><span class="s2"> / </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="o">*</span> <span class="mi">8</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">encoded</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="o">*</span> <span class="mi">8</span><span class="p">)</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è§£ç å‡½æ•°</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">huffman_decoding</span><span class="p">(</span><span class="n">encoded_text</span><span class="p">,</span> <span class="n">root</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;å“ˆå¤«æ›¼è§£ç &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">decoded</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">current</span> <span class="o">=</span> <span class="n">root</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">bit</span> <span class="ow">in</span> <span class="n">encoded_text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">bit</span> <span class="o">==</span> <span class="s1">&#39;0&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">current</span> <span class="o">=</span> <span class="n">current</span><span class="o">.</span><span class="n">left</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">current</span> <span class="o">=</span> <span class="n">current</span><span class="o">.</span><span class="n">right</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">current</span><span class="o">.</span><span class="n">char</span><span class="p">:</span>  <span class="c1"># åˆ°è¾¾å¶å­èŠ‚ç‚¹</span>
</span></span><span class="line"><span class="cl">            <span class="n">decoded</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current</span><span class="o">.</span><span class="n">char</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">current</span> <span class="o">=</span> <span class="n">root</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s2">&#34;&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">decoded</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">decoded</span> <span class="o">=</span> <span class="n">huffman_decoding</span><span class="p">(</span><span class="n">encoded</span><span class="p">,</span> <span class="n">tree</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;è§£ç ç»“æœ:&#34;</span><span class="p">,</span> <span class="n">decoded</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="4-æœ€å°ç”Ÿæˆæ ‘kruskalç®—æ³•">4. æœ€å°ç”Ÿæˆæ ‘ï¼ˆKruskalç®—æ³•ï¼‰</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">UnionFind</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;å¹¶æŸ¥é›†æ•°æ®ç»“æ„&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">rank</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">find</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">!=</span> <span class="n">x</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">union</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">px</span><span class="p">,</span> <span class="n">py</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">px</span> <span class="o">==</span> <span class="n">py</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rank</span><span class="p">[</span><span class="n">px</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">rank</span><span class="p">[</span><span class="n">py</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">            <span class="n">px</span><span class="p">,</span> <span class="n">py</span> <span class="o">=</span> <span class="n">py</span><span class="p">,</span> <span class="n">px</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">[</span><span class="n">py</span><span class="p">]</span> <span class="o">=</span> <span class="n">px</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rank</span><span class="p">[</span><span class="n">px</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">rank</span><span class="p">[</span><span class="n">py</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">rank</span><span class="p">[</span><span class="n">px</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">kruskal_mst</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">edges</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    Kruskalæœ€å°ç”Ÿæˆæ ‘ç®—æ³• - è´ªå¿ƒç®—æ³•
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Args:
</span></span></span><span class="line"><span class="cl"><span class="s2">        n: é¡¶ç‚¹æ•°é‡
</span></span></span><span class="line"><span class="cl"><span class="s2">        edges: [(weight, u, v), ...] è¾¹çš„åˆ—è¡¨
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Returns:
</span></span></span><span class="line"><span class="cl"><span class="s2">        (mst_weight, mst_edges): æœ€å°ç”Ÿæˆæ ‘çš„æƒé‡å’Œè¾¹
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># æŒ‰æƒé‡æ’åº</span>
</span></span><span class="line"><span class="cl">    <span class="n">edges</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">uf</span> <span class="o">=</span> <span class="n">UnionFind</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">mst_edges</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">mst_weight</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">weight</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">uf</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>  <span class="c1"># å¦‚æœä¸å½¢æˆç¯</span>
</span></span><span class="line"><span class="cl">            <span class="n">mst_edges</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">weight</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="n">mst_weight</span> <span class="o">+=</span> <span class="n">weight</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">mst_edges</span><span class="p">)</span> <span class="o">==</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># ç”Ÿæˆæ ‘å®Œæˆ</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">mst_weight</span><span class="p">,</span> <span class="n">mst_edges</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="n">edges</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>   <span class="c1"># è¾¹ 0-1ï¼Œæƒé‡1</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>   <span class="c1"># è¾¹ 0-2ï¼Œæƒé‡2</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>   <span class="c1"># è¾¹ 1-2ï¼Œæƒé‡3</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>   <span class="c1"># è¾¹ 1-3ï¼Œæƒé‡4</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>   <span class="c1"># è¾¹ 2-3ï¼Œæƒé‡5</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">weight</span><span class="p">,</span> <span class="n">mst</span> <span class="o">=</span> <span class="n">kruskal_mst</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">edges</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;æœ€å°ç”Ÿæˆæ ‘æƒé‡: </span><span class="si">{</span><span class="n">weight</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;æœ€å°ç”Ÿæˆæ ‘è¾¹:&#34;</span><span class="p">,</span> <span class="n">mst</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="5-åŒºé—´è°ƒåº¦é—®é¢˜">5. åŒºé—´è°ƒåº¦é—®é¢˜</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">interval_scheduling</span><span class="p">(</span><span class="n">intervals</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    åŒºé—´è°ƒåº¦é—®é¢˜ - è´ªå¿ƒç®—æ³•
</span></span></span><span class="line"><span class="cl"><span class="s2">    é€‰æ‹©æœ€å¤šçš„ä¸é‡å åŒºé—´
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Args:
</span></span></span><span class="line"><span class="cl"><span class="s2">        intervals: [(start, end, interval_id), ...]
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Returns:
</span></span></span><span class="line"><span class="cl"><span class="s2">        selected_intervals: é€‰ä¸­çš„åŒºé—´åˆ—è¡¨
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># æŒ‰ç»“æŸæ—¶é—´æ’åº</span>
</span></span><span class="line"><span class="cl">    <span class="n">intervals</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">selected</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">last_end</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;-inf&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">interval_id</span> <span class="ow">in</span> <span class="n">intervals</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">start</span> <span class="o">&gt;=</span> <span class="n">last_end</span><span class="p">:</span>  <span class="c1"># ä¸é‡å </span>
</span></span><span class="line"><span class="cl">            <span class="n">selected</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">interval_id</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="n">last_end</span> <span class="o">=</span> <span class="n">end</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">selected</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">interval_coloring</span><span class="p">(</span><span class="n">intervals</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    åŒºé—´ç€è‰²é—®é¢˜ - è´ªå¿ƒç®—æ³•
</span></span></span><span class="line"><span class="cl"><span class="s2">    ç”¨æœ€å°‘çš„é¢œè‰²ç»™æ‰€æœ‰åŒºé—´ç€è‰²ï¼Œä½¿å¾—é‡å åŒºé—´é¢œè‰²ä¸åŒ
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Args:
</span></span></span><span class="line"><span class="cl"><span class="s2">        intervals: [(start, end, interval_id), ...]
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Returns:
</span></span></span><span class="line"><span class="cl"><span class="s2">        coloring: {interval_id: color}
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># æŒ‰å¼€å§‹æ—¶é—´æ’åº</span>
</span></span><span class="line"><span class="cl">    <span class="n">intervals</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">coloring</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">    <span class="n">color_end_times</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># æ¯ç§é¢œè‰²çš„æœ€åç»“æŸæ—¶é—´</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">interval_id</span> <span class="ow">in</span> <span class="n">intervals</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># æ‰¾åˆ°å¯ä»¥å¤ç”¨çš„é¢œè‰²</span>
</span></span><span class="line"><span class="cl">        <span class="n">color</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">end_time</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">color_end_times</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">start</span> <span class="o">&gt;=</span> <span class="n">end_time</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">color</span> <span class="o">=</span> <span class="n">i</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">color</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>  <span class="c1"># éœ€è¦æ–°é¢œè‰²</span>
</span></span><span class="line"><span class="cl">            <span class="n">color</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">color_end_times</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">color_end_times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">end</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>  <span class="c1"># å¤ç”¨é¢œè‰²</span>
</span></span><span class="line"><span class="cl">            <span class="n">color_end_times</span><span class="p">[</span><span class="n">color</span><span class="p">]</span> <span class="o">=</span> <span class="n">end</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">coloring</span><span class="p">[</span><span class="n">interval_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">color</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">coloring</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">color_end_times</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="n">intervals</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åŒºé—´è°ƒåº¦</span>
</span></span><span class="line"><span class="cl"><span class="n">selected</span> <span class="o">=</span> <span class="n">interval_scheduling</span><span class="p">(</span><span class="n">intervals</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;é€‰ä¸­çš„åŒºé—´:&#34;</span><span class="p">,</span> <span class="n">selected</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åŒºé—´ç€è‰²</span>
</span></span><span class="line"><span class="cl"><span class="n">coloring</span><span class="p">,</span> <span class="n">num_colors</span> <span class="o">=</span> <span class="n">interval_coloring</span><span class="p">(</span><span class="n">intervals</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;ç€è‰²æ–¹æ¡ˆ:&#34;</span><span class="p">,</span> <span class="n">coloring</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;éœ€è¦é¢œè‰²æ•°:&#34;</span><span class="p">,</span> <span class="n">num_colors</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="è´ªå¿ƒç®—æ³•çš„åº”ç”¨åœºæ™¯">è´ªå¿ƒç®—æ³•çš„åº”ç”¨åœºæ™¯</h2>
<h3 id="1-è°ƒåº¦é—®é¢˜">1. è°ƒåº¦é—®é¢˜</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">job_scheduling_with_deadlines</span><span class="p">(</span><span class="n">jobs</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    å¸¦æˆªæ­¢æ—¶é—´çš„ä½œä¸šè°ƒåº¦ - è´ªå¿ƒç®—æ³•
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Args:
</span></span></span><span class="line"><span class="cl"><span class="s2">        jobs: [(profit, deadline, job_id), ...]
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Returns:
</span></span></span><span class="line"><span class="cl"><span class="s2">        (max_profit, scheduled_jobs): æœ€å¤§åˆ©æ¶¦å’Œè°ƒåº¦çš„ä½œä¸š
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># æŒ‰åˆ©æ¶¦é™åºæ’åº</span>
</span></span><span class="line"><span class="cl">    <span class="n">jobs</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># æ‰¾åˆ°æœ€å¤§æˆªæ­¢æ—¶é—´</span>
</span></span><span class="line"><span class="cl">    <span class="n">max_deadline</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">job</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">job</span> <span class="ow">in</span> <span class="n">jobs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># æ—¶é—´æ§½æ•°ç»„ï¼Œ-1è¡¨ç¤ºç©ºé—²</span>
</span></span><span class="line"><span class="cl">    <span class="n">time_slots</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">max_deadline</span>
</span></span><span class="line"><span class="cl">    <span class="n">scheduled_jobs</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">total_profit</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">profit</span><span class="p">,</span> <span class="n">deadline</span><span class="p">,</span> <span class="n">job_id</span> <span class="ow">in</span> <span class="n">jobs</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># ä»æˆªæ­¢æ—¶é—´å¾€å‰æ‰¾ç©ºé—²æ—¶é—´æ§½</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">deadline</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">max_deadline</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">time_slots</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">time_slots</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">job_id</span>
</span></span><span class="line"><span class="cl">                <span class="n">scheduled_jobs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">profit</span><span class="p">,</span> <span class="n">deadline</span><span class="p">,</span> <span class="n">job_id</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                <span class="n">total_profit</span> <span class="o">+=</span> <span class="n">profit</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">total_profit</span><span class="p">,</span> <span class="n">scheduled_jobs</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="n">jobs</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;J1&#39;</span><span class="p">),</span>  <span class="c1"># ä½œä¸šJ1: åˆ©æ¶¦100, æˆªæ­¢æ—¶é—´2</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;J2&#39;</span><span class="p">),</span>   <span class="c1"># ä½œä¸šJ2: åˆ©æ¶¦10, æˆªæ­¢æ—¶é—´1</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;J3&#39;</span><span class="p">),</span>   <span class="c1"># ä½œä¸šJ3: åˆ©æ¶¦15, æˆªæ­¢æ—¶é—´2</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">27</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;J4&#39;</span><span class="p">),</span>   <span class="c1"># ä½œä¸šJ4: åˆ©æ¶¦27, æˆªæ­¢æ—¶é—´1</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">profit</span><span class="p">,</span> <span class="n">scheduled</span> <span class="o">=</span> <span class="n">job_scheduling_with_deadlines</span><span class="p">(</span><span class="n">jobs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;æœ€å¤§åˆ©æ¶¦: </span><span class="si">{</span><span class="n">profit</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;è°ƒåº¦çš„ä½œä¸š:&#34;</span><span class="p">,</span> <span class="n">scheduled</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="2-å›¾è®ºé—®é¢˜">2. å›¾è®ºé—®é¢˜</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">dijkstra_shortest_path</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">start</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    Dijkstraæœ€çŸ­è·¯å¾„ç®—æ³• - è´ªå¿ƒç®—æ³•
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Args:
</span></span></span><span class="line"><span class="cl"><span class="s2">        graph: {node: [(neighbor, weight), ...]}
</span></span></span><span class="line"><span class="cl"><span class="s2">        start: èµ·å§‹èŠ‚ç‚¹
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    Returns:
</span></span></span><span class="line"><span class="cl"><span class="s2">        distances: {node: shortest_distance}
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">import</span> <span class="nn">heapq</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">distances</span> <span class="o">=</span> <span class="p">{</span><span class="n">node</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">graph</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">distances</span><span class="p">[</span><span class="n">start</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># ä¼˜å…ˆé˜Ÿåˆ—ï¼š(distance, node)</span>
</span></span><span class="line"><span class="cl">    <span class="n">pq</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="n">start</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">    <span class="n">visited</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">pq</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">current_dist</span><span class="p">,</span> <span class="n">current_node</span> <span class="o">=</span> <span class="n">heapq</span><span class="o">.</span><span class="n">heappop</span><span class="p">(</span><span class="n">pq</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">current_node</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">current_node</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># æ›´æ–°é‚»å±…èŠ‚ç‚¹çš„è·ç¦»</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">neighbor</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">current_node</span><span class="p">,</span> <span class="p">[]):</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">neighbor</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">new_dist</span> <span class="o">=</span> <span class="n">current_dist</span> <span class="o">+</span> <span class="n">weight</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">new_dist</span> <span class="o">&lt;</span> <span class="n">distances</span><span class="p">[</span><span class="n">neighbor</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">distances</span><span class="p">[</span><span class="n">neighbor</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_dist</span>
</span></span><span class="line"><span class="cl">                    <span class="n">heapq</span><span class="o">.</span><span class="n">heappush</span><span class="p">(</span><span class="n">pq</span><span class="p">,</span> <span class="p">(</span><span class="n">new_dist</span><span class="p">,</span> <span class="n">neighbor</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">distances</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="n">graph</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)],</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)],</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)],</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)],</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;E&#39;</span><span class="p">:</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">distances</span> <span class="o">=</span> <span class="n">dijkstra_shortest_path</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;ä»Aåˆ°å„ç‚¹çš„æœ€çŸ­è·ç¦»:&#34;</span><span class="p">,</span> <span class="n">distances</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="è´ªå¿ƒç®—æ³•çš„å±€é™æ€§">è´ªå¿ƒç®—æ³•çš„å±€é™æ€§</h2>
<h3 id="1-ä¸é€‚ç”¨çš„é—®é¢˜">1. ä¸é€‚ç”¨çš„é—®é¢˜</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">knapsack_01_counterexample</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    0-1èƒŒåŒ…é—®é¢˜ï¼šè´ªå¿ƒç®—æ³•ä¸èƒ½å¾—åˆ°æœ€ä¼˜è§£
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># ç‰©å“: (é‡é‡, ä»·å€¼)</span>
</span></span><span class="line"><span class="cl">    <span class="n">items</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">60</span><span class="p">),</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">120</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">    <span class="n">capacity</span> <span class="o">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># è´ªå¿ƒç­–ç•¥ï¼šæŒ‰ä»·å€¼å¯†åº¦æ’åº</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># å¯†åº¦: [6.0, 5.0, 4.0]</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># è´ªå¿ƒé€‰æ‹©: ç‰©å“1(10,60) + ç‰©å“2(20,100) = ä»·å€¼160</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># æœ€ä¼˜è§£: ç‰©å“2(20,100) + ç‰©å“3(30,120) = ä»·å€¼220</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;è´ªå¿ƒç®—æ³•ä¸é€‚ç”¨äº0-1èƒŒåŒ…é—®é¢˜&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;è´ªå¿ƒè§£: 160, æœ€ä¼˜è§£: 220&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">coin_change_counterexample</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    ç¡¬å¸æ‰¾é›¶é—®é¢˜ï¼šæŸäº›å¸å€¼ç³»ç»Ÿä¸‹è´ªå¿ƒç®—æ³•ä¸èƒ½å¾—åˆ°æœ€ä¼˜è§£
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># å¸å€¼ç³»ç»Ÿ: [1, 3, 4]</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># ç›®æ ‡é‡‘é¢: 6</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># è´ªå¿ƒç­–ç•¥ï¼šä¼˜å…ˆä½¿ç”¨å¤§é¢é¢</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># è´ªå¿ƒè§£: 4 + 1 + 1 = 3æšç¡¬å¸</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># æœ€ä¼˜è§£: 3 + 3 = 2æšç¡¬å¸</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;æŸäº›å¸å€¼ç³»ç»Ÿä¸‹ï¼Œè´ªå¿ƒç®—æ³•ä¸èƒ½å¾—åˆ°æœ€ä¼˜è§£&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;è´ªå¿ƒè§£: 3æšç¡¬å¸, æœ€ä¼˜è§£: 2æšç¡¬å¸&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="2-è´ªå¿ƒç®—æ³•çš„é€‚ç”¨æ¡ä»¶">2. è´ªå¿ƒç®—æ³•çš„é€‚ç”¨æ¡ä»¶</h3>
<table>
  <thead>
      <tr>
          <th>æ¡ä»¶</th>
          <th>è¯´æ˜</th>
          <th>æ£€éªŒæ–¹æ³•</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>è´ªå¿ƒé€‰æ‹©æ€§è´¨</strong></td>
          <td>å±€éƒ¨æœ€ä¼˜èƒ½å¯¼è‡´å…¨å±€æœ€ä¼˜</td>
          <td>æ•°å­¦è¯æ˜æˆ–åè¯æ³•</td>
      </tr>
      <tr>
          <td><strong>æœ€ä¼˜å­ç»“æ„</strong></td>
          <td>å­é—®é¢˜çš„æœ€ä¼˜è§£æ„æˆåŸé—®é¢˜çš„æœ€ä¼˜è§£</td>
          <td>é€’å½’åˆ†æ</td>
      </tr>
      <tr>
          <td><strong>æ— åæ•ˆæ€§</strong></td>
          <td>å½“å‰é€‰æ‹©ä¸å½±å“ä¹‹å‰çš„é€‰æ‹©</td>
          <td>çŠ¶æ€åˆ†æ</td>
      </tr>
  </tbody>
</table>
<h2 id="è´ªå¿ƒç®—æ³•è®¾è®¡æŠ€å·§">è´ªå¿ƒç®—æ³•è®¾è®¡æŠ€å·§</h2>
<h3 id="1-ç­–ç•¥é€‰æ‹©æŒ‡å—">1. ç­–ç•¥é€‰æ‹©æŒ‡å—</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">strategy_selection_guide</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    è´ªå¿ƒç­–ç•¥é€‰æ‹©æŒ‡å—
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">strategies</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;æœ€æ—©æˆªæ­¢æ—¶é—´ä¼˜å…ˆ&#34;</span><span class="p">:</span> <span class="s2">&#34;è°ƒåº¦é—®é¢˜ï¼Œé¿å…é”™è¿‡æˆªæ­¢æ—¶é—´&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;æœ€çŸ­å¤„ç†æ—¶é—´ä¼˜å…ˆ&#34;</span><span class="p">:</span> <span class="s2">&#34;æœ€å°åŒ–å¹³å‡ç­‰å¾…æ—¶é—´&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;æœ€é«˜ä»·å€¼å¯†åº¦ä¼˜å…ˆ&#34;</span><span class="p">:</span> <span class="s2">&#34;èƒŒåŒ…ç±»é—®é¢˜ï¼Œæœ€å¤§åŒ–å•ä½æ”¶ç›Š&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;æœ€å°æƒé‡ä¼˜å…ˆ&#34;</span><span class="p">:</span> <span class="s2">&#34;ç”Ÿæˆæ ‘é—®é¢˜ï¼Œæœ€å°åŒ–æ€»æˆæœ¬&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;æœ€å¤§åˆ©æ¶¦ä¼˜å…ˆ&#34;</span><span class="p">:</span> <span class="s2">&#34;é€‰æ‹©é—®é¢˜ï¼Œæœ€å¤§åŒ–æ€»æ”¶ç›Š&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">strategy</span><span class="p">,</span> <span class="n">application</span> <span class="ow">in</span> <span class="n">strategies</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">strategy</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">application</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="2-æ­£ç¡®æ€§è¯æ˜æ–¹æ³•">2. æ­£ç¡®æ€§è¯æ˜æ–¹æ³•</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">greedy_proof_methods</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    è´ªå¿ƒç®—æ³•æ­£ç¡®æ€§è¯æ˜æ–¹æ³•
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">methods</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;äº¤æ¢è®ºè¯&#34;</span><span class="p">:</span> <span class="s2">&#34;è¯æ˜è´ªå¿ƒé€‰æ‹©å¯ä»¥æ›¿æ¢æœ€ä¼˜è§£ä¸­çš„é€‰æ‹©&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;å½’çº³æ³•&#34;</span><span class="p">:</span> <span class="s2">&#34;è¯æ˜æ¯ä¸€æ­¥è´ªå¿ƒé€‰æ‹©éƒ½ä¿æŒæœ€ä¼˜æ€§&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;åè¯æ³•&#34;</span><span class="p">:</span> <span class="s2">&#34;å‡è®¾è´ªå¿ƒè§£ä¸æ˜¯æœ€ä¼˜è§£ï¼Œæ¨å‡ºçŸ›ç›¾&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;åˆ‡å‰²ç²˜è´´&#34;</span><span class="p">:</span> <span class="s2">&#34;å°†æœ€ä¼˜è§£åˆ†å‰²é‡ç»„ï¼Œè¯æ˜è´ªå¿ƒè§£ä¸å·®&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">method</span><span class="p">,</span> <span class="n">description</span> <span class="ow">in</span> <span class="n">methods</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">description</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="å®é™…åº”ç”¨æ¡ˆä¾‹">å®é™…åº”ç”¨æ¡ˆä¾‹</h2>
<h3 id="1-ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿ">1. ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿ</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">TaskScheduler</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;åŸºäºè´ªå¿ƒç®—æ³•çš„ä»»åŠ¡è°ƒåº¦å™¨&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">tasks</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">add_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_id</span><span class="p">,</span> <span class="n">priority</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">deadline</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;æ·»åŠ ä»»åŠ¡&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="n">task_id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;priority&#39;</span><span class="p">:</span> <span class="n">priority</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;duration&#39;</span><span class="p">:</span> <span class="n">duration</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;deadline&#39;</span><span class="p">:</span> <span class="n">deadline</span>
</span></span><span class="line"><span class="cl">        <span class="p">})</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">schedule_by_priority</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;æŒ‰ä¼˜å…ˆçº§è°ƒåº¦&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tasks</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;priority&#39;</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">schedule_by_deadline</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;æŒ‰æˆªæ­¢æ—¶é—´è°ƒåº¦&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tasks</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;deadline&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">schedule_by_shortest_job_first</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;æœ€çŸ­ä½œä¸šä¼˜å…ˆè°ƒåº¦&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tasks</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="n">scheduler</span> <span class="o">=</span> <span class="n">TaskScheduler</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">scheduler</span><span class="o">.</span><span class="n">add_task</span><span class="p">(</span><span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">scheduler</span><span class="o">.</span><span class="n">add_task</span><span class="p">(</span><span class="s1">&#39;T2&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">scheduler</span><span class="o">.</span><span class="n">add_task</span><span class="p">(</span><span class="s1">&#39;T3&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;æŒ‰ä¼˜å…ˆçº§è°ƒåº¦:&#34;</span><span class="p">,</span> <span class="n">scheduler</span><span class="o">.</span><span class="n">schedule_by_priority</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;æŒ‰æˆªæ­¢æ—¶é—´è°ƒåº¦:&#34;</span><span class="p">,</span> <span class="n">scheduler</span><span class="o">.</span><span class="n">schedule_by_deadline</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;æœ€çŸ­ä½œä¸šä¼˜å…ˆ:&#34;</span><span class="p">,</span> <span class="n">scheduler</span><span class="o">.</span><span class="n">schedule_by_shortest_job_first</span><span class="p">())</span>
</span></span></code></pre></div><h3 id="2-ç¼“å­˜æ›¿æ¢ç®—æ³•">2. ç¼“å­˜æ›¿æ¢ç®—æ³•</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">LRUCache</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;åŸºäºè´ªå¿ƒæ€æƒ³çš„LRUç¼“å­˜&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">capacity</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span> <span class="o">=</span> <span class="n">capacity</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">cache</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">access_order</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;è·å–ç¼“å­˜å€¼&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># æ›´æ–°è®¿é—®é¡ºåºï¼ˆè´ªå¿ƒç­–ç•¥ï¼šæœ€è¿‘ä½¿ç”¨çš„æ”¾åœ¨æœ€åï¼‰</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">access_order</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">access_order</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">put</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;è®¾ç½®ç¼“å­˜å€¼&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># æ›´æ–°ç°æœ‰é”®</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">access_order</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">access_order</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># æ·»åŠ æ–°é”®</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="c1"># è´ªå¿ƒç­–ç•¥ï¼šç§»é™¤æœ€ä¹…æœªä½¿ç”¨çš„é”®</span>
</span></span><span class="line"><span class="cl">                <span class="n">lru_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_order</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="n">lru_key</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">access_order</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="n">cache</span> <span class="o">=</span> <span class="n">LRUCache</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">cache</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">cache</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">cache</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;ç¼“å­˜çŠ¶æ€:&#34;</span><span class="p">,</span> <span class="n">cache</span><span class="o">.</span><span class="n">cache</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>  <span class="c1"># è®¿é—®A</span>
</span></span><span class="line"><span class="cl"><span class="n">cache</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>  <span class="c1"># æ·»åŠ Dï¼Œåº”è¯¥ç§»é™¤B</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;æ·»åŠ Då:&#34;</span><span class="p">,</span> <span class="n">cache</span><span class="o">.</span><span class="n">cache</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="å­¦ä¹ å»ºè®®å’Œæ€»ç»“">å­¦ä¹ å»ºè®®å’Œæ€»ç»“</h2>
<h3 id="å­¦ä¹ è·¯å¾„">å­¦ä¹ è·¯å¾„</h3>
<ol>
<li><strong>ç†è§£æ ¸å¿ƒæ¦‚å¿µ</strong>ï¼šæŒæ¡è´ªå¿ƒé€‰æ‹©æ€§è´¨å’Œæœ€ä¼˜å­ç»“æ„</li>
<li><strong>ç»ƒä¹ ç»å…¸é—®é¢˜</strong>ï¼šæ´»åŠ¨é€‰æ‹©ã€èƒŒåŒ…é—®é¢˜ã€æœ€çŸ­è·¯å¾„ç­‰</li>
<li><strong>å­¦ä¼šè¯æ˜æ–¹æ³•</strong>ï¼šäº¤æ¢è®ºè¯ã€å½’çº³æ³•ã€åè¯æ³•</li>
<li><strong>è¯†åˆ«é€‚ç”¨åœºæ™¯</strong>ï¼šåˆ¤æ–­é—®é¢˜æ˜¯å¦é€‚åˆè´ªå¿ƒç®—æ³•</li>
<li><strong>å®é™…åº”ç”¨ç»ƒä¹ </strong>ï¼šè°ƒåº¦ã€ä¼˜åŒ–ã€å›¾è®ºç­‰å®é™…é—®é¢˜</li>
</ol>
<h3 id="å…³é”®è¦ç‚¹">å…³é”®è¦ç‚¹</h3>
<table>
  <thead>
      <tr>
          <th>è¦ç‚¹</th>
          <th>è¯´æ˜</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>ç­–ç•¥é€‰æ‹©</strong></td>
          <td>æ­£ç¡®çš„è´ªå¿ƒç­–ç•¥æ˜¯ç®—æ³•æˆåŠŸçš„å…³é”®</td>
      </tr>
      <tr>
          <td><strong>æ­£ç¡®æ€§è¯æ˜</strong></td>
          <td>å¿…é¡»è¯æ˜è´ªå¿ƒé€‰æ‹©èƒ½å¾—åˆ°æœ€ä¼˜è§£</td>
      </tr>
      <tr>
          <td><strong>é€‚ç”¨æ€§åˆ¤æ–­</strong></td>
          <td>ä¸æ˜¯æ‰€æœ‰é—®é¢˜éƒ½é€‚åˆè´ªå¿ƒç®—æ³•</td>
      </tr>
      <tr>
          <td><strong>æ•ˆç‡ä¼˜åŠ¿</strong></td>
          <td>è´ªå¿ƒç®—æ³•é€šå¸¸å…·æœ‰è¾ƒä½çš„æ—¶é—´å¤æ‚åº¦</td>
      </tr>
  </tbody>
</table>
<h3 id="å¸¸è§è¯¯åŒº">å¸¸è§è¯¯åŒº</h3>
<ol>
<li><strong>ç›²ç›®åº”ç”¨</strong>ï¼šä¸éªŒè¯è´ªå¿ƒé€‰æ‹©æ€§è´¨å°±ä½¿ç”¨è´ªå¿ƒç®—æ³•</li>
<li><strong>ç­–ç•¥é”™è¯¯</strong>ï¼šé€‰æ‹©äº†é”™è¯¯çš„è´ªå¿ƒç­–ç•¥</li>
<li><strong>å¿½ç•¥è¯æ˜</strong>ï¼šæ²¡æœ‰è¯æ˜ç®—æ³•çš„æ­£ç¡®æ€§</li>
<li><strong>é€‚ç”¨èŒƒå›´</strong>ï¼šå°†è´ªå¿ƒç®—æ³•åº”ç”¨åˆ°ä¸é€‚åˆçš„é—®é¢˜ä¸Š</li>
</ol>
<p>è´ªå¿ƒç®—æ³•æ˜¯ç®—æ³•è®¾è®¡ä¸­çš„é‡è¦æ€æƒ³ï¼Œè™½ç„¶ä¸èƒ½è§£å†³æ‰€æœ‰ä¼˜åŒ–é—®é¢˜ï¼Œä½†åœ¨é€‚ç”¨çš„åœºæ™¯ä¸‹èƒ½å¤Ÿæä¾›ç®€æ´é«˜æ•ˆçš„è§£å†³æ–¹æ¡ˆã€‚æŒæ¡è´ªå¿ƒç®—æ³•çš„å…³é”®åœ¨äºç†è§£å…¶é€‚ç”¨æ¡ä»¶ï¼Œé€‰æ‹©æ­£ç¡®çš„è´ªå¿ƒç­–ç•¥ï¼Œå¹¶èƒ½å¤Ÿè¯æ˜ç®—æ³•çš„æ­£ç¡®æ€§ã€‚</p>
]]></content:encoded>
    </item>
    <item>
      <title>å‰ç¼€å’Œç®—æ³•è¯¦è§£ä¸åº”ç”¨</title>
      <link>https://tyhzxh.github.io/posts/prefix-sum-algorithm/</link>
      <pubDate>Fri, 23 Feb 2024 13:34:50 +0800</pubDate>
      <guid>https://tyhzxh.github.io/posts/prefix-sum-algorithm/</guid>
      <description>æ·±å…¥è®²è§£å‰ç¼€å’Œç®—æ³•çš„åŸç†å’Œåº”ç”¨ï¼ŒåŒ…æ‹¬ç´¯è®¡å€¼å‰ç¼€æ•°ç»„ã€ç´¯è®¡å‡ºç°æ¬¡æ•°å‰ç¼€æ•°ç»„ã€ç´¯ç§¯æœ€å¤§å€¼å‰ç¼€æ•°ç»„ç­‰å¤šç§å˜ä½“</description>
      <content:encoded><![CDATA[<h2 id="å‰ç¼€å’Œç®—æ³•æ¦‚è¿°">å‰ç¼€å’Œç®—æ³•æ¦‚è¿°</h2>
<p>å‰ç¼€å’Œæ˜¯ä¸€ç§é‡è¦çš„ç®—æ³•æŠ€å·§ï¼Œä¸»è¦ç”¨äºå¿«é€Ÿè®¡ç®—æ•°ç»„åŒºé—´å†…çš„å„ç§ç»Ÿè®¡ä¿¡æ¯ã€‚é€šè¿‡é¢„å¤„ç†æ„å»ºå‰ç¼€æ•°ç»„ï¼Œå¯ä»¥å°†åŸæœ¬éœ€è¦O(n)æ—¶é—´å¤æ‚åº¦çš„åŒºé—´æŸ¥è¯¢ä¼˜åŒ–åˆ°O(1)ã€‚</p>
<p>å‰ç¼€å’Œç®—æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š<strong>åˆ©ç”¨å‰é¢å·²ç»è®¡ç®—è¿‡çš„ç»“æœæ¥å¿«é€Ÿå¾—å‡ºå½“å‰çš„ç»“æœ</strong>ã€‚</p>
<h2 id="å‰ç¼€å’Œçš„åŸºæœ¬ç±»å‹">å‰ç¼€å’Œçš„åŸºæœ¬ç±»å‹</h2>
<h3 id="1-ç´¯è®¡å€¼å‰ç¼€æ•°ç»„ç”¨äºåŒºé—´æ±‚å’Œ">1. ç´¯è®¡å€¼å‰ç¼€æ•°ç»„ï¼ˆç”¨äºåŒºé—´æ±‚å’Œï¼‰</h3>
<p>è¿™æ˜¯æœ€å¸¸è§çš„å‰ç¼€å’Œåº”ç”¨ï¼Œç”¨äºå¿«é€Ÿè®¡ç®—æ•°ç»„ä¸­ä»»æ„åŒºé—´çš„å…ƒç´ å’Œã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">build_prefix_sum</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;æ„å»ºå‰ç¼€å’Œæ•°ç»„&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">prefix_sum</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># åˆå§‹åŒ–å‰ç¼€å’Œæ•°ç»„ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ ä¸º0</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">arr</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">prefix_sum</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prefix_sum</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">num</span><span class="p">)</span>  <span class="c1"># å°†å½“å‰å…ƒç´ åŠ åˆ°å‰ä¸€ä¸ªå‰ç¼€å’Œä¸Š</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">prefix_sum</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">range_sum</span><span class="p">(</span><span class="n">prefix_sum</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;è®¡ç®—åŒºé—´å’Œ&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">prefix_sum</span><span class="p">[</span><span class="n">end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">prefix_sum</span><span class="p">[</span><span class="n">start</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="n">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">prefix_sum</span> <span class="o">=</span> <span class="n">build_prefix_sum</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;åŸæ•°ç»„: </span><span class="si">{</span><span class="n">arr</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;å‰ç¼€å’Œæ•°ç»„: </span><span class="si">{</span><span class="n">prefix_sum</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥è¯¢åŒºé—´ [1, 3] çš„å’Œ (ç´¢å¼•1åˆ°3ï¼Œå³å…ƒç´ 2, 3, 4)</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">range_sum</span><span class="p">(</span><span class="n">prefix_sum</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;åŒºé—´ [1, 3] çš„å’Œ: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>  <span class="c1"># è¾“å‡º 9 (2 + 3 + 4)</span>
</span></span></code></pre></div><p><strong>ç®—æ³•è§£é‡Š</strong>ï¼š</p>
<ul>
<li><code>build_prefix_sum</code> å‡½æ•°é€šè¿‡éå†è¾“å…¥æ•°ç»„å¹¶ç´¯åŠ æ¯ä¸ªå…ƒç´ æ¥æ„å»ºå‰ç¼€å’Œæ•°ç»„</li>
<li>å‰ç¼€å’Œæ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ åˆå§‹åŒ–ä¸º0ï¼Œè¡¨ç¤ºç©ºåŒºé—´çš„å’Œ</li>
<li><code>range_sum</code> å‡½æ•°åˆ©ç”¨å‰ç¼€å’Œçš„æ€§è´¨ï¼šåŒºé—´[start, end]çš„å’Œ = prefix_sum[end+1] - prefix_sum[start]</li>
</ul>
<h3 id="2-ç´¯è®¡å‡ºç°æ¬¡æ•°å‰ç¼€æ•°ç»„">2. ç´¯è®¡å‡ºç°æ¬¡æ•°å‰ç¼€æ•°ç»„</h3>
<p>ç”¨äºå¿«é€ŸæŸ¥è¯¢æŸä¸ªç‰¹å®šå€¼åœ¨æŒ‡å®šåŒºé—´å†…çš„å‡ºç°æ¬¡æ•°ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">build_prefix_count</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;æ„å»ºç›®æ ‡å€¼çš„å‰ç¼€è®¡æ•°æ•°ç»„&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">prefix_count</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># åˆå§‹åŒ–å‰ç¼€è®¡æ•°æ•°ç»„</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">arr</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">num</span> <span class="o">==</span> <span class="n">target</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">prefix_count</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prefix_count</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># å¦‚æœæ˜¯ç›®æ ‡å€¼ï¼Œè®¡æ•°åŠ 1</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">prefix_count</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prefix_count</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># å¦åˆ™ï¼Œè®¡æ•°ä¸å˜</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">prefix_count</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">count_range_occurrences</span><span class="p">(</span><span class="n">prefix_count</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;è®¡ç®—åŒºé—´å†…ç›®æ ‡å€¼çš„å‡ºç°æ¬¡æ•°&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">prefix_count</span><span class="p">[</span><span class="n">end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">prefix_count</span><span class="p">[</span><span class="n">start</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="n">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">target</span> <span class="o">=</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="n">prefix_count</span> <span class="o">=</span> <span class="n">build_prefix_count</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;åŸæ•°ç»„: </span><span class="si">{</span><span class="n">arr</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;ç›®æ ‡å€¼ </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2"> çš„å‰ç¼€è®¡æ•°æ•°ç»„: </span><span class="si">{</span><span class="n">prefix_count</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥è¯¢åŒºé—´ [1, 4] ä¸­ç›®æ ‡å€¼çš„å‡ºç°æ¬¡æ•°</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">count_range_occurrences</span><span class="p">(</span><span class="n">prefix_count</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;åŒºé—´ [1, 4] ä¸­å€¼ </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2"> çš„å‡ºç°æ¬¡æ•°: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>  <span class="c1"># è¾“å‡º 3</span>
</span></span></code></pre></div><p><strong>ç®—æ³•è§£é‡Š</strong>ï¼š</p>
<ul>
<li><code>build_prefix_count</code> å‡½æ•°æ„å»ºä¸€ä¸ªå‰ç¼€è®¡æ•°æ•°ç»„ï¼Œè®°å½•åˆ°å½“å‰ä½ç½®ä¸ºæ­¢ç›®æ ‡å€¼çš„ç´¯è®¡å‡ºç°æ¬¡æ•°</li>
<li>æŸ¥è¯¢æ—¶åŒæ ·ä½¿ç”¨å·®å€¼çš„æ–¹æ³•ï¼šåŒºé—´å†…å‡ºç°æ¬¡æ•° = prefix_count[end+1] - prefix_count[start]</li>
</ul>
<h3 id="3-ç´¯ç§¯æœ€å¤§å€¼å‰ç¼€æ•°ç»„">3. ç´¯ç§¯æœ€å¤§å€¼å‰ç¼€æ•°ç»„</h3>
<p>ç”¨äºå¿«é€ŸæŸ¥è¯¢ä»æ•°ç»„å¼€å§‹åˆ°æŸä¸ªä½ç½®çš„æœ€å¤§å€¼ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">build_prefix_max</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;æ„å»ºå‰ç¼€æœ€å¤§å€¼æ•°ç»„&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">arr</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">prefix_max</span> <span class="o">=</span> <span class="p">[</span><span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>  <span class="c1"># åˆå§‹åŒ–å‰ç¼€æœ€å¤§å€¼æ•°ç»„ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ ä¸ºæ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ </span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
</span></span><span class="line"><span class="cl">        <span class="n">prefix_max</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">prefix_max</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">num</span><span class="p">))</span>  <span class="c1"># è®°å½•åˆ°å½“å‰ä½ç½®ä¸ºæ­¢çš„æœ€å¤§å€¼</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">prefix_max</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">prefix_max_query</span><span class="p">(</span><span class="n">prefix_max</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;æŸ¥è¯¢ä»å¼€å§‹åˆ°æŒ‡å®šä½ç½®çš„æœ€å¤§å€¼&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">prefix_max</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="n">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">prefix_max</span> <span class="o">=</span> <span class="n">build_prefix_max</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;åŸæ•°ç»„: </span><span class="si">{</span><span class="n">arr</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;å‰ç¼€æœ€å¤§å€¼æ•°ç»„: </span><span class="si">{</span><span class="n">prefix_max</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥è¯¢ä»å¼€å§‹åˆ°ç´¢å¼•3çš„æœ€å¤§å€¼</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">prefix_max_query</span><span class="p">(</span><span class="n">prefix_max</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;ä»å¼€å§‹åˆ°ç´¢å¼•3çš„æœ€å¤§å€¼: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>  <span class="c1"># è¾“å‡º 5</span>
</span></span></code></pre></div><p><strong>ç®—æ³•è§£é‡Š</strong>ï¼š</p>
<ul>
<li><code>build_prefix_max</code> å‡½æ•°æ„å»ºä¸€ä¸ªå‰ç¼€æœ€å¤§å€¼æ•°ç»„ï¼Œè®°å½•åˆ°æ¯ä¸ªä½ç½®ä¸ºæ­¢çš„æœ€å¤§å€¼</li>
<li>è¿™ç§æ–¹æ³•ç‰¹åˆ«é€‚ç”¨äºéœ€è¦é¢‘ç¹æŸ¥è¯¢&quot;ä»å¼€å§‹åˆ°æŸä¸ªä½ç½®çš„æœ€å¤§å€¼&quot;çš„åœºæ™¯</li>
</ul>
<h2 id="äºŒç»´å‰ç¼€å’Œ">äºŒç»´å‰ç¼€å’Œ</h2>
<p>å¯¹äºäºŒç»´æ•°ç»„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ„å»ºäºŒç»´å‰ç¼€å’Œæ¥å¿«é€Ÿè®¡ç®—çŸ©å½¢åŒºåŸŸçš„å’Œã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">build_2d_prefix_sum</span><span class="p">(</span><span class="n">matrix</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;æ„å»ºäºŒç»´å‰ç¼€å’Œæ•°ç»„&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">matrix</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">prefix_2d</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">cols</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">rows</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">prefix_2d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> 
</span></span><span class="line"><span class="cl">                              <span class="n">prefix_2d</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> 
</span></span><span class="line"><span class="cl">                              <span class="n">prefix_2d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> 
</span></span><span class="line"><span class="cl">                              <span class="n">prefix_2d</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">prefix_2d</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">range_sum_2d</span><span class="p">(</span><span class="n">prefix_2d</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;è®¡ç®—çŸ©å½¢åŒºåŸŸçš„å’Œ&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">(</span><span class="n">prefix_2d</span><span class="p">[</span><span class="n">x2</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">y2</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> 
</span></span><span class="line"><span class="cl">            <span class="n">prefix_2d</span><span class="p">[</span><span class="n">x1</span><span class="p">][</span><span class="n">y2</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> 
</span></span><span class="line"><span class="cl">            <span class="n">prefix_2d</span><span class="p">[</span><span class="n">x2</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">y1</span><span class="p">]</span> <span class="o">+</span> 
</span></span><span class="line"><span class="cl">            <span class="n">prefix_2d</span><span class="p">[</span><span class="n">x1</span><span class="p">][</span><span class="n">y1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="n">matrix</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">prefix_2d</span> <span class="o">=</span> <span class="n">build_2d_prefix_sum</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥è¯¢çŸ©å½¢åŒºåŸŸ (0,0) åˆ° (1,1) çš„å’Œ</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">range_sum_2d</span><span class="p">(</span><span class="n">prefix_2d</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;çŸ©å½¢åŒºåŸŸ (0,0) åˆ° (1,1) çš„å’Œ: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>  <span class="c1"># è¾“å‡º 12 (1+2+4+5)</span>
</span></span></code></pre></div><h2 id="å·®åˆ†æ•°ç»„">å·®åˆ†æ•°ç»„</h2>
<p>å·®åˆ†æ•°ç»„æ˜¯å‰ç¼€å’Œçš„é€†è¿ç®—ï¼Œä¸»è¦ç”¨äºå¤„ç†åŒºé—´æ›´æ–°é—®é¢˜ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">build_difference_array</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;æ„å»ºå·®åˆ†æ•°ç»„&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">arr</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">diff</span> <span class="o">=</span> <span class="p">[</span><span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">        <span class="n">diff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">diff</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">range_update</span><span class="p">(</span><span class="n">diff</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">delta</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;åŒºé—´æ›´æ–°ï¼šç»™[start, end]åŒºé—´çš„æ‰€æœ‰å…ƒç´ åŠ ä¸Šdelta&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">diff</span><span class="p">[</span><span class="n">start</span><span class="p">]</span> <span class="o">+=</span> <span class="n">delta</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">end</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">diff</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">diff</span><span class="p">[</span><span class="n">end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">delta</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">restore_from_difference</span><span class="p">(</span><span class="n">diff</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;ä»å·®åˆ†æ•°ç»„æ¢å¤åŸæ•°ç»„&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="n">diff</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">diff</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">diff</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">result</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="n">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">diff</span> <span class="o">=</span> <span class="n">build_difference_array</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;åŸæ•°ç»„: </span><span class="si">{</span><span class="n">arr</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;å·®åˆ†æ•°ç»„: </span><span class="si">{</span><span class="n">diff</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç»™åŒºé—´ [1, 3] çš„æ‰€æœ‰å…ƒç´ åŠ ä¸Š 10</span>
</span></span><span class="line"><span class="cl"><span class="n">range_update</span><span class="p">(</span><span class="n">diff</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">updated_arr</span> <span class="o">=</span> <span class="n">restore_from_difference</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;æ›´æ–°åçš„æ•°ç»„: </span><span class="si">{</span><span class="n">updated_arr</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>  <span class="c1"># è¾“å‡º [1, 12, 13, 14, 5]</span>
</span></span></code></pre></div><h2 id="å®é™…åº”ç”¨åœºæ™¯">å®é™…åº”ç”¨åœºæ™¯</h2>
<h3 id="1-åŒºé—´æŸ¥è¯¢é—®é¢˜">1. åŒºé—´æŸ¥è¯¢é—®é¢˜</h3>
<ul>
<li>æ•°ç»„åŒºé—´å’ŒæŸ¥è¯¢</li>
<li>åŒºé—´æœ€å€¼æŸ¥è¯¢</li>
<li>åŒºé—´å…ƒç´ è®¡æ•°</li>
</ul>
<h3 id="2-åŠ¨æ€è§„åˆ’ä¼˜åŒ–">2. åŠ¨æ€è§„åˆ’ä¼˜åŒ–</h3>
<ul>
<li>åˆ©ç”¨å‰ç¼€å’Œä¼˜åŒ–çŠ¶æ€è½¬ç§»</li>
<li>å‡å°‘é‡å¤è®¡ç®—</li>
</ul>
<h3 id="3-å­—ç¬¦ä¸²å¤„ç†">3. å­—ç¬¦ä¸²å¤„ç†</h3>
<ul>
<li>å­ä¸²ç‰¹å¾ç»Ÿè®¡</li>
<li>æ¨¡å¼åŒ¹é…ä¼˜åŒ–</li>
</ul>
<h3 id="4-å›¾åƒå¤„ç†">4. å›¾åƒå¤„ç†</h3>
<ul>
<li>ç§¯åˆ†å›¾åƒè®¡ç®—</li>
<li>å¿«é€ŸåŒºåŸŸç‰¹å¾æå–</li>
</ul>
<h2 id="æ—¶é—´å¤æ‚åº¦åˆ†æ">æ—¶é—´å¤æ‚åº¦åˆ†æ</h2>
<table>
  <thead>
      <tr>
          <th>æ“ä½œ</th>
          <th>æœ´ç´ æ–¹æ³•</th>
          <th>å‰ç¼€å’Œæ–¹æ³•</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>é¢„å¤„ç†</td>
          <td>O(1)</td>
          <td>O(n)</td>
      </tr>
      <tr>
          <td>å•æ¬¡æŸ¥è¯¢</td>
          <td>O(n)</td>
          <td>O(1)</td>
      </tr>
      <tr>
          <td>mæ¬¡æŸ¥è¯¢</td>
          <td>O(mÃ—n)</td>
          <td>O(n + m)</td>
      </tr>
  </tbody>
</table>
<p>å½“æŸ¥è¯¢æ¬¡æ•°è¾ƒå¤šæ—¶ï¼Œå‰ç¼€å’Œæ–¹æ³•çš„ä¼˜åŠ¿éå¸¸æ˜æ˜¾ã€‚</p>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>å‰ç¼€å’Œç®—æ³•æ˜¯ä¸€ç§ä»¥ç©ºé—´æ¢æ—¶é—´çš„ç»å…¸ç®—æ³•æŠ€å·§ï¼Œé€šè¿‡é¢„å¤„ç†æ„å»ºè¾…åŠ©æ•°ç»„ï¼Œå¯ä»¥æ˜¾è‘—æé«˜åŒºé—´æŸ¥è¯¢çš„æ•ˆç‡ã€‚æŒæ¡å‰ç¼€å’ŒåŠå…¶å˜ä½“å¯¹äºè§£å†³å„ç§ç®—æ³•é—®é¢˜éƒ½æœ‰é‡è¦æ„ä¹‰ã€‚</p>
<p>å…³é”®è¦ç‚¹ï¼š</p>
<ol>
<li><strong>é¢„å¤„ç†</strong>ï¼šæ„å»ºå‰ç¼€æ•°ç»„éœ€è¦O(n)æ—¶é—´</li>
<li><strong>å¿«é€ŸæŸ¥è¯¢</strong>ï¼šå•æ¬¡æŸ¥è¯¢åªéœ€O(1)æ—¶é—´</li>
<li><strong>çµæ´»åº”ç”¨</strong>ï¼šå¯ä»¥æ‰©å±•åˆ°äºŒç»´ã€å¤šç»´ä»¥åŠå„ç§ç»Ÿè®¡ä¿¡æ¯</li>
<li><strong>ä¸å·®åˆ†ç»“åˆ</strong>ï¼šå¯ä»¥é«˜æ•ˆå¤„ç†åŒºé—´æ›´æ–°é—®é¢˜</li>
</ol>
<p>å‰ç¼€å’Œç®—æ³•åœ¨ç«èµ›ç¼–ç¨‹ã€å®é™…å¼€å‘ä¸­éƒ½æœ‰å¹¿æ³›åº”ç”¨ï¼Œæ˜¯æ¯ä¸ªç¨‹åºå‘˜éƒ½åº”è¯¥æŒæ¡çš„åŸºç¡€ç®—æ³•æŠ€å·§ã€‚</p>
]]></content:encoded>
    </item>
    <item>
      <title>SpringBoot æ ¸å¿ƒæ¦‚å¿µè¯¦è§£</title>
      <link>https://tyhzxh.github.io/posts/springboot-fundamentals/</link>
      <pubDate>Fri, 23 Feb 2024 02:36:48 +0800</pubDate>
      <guid>https://tyhzxh.github.io/posts/springboot-fundamentals/</guid>
      <description>SpringBootæ¡†æ¶çš„æ ¸å¿ƒæ¦‚å¿µè¯¦è§£ï¼ŒåŒ…æ‹¬IoCå®¹å™¨ã€ä¾èµ–æ³¨å…¥ã€AOPé¢å‘åˆ‡é¢ç¼–ç¨‹ç­‰é‡è¦æ¦‚å¿µçš„æ·±å…¥è§£æ</description>
      <content:encoded><![CDATA[<blockquote>
<p>SpringBootæ˜¯Javaæœ€æµè¡Œçš„å¼€å‘æ¡†æ¶ï¼Œå®ƒé€šè¿‡è§£è€¦ä»£ç æ¥æå‡å¯ç»´æŠ¤æ€§å’Œå¯æµ‹è¯•æ€§ã€‚æœ¬æ–‡å°†æ·±å…¥è§£æSpringBootçš„æ ¸å¿ƒæ¦‚å¿µã€‚</p></blockquote>
<h2 id="æ¡†æ¶æ¦‚è¿°">æ¡†æ¶æ¦‚è¿°</h2>
<p><strong>SpringBoot</strong> æ˜¯åŸºäºSpringæ¡†æ¶çš„å¿«é€Ÿå¼€å‘è„šæ‰‹æ¶ï¼Œå®ƒç®€åŒ–äº†Springåº”ç”¨çš„é…ç½®å’Œéƒ¨ç½²è¿‡ç¨‹ï¼Œè®©å¼€å‘è€…èƒ½å¤Ÿå¿«é€Ÿæ„å»ºç”Ÿäº§çº§åˆ«çš„åº”ç”¨ç¨‹åºã€‚</p>
<h3 id="ä¸»è¦ä¼˜åŠ¿">ä¸»è¦ä¼˜åŠ¿</h3>
<ul>
<li>ğŸš€ <strong>å¿«é€Ÿå¯åŠ¨</strong>ï¼šæä¾›å¼€ç®±å³ç”¨çš„é…ç½®</li>
<li>ğŸ”§ <strong>è‡ªåŠ¨é…ç½®</strong>ï¼šæ ¹æ®ä¾èµ–è‡ªåŠ¨é…ç½®åº”ç”¨</li>
<li>ğŸ“¦ <strong>å†…åµŒæœåŠ¡å™¨</strong>ï¼šæ— éœ€å¤–éƒ¨å®¹å™¨å³å¯è¿è¡Œ</li>
<li>ğŸ¯ <strong>ç®€åŒ–é…ç½®</strong>ï¼šçº¦å®šä¼˜äºé…ç½®çš„ç†å¿µ</li>
</ul>
<h2 id="spring-æ ¸å¿ƒæ¦‚å¿µ">Spring æ ¸å¿ƒæ¦‚å¿µ</h2>
<p>Springæ¡†æ¶æœ‰ä¸‰ä¸ªæœ€å…³é”®çš„æ ¸å¿ƒæ¦‚å¿µï¼š<strong>IoCå®¹å™¨</strong>ã€<strong>ä¾èµ–æ³¨å…¥(DI)</strong>ã€<strong>é¢å‘åˆ‡é¢ç¼–ç¨‹(AOP)</strong>ã€‚</p>
<h2 id="ä¸€iocå®¹å™¨æ§åˆ¶åè½¬">ä¸€ã€IoCå®¹å™¨ï¼ˆæ§åˆ¶åè½¬ï¼‰</h2>
<h3 id="ä»€ä¹ˆæ˜¯ioc">ä»€ä¹ˆæ˜¯IoCï¼Ÿ</h3>
<p><strong>IoC (Inversion of Control)</strong> æ§åˆ¶åè½¬ï¼Œæ˜¯ä¸€ç§è®¾è®¡åŸåˆ™ã€‚ä¼ ç»Ÿçš„ç¨‹åºè®¾è®¡ä¸­ï¼Œå¯¹è±¡çš„åˆ›å»ºå’Œä¾èµ–å…³ç³»ç”±ç¨‹åºä»£ç ç›´æ¥æ§åˆ¶ï¼Œè€ŒIoCå°†è¿™ç§æ§åˆ¶æƒäº¤ç»™äº†æ¡†æ¶ã€‚</p>
<h3 id="ä¼ ç»Ÿæ–¹å¼-vs-iocæ–¹å¼">ä¼ ç»Ÿæ–¹å¼ vs IoCæ–¹å¼</h3>
<p><strong>ä¼ ç»Ÿæ–¹å¼</strong>ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">UserService</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">UserDao</span><span class="w"> </span><span class="n">userDao</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">UserDao</span><span class="p">();</span><span class="w"> </span><span class="c1">// æ‰‹åŠ¨åˆ›å»ºä¾èµ–</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">saveUser</span><span class="p">(</span><span class="n">User</span><span class="w"> </span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">userDao</span><span class="p">.</span><span class="na">save</span><span class="p">(</span><span class="n">user</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p><strong>IoCæ–¹å¼</strong>ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Service</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">UserService</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Autowired</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">UserDao</span><span class="w"> </span><span class="n">userDao</span><span class="p">;</span><span class="w"> </span><span class="c1">// æ¡†æ¶è‡ªåŠ¨æ³¨å…¥</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">saveUser</span><span class="p">(</span><span class="n">User</span><span class="w"> </span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">userDao</span><span class="p">.</span><span class="na">save</span><span class="p">(</span><span class="n">user</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="iocçš„ä¼˜åŠ¿">IoCçš„ä¼˜åŠ¿</h3>
<ol>
<li><strong>é™ä½è€¦åˆåº¦</strong>ï¼šå¯¹è±¡ä¹‹é—´çš„ä¾èµ–å…³ç³»ç”±æ¡†æ¶ç®¡ç†</li>
<li><strong>æé«˜å¯æµ‹è¯•æ€§</strong>ï¼šä¾¿äºè¿›è¡Œå•å…ƒæµ‹è¯•å’ŒMock</li>
<li><strong>å¢å¼ºå¯ç»´æŠ¤æ€§</strong>ï¼šä¿®æ”¹ä¾èµ–å…³ç³»æ— éœ€ä¿®æ”¹ä¸šåŠ¡ä»£ç </li>
<li><strong>æ”¯æŒé…ç½®åŒ–</strong>ï¼šå¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶ç®¡ç†å¯¹è±¡å…³ç³»</li>
</ol>
<h2 id="äºŒä¾èµ–æ³¨å…¥di">äºŒã€ä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰</h2>
<h3 id="ä»€ä¹ˆæ˜¯ä¾èµ–æ³¨å…¥">ä»€ä¹ˆæ˜¯ä¾èµ–æ³¨å…¥ï¼Ÿ</h3>
<p><strong>DI (Dependency Injection)</strong> ä¾èµ–æ³¨å…¥ï¼Œæ˜¯IoCå®¹å™¨çš„å…·ä½“å®ç°æ–¹å¼ã€‚å®ƒæ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œç”¨äºå®ç°å¯¹è±¡ä¹‹é—´çš„æ¾è€¦åˆã€‚</p>
<h3 id="ä¸‰ç§æ³¨å…¥æ–¹å¼">ä¸‰ç§æ³¨å…¥æ–¹å¼</h3>
<h4 id="1-å­—æ®µæ³¨å…¥field-injection">1. å­—æ®µæ³¨å…¥ï¼ˆField Injectionï¼‰</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Service</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">UserService</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Autowired</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">UserDao</span><span class="w"> </span><span class="n">userDao</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Autowired</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">EmailService</span><span class="w"> </span><span class="n">emailService</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p><strong>ç‰¹ç‚¹</strong>ï¼š</p>
<ul>
<li>âœ… ä»£ç ç®€æ´</li>
<li>âŒ éš¾ä»¥è¿›è¡Œå•å…ƒæµ‹è¯•</li>
<li>âŒ è¿åäº†å°è£…åŸåˆ™</li>
</ul>
<h4 id="2-æ„é€ å™¨æ³¨å…¥constructor-injection-æ¨è">2. æ„é€ å™¨æ³¨å…¥ï¼ˆConstructor Injectionï¼‰â­ æ¨è</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Service</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">UserService</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">UserDao</span><span class="w"> </span><span class="n">userDao</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">EmailService</span><span class="w"> </span><span class="n">emailService</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Autowired</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">UserService</span><span class="p">(</span><span class="n">UserDao</span><span class="w"> </span><span class="n">userDao</span><span class="p">,</span><span class="w"> </span><span class="n">EmailService</span><span class="w"> </span><span class="n">emailService</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">userDao</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">userDao</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">emailService</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">emailService</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p><strong>ç‰¹ç‚¹</strong>ï¼š</p>
<ul>
<li>âœ… ä¿è¯ä¾èµ–ä¸å¯å˜ï¼ˆfinalï¼‰</li>
<li>âœ… ä¾¿äºå•å…ƒæµ‹è¯•</li>
<li>âœ… åœ¨å¯¹è±¡åˆ›å»ºæ—¶å°±ç¡®ä¿ä¾èµ–å®Œæ•´</li>
<li>âœ… ç¬¦åˆé¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™</li>
</ul>
<h4 id="3-setteræ³¨å…¥setter-injection">3. Setteræ³¨å…¥ï¼ˆSetter Injectionï¼‰</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Service</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">UserService</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">UserDao</span><span class="w"> </span><span class="n">userDao</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">EmailService</span><span class="w"> </span><span class="n">emailService</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Autowired</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setUserDao</span><span class="p">(</span><span class="n">UserDao</span><span class="w"> </span><span class="n">userDao</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">userDao</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">userDao</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Autowired</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setEmailService</span><span class="p">(</span><span class="n">EmailService</span><span class="w"> </span><span class="n">emailService</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">emailService</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">emailService</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p><strong>ç‰¹ç‚¹</strong>ï¼š</p>
<ul>
<li>âœ… æ”¯æŒå¯é€‰ä¾èµ–</li>
<li>âœ… æ”¯æŒé‡æ–°é…ç½®</li>
<li>âŒ ä¾èµ–å¯èƒ½ä¸ºnull</li>
</ul>
<h3 id="beançš„ç”Ÿå‘½å‘¨æœŸ">Beançš„ç”Ÿå‘½å‘¨æœŸ</h3>
<p>Springå®¹å™¨ä¸­Beançš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Component</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MyBean</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">InitializingBean</span><span class="p">,</span><span class="w"> </span><span class="n">DisposableBean</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@PostConstruct</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">init</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;Beanåˆå§‹åŒ–&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">afterPropertiesSet</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;å±æ€§è®¾ç½®å®Œæˆå&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@PreDestroy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">cleanup</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;Beané”€æ¯å‰&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">destroy</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;Beané”€æ¯&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h2 id="ä¸‰aopé¢å‘åˆ‡é¢ç¼–ç¨‹">ä¸‰ã€AOPï¼ˆé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼‰</h2>
<h3 id="ä»€ä¹ˆæ˜¯aop">ä»€ä¹ˆæ˜¯AOPï¼Ÿ</h3>
<p><strong>AOP (Aspect-Oriented Programming)</strong> é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œæ˜¯ä¸€ç§ç¼–ç¨‹èŒƒå¼ï¼Œç”¨äºå°†æ¨ªåˆ‡å…³æ³¨ç‚¹ï¼ˆå¦‚æ—¥å¿—ã€å®‰å…¨ã€äº‹åŠ¡ç­‰ï¼‰ä»ä¸šåŠ¡é€»è¾‘ä¸­åˆ†ç¦»å‡ºæ¥ã€‚</p>
<h3 id="aopçš„æ ¸å¿ƒæ¦‚å¿µ">AOPçš„æ ¸å¿ƒæ¦‚å¿µ</h3>
<ul>
<li><strong>åˆ‡é¢(Aspect)</strong>ï¼šæ¨ªåˆ‡å…³æ³¨ç‚¹çš„æ¨¡å—åŒ–</li>
<li><strong>è¿æ¥ç‚¹(Join Point)</strong>ï¼šç¨‹åºæ‰§è¡Œçš„æŸä¸ªç‰¹å®šä½ç½®</li>
<li><strong>åˆ‡ç‚¹(Pointcut)</strong>ï¼šè¿æ¥ç‚¹çš„é›†åˆ</li>
<li><strong>é€šçŸ¥(Advice)</strong>ï¼šåœ¨åˆ‡ç‚¹æ‰§è¡Œçš„ä»£ç </li>
<li><strong>ç»‡å…¥(Weaving)</strong>ï¼šå°†åˆ‡é¢åº”ç”¨åˆ°ç›®æ ‡å¯¹è±¡çš„è¿‡ç¨‹</li>
</ul>
<h3 id="aopå®ç°åŸç†">AOPå®ç°åŸç†</h3>
<p>AOPä¸»è¦é€šè¿‡<strong>åŠ¨æ€ä»£ç†</strong>æ¥å®ç°ï¼š</p>
<ol>
<li><strong>JDKåŠ¨æ€ä»£ç†</strong>ï¼šåŸºäºæ¥å£çš„ä»£ç†</li>
<li><strong>CGLIBä»£ç†</strong>ï¼šåŸºäºç±»çš„ä»£ç†</li>
</ol>
<h3 id="aopå®é™…åº”ç”¨">AOPå®é™…åº”ç”¨</h3>
<h4 id="1-æ—¥å¿—åˆ‡é¢">1. æ—¥å¿—åˆ‡é¢</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Aspect</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Component</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">LoggingAspect</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Around</span><span class="p">(</span><span class="s">&#34;@annotation(org.springframework.web.bind.annotation.RequestMapping)&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="nf">logExecutionTime</span><span class="p">(</span><span class="n">ProceedingJoinPoint</span><span class="w"> </span><span class="n">joinPoint</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Throwable</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kt">long</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="na">currentTimeMillis</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Object</span><span class="w"> </span><span class="n">proceed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">joinPoint</span><span class="p">.</span><span class="na">proceed</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kt">long</span><span class="w"> </span><span class="n">executionTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="na">currentTimeMillis</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">joinPoint</span><span class="p">.</span><span class="na">getSignature</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34; executed in &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">executionTime</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34; ms&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">proceed</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="2-äº‹åŠ¡ç®¡ç†">2. äº‹åŠ¡ç®¡ç†</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Service</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Transactional</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">UserService</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Transactional</span><span class="p">(</span><span class="n">rollbackFor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Exception</span><span class="p">.</span><span class="na">class</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">transferMoney</span><span class="p">(</span><span class="n">Long</span><span class="w"> </span><span class="n">fromId</span><span class="p">,</span><span class="w"> </span><span class="n">Long</span><span class="w"> </span><span class="n">toId</span><span class="p">,</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">amount</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// ä¸šåŠ¡é€»è¾‘ï¼Œäº‹åŠ¡ç”±AOPè‡ªåŠ¨ç®¡ç†</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">accountService</span><span class="p">.</span><span class="na">debit</span><span class="p">(</span><span class="n">fromId</span><span class="p">,</span><span class="w"> </span><span class="n">amount</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">accountService</span><span class="p">.</span><span class="na">credit</span><span class="p">(</span><span class="n">toId</span><span class="p">,</span><span class="w"> </span><span class="n">amount</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="3-æƒé™æ§åˆ¶">3. æƒé™æ§åˆ¶</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Aspect</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Component</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SecurityAspect</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Before</span><span class="p">(</span><span class="s">&#34;@annotation(RequireRole)&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">checkPermission</span><span class="p">(</span><span class="n">JoinPoint</span><span class="w"> </span><span class="n">joinPoint</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// æƒé™æ£€æŸ¥é€»è¾‘</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">RequireRole</span><span class="w"> </span><span class="n">requireRole</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getAnnotation</span><span class="p">(</span><span class="n">joinPoint</span><span class="p">,</span><span class="w"> </span><span class="n">RequireRole</span><span class="p">.</span><span class="na">class</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">hasRole</span><span class="p">(</span><span class="n">requireRole</span><span class="p">.</span><span class="na">value</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SecurityException</span><span class="p">(</span><span class="s">&#34;æƒé™ä¸è¶³&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="aopçš„ä¼˜åŠ¿">AOPçš„ä¼˜åŠ¿</h3>
<ol>
<li><strong>å…³æ³¨ç‚¹åˆ†ç¦»</strong>ï¼šä¸šåŠ¡é€»è¾‘ä¸æ¨ªåˆ‡å…³æ³¨ç‚¹åˆ†ç¦»</li>
<li><strong>ä»£ç å¤ç”¨</strong>ï¼šæ¨ªåˆ‡é€»è¾‘å¯ä»¥åœ¨å¤šä¸ªåœ°æ–¹å¤ç”¨</li>
<li><strong>æ˜“äºç»´æŠ¤</strong>ï¼šä¿®æ”¹æ¨ªåˆ‡é€»è¾‘ä¸å½±å“ä¸šåŠ¡ä»£ç </li>
<li><strong>åŠ¨æ€æ€§</strong>ï¼šå¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€æ·»åŠ æˆ–ç§»é™¤åˆ‡é¢</li>
</ol>
<h2 id="springbootè‡ªåŠ¨é…ç½®">SpringBootè‡ªåŠ¨é…ç½®</h2>
<h3 id="è‡ªåŠ¨é…ç½®åŸç†">è‡ªåŠ¨é…ç½®åŸç†</h3>
<p>SpringBooté€šè¿‡<code>@EnableAutoConfiguration</code>æ³¨è§£å®ç°è‡ªåŠ¨é…ç½®ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@SpringBootApplication</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Application</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">SpringApplication</span><span class="p">.</span><span class="na">run</span><span class="p">(</span><span class="n">Application</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p><code>@SpringBootApplication</code>åŒ…å«äº†ï¼š</p>
<ul>
<li><code>@SpringBootConfiguration</code></li>
<li><code>@EnableAutoConfiguration</code></li>
<li><code>@ComponentScan</code></li>
</ul>
<h3 id="æ¡ä»¶æ³¨è§£">æ¡ä»¶æ³¨è§£</h3>
<p>SpringBootä½¿ç”¨æ¡ä»¶æ³¨è§£æ¥å†³å®šæ˜¯å¦å¯ç”¨æŸä¸ªé…ç½®ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Configuration</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@ConditionalOnClass</span><span class="p">(</span><span class="n">DataSource</span><span class="p">.</span><span class="na">class</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@ConditionalOnProperty</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;spring.datasource.url&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">DataSourceAutoConfiguration</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Bean</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@ConditionalOnMissingBean</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">DataSource</span><span class="w"> </span><span class="nf">dataSource</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HikariDataSource</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h2 id="æœ€ä½³å®è·µ">æœ€ä½³å®è·µ</h2>
<h3 id="1-ä¾èµ–æ³¨å…¥æœ€ä½³å®è·µ">1. ä¾èµ–æ³¨å…¥æœ€ä½³å®è·µ</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Service</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">UserService</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">UserRepository</span><span class="w"> </span><span class="n">userRepository</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">EmailService</span><span class="w"> </span><span class="n">emailService</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// æ¨èï¼šæ„é€ å™¨æ³¨å…¥</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">UserService</span><span class="p">(</span><span class="n">UserRepository</span><span class="w"> </span><span class="n">userRepository</span><span class="p">,</span><span class="w"> </span><span class="n">EmailService</span><span class="w"> </span><span class="n">emailService</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">userRepository</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">userRepository</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">emailService</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">emailService</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="2-é…ç½®ç±»çš„ä½¿ç”¨">2. é…ç½®ç±»çš„ä½¿ç”¨</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Configuration</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@EnableConfigurationProperties</span><span class="p">(</span><span class="n">AppProperties</span><span class="p">.</span><span class="na">class</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">AppConfig</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Bean</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@ConditionalOnMissingBean</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">RestTemplate</span><span class="w"> </span><span class="nf">restTemplate</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RestTemplate</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="3-å±æ€§é…ç½®">3. å±æ€§é…ç½®</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="c"># application.yml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">app</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">MyApplication</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="m">1.0.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">features</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">feature1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">feature2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spring</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">datasource</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l">jdbc:mysql://localhost:3306/mydb</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="l">${DB_USERNAME:root}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l">${DB_PASSWORD:password}</span><span class="w">
</span></span></span></code></pre></div><h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>SpringBooté€šè¿‡IoCã€DIå’ŒAOPä¸‰å¤§æ ¸å¿ƒæ¦‚å¿µï¼Œå®ç°äº†ï¼š</p>
<ol>
<li><strong>IoCå®¹å™¨</strong>ï¼šç®¡ç†å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸå’Œä¾èµ–å…³ç³»</li>
<li><strong>ä¾èµ–æ³¨å…¥</strong>ï¼šå®ç°æ¾è€¦åˆçš„å¯¹è±¡å…³ç³»</li>
<li><strong>é¢å‘åˆ‡é¢ç¼–ç¨‹</strong>ï¼šåˆ†ç¦»æ¨ªåˆ‡å…³æ³¨ç‚¹ï¼Œæé«˜ä»£ç çš„æ¨¡å—åŒ–ç¨‹åº¦</li>
</ol>
<p>è¿™äº›æ¦‚å¿µçš„ç»“åˆä½¿ç”¨ï¼Œè®©SpringBootæˆä¸ºäº†Javaå¼€å‘ä¸­æœ€å—æ¬¢è¿çš„æ¡†æ¶ï¼Œå¤§å¤§æå‡äº†å¼€å‘æ•ˆç‡å’Œä»£ç è´¨é‡ã€‚</p>
<hr>
<p><em>ç†è§£è¿™äº›æ ¸å¿ƒæ¦‚å¿µæ˜¯æŒæ¡SpringBootçš„å…³é”®ï¼Œå»ºè®®é€šè¿‡å®é™…é¡¹ç›®æ¥åŠ æ·±ç†è§£ã€‚</em></p>
]]></content:encoded>
    </item>
    <item>
      <title>Git ç‰ˆæœ¬æ§åˆ¶å­¦ä¹ ç¬”è®°</title>
      <link>https://tyhzxh.github.io/posts/git-notes/</link>
      <pubDate>Fri, 09 Feb 2024 17:44:43 +0800</pubDate>
      <guid>https://tyhzxh.github.io/posts/git-notes/</guid>
      <description>Gitç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿçš„åŸºç¡€æ¦‚å¿µå’Œå¸¸ç”¨æ“ä½œï¼ŒåŒ…æ‹¬å·¥ä½œåŒºã€æš‚å­˜åŒºã€ç‰ˆæœ¬åº“çš„æ¦‚å¿µä»¥åŠå„ç§Gitå‘½ä»¤çš„ä½¿ç”¨æ–¹æ³•</description>
      <content:encoded><![CDATA[<blockquote>
<p>æœ¬æ–‡æ˜¯å­¦ä¹ å»–é›ªå³°Gitæ•™ç¨‹çš„å­¦ä¹ ç¬”è®°ï¼Œæ•´ç†äº†Gitçš„åŸºç¡€æ¦‚å¿µå’Œå¸¸ç”¨æ“ä½œã€‚</p></blockquote>
<h2 id="åŸºç¡€æ¦‚å¿µ">åŸºç¡€æ¦‚å¿µ</h2>
<p><em><strong>åœ¨.gitæ–‡ä»¶æ‰€åœ¨ç›®å½•ä¸‹è¿›è¡Œæ“ä½œ</strong></em></p>
<p>Gitæœ‰ä¸‰ä¸ªé‡è¦çš„åŒºåŸŸï¼š</p>
<ol>
<li><strong>å·¥ä½œåŒº(Working Directory)</strong> - æ‰€å¤„çš„æ–‡ä»¶ç›®å½•</li>
<li><strong>æš‚å­˜åŒº(Stage)</strong> - é‡ç‚¹æ¦‚å¿µï¼Œä¸´æ—¶å­˜å‚¨ä¿®æ”¹çš„åœ°æ–¹</li>
<li><strong>ç‰ˆæœ¬åº“(Repository)</strong> - å·¥ä½œåŒºæœ‰ä¸€ä¸ªéšè—ç›®å½• <code>.git</code>ï¼Œè¿™ä¸ªä¸ç®—å·¥ä½œåŒºï¼Œè€Œæ˜¯Gitçš„ç‰ˆæœ¬åº“</li>
</ol>
<blockquote>
<p><strong>é‡è¦æç¤º</strong>ï¼šåˆ›å»ºGitç‰ˆæœ¬åº“æ—¶ï¼ŒGitè‡ªåŠ¨ä¸ºæˆ‘ä»¬åˆ›å»ºäº†å”¯ä¸€ä¸€ä¸ªmaster(main)åˆ†æ”¯ï¼Œæ‰€ä»¥<code>git commit</code>å°±æ˜¯å¾€master(main)åˆ†æ”¯ä¸Šæäº¤æ›´æ”¹ã€‚</p></blockquote>
<h2 id="åŸºç¡€æ“ä½œwindowsä¸‹">åŸºç¡€æ“ä½œ(Windowsä¸‹)</h2>
<p><strong>æ ¸å¿ƒç†å¿µ</strong>ï¼š<code>git add</code>å‘½ä»¤å®é™…ä¸Šå°±æ˜¯æŠŠè¦æäº¤çš„æ‰€æœ‰ä¿®æ”¹æ”¾åˆ°æš‚å­˜åŒºï¼ˆStageï¼‰ï¼Œç„¶åï¼Œæ‰§è¡Œ<code>git commit</code>å°±å¯ä»¥ä¸€æ¬¡æ€§æŠŠæš‚å­˜åŒºçš„æ‰€æœ‰ä¿®æ”¹æäº¤åˆ°åˆ†æ”¯ã€‚</p>
<p><strong>æ¨èç¯å¢ƒ</strong>ï¼šåœ¨PowerShellæˆ–Git Bashä¸‹è¾“å…¥å‘½ä»¤
<em>å»ºè®®ä½¿ç”¨Git Bash - æ”¯æŒå¾ˆå¤šLinuxä¸‹çš„å‘½ä»¤</em></p>
<h3 id="åˆå§‹åŒ–å’Œæ·»åŠ æ–‡ä»¶">åˆå§‹åŒ–å’Œæ·»åŠ æ–‡ä»¶</h3>
<ol>
<li><strong>åˆå§‹åŒ–Gitä»“åº“</strong>ï¼šä½¿ç”¨<code>git init</code>å‘½ä»¤</li>
<li><strong>æ·»åŠ æ–‡ä»¶åˆ°Gitä»“åº“</strong>ï¼Œåˆ†ä¸¤æ­¥ï¼š
<ul>
<li>ä½¿ç”¨å‘½ä»¤<code>git add &lt;file&gt;</code>ï¼Œæ³¨æ„ï¼Œå¯åå¤å¤šæ¬¡ä½¿ç”¨ï¼Œæ·»åŠ å¤šä¸ªå·¥ä½œåŒºæ–‡ä»¶åˆ°æš‚å­˜åŒº</li>
<li>ä½¿ç”¨å‘½ä»¤<code>git commit -m &lt;message&gt;</code>æ·»åŠ æš‚å­˜åŒºæ‰€æœ‰æ–‡ä»¶åˆ°Gitä»“åº“ï¼Œå®Œæˆ</li>
</ul>
</li>
</ol>
<h3 id="-å®ç”¨æŠ€å·§">ğŸ’¡ å®ç”¨æŠ€å·§</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># ä¸€æ¬¡æ€§æ·»åŠ æ‰€æœ‰æ”¹åŠ¨</span>
</span></span><span class="line"><span class="cl">git add .
</span></span></code></pre></div><h2 id="æ£€æŸ¥æ“ä½œ">æ£€æŸ¥æ“ä½œ</h2>
<h3 id="æŸ¥çœ‹çŠ¶æ€">æŸ¥çœ‹çŠ¶æ€</h3>
<p>æ£€æŸ¥ <em><strong>å·¥ä½œåŒº+æš‚å­˜åŒº</strong></em> çš„çŠ¶æ€ï¼Œä½¿ç”¨<code>git status</code>å‘½ä»¤ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Changes to be committed:
</span></span><span class="line"><span class="cl"><span class="o">(</span>use <span class="s2">&#34;git restore --staged &lt;file&gt;...&#34;</span> to unstage<span class="o">)</span>
</span></span><span class="line"><span class="cl">        modified:   1.md
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Changes not staged <span class="k">for</span> commit:
</span></span><span class="line"><span class="cl"><span class="o">(</span>use <span class="s2">&#34;git add &lt;file&gt;...&#34;</span> to update what will be committed<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">(</span>use <span class="s2">&#34;git restore &lt;file&gt;...&#34;</span> to discard changes in working directory<span class="o">)</span>
</span></span><span class="line"><span class="cl">        modified:   1.md
</span></span></code></pre></div><h3 id="æŸ¥çœ‹ä¿®æ”¹å†…å®¹">æŸ¥çœ‹ä¿®æ”¹å†…å®¹</h3>
<p>å¦‚æœ<code>git status</code>å‘Šè¯‰ä½ æœ‰æ–‡ä»¶è¢«ä¿®æ”¹è¿‡ï¼Œç”¨<code>git diff</code>å¯ä»¥æŸ¥çœ‹ä¿®æ”¹å†…å®¹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ git diff readme.txt 
</span></span><span class="line"><span class="cl">diff --git a/readme.txt b/readme.txt
</span></span><span class="line"><span class="cl">index 46d49bf..9247db6 <span class="m">100644</span>
</span></span><span class="line"><span class="cl">--- a/readme.txt
</span></span><span class="line"><span class="cl">+++ b/readme.txt
</span></span><span class="line"><span class="cl">@@ -1,2 +1,2 @@
</span></span><span class="line"><span class="cl">-Git is a version control system.
</span></span><span class="line"><span class="cl">+Git is a distributed version control system.
</span></span><span class="line"><span class="cl"> Git is free software.
</span></span></code></pre></div><h3 id="æŸ¥çœ‹å†å²è®°å½•">æŸ¥çœ‹å†å²è®°å½•</h3>
<p>åœ¨Gitä¸­ï¼Œæˆ‘ä»¬ç”¨<code>git log</code>å‘½ä»¤æŸ¥çœ‹å†å²ä¿®æ”¹è®°å½•ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ git log
</span></span><span class="line"><span class="cl">commit 1094adb7b9b3807259d8cb349e7df1d4d6477073 <span class="o">(</span>HEAD -&gt; master<span class="o">)</span>
</span></span><span class="line"><span class="cl">Author: Michael Liao &lt;askxuefeng@gmail.com&gt;
</span></span><span class="line"><span class="cl">Date:   Fri May <span class="m">18</span> 21:06:15 <span class="m">2018</span> +0800
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">append GPL
</span></span></code></pre></div><p>å¦‚æœå«Œè¾“å‡ºè®°å½•å¤ªå¤šï¼Œå¯ä»¥åŠ ä¸Š<code>--pretty=oneline</code>å‚æ•°ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ git log --pretty<span class="o">=</span>oneline
</span></span><span class="line"><span class="cl">049c19eb21cbe21986810b7de105d3d7ab584d1c <span class="o">(</span>HEAD -&gt; main<span class="o">)</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl">a87bfdefbae52977a72b7955a406eab118a04df5 w
</span></span><span class="line"><span class="cl">1dc3373085994a336323614fa726732b582f22f2 <span class="m">1</span>
</span></span></code></pre></div><p><strong>è¯´æ˜</strong>ï¼šä¸€å¤§ä¸²ç±»ä¼¼<code>049c19eb21cbe...</code>çš„æ˜¯commit idï¼ˆç‰ˆæœ¬å·ï¼‰ï¼Œç”±SHA1è®¡ç®—å‡ºæ¥çš„ä¸€ä¸ªéå¸¸å¤§çš„æ•°å­—ï¼Œç”¨åå…­è¿›åˆ¶è¡¨ç¤ºã€‚</p>
<h3 id="ç‰ˆæœ¬æŒ‡é’ˆæ¦‚å¿µ">ç‰ˆæœ¬æŒ‡é’ˆæ¦‚å¿µ</h3>
<p>åœ¨Gitä¸­ï¼š</p>
<ul>
<li><strong>HEAD</strong> è¡¨ç¤ºå½“å‰ç‰ˆæœ¬ï¼Œä¹Ÿå°±æ˜¯æœ€æ–°çš„æäº¤</li>
<li><strong>HEAD^</strong> è¡¨ç¤ºä¸Šä¸€ä¸ªç‰ˆæœ¬</li>
<li><strong>HEAD^^</strong> è¡¨ç¤ºä¸Šä¸Šä¸€ä¸ªç‰ˆæœ¬</li>
<li><strong>HEAD~100</strong> è¡¨ç¤ºå¾€ä¸Š100ä¸ªç‰ˆæœ¬</li>
</ul>
<h2 id="å›é€€æ“ä½œ">å›é€€æ“ä½œ</h2>
<h3 id="å·¥ä½œåŒºå›é€€">å·¥ä½œåŒºå›é€€</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># ä¸¢å¼ƒå·¥ä½œåŒºçš„ä¿®æ”¹</span>
</span></span><span class="line"><span class="cl">git checkout -- file
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹</span>
</span></span><span class="line"><span class="cl">git checkout -- readme.txt
</span></span></code></pre></div><p><strong>æ³¨æ„</strong>ï¼š<code>--</code> å¾ˆé‡è¦ï¼Œä¸èƒ½çœç•¥ï¼</p>
<h3 id="æš‚å­˜åŒºå›é€€">æš‚å­˜åŒºå›é€€</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æŠŠæš‚å­˜åŒºçš„ä¿®æ”¹æ’¤é”€æ‰ï¼ˆunstageï¼‰ï¼Œé‡æ–°æ”¾å›å·¥ä½œåŒº</span>
</span></span><span class="line"><span class="cl">git reset HEAD &lt;file&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¤ºä¾‹</span>
</span></span><span class="line"><span class="cl">git reset HEAD 1.md
</span></span></code></pre></div><h3 id="ç‰ˆæœ¬åº“å›é€€">ç‰ˆæœ¬åº“å›é€€</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># å›é€€åˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬</span>
</span></span><span class="line"><span class="cl">git reset --hard HEAD^
</span></span></code></pre></div><p><strong>ä¸ªäººç†è§£</strong>ï¼šç‰ˆæœ¬å›é€€å°±æ˜¯ä¿®æ”¹HEADæŒ‡é’ˆçš„æŒ‡å‘ï¼ˆHEADæŒ‡å‘å½“å‰æ‰€å¤„ç‰ˆæœ¬ï¼‰</p>
<p>å¦‚æœå›é€€åæƒ³è¦æ¢å¤ï¼Œå¯ä»¥ä½¿ç”¨<code>git reflog</code>æ¥æŸ¥çœ‹æ¯ä¸€æ¬¡å‘½ä»¤çš„è®°å½•ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ git reflog
</span></span><span class="line"><span class="cl">e475afc HEAD@<span class="o">{</span>1<span class="o">}</span>: reset: moving to HEAD^
</span></span><span class="line"><span class="cl">1094adb <span class="o">(</span>HEAD -&gt; master<span class="o">)</span> HEAD@<span class="o">{</span>2<span class="o">}</span>: commit: append GPL
</span></span><span class="line"><span class="cl">e475afc HEAD@<span class="o">{</span>3<span class="o">}</span>: commit: add distributed
</span></span><span class="line"><span class="cl">eaadf4e HEAD@<span class="o">{</span>4<span class="o">}</span>: commit <span class="o">(</span>initial<span class="o">)</span>: wrote a readme file
</span></span></code></pre></div><p>ä»è¾“å‡ºå¯çŸ¥ï¼Œå¯ä»¥é€šè¿‡commit idæ¥æ¢å¤åˆ°æŒ‡å®šç‰ˆæœ¬ã€‚</p>
<h2 id="åˆ é™¤æ“ä½œ">åˆ é™¤æ“ä½œ</h2>
<h3 id="æ™®é€šåˆ é™¤-vs-gitåˆ é™¤">æ™®é€šåˆ é™¤ vs Gitåˆ é™¤</h3>
<p><strong>æ™®é€šæƒ…å†µä¸‹</strong>ï¼šç›´æ¥åœ¨æ–‡ä»¶ç®¡ç†å™¨ä¸­åˆ é™¤æ–‡ä»¶ï¼Œæˆ–è€…ç”¨<code>rm</code>å‘½ä»¤åˆ é™¤ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">rm test.txt
</span></span></code></pre></div><p><strong>åœ¨Gitä¸­</strong>ï¼Œåˆ é™¤æ–‡ä»¶åæŸ¥çœ‹çŠ¶æ€ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ git status
</span></span><span class="line"><span class="cl">On branch master
</span></span><span class="line"><span class="cl">Changes not staged <span class="k">for</span> commit:
</span></span><span class="line"><span class="cl"><span class="o">(</span>use <span class="s2">&#34;git add/rm &lt;file&gt;...&#34;</span> to update what will be committed<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">(</span>use <span class="s2">&#34;git checkout -- &lt;file&gt;...&#34;</span> to discard changes in working directory<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">deleted:    test.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">no changes added to commit <span class="o">(</span>use <span class="s2">&#34;git add&#34;</span> and/or <span class="s2">&#34;git commit -a&#34;</span><span class="o">)</span>
</span></span></code></pre></div><p>å¯ä»¥çœ‹å‡ºå·¥ä½œåŒºå’Œç‰ˆæœ¬åº“ä¸ä¸€è‡´ï¼Œæ­¤æ—¶æœ‰ä¸¤ä¸ªé€‰æ‹©ï¼š</p>
<h3 id="é€‰æ‹©1ç¡®å®è¦åˆ é™¤">é€‰æ‹©1ï¼šç¡®å®è¦åˆ é™¤</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># ä»ç‰ˆæœ¬åº“ä¸­åˆ é™¤æ–‡ä»¶</span>
</span></span><span class="line"><span class="cl">git rm test.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æäº¤åˆ é™¤æ“ä½œ</span>
</span></span><span class="line"><span class="cl">git commit -m <span class="s2">&#34;remove test.txt&#34;</span>
</span></span></code></pre></div><h3 id="é€‰æ‹©2è¯¯åˆ æ¢å¤">é€‰æ‹©2ï¼šè¯¯åˆ æ¢å¤</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># ä»ç‰ˆæœ¬åº“æ¢å¤æ–‡ä»¶åˆ°å·¥ä½œåŒº</span>
</span></span><span class="line"><span class="cl">git checkout -- test.txt
</span></span></code></pre></div><blockquote>
<p><strong>é‡è¦æé†’</strong>ï¼š<code>git checkout</code>å…¶å®æ˜¯ç”¨ç‰ˆæœ¬åº“é‡Œçš„ç‰ˆæœ¬æ›¿æ¢å·¥ä½œåŒºçš„ç‰ˆæœ¬ï¼Œæ— è®ºå·¥ä½œåŒºæ˜¯ä¿®æ”¹è¿˜æ˜¯åˆ é™¤ï¼Œéƒ½å¯ä»¥&quot;ä¸€é”®è¿˜åŸ&quot;ã€‚ä½†æ˜¯ï¼Œä»æ¥æ²¡æœ‰è¢«æ·»åŠ åˆ°ç‰ˆæœ¬åº“å°±è¢«åˆ é™¤çš„æ–‡ä»¶ï¼Œæ˜¯æ— æ³•æ¢å¤çš„ï¼</p></blockquote>
<h2 id="è¿œç¨‹ä»“åº“">è¿œç¨‹ä»“åº“</h2>
<h3 id="åŸºæœ¬æ“ä½œ">åŸºæœ¬æ“ä½œ</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æ¨é€åˆ°è¿œç¨‹ä»“åº“</span>
</span></span><span class="line"><span class="cl">git push origin master
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ·»åŠ è¿œç¨‹ä»“åº“</span>
</span></span><span class="line"><span class="cl">git remote add origin https://github.com/tyhzxh/tyhzxh.github.io.git
</span></span></code></pre></div><h3 id="ä¸ªäººç»éªŒ">ä¸ªäººç»éªŒ</h3>
<p>å¦‚æœæ˜¯é€šè¿‡<code>git clone</code>è·å–çš„ä»“åº“ï¼Œæœ¬åœ°ä»“åº“å’Œè¿œç¨‹ä»“åº“ä¼šè‡ªåŠ¨åŒæ­¥ï¼Œæ‰€ä»¥æ¯æ¬¡åªéœ€è¦ï¼š</p>
<ol>
<li>åœ¨æœ¬åœ°å®Œæˆä¿®æ”¹å’Œæäº¤</li>
<li>ä½¿ç”¨<code>git push</code>æ¨é€åˆ°è¿œç¨‹ä»“åº“</li>
</ol>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>Gitçš„æ ¸å¿ƒæ¦‚å¿µæ˜¯ç†è§£ä¸‰ä¸ªåŒºåŸŸï¼ˆå·¥ä½œåŒºã€æš‚å­˜åŒºã€ç‰ˆæœ¬åº“ï¼‰ä¹‹é—´çš„å…³ç³»ï¼ŒæŒæ¡äº†è¿™ä¸ªæ¦‚å¿µï¼ŒGitçš„å„ç§æ“ä½œå°±å˜å¾—æ¸…æ™°æ˜äº†ã€‚è®°ä½ï¼š</p>
<ul>
<li><code>git add</code> æ˜¯å°†ä¿®æ”¹ä»å·¥ä½œåŒºæäº¤åˆ°æš‚å­˜åŒº</li>
<li><code>git commit</code> æ˜¯å°†æš‚å­˜åŒºçš„ä¿®æ”¹æäº¤åˆ°ç‰ˆæœ¬åº“</li>
<li><code>git push</code> æ˜¯å°†æœ¬åœ°ç‰ˆæœ¬åº“åŒæ­¥åˆ°è¿œç¨‹ä»“åº“</li>
</ul>
<hr>
<p><em>å‚è€ƒèµ„æ–™ï¼šå»–é›ªå³°Gitæ•™ç¨‹</em></p>
]]></content:encoded>
    </item>
    <item>
      <title>Gitç‰ˆæœ¬æ§åˆ¶åŸºç¡€æŒ‡å—</title>
      <link>https://tyhzxh.github.io/posts/git-fundamentals-guide/</link>
      <pubDate>Fri, 09 Feb 2024 17:44:43 +0800</pubDate>
      <guid>https://tyhzxh.github.io/posts/git-fundamentals-guide/</guid>
      <description>Gitç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿçš„åŸºç¡€æ¦‚å¿µå’Œå¸¸ç”¨æ“ä½œæŒ‡å—ï¼ŒåŒ…æ‹¬å·¥ä½œåŒºã€æš‚å­˜åŒºã€ç‰ˆæœ¬åº“çš„æ¦‚å¿µï¼Œä»¥åŠæ–‡ä»¶æ“ä½œã€ç‰ˆæœ¬å›é€€ã€è¿œç¨‹ä»“åº“ç­‰æ ¸å¿ƒåŠŸèƒ½</description>
      <content:encoded><![CDATA[<h2 id="å‰è¨€">å‰è¨€</h2>
<p>æœ¬æ–‡æ˜¯å­¦ä¹ å»–é›ªå³°Gitæ•™ç¨‹çš„å­¦ä¹ ç¬”è®°ï¼Œæ¶µç›–äº†Gitç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿçš„åŸºç¡€æ¦‚å¿µå’Œå¸¸ç”¨æ“ä½œã€‚Gitæ˜¯ç›®å‰æœ€æµè¡Œçš„åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼ŒæŒæ¡Gitå¯¹äºè½¯ä»¶å¼€å‘è‡³å…³é‡è¦ã€‚</p>
<blockquote>
<p><strong>æ³¨æ„</strong>ï¼šæ‰€æœ‰Gitæ“ä½œéƒ½éœ€è¦åœ¨.gitæ–‡ä»¶æ‰€åœ¨ç›®å½•ä¸‹è¿›è¡Œ</p></blockquote>
<h2 id="åŸºç¡€æ¦‚å¿µ">åŸºç¡€æ¦‚å¿µ</h2>
<h3 id="gitçš„ä¸‰ä¸ªåŒºåŸŸ">Gitçš„ä¸‰ä¸ªåŒºåŸŸ</h3>
<p>Gitå°†æ–‡ä»¶ç®¡ç†åˆ†ä¸ºä¸‰ä¸ªä¸»è¦åŒºåŸŸï¼š</p>
<ol>
<li>
<p><strong>å·¥ä½œåŒºï¼ˆWorking Directoryï¼‰</strong></p>
<ul>
<li>å°±æ˜¯ä½ åœ¨ç”µè„‘é‡Œèƒ½çœ‹åˆ°çš„ç›®å½•</li>
<li>å­˜æ”¾é¡¹ç›®æ–‡ä»¶çš„åœ°æ–¹</li>
</ul>
</li>
<li>
<p><strong>æš‚å­˜åŒºï¼ˆStage/Indexï¼‰</strong> â­ <strong>é‡ç‚¹</strong></p>
<ul>
<li>ä¸´æ—¶å­˜æ”¾æ–‡ä»¶ä¿®æ”¹çš„åœ°æ–¹</li>
<li>ä½äº.gitç›®å½•ä¸­çš„indexæ–‡ä»¶</li>
</ul>
</li>
<li>
<p><strong>ç‰ˆæœ¬åº“ï¼ˆRepositoryï¼‰</strong></p>
<ul>
<li>å·¥ä½œåŒºæœ‰ä¸€ä¸ªéšè—ç›®å½•<code>.git</code>ï¼Œè¿™å°±æ˜¯Gitçš„ç‰ˆæœ¬åº“</li>
<li>åŒ…å«æš‚å­˜åŒºå’Œåˆ†æ”¯ä¿¡æ¯</li>
<li>Gitè‡ªåŠ¨åˆ›å»ºçš„ç¬¬ä¸€ä¸ªåˆ†æ”¯æ˜¯<code>master</code>ï¼ˆæˆ–<code>main</code>ï¼‰</li>
</ul>
</li>
</ol>
<h3 id="å·¥ä½œæµç¨‹">å·¥ä½œæµç¨‹</h3>
<pre tabindex="0"><code class="language-mermaid" data-lang="mermaid">graph LR
    A[å·¥ä½œåŒº] --&gt;|git add| B[æš‚å­˜åŒº]
    B --&gt;|git commit| C[ç‰ˆæœ¬åº“]
    C --&gt;|git checkout| A
</code></pre><p><strong>æ ¸å¿ƒç†å¿µ</strong>ï¼š</p>
<ul>
<li><code>git add</code>å‘½ä»¤æŠŠè¦æäº¤çš„æ‰€æœ‰ä¿®æ”¹æ”¾åˆ°æš‚å­˜åŒº</li>
<li><code>git commit</code>ä¸€æ¬¡æ€§æŠŠæš‚å­˜åŒºçš„æ‰€æœ‰ä¿®æ”¹æäº¤åˆ°åˆ†æ”¯</li>
</ul>
<h2 id="åŸºç¡€æ“ä½œ">åŸºç¡€æ“ä½œ</h2>
<h3 id="ç¯å¢ƒå‡†å¤‡">ç¯å¢ƒå‡†å¤‡</h3>
<p>æ¨èä½¿ç”¨Git Bashï¼Œå› ä¸ºå®ƒæ”¯æŒå¾ˆå¤šLinuxå‘½ä»¤ï¼Œåœ¨Windowsä¸‹æä¾›æ›´å¥½çš„ä½“éªŒã€‚</p>
<h3 id="ä»“åº“åˆå§‹åŒ–">ä»“åº“åˆå§‹åŒ–</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># åˆå§‹åŒ–Gitä»“åº“</span>
</span></span><span class="line"><span class="cl">git init
</span></span></code></pre></div><h3 id="æ–‡ä»¶æ·»åŠ å’Œæäº¤">æ–‡ä»¶æ·»åŠ å’Œæäº¤</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æ·»åŠ å•ä¸ªæ–‡ä»¶åˆ°æš‚å­˜åŒº</span>
</span></span><span class="line"><span class="cl">git add &lt;file&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ·»åŠ æ‰€æœ‰ä¿®æ”¹åˆ°æš‚å­˜åŒº â­ å¸¸ç”¨</span>
</span></span><span class="line"><span class="cl">git add .
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æäº¤æš‚å­˜åŒºçš„æ‰€æœ‰æ–‡ä»¶åˆ°ç‰ˆæœ¬åº“</span>
</span></span><span class="line"><span class="cl">git commit -m <span class="s2">&#34;æäº¤è¯´æ˜&#34;</span>
</span></span></code></pre></div><p><strong>å®Œæ•´æµç¨‹ç¤ºä¾‹</strong>ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 1. åˆ›å»ºæˆ–ä¿®æ”¹æ–‡ä»¶</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;Hello Git&#34;</span> &gt; readme.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 2. æ·»åŠ åˆ°æš‚å­˜åŒº</span>
</span></span><span class="line"><span class="cl">git add readme.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 3. æäº¤åˆ°ç‰ˆæœ¬åº“</span>
</span></span><span class="line"><span class="cl">git commit -m <span class="s2">&#34;add readme file&#34;</span>
</span></span></code></pre></div><h2 id="çŠ¶æ€æ£€æŸ¥å’Œå·®å¼‚æŸ¥çœ‹">çŠ¶æ€æ£€æŸ¥å’Œå·®å¼‚æŸ¥çœ‹</h2>
<h3 id="æŸ¥çœ‹ä»“åº“çŠ¶æ€">æŸ¥çœ‹ä»“åº“çŠ¶æ€</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹å·¥ä½œåŒºå’Œæš‚å­˜åŒºçš„çŠ¶æ€</span>
</span></span><span class="line"><span class="cl">git status
</span></span></code></pre></div><p><strong>çŠ¶æ€ç¤ºä¾‹</strong>ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Changes to be committed:
</span></span><span class="line"><span class="cl">  <span class="o">(</span>use <span class="s2">&#34;git restore --staged &lt;file&gt;...&#34;</span> to unstage<span class="o">)</span>
</span></span><span class="line"><span class="cl">        modified:   readme.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Changes not staged <span class="k">for</span> commit:
</span></span><span class="line"><span class="cl">  <span class="o">(</span>use <span class="s2">&#34;git add &lt;file&gt;...&#34;</span> to update what will be committed<span class="o">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">(</span>use <span class="s2">&#34;git restore &lt;file&gt;...&#34;</span> to discard changes in working directory<span class="o">)</span>
</span></span><span class="line"><span class="cl">        modified:   readme.txt
</span></span></code></pre></div><h3 id="æŸ¥çœ‹æ–‡ä»¶å·®å¼‚">æŸ¥çœ‹æ–‡ä»¶å·®å¼‚</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹å·¥ä½œåŒºå’Œæš‚å­˜åŒºçš„å·®å¼‚</span>
</span></span><span class="line"><span class="cl">git diff &lt;file&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹æš‚å­˜åŒºå’Œç‰ˆæœ¬åº“çš„å·®å¼‚</span>
</span></span><span class="line"><span class="cl">git diff --cached &lt;file&gt;
</span></span></code></pre></div><p><strong>å·®å¼‚ç¤ºä¾‹</strong>ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ git diff readme.txt 
</span></span><span class="line"><span class="cl">diff --git a/readme.txt b/readme.txt
</span></span><span class="line"><span class="cl">index 46d49bf..9247db6 <span class="m">100644</span>
</span></span><span class="line"><span class="cl">--- a/readme.txt
</span></span><span class="line"><span class="cl">+++ b/readme.txt
</span></span><span class="line"><span class="cl">@@ -1,2 +1,2 @@
</span></span><span class="line"><span class="cl">-Git is a version control system.
</span></span><span class="line"><span class="cl">+Git is a distributed version control system.
</span></span><span class="line"><span class="cl"> Git is free software.
</span></span></code></pre></div><h3 id="æŸ¥çœ‹æäº¤å†å²">æŸ¥çœ‹æäº¤å†å²</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹è¯¦ç»†çš„æäº¤å†å²</span>
</span></span><span class="line"><span class="cl">git log
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹ç®€æ´çš„æäº¤å†å²ï¼ˆæ¨èï¼‰</span>
</span></span><span class="line"><span class="cl">git log --pretty<span class="o">=</span>oneline
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹å›¾å½¢åŒ–çš„åˆ†æ”¯å†å²</span>
</span></span><span class="line"><span class="cl">git log --graph --pretty<span class="o">=</span>oneline --abbrev-commit
</span></span></code></pre></div><p><strong>å†å²è®°å½•ç¤ºä¾‹</strong>ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ git log --pretty<span class="o">=</span>oneline
</span></span><span class="line"><span class="cl">049c19eb21cbe21986810b7de105d3d7ab584d1c <span class="o">(</span>HEAD -&gt; main<span class="o">)</span> æœ€æ–°æäº¤
</span></span><span class="line"><span class="cl">a87bfdefbae52977a72b7955a406eab118a04df5 ç¬¬äºŒæ¬¡æäº¤
</span></span><span class="line"><span class="cl">1dc3373085994a336323614fa726732b582f22f2 åˆå§‹æäº¤
</span></span></code></pre></div><h2 id="ç‰ˆæœ¬å›é€€å’Œæ’¤é”€">ç‰ˆæœ¬å›é€€å’Œæ’¤é”€</h2>
<h3 id="ç‰ˆæœ¬æŒ‡é’ˆæ¦‚å¿µ">ç‰ˆæœ¬æŒ‡é’ˆæ¦‚å¿µ</h3>
<ul>
<li><strong>HEAD</strong>ï¼šè¡¨ç¤ºå½“å‰ç‰ˆæœ¬</li>
<li><strong>HEAD^</strong>ï¼šä¸Šä¸€ä¸ªç‰ˆæœ¬</li>
<li><strong>HEAD^^</strong>ï¼šä¸Šä¸Šä¸ªç‰ˆæœ¬</li>
<li><strong>HEAD~100</strong>ï¼šå¾€ä¸Š100ä¸ªç‰ˆæœ¬</li>
</ul>
<h3 id="ç‰ˆæœ¬å›é€€">ç‰ˆæœ¬å›é€€</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># å›é€€åˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬</span>
</span></span><span class="line"><span class="cl">git reset --hard HEAD^
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å›é€€åˆ°æŒ‡å®šç‰ˆæœ¬ï¼ˆä½¿ç”¨commit idï¼‰</span>
</span></span><span class="line"><span class="cl">git reset --hard 1094adb
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹å‘½ä»¤å†å²ï¼ˆæ‰¾å›commit idï¼‰</span>
</span></span><span class="line"><span class="cl">git reflog
</span></span></code></pre></div><p><strong>å›é€€ç¤ºä¾‹</strong>ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ git reset --hard HEAD^
</span></span><span class="line"><span class="cl">HEAD is now at e475afc add distributed
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">$ git reflog
</span></span><span class="line"><span class="cl">e475afc HEAD@<span class="o">{</span>1<span class="o">}</span>: reset: moving to HEAD^
</span></span><span class="line"><span class="cl">1094adb <span class="o">(</span>HEAD -&gt; master<span class="o">)</span> HEAD@<span class="o">{</span>2<span class="o">}</span>: commit: append GPL
</span></span><span class="line"><span class="cl">e475afc HEAD@<span class="o">{</span>3<span class="o">}</span>: commit: add distributed
</span></span></code></pre></div><h3 id="æ’¤é”€ä¿®æ”¹">æ’¤é”€ä¿®æ”¹</h3>
<h4 id="1-æ’¤é”€å·¥ä½œåŒºä¿®æ”¹">1. æ’¤é”€å·¥ä½œåŒºä¿®æ”¹</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># ä¸¢å¼ƒå·¥ä½œåŒºçš„ä¿®æ”¹ï¼ˆæ³¨æ„--å¾ˆé‡è¦ï¼‰</span>
</span></span><span class="line"><span class="cl">git checkout -- &lt;file&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æˆ–è€…ä½¿ç”¨æ–°çš„å‘½ä»¤</span>
</span></span><span class="line"><span class="cl">git restore &lt;file&gt;
</span></span></code></pre></div><h4 id="2-æ’¤é”€æš‚å­˜åŒºä¿®æ”¹">2. æ’¤é”€æš‚å­˜åŒºä¿®æ”¹</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æŠŠæš‚å­˜åŒºçš„ä¿®æ”¹æ’¤é”€ï¼Œé‡æ–°æ”¾å›å·¥ä½œåŒº</span>
</span></span><span class="line"><span class="cl">git reset HEAD &lt;file&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æˆ–è€…ä½¿ç”¨æ–°çš„å‘½ä»¤</span>
</span></span><span class="line"><span class="cl">git restore --staged &lt;file&gt;
</span></span></code></pre></div><h4 id="3-æ’¤é”€ç‰ˆæœ¬åº“ä¿®æ”¹">3. æ’¤é”€ç‰ˆæœ¬åº“ä¿®æ”¹</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># ç‰ˆæœ¬å›é€€ï¼ˆå¦‚ä¸Šæ‰€è¿°ï¼‰</span>
</span></span><span class="line"><span class="cl">git reset --hard HEAD^
</span></span></code></pre></div><h3 id="æ’¤é”€åœºæ™¯æ€»ç»“">æ’¤é”€åœºæ™¯æ€»ç»“</h3>
<table>
  <thead>
      <tr>
          <th>åœºæ™¯</th>
          <th>è§£å†³æ–¹æ¡ˆ</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>ä¿®æ”¹äº†å·¥ä½œåŒºæ–‡ä»¶ï¼Œæƒ³æ’¤é”€</td>
          <td><code>git checkout -- file</code></td>
      </tr>
      <tr>
          <td>ä¿®æ”¹äº†æ–‡ä»¶å¹¶æ·»åŠ åˆ°æš‚å­˜åŒºï¼Œæƒ³æ’¤é”€</td>
          <td>å…ˆ<code>git reset HEAD file</code>ï¼Œå†<code>git checkout -- file</code></td>
      </tr>
      <tr>
          <td>ä¿®æ”¹äº†æ–‡ä»¶å¹¶æäº¤åˆ°ç‰ˆæœ¬åº“ï¼Œæƒ³æ’¤é”€</td>
          <td><code>git reset --hard HEAD^</code></td>
      </tr>
  </tbody>
</table>
<h2 id="æ–‡ä»¶åˆ é™¤æ“ä½œ">æ–‡ä»¶åˆ é™¤æ“ä½œ</h2>
<h3 id="åˆ é™¤æ–‡ä»¶çš„ä¸¤ç§æƒ…å†µ">åˆ é™¤æ–‡ä»¶çš„ä¸¤ç§æƒ…å†µ</h3>
<h4 id="1-ç¡®å®è¦åˆ é™¤æ–‡ä»¶">1. ç¡®å®è¦åˆ é™¤æ–‡ä»¶</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># ä»å·¥ä½œåŒºåˆ é™¤æ–‡ä»¶</span>
</span></span><span class="line"><span class="cl">rm test.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ä»ç‰ˆæœ¬åº“åˆ é™¤æ–‡ä»¶</span>
</span></span><span class="line"><span class="cl">git rm test.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æäº¤åˆ é™¤æ“ä½œ</span>
</span></span><span class="line"><span class="cl">git commit -m <span class="s2">&#34;remove test.txt&#34;</span>
</span></span></code></pre></div><h4 id="2-è¯¯åˆ æ–‡ä»¶éœ€è¦æ¢å¤">2. è¯¯åˆ æ–‡ä»¶ï¼Œéœ€è¦æ¢å¤</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># ä»ç‰ˆæœ¬åº“æ¢å¤æ–‡ä»¶åˆ°å·¥ä½œåŒº</span>
</span></span><span class="line"><span class="cl">git checkout -- test.txt
</span></span></code></pre></div><p><strong>é‡è¦æé†’</strong>ï¼š</p>
<ul>
<li>åªèƒ½æ¢å¤æ–‡ä»¶åˆ°æœ€æ–°ç‰ˆæœ¬</li>
<li>ä¼šä¸¢å¤±æœ€è¿‘ä¸€æ¬¡æäº¤åçš„ä¿®æ”¹å†…å®¹</li>
<li>ä»æœªæ·»åŠ åˆ°ç‰ˆæœ¬åº“çš„æ–‡ä»¶æ— æ³•æ¢å¤</li>
</ul>
<h2 id="è¿œç¨‹ä»“åº“æ“ä½œ">è¿œç¨‹ä»“åº“æ“ä½œ</h2>
<h3 id="å…³è”è¿œç¨‹ä»“åº“">å…³è”è¿œç¨‹ä»“åº“</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æ·»åŠ è¿œç¨‹ä»“åº“</span>
</span></span><span class="line"><span class="cl">git remote add origin https://github.com/username/repository.git
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹è¿œç¨‹ä»“åº“</span>
</span></span><span class="line"><span class="cl">git remote -v
</span></span></code></pre></div><h3 id="æ¨é€åˆ°è¿œç¨‹ä»“åº“">æ¨é€åˆ°è¿œç¨‹ä»“åº“</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æ¨é€åˆ°è¿œç¨‹ä»“åº“çš„masteråˆ†æ”¯</span>
</span></span><span class="line"><span class="cl">git push origin master
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¬¬ä¸€æ¬¡æ¨é€æ—¶ï¼Œä½¿ç”¨-uå‚æ•°å…³è”æœ¬åœ°å’Œè¿œç¨‹åˆ†æ”¯</span>
</span></span><span class="line"><span class="cl">git push -u origin master
</span></span></code></pre></div><h3 id="ä»è¿œç¨‹ä»“åº“å…‹éš†">ä»è¿œç¨‹ä»“åº“å…‹éš†</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># å…‹éš†è¿œç¨‹ä»“åº“åˆ°æœ¬åœ°</span>
</span></span><span class="line"><span class="cl">git clone https://github.com/username/repository.git
</span></span></code></pre></div><h3 id="ä»è¿œç¨‹ä»“åº“æ‹‰å–">ä»è¿œç¨‹ä»“åº“æ‹‰å–</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æ‹‰å–è¿œç¨‹ä»“åº“çš„æœ€æ–°å†…å®¹</span>
</span></span><span class="line"><span class="cl">git pull origin master
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æˆ–è€…åˆ†ä¸¤æ­¥æ“ä½œ</span>
</span></span><span class="line"><span class="cl">git fetch origin
</span></span><span class="line"><span class="cl">git merge origin/master
</span></span></code></pre></div><h2 id="åˆ†æ”¯ç®¡ç†">åˆ†æ”¯ç®¡ç†</h2>
<h3 id="åˆ†æ”¯åŸºæœ¬æ“ä½œ">åˆ†æ”¯åŸºæœ¬æ“ä½œ</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹åˆ†æ”¯</span>
</span></span><span class="line"><span class="cl">git branch
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åˆ›å»ºåˆ†æ”¯</span>
</span></span><span class="line"><span class="cl">git branch &lt;branch-name&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åˆ‡æ¢åˆ†æ”¯</span>
</span></span><span class="line"><span class="cl">git checkout &lt;branch-name&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åˆ›å»ºå¹¶åˆ‡æ¢åˆ†æ”¯</span>
</span></span><span class="line"><span class="cl">git checkout -b &lt;branch-name&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åˆå¹¶åˆ†æ”¯åˆ°å½“å‰åˆ†æ”¯</span>
</span></span><span class="line"><span class="cl">git merge &lt;branch-name&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åˆ é™¤åˆ†æ”¯</span>
</span></span><span class="line"><span class="cl">git branch -d &lt;branch-name&gt;
</span></span></code></pre></div><h3 id="åˆ†æ”¯ç®¡ç†ç­–ç•¥">åˆ†æ”¯ç®¡ç†ç­–ç•¥</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># ç¦ç”¨Fast forwardæ¨¡å¼åˆå¹¶</span>
</span></span><span class="line"><span class="cl">git merge --no-ff -m <span class="s2">&#34;merge with no-ff&#34;</span> dev
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹åˆ†æ”¯å†å²</span>
</span></span><span class="line"><span class="cl">git log --graph --pretty<span class="o">=</span>oneline --abbrev-commit
</span></span></code></pre></div><h2 id="å®ç”¨æŠ€å·§">å®ç”¨æŠ€å·§</h2>
<h3 id="1-é…ç½®git">1. é…ç½®Git</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># é…ç½®ç”¨æˆ·ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">git config --global user.name <span class="s2">&#34;Your Name&#34;</span>
</span></span><span class="line"><span class="cl">git config --global user.email <span class="s2">&#34;email@example.com&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># é…ç½®åˆ«å</span>
</span></span><span class="line"><span class="cl">git config --global alias.st status
</span></span><span class="line"><span class="cl">git config --global alias.co checkout
</span></span><span class="line"><span class="cl">git config --global alias.ci commit
</span></span><span class="line"><span class="cl">git config --global alias.br branch
</span></span></code></pre></div><h3 id="2-å¿½ç•¥æ–‡ä»¶">2. å¿½ç•¥æ–‡ä»¶</h3>
<p>åˆ›å»º<code>.gitignore</code>æ–‡ä»¶ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># å¿½ç•¥æ‰€æœ‰.logæ–‡ä»¶</span>
</span></span><span class="line"><span class="cl">*.log
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¿½ç•¥node_modulesç›®å½•</span>
</span></span><span class="line"><span class="cl">node_modules/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¿½ç•¥ç‰¹å®šæ–‡ä»¶</span>
</span></span><span class="line"><span class="cl">config.ini
</span></span></code></pre></div><h3 id="3-æ ‡ç­¾ç®¡ç†">3. æ ‡ç­¾ç®¡ç†</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># åˆ›å»ºæ ‡ç­¾</span>
</span></span><span class="line"><span class="cl">git tag v1.0
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åˆ›å»ºå¸¦è¯´æ˜çš„æ ‡ç­¾</span>
</span></span><span class="line"><span class="cl">git tag -a v1.0 -m <span class="s2">&#34;version 1.0 released&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹æ ‡ç­¾</span>
</span></span><span class="line"><span class="cl">git tag
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ¨é€æ ‡ç­¾åˆ°è¿œç¨‹</span>
</span></span><span class="line"><span class="cl">git push origin v1.0
</span></span><span class="line"><span class="cl">git push origin --tags
</span></span></code></pre></div><h2 id="å¸¸è§é—®é¢˜è§£å†³">å¸¸è§é—®é¢˜è§£å†³</h2>
<h3 id="1-åˆå¹¶å†²çª">1. åˆå¹¶å†²çª</h3>
<p>å½“Gitæ— æ³•è‡ªåŠ¨åˆå¹¶åˆ†æ”¯æ—¶ï¼Œéœ€è¦æ‰‹åŠ¨è§£å†³å†²çªï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹å†²çªæ–‡ä»¶</span>
</span></span><span class="line"><span class="cl">git status
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¼–è¾‘å†²çªæ–‡ä»¶ï¼Œè§£å†³å†²çªå</span>
</span></span><span class="line"><span class="cl">git add &lt;conflict-file&gt;
</span></span><span class="line"><span class="cl">git commit -m <span class="s2">&#34;resolve conflict&#34;</span>
</span></span></code></pre></div><h3 id="2-æš‚å­˜å·¥ä½œç°åœº">2. æš‚å­˜å·¥ä½œç°åœº</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æš‚å­˜å½“å‰å·¥ä½œç°åœº</span>
</span></span><span class="line"><span class="cl">git stash
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹æš‚å­˜åˆ—è¡¨</span>
</span></span><span class="line"><span class="cl">git stash list
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ¢å¤æš‚å­˜çš„å·¥ä½œç°åœº</span>
</span></span><span class="line"><span class="cl">git stash pop
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æˆ–è€…</span>
</span></span><span class="line"><span class="cl">git stash apply
</span></span><span class="line"><span class="cl">git stash drop
</span></span></code></pre></div><h3 id="3-ä¿®æ”¹æœ€åä¸€æ¬¡æäº¤">3. ä¿®æ”¹æœ€åä¸€æ¬¡æäº¤</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># ä¿®æ”¹æœ€åä¸€æ¬¡æäº¤çš„è¯´æ˜</span>
</span></span><span class="line"><span class="cl">git commit --amend -m <span class="s2">&#34;new commit message&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å‘æœ€åä¸€æ¬¡æäº¤æ·»åŠ æ–‡ä»¶</span>
</span></span><span class="line"><span class="cl">git add forgotten-file.txt
</span></span><span class="line"><span class="cl">git commit --amend --no-edit
</span></span></code></pre></div><h2 id="æœ€ä½³å®è·µ">æœ€ä½³å®è·µ</h2>
<h3 id="1-æäº¤è§„èŒƒ">1. æäº¤è§„èŒƒ</h3>
<ul>
<li>æäº¤ä¿¡æ¯è¦æ¸…æ™°æ˜äº†</li>
<li>æ¯æ¬¡æäº¤åªåšä¸€ä»¶äº‹</li>
<li>æäº¤å‰æ£€æŸ¥ä»£ç è´¨é‡</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># å¥½çš„æäº¤ä¿¡æ¯ç¤ºä¾‹</span>
</span></span><span class="line"><span class="cl">git commit -m <span class="s2">&#34;feat: add user authentication&#34;</span>
</span></span><span class="line"><span class="cl">git commit -m <span class="s2">&#34;fix: resolve login button click issue&#34;</span>
</span></span><span class="line"><span class="cl">git commit -m <span class="s2">&#34;docs: update README with installation guide&#34;</span>
</span></span></code></pre></div><h3 id="2-åˆ†æ”¯ç­–ç•¥">2. åˆ†æ”¯ç­–ç•¥</h3>
<ul>
<li><code>master/main</code>ï¼šç¨³å®šçš„ç”Ÿäº§åˆ†æ”¯</li>
<li><code>develop</code>ï¼šå¼€å‘åˆ†æ”¯</li>
<li><code>feature/*</code>ï¼šåŠŸèƒ½åˆ†æ”¯</li>
<li><code>hotfix/*</code>ï¼šç´§æ€¥ä¿®å¤åˆ†æ”¯</li>
</ul>
<h3 id="3-å·¥ä½œæµç¨‹">3. å·¥ä½œæµç¨‹</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 1. ä»ä¸»åˆ†æ”¯åˆ›å»ºåŠŸèƒ½åˆ†æ”¯</span>
</span></span><span class="line"><span class="cl">git checkout -b feature/new-feature
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 2. å¼€å‘å¹¶æäº¤</span>
</span></span><span class="line"><span class="cl">git add .
</span></span><span class="line"><span class="cl">git commit -m <span class="s2">&#34;implement new feature&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 3. æ¨é€åˆ°è¿œç¨‹</span>
</span></span><span class="line"><span class="cl">git push origin feature/new-feature
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 4. åˆ›å»ºPull Request/Merge Request</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 5. åˆå¹¶ååˆ é™¤åˆ†æ”¯</span>
</span></span><span class="line"><span class="cl">git checkout main
</span></span><span class="line"><span class="cl">git pull origin main
</span></span><span class="line"><span class="cl">git branch -d feature/new-feature
</span></span></code></pre></div><h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>Gitæ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼ŒæŒæ¡å…¶åŸºæœ¬æ¦‚å¿µå’Œå¸¸ç”¨æ“ä½œå¯¹äºè½¯ä»¶å¼€å‘è‡³å…³é‡è¦ã€‚é€šè¿‡ç†è§£å·¥ä½œåŒºã€æš‚å­˜åŒºã€ç‰ˆæœ¬åº“çš„æ¦‚å¿µï¼Œä»¥åŠç†Ÿç»ƒä½¿ç”¨å„ç§Gitå‘½ä»¤ï¼Œå¯ä»¥æœ‰æ•ˆåœ°ç®¡ç†ä»£ç ç‰ˆæœ¬ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚</p>
<h3 id="æ ¸å¿ƒè¦ç‚¹">æ ¸å¿ƒè¦ç‚¹</h3>
<ol>
<li><strong>ä¸‰ä¸ªåŒºåŸŸ</strong>ï¼šå·¥ä½œåŒºã€æš‚å­˜åŒºã€ç‰ˆæœ¬åº“</li>
<li><strong>åŸºæœ¬æµç¨‹</strong>ï¼šä¿®æ”¹ â†’ add â†’ commit â†’ push</li>
<li><strong>ç‰ˆæœ¬ç®¡ç†</strong>ï¼šä½¿ç”¨commit idå’ŒHEADæŒ‡é’ˆ</li>
<li><strong>åˆ†æ”¯ç®¡ç†</strong>ï¼šå¹¶è¡Œå¼€å‘ï¼Œåˆå¹¶ä»£ç </li>
<li><strong>è¿œç¨‹åä½œ</strong>ï¼šcloneã€pullã€push</li>
</ol>
<p>è®°ä½è¿™äº›æ ¸å¿ƒæ¦‚å¿µå’Œæ“ä½œï¼Œå°±èƒ½å¤Ÿç†Ÿç»ƒä½¿ç”¨Gitè¿›è¡Œç‰ˆæœ¬æ§åˆ¶äº†ï¼</p>
]]></content:encoded>
    </item>
    <item>
      <title>ä½¿ç”¨Hugoå’ŒPaperModä¸»é¢˜æ­å»ºä¸ªäººåšå®¢</title>
      <link>https://tyhzxh.github.io/posts/hugo-blog-setup/</link>
      <pubDate>Tue, 02 Jan 2024 14:30:00 +0800</pubDate>
      <guid>https://tyhzxh.github.io/posts/hugo-blog-setup/</guid>
      <description>è¯¦ç»†ä»‹ç»å¦‚ä½•ä½¿ç”¨Hugoé™æ€ç«™ç‚¹ç”Ÿæˆå™¨å’ŒPaperModä¸»é¢˜æ­å»ºä¸ªäººåšå®¢</description>
      <content:encoded><![CDATA[<h1 id="ä½¿ç”¨hugoå’Œpapermodä¸»é¢˜æ­å»ºä¸ªäººåšå®¢">ä½¿ç”¨Hugoå’ŒPaperModä¸»é¢˜æ­å»ºä¸ªäººåšå®¢</h1>
<p>åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†è¯¦ç»†ä»‹ç»å¦‚ä½•ä½¿ç”¨Hugoé™æ€ç«™ç‚¹ç”Ÿæˆå™¨å’ŒPaperModä¸»é¢˜æ¥æ­å»ºä¸€ä¸ªåŠŸèƒ½å®Œæ•´ã€è®¾è®¡ç¾è§‚çš„ä¸ªäººåšå®¢ã€‚</p>
<h2 id="ä¸ºä»€ä¹ˆé€‰æ‹©hugo">ä¸ºä»€ä¹ˆé€‰æ‹©Hugoï¼Ÿ</h2>
<p>Hugoæ˜¯ä¸€ä¸ªç”¨Goè¯­è¨€ç¼–å†™çš„é™æ€ç«™ç‚¹ç”Ÿæˆå™¨ï¼Œå…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š</p>
<ul>
<li>âš¡ <strong>æ„å»ºé€Ÿåº¦æå¿«</strong> - å‡ ç§’é’Ÿå°±èƒ½ç”Ÿæˆæ•´ä¸ªç½‘ç«™</li>
<li>ğŸ¨ <strong>ä¸»é¢˜ä¸°å¯Œ</strong> - æœ‰å¤§é‡ç²¾ç¾çš„ä¸»é¢˜å¯ä¾›é€‰æ‹©</li>
<li>ğŸ“ <strong>Markdownæ”¯æŒ</strong> - ä½¿ç”¨Markdownç¼–å†™å†…å®¹</li>
<li>ğŸ”§ <strong>é…ç½®ç®€å•</strong> - é…ç½®æ–‡ä»¶ç®€æ´æ˜äº†</li>
<li>ğŸš€ <strong>éƒ¨ç½²æ–¹ä¾¿</strong> - å¯ä»¥è½»æ¾éƒ¨ç½²åˆ°å„ç§å¹³å°</li>
</ul>
<h2 id="ç¯å¢ƒå‡†å¤‡">ç¯å¢ƒå‡†å¤‡</h2>
<h3 id="1-å®‰è£…hugo">1. å®‰è£…Hugo</h3>
<p><strong>Windowsç”¨æˆ·ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># ä½¿ç”¨Chocolateyå®‰è£…</span>
</span></span><span class="line"><span class="cl">choco install hugo-extended
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æˆ–è€…ä½¿ç”¨Scoopå®‰è£…</span>
</span></span><span class="line"><span class="cl">scoop install hugo-extended
</span></span></code></pre></div><p><strong>macOSç”¨æˆ·ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># ä½¿ç”¨Homebrewå®‰è£…</span>
</span></span><span class="line"><span class="cl">brew install hugo
</span></span></code></pre></div><p><strong>Linuxç”¨æˆ·ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Ubuntu/Debian</span>
</span></span><span class="line"><span class="cl">sudo apt install hugo
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æˆ–è€…ä¸‹è½½äºŒè¿›åˆ¶æ–‡ä»¶</span>
</span></span><span class="line"><span class="cl">wget https://github.com/gohugoio/hugo/releases/download/v0.xxx.x/hugo_extended_0.xxx.x_Linux-64bit.tar.gz
</span></span></code></pre></div><h3 id="2-éªŒè¯å®‰è£…">2. éªŒè¯å®‰è£…</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">hugo version
</span></span></code></pre></div><h2 id="åˆ›å»ºhugoç«™ç‚¹">åˆ›å»ºHugoç«™ç‚¹</h2>
<h3 id="1-åˆ›å»ºæ–°ç«™ç‚¹">1. åˆ›å»ºæ–°ç«™ç‚¹</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">hugo new site my-blog
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> my-blog
</span></span></code></pre></div><h3 id="2-åˆå§‹åŒ–gitä»“åº“">2. åˆå§‹åŒ–Gitä»“åº“</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git init
</span></span></code></pre></div><h2 id="å®‰è£…papermodä¸»é¢˜">å®‰è£…PaperModä¸»é¢˜</h2>
<p>PaperModæ˜¯ä¸€ä¸ªç®€æ´ã€åŠŸèƒ½ä¸°å¯Œçš„Hugoä¸»é¢˜ï¼Œç‰¹åˆ«é€‚åˆæŠ€æœ¯åšå®¢ã€‚</p>
<h3 id="1-æ·»åŠ ä¸»é¢˜ä½œä¸ºgitå­æ¨¡å—">1. æ·»åŠ ä¸»é¢˜ä½œä¸ºGitå­æ¨¡å—</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git submodule add --depth<span class="o">=</span><span class="m">1</span> https://github.com/adityatelange/hugo-PaperMod.git themes/PaperMod
</span></span></code></pre></div><h3 id="2-æ›´æ–°é…ç½®æ–‡ä»¶">2. æ›´æ–°é…ç½®æ–‡ä»¶</h3>
<p>ç¼–è¾‘ <code>hugo.toml</code> æ–‡ä»¶ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-toml" data-lang="toml"><span class="line"><span class="cl"><span class="nx">baseURL</span> <span class="p">=</span> <span class="s1">&#39;https://yourusername.github.io/&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nx">languageCode</span> <span class="p">=</span> <span class="s1">&#39;zh-cn&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nx">title</span> <span class="p">=</span> <span class="s1">&#39;ä½ çš„åšå®¢æ ‡é¢˜&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nx">theme</span> <span class="p">=</span> <span class="s1">&#39;PaperMod&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># å¯ç”¨è¡¨æƒ…ç¬¦å·</span>
</span></span><span class="line"><span class="cl"><span class="nx">enableEmoji</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># åˆ†é¡µè®¾ç½®</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">pagination</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="nx">pagerSize</span> <span class="p">=</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># ä»£ç é«˜äº®è®¾ç½®</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">markup</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nx">markup</span><span class="p">.</span><span class="nx">highlight</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="nx">style</span> <span class="p">=</span> <span class="s2">&#34;github&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">codeFences</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">    <span class="nx">lineNos</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># PaperModä¸»é¢˜é…ç½®</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">params</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="nx">description</span> <span class="p">=</span> <span class="s2">&#34;ä½ çš„åšå®¢æè¿°&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">author</span> <span class="p">=</span> <span class="s2">&#34;ä½ çš„åå­—&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">ShowReadingTime</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">  <span class="nx">ShowShareButtons</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">  <span class="nx">ShowPostNavLinks</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">  <span class="nx">ShowBreadCrumbs</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">  <span class="nx">ShowCodeCopyButtons</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">  <span class="nx">ShowToc</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">  <span class="nx">defaultTheme</span> <span class="p">=</span> <span class="s2">&#34;auto&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c"># é¦–é¡µä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">homeInfoParams</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="nx">Title</span> <span class="p">=</span> <span class="s2">&#34;æ¬¢è¿æ¥åˆ°æˆ‘çš„åšå®¢&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">Content</span> <span class="p">=</span> <span class="s2">&#34;è¿™é‡Œæ˜¯åšå®¢çš„ç®€ä»‹...&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c"># ç¤¾äº¤é“¾æ¥</span>
</span></span><span class="line"><span class="cl">  <span class="p">[[</span><span class="nx">params</span><span class="p">.</span><span class="nx">socialIcons</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">    <span class="nx">name</span> <span class="p">=</span> <span class="s2">&#34;github&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">url</span> <span class="p">=</span> <span class="s2">&#34;https://github.com/yourusername&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># èœå•é…ç½®</span>
</span></span><span class="line"><span class="cl"><span class="p">[[</span><span class="nx">menu</span><span class="p">.</span><span class="nx">main</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">  <span class="nx">name</span> <span class="p">=</span> <span class="s2">&#34;é¦–é¡µ&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">url</span> <span class="p">=</span> <span class="s2">&#34;/&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">weight</span> <span class="p">=</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[[</span><span class="nx">menu</span><span class="p">.</span><span class="nx">main</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">  <span class="nx">name</span> <span class="p">=</span> <span class="s2">&#34;æ–‡ç« &#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">url</span> <span class="p">=</span> <span class="s2">&#34;/posts/&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">weight</span> <span class="p">=</span> <span class="mi">20</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[[</span><span class="nx">menu</span><span class="p">.</span><span class="nx">main</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">  <span class="nx">name</span> <span class="p">=</span> <span class="s2">&#34;æ ‡ç­¾&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">url</span> <span class="p">=</span> <span class="s2">&#34;/tags/&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">weight</span> <span class="p">=</span> <span class="mi">30</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[[</span><span class="nx">menu</span><span class="p">.</span><span class="nx">main</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">  <span class="nx">name</span> <span class="p">=</span> <span class="s2">&#34;å…³äº&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">url</span> <span class="p">=</span> <span class="s2">&#34;/about/&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">weight</span> <span class="p">=</span> <span class="mi">40</span>
</span></span></code></pre></div><h2 id="åˆ›å»ºå†…å®¹">åˆ›å»ºå†…å®¹</h2>
<h3 id="1-åˆ›å»ºå…³äºé¡µé¢">1. åˆ›å»ºå…³äºé¡µé¢</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">hugo new content about.md
</span></span></code></pre></div><p>ç¼–è¾‘ <code>content/about.md</code>ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl">---
</span></span><span class="line"><span class="cl">title: &#34;å…³äºæˆ‘&#34;
</span></span><span class="line"><span class="cl">date: 2024-01-01T00:00:00+08:00
</span></span><span class="line"><span class="cl">draft: false
</span></span><span class="line"><span class="cl">---
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gh"># å…³äºæˆ‘
</span></span></span><span class="line"><span class="cl"><span class="gh"></span>
</span></span><span class="line"><span class="cl">è¿™é‡Œæ˜¯å…³äºé¡µé¢çš„å†…å®¹...
</span></span></code></pre></div><h3 id="2-åˆ›å»ºç¬¬ä¸€ç¯‡æ–‡ç« ">2. åˆ›å»ºç¬¬ä¸€ç¯‡æ–‡ç« </h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">hugo new content posts/my-first-post.md
</span></span></code></pre></div><p>ç¼–è¾‘æ–‡ç« å†…å®¹ï¼Œè®°å¾—å°† <code>draft: true</code> æ”¹ä¸º <code>draft: false</code>ã€‚</p>
<h2 id="æœ¬åœ°é¢„è§ˆ">æœ¬åœ°é¢„è§ˆ</h2>
<p>å¯åŠ¨æœ¬åœ°å¼€å‘æœåŠ¡å™¨ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">hugo server -D
</span></span></code></pre></div><p>æ‰“å¼€æµè§ˆå™¨è®¿é—® <code>http://localhost:1313</code> å³å¯é¢„è§ˆåšå®¢ã€‚</p>
<h2 id="éƒ¨ç½²åˆ°github-pages">éƒ¨ç½²åˆ°GitHub Pages</h2>
<h3 id="1-åˆ›å»ºgithubä»“åº“">1. åˆ›å»ºGitHubä»“åº“</h3>
<p>åœ¨GitHubä¸Šåˆ›å»ºä¸€ä¸ªåä¸º <code>yourusername.github.io</code> çš„ä»“åº“ã€‚</p>
<h3 id="2-é…ç½®github-actions">2. é…ç½®GitHub Actions</h3>
<p>åˆ›å»º <code>.github/workflows/hugo.yml</code> æ–‡ä»¶ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Deploy Hugo site to Pages</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">on</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">push</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">branches</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;main&#34;</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">workflow_dispatch</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">permissions</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">contents</span><span class="p">:</span><span class="w"> </span><span class="l">read</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">pages</span><span class="p">:</span><span class="w"> </span><span class="l">write</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">id-token</span><span class="p">:</span><span class="w"> </span><span class="l">write</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">concurrency</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;pages&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">cancel-in-progress</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">defaults</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">run</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">shell</span><span class="p">:</span><span class="w"> </span><span class="l">bash</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">jobs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">build</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l">ubuntu-latest</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">steps</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Checkout</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l">actions/checkout@v4</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">with</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">submodules</span><span class="p">:</span><span class="w"> </span><span class="l">recursive</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Setup Hugo</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l">peaceiris/actions-hugo@v2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">with</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">hugo-version</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;latest&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">extended</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Build</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l">hugo --minify</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Upload artifact</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l">actions/upload-pages-artifact@v2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">with</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">./public</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">deploy</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">environment</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">github-pages</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l">${{ steps.deployment.outputs.page_url }}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l">ubuntu-latest</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">needs</span><span class="p">:</span><span class="w"> </span><span class="l">build</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">steps</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Deploy to GitHub Pages</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l">deployment</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l">actions/deploy-pages@v2</span><span class="w">
</span></span></span></code></pre></div><h3 id="3-æ¨é€ä»£ç ">3. æ¨é€ä»£ç </h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git add .
</span></span><span class="line"><span class="cl">git commit -m <span class="s2">&#34;Initial commit&#34;</span>
</span></span><span class="line"><span class="cl">git branch -M main
</span></span><span class="line"><span class="cl">git remote add origin https://github.com/yourusername/yourusername.github.io.git
</span></span><span class="line"><span class="cl">git push -u origin main
</span></span></code></pre></div><h3 id="4-å¯ç”¨github-pages">4. å¯ç”¨GitHub Pages</h3>
<p>åœ¨GitHubä»“åº“è®¾ç½®ä¸­ï¼š</p>
<ol>
<li>è¿›å…¥ Settings &gt; Pages</li>
<li>Source é€‰æ‹© &ldquo;GitHub Actions&rdquo;</li>
<li>ç­‰å¾…éƒ¨ç½²å®Œæˆ</li>
</ol>
<h2 id="é«˜çº§é…ç½®">é«˜çº§é…ç½®</h2>
<h3 id="1-è‡ªå®šä¹‰css">1. è‡ªå®šä¹‰CSS</h3>
<p>åˆ›å»º <code>assets/css/extended/custom.css</code>ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-css" data-lang="css"><span class="line"><span class="cl"><span class="c">/* è‡ªå®šä¹‰æ ·å¼ */</span>
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nc">main</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">max-width</span><span class="p">:</span> <span class="mi">800</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">/* ä»£ç å—æ ·å¼ä¼˜åŒ– */</span>
</span></span><span class="line"><span class="cl"><span class="nt">pre</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">border-radius</span><span class="p">:</span> <span class="mi">8</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="2-æ·»åŠ è¯„è®ºç³»ç»Ÿ">2. æ·»åŠ è¯„è®ºç³»ç»Ÿ</h3>
<p>åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-toml" data-lang="toml"><span class="line"><span class="cl"><span class="p">[</span><span class="nx">params</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="nx">comments</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">comments</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="nx">system</span> <span class="p">=</span> <span class="s2">&#34;giscus&#34;</span>  <span class="c"># æˆ–è€… &#34;disqus&#34;</span>
</span></span></code></pre></div><h3 id="3-æ·»åŠ æœç´¢åŠŸèƒ½">3. æ·»åŠ æœç´¢åŠŸèƒ½</h3>
<p>åˆ›å»º <code>content/search.md</code>ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl">---
</span></span><span class="line"><span class="cl">title: &#34;æœç´¢&#34;
</span></span><span class="line"><span class="cl">layout: &#34;search&#34;
</span></span><span class="line"><span class="cl">---
</span></span></code></pre></div><h2 id="å¸¸ç”¨å‘½ä»¤">å¸¸ç”¨å‘½ä»¤</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># åˆ›å»ºæ–°æ–‡ç« </span>
</span></span><span class="line"><span class="cl">hugo new content posts/article-name.md
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æœ¬åœ°é¢„è§ˆï¼ˆåŒ…å«è‰ç¨¿ï¼‰</span>
</span></span><span class="line"><span class="cl">hugo server -D
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ„å»ºç«™ç‚¹</span>
</span></span><span class="line"><span class="cl">hugo
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ¸…ç†ç¼“å­˜</span>
</span></span><span class="line"><span class="cl">hugo mod clean
</span></span></code></pre></div><h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>é€šè¿‡ä»¥ä¸Šæ­¥éª¤ï¼Œä½ å°±æˆåŠŸæ­å»ºäº†ä¸€ä¸ªåŸºäºHugoå’ŒPaperModä¸»é¢˜çš„ä¸ªäººåšå®¢ã€‚è¿™ä¸ªåšå®¢å…·æœ‰ï¼š</p>
<ul>
<li>ğŸ¨ ç®€æ´ç¾è§‚çš„è®¾è®¡</li>
<li>ğŸ“± å“åº”å¼å¸ƒå±€</li>
<li>ğŸ” æœç´¢åŠŸèƒ½</li>
<li>ğŸ·ï¸ æ ‡ç­¾å’Œåˆ†ç±»</li>
<li>ğŸ“Š é˜…è¯»æ—¶é—´æ˜¾ç¤º</li>
<li>ğŸŒ™ æ·±è‰²æ¨¡å¼æ”¯æŒ</li>
<li>ğŸ“ Markdownç¼–å†™æ”¯æŒ</li>
</ul>
<p>æ¥ä¸‹æ¥ä½ å¯ä»¥ï¼š</p>
<ol>
<li>è‡ªå®šä¹‰ä¸»é¢˜æ ·å¼</li>
<li>æ·»åŠ æ›´å¤šåŠŸèƒ½æ’ä»¶</li>
<li>ä¼˜åŒ–SEOè®¾ç½®</li>
<li>å®šæœŸæ›´æ–°å†…å®¹</li>
</ol>
<p>å¸Œæœ›è¿™ç¯‡æ•™ç¨‹å¯¹ä½ æœ‰å¸®åŠ©ï¼å¦‚æœæœ‰ä»»ä½•é—®é¢˜ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºè®¨è®ºã€‚</p>
<hr>
<p><em>å‚è€ƒèµ„æ–™ï¼š</em></p>
<ul>
<li><a href="https://gohugo.io/documentation/">Hugoå®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://github.com/adityatelange/hugo-PaperMod">PaperModä¸»é¢˜æ–‡æ¡£</a></li>
<li><a href="https://docs.github.com/en/pages">GitHub Pagesæ–‡æ¡£</a></li>
</ul>
]]></content:encoded>
    </item>
    <item>
      <title>æ¬¢è¿æ¥åˆ°æˆ‘çš„åšå®¢ï¼</title>
      <link>https://tyhzxh.github.io/posts/welcome/</link>
      <pubDate>Mon, 01 Jan 2024 10:00:00 +0800</pubDate>
      <guid>https://tyhzxh.github.io/posts/welcome/</guid>
      <description>åšå®¢å¼€é€šçš„ç¬¬ä¸€ç¯‡æ–‡ç« </description>
      <content:encoded><![CDATA[<h1 id="æ¬¢è¿æ¥åˆ°æˆ‘çš„åšå®¢">æ¬¢è¿æ¥åˆ°æˆ‘çš„åšå®¢ï¼ğŸ‰</h1>
<p>å¤§å®¶å¥½ï¼æ¬¢è¿æ¥åˆ°æˆ‘çš„ä¸ªäººåšå®¢ã€‚è¿™æ˜¯æˆ‘åœ¨è¿™é‡Œå‘å¸ƒçš„ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œæˆ‘æƒ³å€Ÿæ­¤æœºä¼šå‘å¤§å®¶ä»‹ç»ä¸€ä¸‹è¿™ä¸ªåšå®¢çš„ç›®çš„å’Œå†…å®¹ã€‚</p>
<h2 id="ä¸ºä»€ä¹ˆè¦å†™åšå®¢">ä¸ºä»€ä¹ˆè¦å†™åšå®¢ï¼Ÿ</h2>
<p>å†™åšå®¢å¯¹æˆ‘æ¥è¯´æœ‰å‡ ä¸ªé‡è¦çš„æ„ä¹‰ï¼š</p>
<ol>
<li>
<p><strong>çŸ¥è¯†åˆ†äº«</strong> ğŸ“š<br>
å°†æˆ‘åœ¨å­¦ä¹ å’Œå·¥ä½œä¸­ç§¯ç´¯çš„ç»éªŒåˆ†äº«ç»™å¤§å®¶ï¼Œå¸Œæœ›èƒ½å¤Ÿå¸®åŠ©åˆ°æœ‰éœ€è¦çš„äººã€‚</p>
</li>
<li>
<p><strong>å­¦ä¹ è®°å½•</strong> âœï¸<br>
é€šè¿‡å†™ä½œæ¥æ•´ç†å’Œå·©å›ºè‡ªå·±çš„çŸ¥è¯†ï¼Œ&ldquo;æ•™å­¦ç›¸é•¿&quot;æ˜¯æœ€å¥½çš„å­¦ä¹ æ–¹å¼ä¹‹ä¸€ã€‚</p>
</li>
<li>
<p><strong>æ€è€ƒæ²‰æ·€</strong> ğŸ¤”<br>
è®°å½•è‡ªå·±çš„æ€è€ƒè¿‡ç¨‹å’Œæ„Ÿæ‚Ÿï¼Œå½¢æˆè‡ªå·±çš„çŸ¥è¯†ä½“ç³»ã€‚</p>
</li>
<li>
<p><strong>æŠ€æœ¯äº¤æµ</strong> ğŸ’¬<br>
ä¸åŒè¡Œä»¬äº¤æµæŠ€æœ¯å¿ƒå¾—ï¼Œå…±åŒè¿›æ­¥ã€‚</p>
</li>
</ol>
<h2 id="åšå®¢å†…å®¹è§„åˆ’">åšå®¢å†…å®¹è§„åˆ’</h2>
<p>è¿™ä¸ªåšå®¢ä¸»è¦ä¼šåŒ…å«ä»¥ä¸‹å‡ ç±»å†…å®¹ï¼š</p>
<h3 id="æŠ€æœ¯æ–‡ç« -">æŠ€æœ¯æ–‡ç«  ğŸ’»</h3>
<ul>
<li>ç¼–ç¨‹è¯­è¨€å­¦ä¹ å¿ƒå¾—</li>
<li>æ¡†æ¶å’Œå·¥å…·ä½¿ç”¨ç»éªŒ</li>
<li>é¡¹ç›®å¼€å‘æ€»ç»“</li>
<li>é—®é¢˜è§£å†³æ–¹æ¡ˆ</li>
</ul>
<h3 id="å­¦ä¹ ç¬”è®°-">å­¦ä¹ ç¬”è®° ğŸ“–</h3>
<ul>
<li>è¯»ä¹¦ç¬”è®°å’Œå¿ƒå¾—</li>
<li>åœ¨çº¿è¯¾ç¨‹å­¦ä¹ æ€»ç»“</li>
<li>æŠ€æœ¯æ–‡æ¡£ç¿»è¯‘å’Œè§£è¯»</li>
</ul>
<h3 id="ç”Ÿæ´»æ„Ÿæ‚Ÿ-">ç”Ÿæ´»æ„Ÿæ‚Ÿ ğŸŒŸ</h3>
<ul>
<li>å·¥ä½œå’Œå­¦ä¹ çš„æ€è€ƒ</li>
<li>ä¸ªäººæˆé•¿ç»å†</li>
<li>ç”Ÿæ´»ä¸­çš„æœ‰è¶£å‘ç°</li>
</ul>
<h2 id="æŠ€æœ¯æ ˆä»‹ç»">æŠ€æœ¯æ ˆä»‹ç»</h2>
<p>è¿™ä¸ªåšå®¢ä½¿ç”¨äº†ä»¥ä¸‹æŠ€æœ¯ï¼š</p>
<ul>
<li><strong>é™æ€ç«™ç‚¹ç”Ÿæˆå™¨</strong>: <a href="https://gohugo.io/">Hugo</a></li>
<li><strong>ä¸»é¢˜</strong>: <a href="https://github.com/adityatelange/hugo-PaperMod">PaperMod</a></li>
<li><strong>æ‰˜ç®¡å¹³å°</strong>: GitHub Pages</li>
<li><strong>åŸŸå</strong>: GitHubæä¾›çš„å…è´¹åŸŸå</li>
</ul>
<p>é€‰æ‹©Hugoæ˜¯å› ä¸ºå®ƒæ„å»ºé€Ÿåº¦å¿«ï¼Œé…ç½®ç®€å•ï¼Œè€ŒPaperModä¸»é¢˜ç®€æ´ç¾è§‚ï¼ŒåŠŸèƒ½é½å…¨ã€‚</p>
<h2 id="æœªæ¥è®¡åˆ’">æœªæ¥è®¡åˆ’</h2>
<p>æ¥ä¸‹æ¥æˆ‘è®¡åˆ’ï¼š</p>
<ul>
<li>å®šæœŸæ›´æ–°æŠ€æœ¯æ–‡ç« </li>
<li>åˆ†äº«é¡¹ç›®å¼€å‘ç»éªŒ</li>
<li>è®°å½•å­¦ä¹ æ–°æŠ€æœ¯çš„è¿‡ç¨‹</li>
<li>ä¸è¯»è€…äº’åŠ¨äº¤æµ</li>
</ul>
<h2 id="ç»“è¯­">ç»“è¯­</h2>
<p>æ„Ÿè°¢ä½ èŠ±æ—¶é—´é˜…è¯»è¿™ç¯‡æ–‡ç« ï¼å¦‚æœä½ å¯¹æŸä¸ªè¯é¢˜ç‰¹åˆ«æ„Ÿå…´è¶£ï¼Œæˆ–è€…æœ‰ä»»ä½•å»ºè®®ï¼Œæ¬¢è¿é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»æˆ‘ï¼š</p>
<ul>
<li>GitHub: <a href="https://github.com/tyhzxh">https://github.com/tyhzxh</a></li>
<li>Email: <a href="mailto:your-email@example.com">your-email@example.com</a></li>
</ul>
<p>è®©æˆ‘ä»¬ä¸€èµ·åœ¨æŠ€æœ¯çš„é“è·¯ä¸Šä¸æ–­å‰è¿›ï¼ğŸš€</p>
<hr>
<p><em>è¿™ç¯‡æ–‡ç« æ ‡å¿—ç€æˆ‘åšå®¢ä¹‹æ—…çš„å¼€å§‹ï¼ŒæœŸå¾…ä¸å¤§å®¶åˆ†äº«æ›´å¤šæœ‰ä»·å€¼çš„å†…å®¹ï¼</em></p>
]]></content:encoded>
    </item>
  </channel>
</rss>
